<!DOCTYPE html>
<html data-init="no-js">
<head>
<meta charset="UTF-8" />
<title>Queen of the Seas</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<!--

SugarCube (v2.19.0): A free (gratis and libre) story format.

Copyright © 2013–2017 Thomas Michael Edwards <thomasmedwards@gmail.com>.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice, this
   list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright notice,
   this list of conditions and the following disclaimer in the documentation
   and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

-->
<script id="script-libraries" type="text/javascript">
if(document.head&&document.addEventListener&&document.querySelector&&Object.create&&Object.freeze&&JSON){document.documentElement.setAttribute("data-init", "loading");
/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js */
if("document" in self){if(!("classList" in document.createElement("_"))){(function(j){"use strict";if(!("Element" in j)){return}var a="classList",f="prototype",m=j.Element[f],b=Object,k=String[f].trim||function(){return this.replace(/^\s+|\s+$/g,"")},c=Array[f].indexOf||function(q){var p=0,o=this.length;for(;p<o;p++){if(p in this&&this[p]===q){return p}}return -1},n=function(o,p){this.name=o;this.code=DOMException[o];this.message=p},g=function(p,o){if(o===""){throw new n("SYNTAX_ERR","An invalid or illegal string was specified")}if(/\s/.test(o)){throw new n("INVALID_CHARACTER_ERR","String contains an invalid character")}return c.call(p,o)},d=function(s){var r=k.call(s.getAttribute("class")||""),q=r?r.split(/\s+/):[],p=0,o=q.length;for(;p<o;p++){this.push(q[p])}this._updateClassName=function(){s.setAttribute("class",this.toString())}},e=d[f]=[],i=function(){return new d(this)};n[f]=Error[f];e.item=function(o){return this[o]||null};e.contains=function(o){o+="";return g(this,o)!==-1};e.add=function(){var s=arguments,r=0,p=s.length,q,o=false;do{q=s[r]+"";if(g(this,q)===-1){this.push(q);o=true}}while(++r<p);if(o){this._updateClassName()}};e.remove=function(){var t=arguments,s=0,p=t.length,r,o=false,q;do{r=t[s]+"";q=g(this,r);while(q!==-1){this.splice(q,1);o=true;q=g(this,r)}}while(++s<p);if(o){this._updateClassName()}};e.toggle=function(p,q){p+="";var o=this.contains(p),r=o?q!==true&&"remove":q!==false&&"add";if(r){this[r](p)}if(q===true||q===false){return q}else{return !o}};e.toString=function(){return this.join(" ")};if(b.defineProperty){var l={get:i,enumerable:true,configurable:true};try{b.defineProperty(m,a,l)}catch(h){if(h.number===-2146823252){l.enumerable=false;b.defineProperty(m,a,l)}}}else{if(b[f].__defineGetter__){m.__defineGetter__(a,i)}}}(self))}else{(function(){var b=document.createElement("_");b.classList.add("c1","c2");if(!b.classList.contains("c2")){var c=function(e){var d=DOMTokenList.prototype[e];DOMTokenList.prototype[e]=function(h){var g,f=arguments.length;for(g=0;g<f;g++){h=arguments[g];d.call(this,h)}}};c("add");c("remove")}b.classList.toggle("c3",false);if(b.classList.contains("c3")){var a=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(d,e){if(1 in arguments&&!this.contains(d)===!e){return e}else{return a.call(this,d)}}}b=null}())}};
/*!
 * https://github.com/es-shims/es5-shim
 * @license es5-shim Copyright 2009-2015 by contributors, MIT License
 * see https://github.com/es-shims/es5-shim/blob/v4.5.9/LICENSE
 */
(function(t,r){"use strict";if(typeof define==="function"&&define.amd){define(r)}else if(typeof exports==="object"){module.exports=r()}else{t.returnExports=r()}})(this,function(){var t=Array;var r=t.prototype;var e=Object;var n=e.prototype;var i=Function;var a=i.prototype;var o=String;var f=o.prototype;var u=Number;var l=u.prototype;var s=r.slice;var c=r.splice;var v=r.push;var h=r.unshift;var p=r.concat;var y=r.join;var d=a.call;var g=a.apply;var w=Math.max;var b=Math.min;var T=n.toString;var m=typeof Symbol==="function"&&typeof Symbol.toStringTag==="symbol";var D;var S=Function.prototype.toString,x=/^\s*class /,O=function isES6ClassFn(t){try{var r=S.call(t);var e=r.replace(/\/\/.*\n/g,"");var n=e.replace(/\/\*[.\s\S]*\*\//g,"");var i=n.replace(/\n/gm," ").replace(/ {2}/g," ");return x.test(i)}catch(a){return false}},j=function tryFunctionObject(t){try{if(O(t)){return false}S.call(t);return true}catch(r){return false}},E="[object Function]",I="[object GeneratorFunction]",D=function isCallable(t){if(!t){return false}if(typeof t!=="function"&&typeof t!=="object"){return false}if(m){return j(t)}if(O(t)){return false}var r=T.call(t);return r===E||r===I};var M;var U=RegExp.prototype.exec,F=function tryRegexExec(t){try{U.call(t);return true}catch(r){return false}},N="[object RegExp]";M=function isRegex(t){if(typeof t!=="object"){return false}return m?F(t):T.call(t)===N};var C;var k=String.prototype.valueOf,A=function tryStringObject(t){try{k.call(t);return true}catch(r){return false}},R="[object String]";C=function isString(t){if(typeof t==="string"){return true}if(typeof t!=="object"){return false}return m?A(t):T.call(t)===R};var P=e.defineProperty&&function(){try{var t={};e.defineProperty(t,"x",{enumerable:false,value:t});for(var r in t){return false}return t.x===t}catch(n){return false}}();var $=function(t){var r;if(P){r=function(t,r,n,i){if(!i&&r in t){return}e.defineProperty(t,r,{configurable:true,enumerable:false,writable:true,value:n})}}else{r=function(t,r,e,n){if(!n&&r in t){return}t[r]=e}}return function defineProperties(e,n,i){for(var a in n){if(t.call(n,a)){r(e,a,n[a],i)}}}}(n.hasOwnProperty);var J=function isPrimitive(t){var r=typeof t;return t===null||r!=="object"&&r!=="function"};var Y=u.isNaN||function isActualNaN(t){return t!==t};var Z={ToInteger:function ToInteger(t){var r=+t;if(Y(r)){r=0}else if(r!==0&&r!==1/0&&r!==-(1/0)){r=(r>0||-1)*Math.floor(Math.abs(r))}return r},ToPrimitive:function ToPrimitive(t){var r,e,n;if(J(t)){return t}e=t.valueOf;if(D(e)){r=e.call(t);if(J(r)){return r}}n=t.toString;if(D(n)){r=n.call(t);if(J(r)){return r}}throw new TypeError},ToObject:function(t){if(t==null){throw new TypeError("can't convert "+t+" to object")}return e(t)},ToUint32:function ToUint32(t){return t>>>0}};var z=function Empty(){};$(a,{bind:function bind(t){var r=this;if(!D(r)){throw new TypeError("Function.prototype.bind called on incompatible "+r)}var n=s.call(arguments,1);var a;var o=function(){if(this instanceof a){var i=g.call(r,this,p.call(n,s.call(arguments)));if(e(i)===i){return i}return this}else{return g.call(r,t,p.call(n,s.call(arguments)))}};var f=w(0,r.length-n.length);var u=[];for(var l=0;l<f;l++){v.call(u,"$"+l)}a=i("binder","return function ("+y.call(u,",")+"){ return binder.apply(this, arguments); }")(o);if(r.prototype){z.prototype=r.prototype;a.prototype=new z;z.prototype=null}return a}});var G=d.bind(n.hasOwnProperty);var B=d.bind(n.toString);var H=d.bind(s);var W=g.bind(s);var L=d.bind(f.slice);var X=d.bind(f.split);var q=d.bind(f.indexOf);var K=d.bind(v);var Q=d.bind(n.propertyIsEnumerable);var V=d.bind(r.sort);var _=t.isArray||function isArray(t){return B(t)==="[object Array]"};var tt=[].unshift(0)!==1;$(r,{unshift:function(){h.apply(this,arguments);return this.length}},tt);$(t,{isArray:_});var rt=e("a");var et=rt[0]!=="a"||!(0 in rt);var nt=function properlyBoxed(t){var r=true;var e=true;var n=false;if(t){try{t.call("foo",function(t,e,n){if(typeof n!=="object"){r=false}});t.call([1],function(){"use strict";e=typeof this==="string"},"x")}catch(i){n=true}}return!!t&&!n&&r&&e};$(r,{forEach:function forEach(t){var r=Z.ToObject(this);var e=et&&C(this)?X(this,""):r;var n=-1;var i=Z.ToUint32(e.length);var a;if(arguments.length>1){a=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.forEach callback must be a function")}while(++n<i){if(n in e){if(typeof a==="undefined"){t(e[n],n,r)}else{t.call(a,e[n],n,r)}}}}},!nt(r.forEach));$(r,{map:function map(r){var e=Z.ToObject(this);var n=et&&C(this)?X(this,""):e;var i=Z.ToUint32(n.length);var a=t(i);var o;if(arguments.length>1){o=arguments[1]}if(!D(r)){throw new TypeError("Array.prototype.map callback must be a function")}for(var f=0;f<i;f++){if(f in n){if(typeof o==="undefined"){a[f]=r(n[f],f,e)}else{a[f]=r.call(o,n[f],f,e)}}}return a}},!nt(r.map));$(r,{filter:function filter(t){var r=Z.ToObject(this);var e=et&&C(this)?X(this,""):r;var n=Z.ToUint32(e.length);var i=[];var a;var o;if(arguments.length>1){o=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.filter callback must be a function")}for(var f=0;f<n;f++){if(f in e){a=e[f];if(typeof o==="undefined"?t(a,f,r):t.call(o,a,f,r)){K(i,a)}}}return i}},!nt(r.filter));$(r,{every:function every(t){var r=Z.ToObject(this);var e=et&&C(this)?X(this,""):r;var n=Z.ToUint32(e.length);var i;if(arguments.length>1){i=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.every callback must be a function")}for(var a=0;a<n;a++){if(a in e&&!(typeof i==="undefined"?t(e[a],a,r):t.call(i,e[a],a,r))){return false}}return true}},!nt(r.every));$(r,{some:function some(t){var r=Z.ToObject(this);var e=et&&C(this)?X(this,""):r;var n=Z.ToUint32(e.length);var i;if(arguments.length>1){i=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.some callback must be a function")}for(var a=0;a<n;a++){if(a in e&&(typeof i==="undefined"?t(e[a],a,r):t.call(i,e[a],a,r))){return true}}return false}},!nt(r.some));var it=false;if(r.reduce){it=typeof r.reduce.call("es5",function(t,r,e,n){return n})==="object"}$(r,{reduce:function reduce(t){var r=Z.ToObject(this);var e=et&&C(this)?X(this,""):r;var n=Z.ToUint32(e.length);if(!D(t)){throw new TypeError("Array.prototype.reduce callback must be a function")}if(n===0&&arguments.length===1){throw new TypeError("reduce of empty array with no initial value")}var i=0;var a;if(arguments.length>=2){a=arguments[1]}else{do{if(i in e){a=e[i++];break}if(++i>=n){throw new TypeError("reduce of empty array with no initial value")}}while(true)}for(;i<n;i++){if(i in e){a=t(a,e[i],i,r)}}return a}},!it);var at=false;if(r.reduceRight){at=typeof r.reduceRight.call("es5",function(t,r,e,n){return n})==="object"}$(r,{reduceRight:function reduceRight(t){var r=Z.ToObject(this);var e=et&&C(this)?X(this,""):r;var n=Z.ToUint32(e.length);if(!D(t)){throw new TypeError("Array.prototype.reduceRight callback must be a function")}if(n===0&&arguments.length===1){throw new TypeError("reduceRight of empty array with no initial value")}var i;var a=n-1;if(arguments.length>=2){i=arguments[1]}else{do{if(a in e){i=e[a--];break}if(--a<0){throw new TypeError("reduceRight of empty array with no initial value")}}while(true)}if(a<0){return i}do{if(a in e){i=t(i,e[a],a,r)}}while(a--);return i}},!at);var ot=r.indexOf&&[0,1].indexOf(1,2)!==-1;$(r,{indexOf:function indexOf(t){var r=et&&C(this)?X(this,""):Z.ToObject(this);var e=Z.ToUint32(r.length);if(e===0){return-1}var n=0;if(arguments.length>1){n=Z.ToInteger(arguments[1])}n=n>=0?n:w(0,e+n);for(;n<e;n++){if(n in r&&r[n]===t){return n}}return-1}},ot);var ft=r.lastIndexOf&&[0,1].lastIndexOf(0,-3)!==-1;$(r,{lastIndexOf:function lastIndexOf(t){var r=et&&C(this)?X(this,""):Z.ToObject(this);var e=Z.ToUint32(r.length);if(e===0){return-1}var n=e-1;if(arguments.length>1){n=b(n,Z.ToInteger(arguments[1]))}n=n>=0?n:e-Math.abs(n);for(;n>=0;n--){if(n in r&&t===r[n]){return n}}return-1}},ft);var ut=function(){var t=[1,2];var r=t.splice();return t.length===2&&_(r)&&r.length===0}();$(r,{splice:function splice(t,r){if(arguments.length===0){return[]}else{return c.apply(this,arguments)}}},!ut);var lt=function(){var t={};r.splice.call(t,0,0,1);return t.length===1}();$(r,{splice:function splice(t,r){if(arguments.length===0){return[]}var e=arguments;this.length=w(Z.ToInteger(this.length),0);if(arguments.length>0&&typeof r!=="number"){e=H(arguments);if(e.length<2){K(e,this.length-t)}else{e[1]=Z.ToInteger(r)}}return c.apply(this,e)}},!lt);var st=function(){var r=new t(1e5);r[8]="x";r.splice(1,1);return r.indexOf("x")===7}();var ct=function(){var t=256;var r=[];r[t]="a";r.splice(t+1,0,"b");return r[t]==="a"}();$(r,{splice:function splice(t,r){var e=Z.ToObject(this);var n=[];var i=Z.ToUint32(e.length);var a=Z.ToInteger(t);var f=a<0?w(i+a,0):b(a,i);var u=b(w(Z.ToInteger(r),0),i-f);var l=0;var s;while(l<u){s=o(f+l);if(G(e,s)){n[l]=e[s]}l+=1}var c=H(arguments,2);var v=c.length;var h;if(v<u){l=f;var p=i-u;while(l<p){s=o(l+u);h=o(l+v);if(G(e,s)){e[h]=e[s]}else{delete e[h]}l+=1}l=i;var y=i-u+v;while(l>y){delete e[l-1];l-=1}}else if(v>u){l=i-u;while(l>f){s=o(l+u-1);h=o(l+v-1);if(G(e,s)){e[h]=e[s]}else{delete e[h]}l-=1}}l=f;for(var d=0;d<c.length;++d){e[l]=c[d];l+=1}e.length=i-u+v;return n}},!st||!ct);var vt=r.join;var ht;try{ht=Array.prototype.join.call("123",",")!=="1,2,3"}catch(pt){ht=true}if(ht){$(r,{join:function join(t){var r=typeof t==="undefined"?",":t;return vt.call(C(this)?X(this,""):this,r)}},ht)}var yt=[1,2].join(undefined)!=="1,2";if(yt){$(r,{join:function join(t){var r=typeof t==="undefined"?",":t;return vt.call(this,r)}},yt)}var dt=function push(t){var r=Z.ToObject(this);var e=Z.ToUint32(r.length);var n=0;while(n<arguments.length){r[e+n]=arguments[n];n+=1}r.length=e+n;return e+n};var gt=function(){var t={};var r=Array.prototype.push.call(t,undefined);return r!==1||t.length!==1||typeof t[0]!=="undefined"||!G(t,0)}();$(r,{push:function push(t){if(_(this)){return v.apply(this,arguments)}return dt.apply(this,arguments)}},gt);var wt=function(){var t=[];var r=t.push(undefined);return r!==1||t.length!==1||typeof t[0]!=="undefined"||!G(t,0)}();$(r,{push:dt},wt);$(r,{slice:function(t,r){var e=C(this)?X(this,""):this;return W(e,arguments)}},et);var bt=function(){try{[1,2].sort(null);[1,2].sort({});return true}catch(t){}return false}();var Tt=function(){try{[1,2].sort(/a/);return false}catch(t){}return true}();var mt=function(){try{[1,2].sort(undefined);return true}catch(t){}return false}();$(r,{sort:function sort(t){if(typeof t==="undefined"){return V(this)}if(!D(t)){throw new TypeError("Array.prototype.sort callback must be a function")}return V(this,t)}},bt||!mt||!Tt);var Dt=!Q({toString:null},"toString");var St=Q(function(){},"prototype");var xt=!G("x","0");var Ot=function(t){var r=t.constructor;return r&&r.prototype===t};var jt={$window:true,$console:true,$parent:true,$self:true,$frame:true,$frames:true,$frameElement:true,$webkitIndexedDB:true,$webkitStorageInfo:true,$external:true};var Et=function(){if(typeof window==="undefined"){return false}for(var t in window){try{if(!jt["$"+t]&&G(window,t)&&window[t]!==null&&typeof window[t]==="object"){Ot(window[t])}}catch(r){return true}}return false}();var It=function(t){if(typeof window==="undefined"||!Et){return Ot(t)}try{return Ot(t)}catch(r){return false}};var Mt=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];var Ut=Mt.length;var Ft=function isArguments(t){return B(t)==="[object Arguments]"};var Nt=function isArguments(t){return t!==null&&typeof t==="object"&&typeof t.length==="number"&&t.length>=0&&!_(t)&&D(t.callee)};var Ct=Ft(arguments)?Ft:Nt;$(e,{keys:function keys(t){var r=D(t);var e=Ct(t);var n=t!==null&&typeof t==="object";var i=n&&C(t);if(!n&&!r&&!e){throw new TypeError("Object.keys called on a non-object")}var a=[];var f=St&&r;if(i&&xt||e){for(var u=0;u<t.length;++u){K(a,o(u))}}if(!e){for(var l in t){if(!(f&&l==="prototype")&&G(t,l)){K(a,o(l))}}}if(Dt){var s=It(t);for(var c=0;c<Ut;c++){var v=Mt[c];if(!(s&&v==="constructor")&&G(t,v)){K(a,v)}}}return a}});var kt=e.keys&&function(){return e.keys(arguments).length===2}(1,2);var At=e.keys&&function(){var t=e.keys(arguments);return arguments.length!==1||t.length!==1||t[0]!==1}(1);var Rt=e.keys;$(e,{keys:function keys(t){if(Ct(t)){return Rt(H(t))}else{return Rt(t)}}},!kt||At);var Pt=new Date(-0xc782b5b342b24).getUTCMonth()!==0;var $t=new Date(-0x55d318d56a724);var Jt=new Date(14496624e5);var Yt=$t.toUTCString()!=="Mon, 01 Jan -45875 11:59:59 GMT";var Zt;var zt;var Gt=$t.getTimezoneOffset();if(Gt<-720){Zt=$t.toDateString()!=="Tue Jan 02 -45875";zt=!/^Thu Dec 10 2015 \d\d:\d\d:\d\d GMT[-\+]\d\d\d\d(?: |$)/.test(Jt.toString())}else{Zt=$t.toDateString()!=="Mon Jan 01 -45875";zt=!/^Wed Dec 09 2015 \d\d:\d\d:\d\d GMT[-\+]\d\d\d\d(?: |$)/.test(Jt.toString())}var Bt=d.bind(Date.prototype.getFullYear);var Ht=d.bind(Date.prototype.getMonth);var Wt=d.bind(Date.prototype.getDate);var Lt=d.bind(Date.prototype.getUTCFullYear);var Xt=d.bind(Date.prototype.getUTCMonth);var qt=d.bind(Date.prototype.getUTCDate);var Kt=d.bind(Date.prototype.getUTCDay);var Qt=d.bind(Date.prototype.getUTCHours);var Vt=d.bind(Date.prototype.getUTCMinutes);var _t=d.bind(Date.prototype.getUTCSeconds);var tr=d.bind(Date.prototype.getUTCMilliseconds);var rr=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];var er=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var nr=function daysInMonth(t,r){return Wt(new Date(r,t,0))};$(Date.prototype,{getFullYear:function getFullYear(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Bt(this);if(t<0&&Ht(this)>11){return t+1}return t},getMonth:function getMonth(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Bt(this);var r=Ht(this);if(t<0&&r>11){return 0}return r},getDate:function getDate(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Bt(this);var r=Ht(this);var e=Wt(this);if(t<0&&r>11){if(r===12){return e}var n=nr(0,t+1);return n-e+1}return e},getUTCFullYear:function getUTCFullYear(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Lt(this);if(t<0&&Xt(this)>11){return t+1}return t},getUTCMonth:function getUTCMonth(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Lt(this);var r=Xt(this);if(t<0&&r>11){return 0}return r},getUTCDate:function getUTCDate(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Lt(this);var r=Xt(this);var e=qt(this);if(t<0&&r>11){if(r===12){return e}var n=nr(0,t+1);return n-e+1}return e}},Pt);$(Date.prototype,{toUTCString:function toUTCString(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Kt(this);var r=qt(this);var e=Xt(this);var n=Lt(this);var i=Qt(this);var a=Vt(this);var o=_t(this);return rr[t]+", "+(r<10?"0"+r:r)+" "+er[e]+" "+n+" "+(i<10?"0"+i:i)+":"+(a<10?"0"+a:a)+":"+(o<10?"0"+o:o)+" GMT"}},Pt||Yt);$(Date.prototype,{toDateString:function toDateString(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=this.getDay();var r=this.getDate();var e=this.getMonth();var n=this.getFullYear();return rr[t]+" "+er[e]+" "+(r<10?"0"+r:r)+" "+n}},Pt||Zt);if(Pt||zt){Date.prototype.toString=function toString(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=this.getDay();var r=this.getDate();var e=this.getMonth();var n=this.getFullYear();var i=this.getHours();var a=this.getMinutes();var o=this.getSeconds();var f=this.getTimezoneOffset();var u=Math.floor(Math.abs(f)/60);var l=Math.floor(Math.abs(f)%60);return rr[t]+" "+er[e]+" "+(r<10?"0"+r:r)+" "+n+" "+(i<10?"0"+i:i)+":"+(a<10?"0"+a:a)+":"+(o<10?"0"+o:o)+" GMT"+(f>0?"-":"+")+(u<10?"0"+u:u)+(l<10?"0"+l:l)};if(P){e.defineProperty(Date.prototype,"toString",{configurable:true,enumerable:false,writable:true})}}var ir=-621987552e5;var ar="-000001";var or=Date.prototype.toISOString&&new Date(ir).toISOString().indexOf(ar)===-1;var fr=Date.prototype.toISOString&&new Date(-1).toISOString()!=="1969-12-31T23:59:59.999Z";var ur=d.bind(Date.prototype.getTime);$(Date.prototype,{toISOString:function toISOString(){if(!isFinite(this)||!isFinite(ur(this))){throw new RangeError("Date.prototype.toISOString called on non-finite value.")}var t=Lt(this);var r=Xt(this);t+=Math.floor(r/12);r=(r%12+12)%12;var e=[r+1,qt(this),Qt(this),Vt(this),_t(this)];t=(t<0?"-":t>9999?"+":"")+L("00000"+Math.abs(t),0<=t&&t<=9999?-4:-6);for(var n=0;n<e.length;++n){e[n]=L("00"+e[n],-2)}return t+"-"+H(e,0,2).join("-")+"T"+H(e,2).join(":")+"."+L("000"+tr(this),-3)+"Z"}},or||fr);var lr=function(){try{return Date.prototype.toJSON&&new Date(NaN).toJSON()===null&&new Date(ir).toJSON().indexOf(ar)!==-1&&Date.prototype.toJSON.call({toISOString:function(){return true}})}catch(t){return false}}();if(!lr){Date.prototype.toJSON=function toJSON(t){var r=e(this);var n=Z.ToPrimitive(r);if(typeof n==="number"&&!isFinite(n)){return null}var i=r.toISOString;if(!D(i)){throw new TypeError("toISOString property is not callable")}return i.call(r)}}var sr=Date.parse("+033658-09-27T01:46:40.000Z")===1e15;var cr=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||!isNaN(Date.parse("2012-11-31T23:59:59.000Z"))||!isNaN(Date.parse("2012-12-31T23:59:60.000Z"));var vr=isNaN(Date.parse("2000-01-01T00:00:00.000Z"));if(vr||cr||!sr){var hr=Math.pow(2,31)-1;var pr=Y(new Date(1970,0,1,0,0,0,hr+1).getTime());Date=function(t){var r=function Date(e,n,i,a,f,u,l){var s=arguments.length;var c;if(this instanceof t){var v=u;var h=l;if(pr&&s>=7&&l>hr){var p=Math.floor(l/hr)*hr;var y=Math.floor(p/1e3);v+=y;h-=y*1e3}c=s===1&&o(e)===e?new t(r.parse(e)):s>=7?new t(e,n,i,a,f,v,h):s>=6?new t(e,n,i,a,f,v):s>=5?new t(e,n,i,a,f):s>=4?new t(e,n,i,a):s>=3?new t(e,n,i):s>=2?new t(e,n):s>=1?new t(e instanceof t?+e:e):new t}else{c=t.apply(this,arguments)}if(!J(c)){$(c,{constructor:r},true)}return c};var e=new RegExp("^"+"(\\d{4}|[+-]\\d{6})"+"(?:-(\\d{2})"+"(?:-(\\d{2})"+"(?:"+"T(\\d{2})"+":(\\d{2})"+"(?:"+":(\\d{2})"+"(?:(\\.\\d{1,}))?"+")?"+"("+"Z|"+"(?:"+"([-+])"+"(\\d{2})"+":(\\d{2})"+")"+")?)?)?)?"+"$");var n=[0,31,59,90,120,151,181,212,243,273,304,334,365];var i=function dayFromMonth(t,r){var e=r>1?1:0;return n[r]+Math.floor((t-1969+e)/4)-Math.floor((t-1901+e)/100)+Math.floor((t-1601+e)/400)+365*(t-1970)};var a=function toUTC(r){var e=0;var n=r;if(pr&&n>hr){var i=Math.floor(n/hr)*hr;var a=Math.floor(i/1e3);e+=a;n-=a*1e3}return u(new t(1970,0,1,0,0,e,n))};for(var f in t){if(G(t,f)){r[f]=t[f]}}$(r,{now:t.now,UTC:t.UTC},true);r.prototype=t.prototype;$(r.prototype,{constructor:r},true);var l=function parse(r){var n=e.exec(r);if(n){var o=u(n[1]),f=u(n[2]||1)-1,l=u(n[3]||1)-1,s=u(n[4]||0),c=u(n[5]||0),v=u(n[6]||0),h=Math.floor(u(n[7]||0)*1e3),p=Boolean(n[4]&&!n[8]),y=n[9]==="-"?1:-1,d=u(n[10]||0),g=u(n[11]||0),w;var b=c>0||v>0||h>0;if(s<(b?24:25)&&c<60&&v<60&&h<1e3&&f>-1&&f<12&&d<24&&g<60&&l>-1&&l<i(o,f+1)-i(o,f)){w=((i(o,f)+l)*24+s+d*y)*60;w=((w+c+g*y)*60+v)*1e3+h;if(p){w=a(w)}if(-864e13<=w&&w<=864e13){return w}}return NaN}return t.parse.apply(this,arguments)};$(r,{parse:l});return r}(Date)}if(!Date.now){Date.now=function now(){return(new Date).getTime()}}var yr=l.toFixed&&(8e-5.toFixed(3)!=="0.000"||.9.toFixed(0)!=="1"||1.255.toFixed(2)!=="1.25"||0xde0b6b3a7640080.toFixed(0)!=="1000000000000000128");var dr={base:1e7,size:6,data:[0,0,0,0,0,0],multiply:function multiply(t,r){var e=-1;var n=r;while(++e<dr.size){n+=t*dr.data[e];dr.data[e]=n%dr.base;n=Math.floor(n/dr.base)}},divide:function divide(t){var r=dr.size;var e=0;while(--r>=0){e+=dr.data[r];dr.data[r]=Math.floor(e/t);e=e%t*dr.base}},numToString:function numToString(){var t=dr.size;var r="";while(--t>=0){if(r!==""||t===0||dr.data[t]!==0){var e=o(dr.data[t]);if(r===""){r=e}else{r+=L("0000000",0,7-e.length)+e}}}return r},pow:function pow(t,r,e){return r===0?e:r%2===1?pow(t,r-1,e*t):pow(t*t,r/2,e)},log:function log(t){var r=0;var e=t;while(e>=4096){r+=12;e/=4096}while(e>=2){r+=1;e/=2}return r}};var gr=function toFixed(t){var r,e,n,i,a,f,l,s;r=u(t);r=Y(r)?0:Math.floor(r);if(r<0||r>20){throw new RangeError("Number.toFixed called with invalid number of decimals")}e=u(this);if(Y(e)){return"NaN"}if(e<=-1e21||e>=1e21){return o(e)}n="";if(e<0){n="-";e=-e}i="0";if(e>1e-21){a=dr.log(e*dr.pow(2,69,1))-69;f=a<0?e*dr.pow(2,-a,1):e/dr.pow(2,a,1);f*=4503599627370496;a=52-a;if(a>0){dr.multiply(0,f);l=r;while(l>=7){dr.multiply(1e7,0);l-=7}dr.multiply(dr.pow(10,l,1),0);l=a-1;while(l>=23){dr.divide(1<<23);l-=23}dr.divide(1<<l);dr.multiply(1,1);dr.divide(2);i=dr.numToString()}else{dr.multiply(0,f);dr.multiply(1<<-a,0);i=dr.numToString()+L("0.00000000000000000000",2,2+r)}}if(r>0){s=i.length;if(s<=r){i=n+L("0.0000000000000000000",0,r-s+2)+i}else{i=n+L(i,0,s-r)+"."+L(i,s-r)}}else{i=n+i}return i};$(l,{toFixed:gr},yr);var wr=function(){try{return 1..toPrecision(undefined)==="1"}catch(t){return true}}();var br=l.toPrecision;$(l,{toPrecision:function toPrecision(t){return typeof t==="undefined"?br.call(this):br.call(this,t)}},wr);if("ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||"tesst".split(/(s)*/)[1]==="t"||"test".split(/(?:)/,-1).length!==4||"".split(/.?/).length||".".split(/()()/).length>1){(function(){var t=typeof/()??/.exec("")[1]==="undefined";var r=Math.pow(2,32)-1;f.split=function(e,n){var i=String(this);if(typeof e==="undefined"&&n===0){return[]}if(!M(e)){return X(this,e,n)}var a=[];var o=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),f=0,u,l,s,c;var h=new RegExp(e.source,o+"g");if(!t){u=new RegExp("^"+h.source+"$(?!\\s)",o)}var p=typeof n==="undefined"?r:Z.ToUint32(n);l=h.exec(i);while(l){s=l.index+l[0].length;if(s>f){K(a,L(i,f,l.index));if(!t&&l.length>1){l[0].replace(u,function(){for(var t=1;t<arguments.length-2;t++){if(typeof arguments[t]==="undefined"){l[t]=void 0}}})}if(l.length>1&&l.index<i.length){v.apply(a,H(l,1))}c=l[0].length;f=s;if(a.length>=p){break}}if(h.lastIndex===l.index){h.lastIndex++}l=h.exec(i)}if(f===i.length){if(c||!h.test("")){K(a,"")}}else{K(a,L(i,f))}return a.length>p?H(a,0,p):a}})()}else if("0".split(void 0,0).length){f.split=function split(t,r){if(typeof t==="undefined"&&r===0){return[]}return X(this,t,r)}}var Tr=f.replace;var mr=function(){var t=[];"x".replace(/x(.)?/g,function(r,e){K(t,e)});return t.length===1&&typeof t[0]==="undefined"}();if(!mr){f.replace=function replace(t,r){var e=D(r);var n=M(t)&&/\)[*?]/.test(t.source);if(!e||!n){return Tr.call(this,t,r)}else{var i=function(e){var n=arguments.length;var i=t.lastIndex;t.lastIndex=0;var a=t.exec(e)||[];t.lastIndex=i;K(a,arguments[n-2],arguments[n-1]);return r.apply(this,a)};return Tr.call(this,t,i)}}}var Dr=f.substr;var Sr="".substr&&"0b".substr(-1)!=="b";$(f,{substr:function substr(t,r){var e=t;if(t<0){e=w(this.length+t,0)}return Dr.call(this,e,r)}},Sr);var xr="	\n\x0B\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003"+"\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028"+"\u2029\ufeff";var Or="\u200b";var jr="["+xr+"]";var Er=new RegExp("^"+jr+jr+"*");var Ir=new RegExp(jr+jr+"*$");var Mr=f.trim&&(xr.trim()||!Or.trim());$(f,{trim:function trim(){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}return o(this).replace(Er,"").replace(Ir,"")}},Mr);var Ur=d.bind(String.prototype.trim);var Fr=f.lastIndexOf&&"abc\u3042\u3044".lastIndexOf("\u3042\u3044",2)!==-1;$(f,{lastIndexOf:function lastIndexOf(t){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}var r=o(this);var e=o(t);var n=arguments.length>1?u(arguments[1]):NaN;var i=Y(n)?Infinity:Z.ToInteger(n);var a=b(w(i,0),r.length);var f=e.length;var l=a+f;while(l>0){l=w(0,l-f);var s=q(L(r,l,a+f),e);if(s!==-1){return l+s}}return-1}},Fr);var Nr=f.lastIndexOf;$(f,{lastIndexOf:function lastIndexOf(t){return Nr.apply(this,arguments)}},f.lastIndexOf.length!==1);if(parseInt(xr+"08")!==8||parseInt(xr+"0x16")!==22){parseInt=function(t){var r=/^[\-+]?0[xX]/;return function parseInt(e,n){var i=Ur(String(e));var a=u(n)||(r.test(i)?16:10);return t(i,a)}}(parseInt)}if(1/parseFloat("-0")!==-Infinity){parseFloat=function(t){return function parseFloat(r){var e=Ur(String(r));var n=t(e);return n===0&&L(e,0,1)==="-"?-0:n}}(parseFloat)}if(String(new RangeError("test"))!=="RangeError: test"){var Cr=function toString(){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}var t=this.name;if(typeof t==="undefined"){t="Error"}else if(typeof t!=="string"){t=o(t)}var r=this.message;if(typeof r==="undefined"){r=""}else if(typeof r!=="string"){r=o(r)}if(!t){return r}if(!r){return t}return t+": "+r};Error.prototype.toString=Cr}if(P){var kr=function(t,r){if(Q(t,r)){var e=Object.getOwnPropertyDescriptor(t,r);if(e.configurable){e.enumerable=false;Object.defineProperty(t,r,e)}}};kr(Error.prototype,"message");if(Error.prototype.message!==""){Error.prototype.message=""}kr(Error.prototype,"name")}if(String(/a/gim)!=="/a/gim"){var Ar=function toString(){var t="/"+this.source+"/";if(this.global){t+="g"}if(this.ignoreCase){t+="i"}if(this.multiline){t+="m"}return t};RegExp.prototype.toString=Ar}});
//# sourceMappingURL=es5-shim.map
/*!
  * https://github.com/paulmillr/es6-shim
  * @license es6-shim Copyright 2013-2016 by Paul Miller (http://paulmillr.com)
  *   and contributors,  MIT License
  * es6-shim: v0.35.3
  * see https://github.com/paulmillr/es6-shim/blob/0.35.1/LICENSE
  * Details and documentation:
  * https://github.com/paulmillr/es6-shim/
  */
(function(e,t){if(typeof define==="function"&&define.amd){define(t)}else if(typeof exports==="object"){module.exports=t()}else{e.returnExports=t()}})(this,function(){"use strict";var e=Function.call.bind(Function.apply);var t=Function.call.bind(Function.call);var r=Array.isArray;var n=Object.keys;var o=function notThunker(t){return function notThunk(){return!e(t,this,arguments)}};var i=function(e){try{e();return false}catch(e){return true}};var a=function valueOrFalseIfThrows(e){try{return e()}catch(e){return false}};var u=o(i);var f=function(){return!i(function(){Object.defineProperty({},"x",{get:function(){}})})};var s=!!Object.defineProperty&&f();var c=function foo(){}.name==="foo";var l=Function.call.bind(Array.prototype.forEach);var p=Function.call.bind(Array.prototype.reduce);var v=Function.call.bind(Array.prototype.filter);var y=Function.call.bind(Array.prototype.some);var h=function(e,t,r,n){if(!n&&t in e){return}if(s){Object.defineProperty(e,t,{configurable:true,enumerable:false,writable:true,value:r})}else{e[t]=r}};var b=function(e,t,r){l(n(t),function(n){var o=t[n];h(e,n,o,!!r)})};var g=Function.call.bind(Object.prototype.toString);var d=typeof/abc/==="function"?function IsCallableSlow(e){return typeof e==="function"&&g(e)==="[object Function]"}:function IsCallableFast(e){return typeof e==="function"};var m={getter:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}Object.defineProperty(e,t,{configurable:true,enumerable:false,get:r})},proxy:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,{configurable:n.configurable,enumerable:n.enumerable,get:function getKey(){return e[t]},set:function setKey(r){e[t]=r}})},redefine:function(e,t,r){if(s){var n=Object.getOwnPropertyDescriptor(e,t);n.value=r;Object.defineProperty(e,t,n)}else{e[t]=r}},defineByDescriptor:function(e,t,r){if(s){Object.defineProperty(e,t,r)}else if("value"in r){e[t]=r.value}},preserveToString:function(e,t){if(t&&d(t.toString)){h(e,"toString",t.toString.bind(t),true)}}};var O=Object.create||function(e,t){var r=function Prototype(){};r.prototype=e;var o=new r;if(typeof t!=="undefined"){n(t).forEach(function(e){m.defineByDescriptor(o,e,t[e])})}return o};var w=function(e,t){if(!Object.setPrototypeOf){return false}return a(function(){var r=function Subclass(t){var r=new e(t);Object.setPrototypeOf(r,Subclass.prototype);return r};Object.setPrototypeOf(r,e);r.prototype=O(e.prototype,{constructor:{value:r}});return t(r)})};var j=function(){if(typeof self!=="undefined"){return self}if(typeof window!=="undefined"){return window}if(typeof global!=="undefined"){return global}throw new Error("unable to locate global object")};var S=j();var T=S.isFinite;var I=Function.call.bind(String.prototype.indexOf);var E=Function.apply.bind(Array.prototype.indexOf);var P=Function.call.bind(Array.prototype.concat);var C=Function.call.bind(String.prototype.slice);var M=Function.call.bind(Array.prototype.push);var x=Function.apply.bind(Array.prototype.push);var N=Function.call.bind(Array.prototype.shift);var A=Math.max;var R=Math.min;var _=Math.floor;var k=Math.abs;var F=Math.exp;var L=Math.log;var D=Math.sqrt;var z=Function.call.bind(Object.prototype.hasOwnProperty);var q;var W=function(){};var G=S.Map;var H=G&&G.prototype["delete"];var V=G&&G.prototype.get;var B=G&&G.prototype.has;var U=G&&G.prototype.set;var $=S.Symbol||{};var J=$.species||"@@species";var X=Number.isNaN||function isNaN(e){return e!==e};var K=Number.isFinite||function isFinite(e){return typeof e==="number"&&T(e)};var Z=d(Math.sign)?Math.sign:function sign(e){var t=Number(e);if(t===0){return t}if(X(t)){return t}return t<0?-1:1};var Y=function isArguments(e){return g(e)==="[object Arguments]"};var Q=function isArguments(e){return e!==null&&typeof e==="object"&&typeof e.length==="number"&&e.length>=0&&g(e)!=="[object Array]"&&g(e.callee)==="[object Function]"};var ee=Y(arguments)?Y:Q;var te={primitive:function(e){return e===null||typeof e!=="function"&&typeof e!=="object"},string:function(e){return g(e)==="[object String]"},regex:function(e){return g(e)==="[object RegExp]"},symbol:function(e){return typeof S.Symbol==="function"&&typeof e==="symbol"}};var re=function overrideNative(e,t,r){var n=e[t];h(e,t,r,true);m.preserveToString(e[t],n)};var ne=typeof $==="function"&&typeof $["for"]==="function"&&te.symbol($());var oe=te.symbol($.iterator)?$.iterator:"_es6-shim iterator_";if(S.Set&&typeof(new S.Set)["@@iterator"]==="function"){oe="@@iterator"}if(!S.Reflect){h(S,"Reflect",{},true)}var ie=S.Reflect;var ae=String;var ue=typeof document==="undefined"||!document?null:document.all;var fe=ue==null?function isNullOrUndefined(e){return e==null}:function isNullOrUndefinedAndNotDocumentAll(e){return e==null&&e!==ue};var se={Call:function Call(t,r){var n=arguments.length>2?arguments[2]:[];if(!se.IsCallable(t)){throw new TypeError(t+" is not a function")}return e(t,r,n)},RequireObjectCoercible:function(e,t){if(fe(e)){throw new TypeError(t||"Cannot call method on "+e)}return e},TypeIsObject:function(e){if(e===void 0||e===null||e===true||e===false){return false}return typeof e==="function"||typeof e==="object"||e===ue},ToObject:function(e,t){return Object(se.RequireObjectCoercible(e,t))},IsCallable:d,IsConstructor:function(e){return se.IsCallable(e)},ToInt32:function(e){return se.ToNumber(e)>>0},ToUint32:function(e){return se.ToNumber(e)>>>0},ToNumber:function(e){if(g(e)==="[object Symbol]"){throw new TypeError("Cannot convert a Symbol value to a number")}return+e},ToInteger:function(e){var t=se.ToNumber(e);if(X(t)){return 0}if(t===0||!K(t)){return t}return(t>0?1:-1)*_(k(t))},ToLength:function(e){var t=se.ToInteger(e);if(t<=0){return 0}if(t>Number.MAX_SAFE_INTEGER){return Number.MAX_SAFE_INTEGER}return t},SameValue:function(e,t){if(e===t){if(e===0){return 1/e===1/t}return true}return X(e)&&X(t)},SameValueZero:function(e,t){return e===t||X(e)&&X(t)},IsIterable:function(e){return se.TypeIsObject(e)&&(typeof e[oe]!=="undefined"||ee(e))},GetIterator:function(e){if(ee(e)){return new q(e,"value")}var t=se.GetMethod(e,oe);if(!se.IsCallable(t)){throw new TypeError("value is not an iterable")}var r=se.Call(t,e);if(!se.TypeIsObject(r)){throw new TypeError("bad iterator")}return r},GetMethod:function(e,t){var r=se.ToObject(e)[t];if(fe(r)){return void 0}if(!se.IsCallable(r)){throw new TypeError("Method not callable: "+t)}return r},IteratorComplete:function(e){return!!e.done},IteratorClose:function(e,t){var r=se.GetMethod(e,"return");if(r===void 0){return}var n,o;try{n=se.Call(r,e)}catch(e){o=e}if(t){return}if(o){throw o}if(!se.TypeIsObject(n)){throw new TypeError("Iterator's return method returned a non-object.")}},IteratorNext:function(e){var t=arguments.length>1?e.next(arguments[1]):e.next();if(!se.TypeIsObject(t)){throw new TypeError("bad iterator")}return t},IteratorStep:function(e){var t=se.IteratorNext(e);var r=se.IteratorComplete(t);return r?false:t},Construct:function(e,t,r,n){var o=typeof r==="undefined"?e:r;if(!n&&ie.construct){return ie.construct(e,t,o)}var i=o.prototype;if(!se.TypeIsObject(i)){i=Object.prototype}var a=O(i);var u=se.Call(e,a,t);return se.TypeIsObject(u)?u:a},SpeciesConstructor:function(e,t){var r=e.constructor;if(r===void 0){return t}if(!se.TypeIsObject(r)){throw new TypeError("Bad constructor")}var n=r[J];if(fe(n)){return t}if(!se.IsConstructor(n)){throw new TypeError("Bad @@species")}return n},CreateHTML:function(e,t,r,n){var o=se.ToString(e);var i="<"+t;if(r!==""){var a=se.ToString(n);var u=a.replace(/"/g,"&quot;");i+=" "+r+'="'+u+'"'}var f=i+">";var s=f+o;return s+"</"+t+">"},IsRegExp:function IsRegExp(e){if(!se.TypeIsObject(e)){return false}var t=e[$.match];if(typeof t!=="undefined"){return!!t}return te.regex(e)},ToString:function ToString(e){return ae(e)}};if(s&&ne){var ce=function defineWellKnownSymbol(e){if(te.symbol($[e])){return $[e]}var t=$["for"]("Symbol."+e);Object.defineProperty($,e,{configurable:false,enumerable:false,writable:false,value:t});return t};if(!te.symbol($.search)){var le=ce("search");var pe=String.prototype.search;h(RegExp.prototype,le,function search(e){return se.Call(pe,e,[this])});var ve=function search(e){var t=se.RequireObjectCoercible(this);if(!fe(e)){var r=se.GetMethod(e,le);if(typeof r!=="undefined"){return se.Call(r,e,[t])}}return se.Call(pe,t,[se.ToString(e)])};re(String.prototype,"search",ve)}if(!te.symbol($.replace)){var ye=ce("replace");var he=String.prototype.replace;h(RegExp.prototype,ye,function replace(e,t){return se.Call(he,e,[this,t])});var be=function replace(e,t){var r=se.RequireObjectCoercible(this);if(!fe(e)){var n=se.GetMethod(e,ye);if(typeof n!=="undefined"){return se.Call(n,e,[r,t])}}return se.Call(he,r,[se.ToString(e),t])};re(String.prototype,"replace",be)}if(!te.symbol($.split)){var ge=ce("split");var de=String.prototype.split;h(RegExp.prototype,ge,function split(e,t){return se.Call(de,e,[this,t])});var me=function split(e,t){var r=se.RequireObjectCoercible(this);if(!fe(e)){var n=se.GetMethod(e,ge);if(typeof n!=="undefined"){return se.Call(n,e,[r,t])}}return se.Call(de,r,[se.ToString(e),t])};re(String.prototype,"split",me)}var Oe=te.symbol($.match);var we=Oe&&function(){var e={};e[$.match]=function(){return 42};return"a".match(e)!==42}();if(!Oe||we){var je=ce("match");var Se=String.prototype.match;h(RegExp.prototype,je,function match(e){return se.Call(Se,e,[this])});var Te=function match(e){var t=se.RequireObjectCoercible(this);if(!fe(e)){var r=se.GetMethod(e,je);if(typeof r!=="undefined"){return se.Call(r,e,[t])}}return se.Call(Se,t,[se.ToString(e)])};re(String.prototype,"match",Te)}}var Ie=function wrapConstructor(e,t,r){m.preserveToString(t,e);if(Object.setPrototypeOf){Object.setPrototypeOf(e,t)}if(s){l(Object.getOwnPropertyNames(e),function(n){if(n in W||r[n]){return}m.proxy(e,n,t)})}else{l(Object.keys(e),function(n){if(n in W||r[n]){return}t[n]=e[n]})}t.prototype=e.prototype;m.redefine(e.prototype,"constructor",t)};var Ee=function(){return this};var Pe=function(e){if(s&&!z(e,J)){m.getter(e,J,Ee)}};var Ce=function(e,t){var r=t||function iterator(){return this};h(e,oe,r);if(!e[oe]&&te.symbol(oe)){e[oe]=r}};var Me=function createDataProperty(e,t,r){if(s){Object.defineProperty(e,t,{configurable:true,enumerable:true,writable:true,value:r})}else{e[t]=r}};var xe=function createDataPropertyOrThrow(e,t,r){Me(e,t,r);if(!se.SameValue(e[t],r)){throw new TypeError("property is nonconfigurable")}};var Ne=function(e,t,r,n){if(!se.TypeIsObject(e)){throw new TypeError("Constructor requires `new`: "+t.name)}var o=t.prototype;if(!se.TypeIsObject(o)){o=r}var i=O(o);for(var a in n){if(z(n,a)){var u=n[a];h(i,a,u,true)}}return i};if(String.fromCodePoint&&String.fromCodePoint.length!==1){var Ae=String.fromCodePoint;re(String,"fromCodePoint",function fromCodePoint(e){return se.Call(Ae,this,arguments)})}var Re={fromCodePoint:function fromCodePoint(e){var t=[];var r;for(var n=0,o=arguments.length;n<o;n++){r=Number(arguments[n]);if(!se.SameValue(r,se.ToInteger(r))||r<0||r>1114111){throw new RangeError("Invalid code point "+r)}if(r<65536){M(t,String.fromCharCode(r))}else{r-=65536;M(t,String.fromCharCode((r>>10)+55296));M(t,String.fromCharCode(r%1024+56320))}}return t.join("")},raw:function raw(e){var t=se.ToObject(e,"bad callSite");var r=se.ToObject(t.raw,"bad raw value");var n=r.length;var o=se.ToLength(n);if(o<=0){return""}var i=[];var a=0;var u,f,s,c;while(a<o){u=se.ToString(a);s=se.ToString(r[u]);M(i,s);if(a+1>=o){break}f=a+1<arguments.length?arguments[a+1]:"";c=se.ToString(f);M(i,c);a+=1}return i.join("")}};if(String.raw&&String.raw({raw:{0:"x",1:"y",length:2}})!=="xy"){re(String,"raw",Re.raw)}b(String,Re);var _e=function repeat(e,t){if(t<1){return""}if(t%2){return repeat(e,t-1)+e}var r=repeat(e,t/2);return r+r};var ke=Infinity;var Fe={repeat:function repeat(e){var t=se.ToString(se.RequireObjectCoercible(this));var r=se.ToInteger(e);if(r<0||r>=ke){throw new RangeError("repeat count must be less than infinity and not overflow maximum string size")}return _e(t,r)},startsWith:function startsWith(e){var t=se.ToString(se.RequireObjectCoercible(this));if(se.IsRegExp(e)){throw new TypeError('Cannot call method "startsWith" with a regex')}var r=se.ToString(e);var n;if(arguments.length>1){n=arguments[1]}var o=A(se.ToInteger(n),0);return C(t,o,o+r.length)===r},endsWith:function endsWith(e){var t=se.ToString(se.RequireObjectCoercible(this));if(se.IsRegExp(e)){throw new TypeError('Cannot call method "endsWith" with a regex')}var r=se.ToString(e);var n=t.length;var o;if(arguments.length>1){o=arguments[1]}var i=typeof o==="undefined"?n:se.ToInteger(o);var a=R(A(i,0),n);return C(t,a-r.length,a)===r},includes:function includes(e){if(se.IsRegExp(e)){throw new TypeError('"includes" does not accept a RegExp')}var t=se.ToString(e);var r;if(arguments.length>1){r=arguments[1]}return I(this,t,r)!==-1},codePointAt:function codePointAt(e){var t=se.ToString(se.RequireObjectCoercible(this));var r=se.ToInteger(e);var n=t.length;if(r>=0&&r<n){var o=t.charCodeAt(r);var i=r+1===n;if(o<55296||o>56319||i){return o}var a=t.charCodeAt(r+1);if(a<56320||a>57343){return o}return(o-55296)*1024+(a-56320)+65536}}};if(String.prototype.includes&&"a".includes("a",Infinity)!==false){re(String.prototype,"includes",Fe.includes)}if(String.prototype.startsWith&&String.prototype.endsWith){var Le=i(function(){"/a/".startsWith(/a/)});var De=a(function(){return"abc".startsWith("a",Infinity)===false});if(!Le||!De){re(String.prototype,"startsWith",Fe.startsWith);re(String.prototype,"endsWith",Fe.endsWith)}}if(ne){var ze=a(function(){var e=/a/;e[$.match]=false;return"/a/".startsWith(e)});if(!ze){re(String.prototype,"startsWith",Fe.startsWith)}var qe=a(function(){var e=/a/;e[$.match]=false;return"/a/".endsWith(e)});if(!qe){re(String.prototype,"endsWith",Fe.endsWith)}var We=a(function(){var e=/a/;e[$.match]=false;return"/a/".includes(e)});if(!We){re(String.prototype,"includes",Fe.includes)}}b(String.prototype,Fe);var Ge=["\t\n\v\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003","\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028","\u2029\ufeff"].join("");var He=new RegExp("(^["+Ge+"]+)|(["+Ge+"]+$)","g");var Ve=function trim(){return se.ToString(se.RequireObjectCoercible(this)).replace(He,"")};var Be=["\x85","\u200b","\ufffe"].join("");var Ue=new RegExp("["+Be+"]","g");var $e=/^[-+]0x[0-9a-f]+$/i;var Je=Be.trim().length!==Be.length;h(String.prototype,"trim",Ve,Je);var Xe=function(e){return{value:e,done:arguments.length===0}};var Ke=function(e){se.RequireObjectCoercible(e);this._s=se.ToString(e);this._i=0};Ke.prototype.next=function(){var e=this._s;var t=this._i;if(typeof e==="undefined"||t>=e.length){this._s=void 0;return Xe()}var r=e.charCodeAt(t);var n,o;if(r<55296||r>56319||t+1===e.length){o=1}else{n=e.charCodeAt(t+1);o=n<56320||n>57343?1:2}this._i=t+o;return Xe(e.substr(t,o))};Ce(Ke.prototype);Ce(String.prototype,function(){return new Ke(this)});var Ze={from:function from(e){var r=this;var n;if(arguments.length>1){n=arguments[1]}var o,i;if(typeof n==="undefined"){o=false}else{if(!se.IsCallable(n)){throw new TypeError("Array.from: when provided, the second argument must be a function")}if(arguments.length>2){i=arguments[2]}o=true}var a=typeof(ee(e)||se.GetMethod(e,oe))!=="undefined";var u,f,s;if(a){f=se.IsConstructor(r)?Object(new r):[];var c=se.GetIterator(e);var l,p;s=0;while(true){l=se.IteratorStep(c);if(l===false){break}p=l.value;try{if(o){p=typeof i==="undefined"?n(p,s):t(n,i,p,s)}f[s]=p}catch(e){se.IteratorClose(c,true);throw e}s+=1}u=s}else{var v=se.ToObject(e);u=se.ToLength(v.length);f=se.IsConstructor(r)?Object(new r(u)):new Array(u);var y;for(s=0;s<u;++s){y=v[s];if(o){y=typeof i==="undefined"?n(y,s):t(n,i,y,s)}xe(f,s,y)}}f.length=u;return f},of:function of(){var e=arguments.length;var t=this;var n=r(t)||!se.IsCallable(t)?new Array(e):se.Construct(t,[e]);for(var o=0;o<e;++o){xe(n,o,arguments[o])}n.length=e;return n}};b(Array,Ze);Pe(Array);q=function(e,t){this.i=0;this.array=e;this.kind=t};b(q.prototype,{next:function(){var e=this.i;var t=this.array;if(!(this instanceof q)){throw new TypeError("Not an ArrayIterator")}if(typeof t!=="undefined"){var r=se.ToLength(t.length);for(;e<r;e++){var n=this.kind;var o;if(n==="key"){o=e}else if(n==="value"){o=t[e]}else if(n==="entry"){o=[e,t[e]]}this.i=e+1;return Xe(o)}}this.array=void 0;return Xe()}});Ce(q.prototype);var Ye=Array.of===Ze.of||function(){var e=function Foo(e){this.length=e};e.prototype=[];var t=Array.of.apply(e,[1,2]);return t instanceof e&&t.length===2}();if(!Ye){re(Array,"of",Ze.of)}var Qe={copyWithin:function copyWithin(e,t){var r=se.ToObject(this);var n=se.ToLength(r.length);var o=se.ToInteger(e);var i=se.ToInteger(t);var a=o<0?A(n+o,0):R(o,n);var u=i<0?A(n+i,0):R(i,n);var f;if(arguments.length>2){f=arguments[2]}var s=typeof f==="undefined"?n:se.ToInteger(f);var c=s<0?A(n+s,0):R(s,n);var l=R(c-u,n-a);var p=1;if(u<a&&a<u+l){p=-1;u+=l-1;a+=l-1}while(l>0){if(u in r){r[a]=r[u]}else{delete r[a]}u+=p;a+=p;l-=1}return r},fill:function fill(e){var t;if(arguments.length>1){t=arguments[1]}var r;if(arguments.length>2){r=arguments[2]}var n=se.ToObject(this);var o=se.ToLength(n.length);t=se.ToInteger(typeof t==="undefined"?0:t);r=se.ToInteger(typeof r==="undefined"?o:r);var i=t<0?A(o+t,0):R(t,o);var a=r<0?o+r:r;for(var u=i;u<o&&u<a;++u){n[u]=e}return n},find:function find(e){var r=se.ToObject(this);var n=se.ToLength(r.length);if(!se.IsCallable(e)){throw new TypeError("Array#find: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0,a;i<n;i++){a=r[i];if(o){if(t(e,o,a,i,r)){return a}}else if(e(a,i,r)){return a}}},findIndex:function findIndex(e){var r=se.ToObject(this);var n=se.ToLength(r.length);if(!se.IsCallable(e)){throw new TypeError("Array#findIndex: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0;i<n;i++){if(o){if(t(e,o,r[i],i,r)){return i}}else if(e(r[i],i,r)){return i}}return-1},keys:function keys(){return new q(this,"key")},values:function values(){return new q(this,"value")},entries:function entries(){return new q(this,"entry")}};if(Array.prototype.keys&&!se.IsCallable([1].keys().next)){delete Array.prototype.keys}if(Array.prototype.entries&&!se.IsCallable([1].entries().next)){delete Array.prototype.entries}if(Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&Array.prototype[oe]){b(Array.prototype,{values:Array.prototype[oe]});if(te.symbol($.unscopables)){Array.prototype[$.unscopables].values=true}}if(c&&Array.prototype.values&&Array.prototype.values.name!=="values"){var et=Array.prototype.values;re(Array.prototype,"values",function values(){return se.Call(et,this,arguments)});h(Array.prototype,oe,Array.prototype.values,true)}b(Array.prototype,Qe);if(1/[true].indexOf(true,-0)<0){h(Array.prototype,"indexOf",function indexOf(e){var t=E(this,arguments);if(t===0&&1/t<0){return 0}return t},true)}Ce(Array.prototype,function(){return this.values()});if(Object.getPrototypeOf){Ce(Object.getPrototypeOf([].values()))}var tt=function(){return a(function(){return Array.from({length:-1}).length===0})}();var rt=function(){var e=Array.from([0].entries());return e.length===1&&r(e[0])&&e[0][0]===0&&e[0][1]===0}();if(!tt||!rt){re(Array,"from",Ze.from)}var nt=function(){return a(function(){return Array.from([0],void 0)})}();if(!nt){var ot=Array.from;re(Array,"from",function from(e){if(arguments.length>1&&typeof arguments[1]!=="undefined"){return se.Call(ot,this,arguments)}else{return t(ot,this,e)}})}var it=-(Math.pow(2,32)-1);var at=function(e,r){var n={length:it};n[r?(n.length>>>0)-1:0]=true;return a(function(){t(e,n,function(){throw new RangeError("should not reach here")},[]);return true})};if(!at(Array.prototype.forEach)){var ut=Array.prototype.forEach;re(Array.prototype,"forEach",function forEach(e){return se.Call(ut,this.length>=0?this:[],arguments)},true)}if(!at(Array.prototype.map)){var ft=Array.prototype.map;re(Array.prototype,"map",function map(e){return se.Call(ft,this.length>=0?this:[],arguments)},true)}if(!at(Array.prototype.filter)){var st=Array.prototype.filter;re(Array.prototype,"filter",function filter(e){return se.Call(st,this.length>=0?this:[],arguments)},true)}if(!at(Array.prototype.some)){var ct=Array.prototype.some;re(Array.prototype,"some",function some(e){return se.Call(ct,this.length>=0?this:[],arguments)},true)}if(!at(Array.prototype.every)){var lt=Array.prototype.every;re(Array.prototype,"every",function every(e){return se.Call(lt,this.length>=0?this:[],arguments)},true)}if(!at(Array.prototype.reduce)){var pt=Array.prototype.reduce;re(Array.prototype,"reduce",function reduce(e){return se.Call(pt,this.length>=0?this:[],arguments)},true)}if(!at(Array.prototype.reduceRight,true)){var vt=Array.prototype.reduceRight;re(Array.prototype,"reduceRight",function reduceRight(e){return se.Call(vt,this.length>=0?this:[],arguments)},true)}var yt=Number("0o10")!==8;var ht=Number("0b10")!==2;var bt=y(Be,function(e){return Number(e+0+e)===0});if(yt||ht||bt){var gt=Number;var dt=/^0b[01]+$/i;var mt=/^0o[0-7]+$/i;var Ot=dt.test.bind(dt);var wt=mt.test.bind(mt);var jt=function(e){var t;if(typeof e.valueOf==="function"){t=e.valueOf();if(te.primitive(t)){return t}}if(typeof e.toString==="function"){t=e.toString();if(te.primitive(t)){return t}}throw new TypeError("No default value")};var St=Ue.test.bind(Ue);var Tt=$e.test.bind($e);var It=function(){var e=function Number(t){var r;if(arguments.length>0){r=te.primitive(t)?t:jt(t,"number")}else{r=0}if(typeof r==="string"){r=se.Call(Ve,r);if(Ot(r)){r=parseInt(C(r,2),2)}else if(wt(r)){r=parseInt(C(r,2),8)}else if(St(r)||Tt(r)){r=NaN}}var n=this;var o=a(function(){gt.prototype.valueOf.call(n);return true});if(n instanceof e&&!o){return new gt(r)}return gt(r)};return e}();Ie(gt,It,{});b(It,{NaN:gt.NaN,MAX_VALUE:gt.MAX_VALUE,MIN_VALUE:gt.MIN_VALUE,NEGATIVE_INFINITY:gt.NEGATIVE_INFINITY,POSITIVE_INFINITY:gt.POSITIVE_INFINITY});Number=It;m.redefine(S,"Number",It)}var Et=Math.pow(2,53)-1;b(Number,{MAX_SAFE_INTEGER:Et,MIN_SAFE_INTEGER:-Et,EPSILON:2.220446049250313e-16,parseInt:S.parseInt,parseFloat:S.parseFloat,isFinite:K,isInteger:function isInteger(e){return K(e)&&se.ToInteger(e)===e},isSafeInteger:function isSafeInteger(e){return Number.isInteger(e)&&k(e)<=Number.MAX_SAFE_INTEGER},isNaN:X});h(Number,"parseInt",S.parseInt,Number.parseInt!==S.parseInt);if([,1].find(function(){return true})===1){re(Array.prototype,"find",Qe.find)}if([,1].findIndex(function(){return true})!==0){re(Array.prototype,"findIndex",Qe.findIndex)}var Pt=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable);var Ct=function ensureEnumerable(e,t){if(s&&Pt(e,t)){Object.defineProperty(e,t,{enumerable:false})}};var Mt=function sliceArgs(){var e=Number(this);var t=arguments.length;var r=t-e;var n=new Array(r<0?0:r);for(var o=e;o<t;++o){n[o-e]=arguments[o]}return n};var xt=function assignTo(e){return function assignToSource(t,r){t[r]=e[r];return t}};var Nt=function(e,t){var r=n(Object(t));var o;if(se.IsCallable(Object.getOwnPropertySymbols)){o=v(Object.getOwnPropertySymbols(Object(t)),Pt(t))}return p(P(r,o||[]),xt(t),e)};var At={assign:function(e,t){var r=se.ToObject(e,"Cannot convert undefined or null to object");return p(se.Call(Mt,1,arguments),Nt,r)},is:function is(e,t){return se.SameValue(e,t)}};var Rt=Object.assign&&Object.preventExtensions&&function(){var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return e[1]==="y"}}();if(Rt){re(Object,"assign",At.assign)}b(Object,At);if(s){var _t={setPrototypeOf:function(e,r){var n;var o=function(e,t){if(!se.TypeIsObject(e)){throw new TypeError("cannot set prototype on a non-object")}if(!(t===null||se.TypeIsObject(t))){throw new TypeError("can only set prototype to an object or null"+t)}};var i=function(e,r){o(e,r);t(n,e,r);return e};try{n=e.getOwnPropertyDescriptor(e.prototype,r).set;t(n,{},null)}catch(t){if(e.prototype!=={}[r]){return}n=function(e){this[r]=e};i.polyfill=i(i({},null),e.prototype)instanceof e}return i}(Object,"__proto__")};b(Object,_t)}if(Object.setPrototypeOf&&Object.getPrototypeOf&&Object.getPrototypeOf(Object.setPrototypeOf({},null))!==null&&Object.getPrototypeOf(Object.create(null))===null){(function(){var e=Object.create(null);var t=Object.getPrototypeOf;var r=Object.setPrototypeOf;Object.getPrototypeOf=function(r){var n=t(r);return n===e?null:n};Object.setPrototypeOf=function(t,n){var o=n===null?e:n;return r(t,o)};Object.setPrototypeOf.polyfill=false})()}var kt=!i(function(){Object.keys("foo")});if(!kt){var Ft=Object.keys;re(Object,"keys",function keys(e){return Ft(se.ToObject(e))});n=Object.keys}var Lt=i(function(){Object.keys(/a/g)});if(Lt){var Dt=Object.keys;re(Object,"keys",function keys(e){if(te.regex(e)){var t=[];for(var r in e){if(z(e,r)){M(t,r)}}return t}return Dt(e)});n=Object.keys}if(Object.getOwnPropertyNames){var zt=!i(function(){Object.getOwnPropertyNames("foo")});if(!zt){var qt=typeof window==="object"?Object.getOwnPropertyNames(window):[];var Wt=Object.getOwnPropertyNames;re(Object,"getOwnPropertyNames",function getOwnPropertyNames(e){var t=se.ToObject(e);if(g(t)==="[object Window]"){try{return Wt(t)}catch(e){return P([],qt)}}return Wt(t)})}}if(Object.getOwnPropertyDescriptor){var Gt=!i(function(){Object.getOwnPropertyDescriptor("foo","bar")});if(!Gt){var Ht=Object.getOwnPropertyDescriptor;re(Object,"getOwnPropertyDescriptor",function getOwnPropertyDescriptor(e,t){return Ht(se.ToObject(e),t)})}}if(Object.seal){var Vt=!i(function(){Object.seal("foo")});if(!Vt){var Bt=Object.seal;re(Object,"seal",function seal(e){if(!se.TypeIsObject(e)){return e}return Bt(e)})}}if(Object.isSealed){var Ut=!i(function(){Object.isSealed("foo")});if(!Ut){var $t=Object.isSealed;re(Object,"isSealed",function isSealed(e){if(!se.TypeIsObject(e)){return true}return $t(e)})}}if(Object.freeze){var Jt=!i(function(){Object.freeze("foo")});if(!Jt){var Xt=Object.freeze;re(Object,"freeze",function freeze(e){if(!se.TypeIsObject(e)){return e}return Xt(e)})}}if(Object.isFrozen){var Kt=!i(function(){Object.isFrozen("foo")});if(!Kt){var Zt=Object.isFrozen;re(Object,"isFrozen",function isFrozen(e){if(!se.TypeIsObject(e)){return true}return Zt(e)})}}if(Object.preventExtensions){var Yt=!i(function(){Object.preventExtensions("foo")});if(!Yt){var Qt=Object.preventExtensions;re(Object,"preventExtensions",function preventExtensions(e){if(!se.TypeIsObject(e)){return e}return Qt(e)})}}if(Object.isExtensible){var er=!i(function(){Object.isExtensible("foo")});if(!er){var tr=Object.isExtensible;re(Object,"isExtensible",function isExtensible(e){if(!se.TypeIsObject(e)){return false}return tr(e)})}}if(Object.getPrototypeOf){var rr=!i(function(){Object.getPrototypeOf("foo")});if(!rr){var nr=Object.getPrototypeOf;re(Object,"getPrototypeOf",function getPrototypeOf(e){return nr(se.ToObject(e))})}}var or=s&&function(){var e=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags");return e&&se.IsCallable(e.get)}();if(s&&!or){var ir=function flags(){if(!se.TypeIsObject(this)){throw new TypeError("Method called on incompatible type: must be an object.")}var e="";if(this.global){e+="g"}if(this.ignoreCase){e+="i"}if(this.multiline){e+="m"}if(this.unicode){e+="u"}if(this.sticky){e+="y"}return e};m.getter(RegExp.prototype,"flags",ir)}var ar=s&&a(function(){return String(new RegExp(/a/g,"i"))==="/a/i"});var ur=ne&&s&&function(){var e=/./;e[$.match]=false;return RegExp(e)===e}();var fr=a(function(){return RegExp.prototype.toString.call({source:"abc"})==="/abc/"});var sr=fr&&a(function(){return RegExp.prototype.toString.call({source:"a",flags:"b"})==="/a/b"});if(!fr||!sr){var cr=RegExp.prototype.toString;h(RegExp.prototype,"toString",function toString(){var e=se.RequireObjectCoercible(this);if(te.regex(e)){return t(cr,e)}var r=ae(e.source);var n=ae(e.flags);return"/"+r+"/"+n},true);m.preserveToString(RegExp.prototype.toString,cr)}if(s&&(!ar||ur)){var lr=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get;var pr=Object.getOwnPropertyDescriptor(RegExp.prototype,"source")||{};var vr=function(){return this.source};var yr=se.IsCallable(pr.get)?pr.get:vr;var hr=RegExp;var br=function(){return function RegExp(e,t){var r=se.IsRegExp(e);var n=this instanceof RegExp;if(!n&&r&&typeof t==="undefined"&&e.constructor===RegExp){return e}var o=e;var i=t;if(te.regex(e)){o=se.Call(yr,e);i=typeof t==="undefined"?se.Call(lr,e):t;return new RegExp(o,i)}else if(r){o=e.source;i=typeof t==="undefined"?e.flags:t}return new hr(e,t)}}();Ie(hr,br,{$input:true});RegExp=br;m.redefine(S,"RegExp",br)}if(s){var gr={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};l(n(gr),function(e){if(e in RegExp&&!(gr[e]in RegExp)){m.getter(RegExp,gr[e],function get(){return RegExp[e]})}})}Pe(RegExp);var dr=1/Number.EPSILON;var mr=function roundTiesToEven(e){return e+dr-dr};var Or=Math.pow(2,-23);var wr=Math.pow(2,127)*(2-Or);var jr=Math.pow(2,-126);var Sr=Math.E;var Tr=Math.LOG2E;var Ir=Math.LOG10E;var Er=Number.prototype.clz;delete Number.prototype.clz;var Pr={acosh:function acosh(e){var t=Number(e);if(X(t)||e<1){return NaN}if(t===1){return 0}if(t===Infinity){return t}return L(t/Sr+D(t+1)*D(t-1)/Sr)+1},asinh:function asinh(e){var t=Number(e);if(t===0||!T(t)){return t}return t<0?-asinh(-t):L(t+D(t*t+1))},atanh:function atanh(e){var t=Number(e);if(X(t)||t<-1||t>1){return NaN}if(t===-1){return-Infinity}if(t===1){return Infinity}if(t===0){return t}return.5*L((1+t)/(1-t))},cbrt:function cbrt(e){var t=Number(e);if(t===0){return t}var r=t<0;var n;if(r){t=-t}if(t===Infinity){n=Infinity}else{n=F(L(t)/3);n=(t/(n*n)+2*n)/3}return r?-n:n},clz32:function clz32(e){var t=Number(e);var r=se.ToUint32(t);if(r===0){return 32}return Er?se.Call(Er,r):31-_(L(r+.5)*Tr)},cosh:function cosh(e){var t=Number(e);if(t===0){return 1}if(X(t)){return NaN}if(!T(t)){return Infinity}if(t<0){t=-t}if(t>21){return F(t)/2}return(F(t)+F(-t))/2},expm1:function expm1(e){var t=Number(e);if(t===-Infinity){return-1}if(!T(t)||t===0){return t}if(k(t)>.5){return F(t)-1}var r=t;var n=0;var o=1;while(n+r!==n){n+=r;o+=1;r*=t/o}return n},hypot:function hypot(e,t){var r=0;var n=0;for(var o=0;o<arguments.length;++o){var i=k(Number(arguments[o]));if(n<i){r*=n/i*(n/i);r+=1;n=i}else{r+=i>0?i/n*(i/n):i}}return n===Infinity?Infinity:n*D(r)},log2:function log2(e){return L(e)*Tr},log10:function log10(e){return L(e)*Ir},log1p:function log1p(e){var t=Number(e);if(t<-1||X(t)){return NaN}if(t===0||t===Infinity){return t}if(t===-1){return-Infinity}return 1+t-1===0?t:t*(L(1+t)/(1+t-1))},sign:Z,sinh:function sinh(e){var t=Number(e);if(!T(t)||t===0){return t}if(k(t)<1){return(Math.expm1(t)-Math.expm1(-t))/2}return(F(t-1)-F(-t-1))*Sr/2},tanh:function tanh(e){var t=Number(e);if(X(t)||t===0){return t}if(t>=20){return 1}if(t<=-20){return-1}return(Math.expm1(t)-Math.expm1(-t))/(F(t)+F(-t))},trunc:function trunc(e){var t=Number(e);return t<0?-_(-t):_(t)},imul:function imul(e,t){var r=se.ToUint32(e);var n=se.ToUint32(t);var o=r>>>16&65535;var i=r&65535;var a=n>>>16&65535;var u=n&65535;return i*u+(o*u+i*a<<16>>>0)|0},fround:function fround(e){var t=Number(e);if(t===0||t===Infinity||t===-Infinity||X(t)){return t}var r=Z(t);var n=k(t);if(n<jr){return r*mr(n/jr/Or)*jr*Or}var o=(1+Or/Number.EPSILON)*n;var i=o-(o-n);if(i>wr||X(i)){return r*Infinity}return r*i}};b(Math,Pr);h(Math,"log1p",Pr.log1p,Math.log1p(-1e-17)!==-1e-17);h(Math,"asinh",Pr.asinh,Math.asinh(-1e7)!==-Math.asinh(1e7));h(Math,"tanh",Pr.tanh,Math.tanh(-2e-17)!==-2e-17);h(Math,"acosh",Pr.acosh,Math.acosh(Number.MAX_VALUE)===Infinity);h(Math,"cbrt",Pr.cbrt,Math.abs(1-Math.cbrt(1e-300)/1e-100)/Number.EPSILON>8);h(Math,"sinh",Pr.sinh,Math.sinh(-2e-17)!==-2e-17);var Cr=Math.expm1(10);h(Math,"expm1",Pr.expm1,Cr>22025.465794806718||Cr<22025.465794806718);var Mr=Math.round;var xr=Math.round(.5-Number.EPSILON/4)===0&&Math.round(-.5+Number.EPSILON/3.99)===1;var Nr=dr+1;var Ar=2*dr-1;var Rr=[Nr,Ar].every(function(e){return Math.round(e)===e});h(Math,"round",function round(e){var t=_(e);var r=t===-1?-0:t+1;
return e-t<.5?t:r},!xr||!Rr);m.preserveToString(Math.round,Mr);var _r=Math.imul;if(Math.imul(4294967295,5)!==-5){Math.imul=Pr.imul;m.preserveToString(Math.imul,_r)}if(Math.imul.length!==2){re(Math,"imul",function imul(e,t){return se.Call(_r,Math,arguments)})}var kr=function(){var e=S.setTimeout;if(typeof e!=="function"&&typeof e!=="object"){return}se.IsPromise=function(e){if(!se.TypeIsObject(e)){return false}if(typeof e._promise==="undefined"){return false}return true};var r=function(e){if(!se.IsConstructor(e)){throw new TypeError("Bad promise constructor")}var t=this;var r=function(e,r){if(t.resolve!==void 0||t.reject!==void 0){throw new TypeError("Bad Promise implementation!")}t.resolve=e;t.reject=r};t.resolve=void 0;t.reject=void 0;t.promise=new e(r);if(!(se.IsCallable(t.resolve)&&se.IsCallable(t.reject))){throw new TypeError("Bad promise constructor")}};var n;if(typeof window!=="undefined"&&se.IsCallable(window.postMessage)){n=function(){var e=[];var t="zero-timeout-message";var r=function(r){M(e,r);window.postMessage(t,"*")};var n=function(r){if(r.source===window&&r.data===t){r.stopPropagation();if(e.length===0){return}var n=N(e);n()}};window.addEventListener("message",n,true);return r}}var o=function(){var e=S.Promise;var t=e&&e.resolve&&e.resolve();return t&&function(e){return t.then(e)}};var i=se.IsCallable(S.setImmediate)?S.setImmediate:typeof process==="object"&&process.nextTick?process.nextTick:o()||(se.IsCallable(n)?n():function(t){e(t,0)});var a=function(e){return e};var u=function(e){throw e};var f=0;var s=1;var c=2;var l=0;var p=1;var v=2;var y={};var h=function(e,t,r){i(function(){g(e,t,r)})};var g=function(e,t,r){var n,o;if(t===y){return e(r)}try{n=e(r);o=t.resolve}catch(e){n=e;o=t.reject}o(n)};var d=function(e,t){var r=e._promise;var n=r.reactionLength;if(n>0){h(r.fulfillReactionHandler0,r.reactionCapability0,t);r.fulfillReactionHandler0=void 0;r.rejectReactions0=void 0;r.reactionCapability0=void 0;if(n>1){for(var o=1,i=0;o<n;o++,i+=3){h(r[i+l],r[i+v],t);e[i+l]=void 0;e[i+p]=void 0;e[i+v]=void 0}}}r.result=t;r.state=s;r.reactionLength=0};var m=function(e,t){var r=e._promise;var n=r.reactionLength;if(n>0){h(r.rejectReactionHandler0,r.reactionCapability0,t);r.fulfillReactionHandler0=void 0;r.rejectReactions0=void 0;r.reactionCapability0=void 0;if(n>1){for(var o=1,i=0;o<n;o++,i+=3){h(r[i+p],r[i+v],t);e[i+l]=void 0;e[i+p]=void 0;e[i+v]=void 0}}}r.result=t;r.state=c;r.reactionLength=0};var O=function(e){var t=false;var r=function(r){var n;if(t){return}t=true;if(r===e){return m(e,new TypeError("Self resolution"))}if(!se.TypeIsObject(r)){return d(e,r)}try{n=r.then}catch(t){return m(e,t)}if(!se.IsCallable(n)){return d(e,r)}i(function(){j(e,r,n)})};var n=function(r){if(t){return}t=true;return m(e,r)};return{resolve:r,reject:n}};var w=function(e,r,n,o){if(e===I){t(e,r,n,o,y)}else{t(e,r,n,o)}};var j=function(e,t,r){var n=O(e);var o=n.resolve;var i=n.reject;try{w(r,t,o,i)}catch(e){i(e)}};var T,I;var E=function(){var e=function Promise(t){if(!(this instanceof e)){throw new TypeError('Constructor Promise requires "new"')}if(this&&this._promise){throw new TypeError("Bad construction")}if(!se.IsCallable(t)){throw new TypeError("not a valid resolver")}var r=Ne(this,e,T,{_promise:{result:void 0,state:f,reactionLength:0,fulfillReactionHandler0:void 0,rejectReactionHandler0:void 0,reactionCapability0:void 0}});var n=O(r);var o=n.reject;try{t(n.resolve,o)}catch(e){o(e)}return r};return e}();T=E.prototype;var P=function(e,t,r,n){var o=false;return function(i){if(o){return}o=true;t[e]=i;if(--n.count===0){var a=r.resolve;a(t)}}};var C=function(e,t,r){var n=e.iterator;var o=[];var i={count:1};var a,u;var f=0;while(true){try{a=se.IteratorStep(n);if(a===false){e.done=true;break}u=a.value}catch(t){e.done=true;throw t}o[f]=void 0;var s=t.resolve(u);var c=P(f,o,r,i);i.count+=1;w(s.then,s,c,r.reject);f+=1}if(--i.count===0){var l=r.resolve;l(o)}return r.promise};var x=function(e,t,r){var n=e.iterator;var o,i,a;while(true){try{o=se.IteratorStep(n);if(o===false){e.done=true;break}i=o.value}catch(t){e.done=true;throw t}a=t.resolve(i);w(a.then,a,r.resolve,r.reject)}return r.promise};b(E,{all:function all(e){var t=this;if(!se.TypeIsObject(t)){throw new TypeError("Promise is not object")}var n=new r(t);var o,i;try{o=se.GetIterator(e);i={iterator:o,done:false};return C(i,t,n)}catch(e){var a=e;if(i&&!i.done){try{se.IteratorClose(o,true)}catch(e){a=e}}var u=n.reject;u(a);return n.promise}},race:function race(e){var t=this;if(!se.TypeIsObject(t)){throw new TypeError("Promise is not object")}var n=new r(t);var o,i;try{o=se.GetIterator(e);i={iterator:o,done:false};return x(i,t,n)}catch(e){var a=e;if(i&&!i.done){try{se.IteratorClose(o,true)}catch(e){a=e}}var u=n.reject;u(a);return n.promise}},reject:function reject(e){var t=this;if(!se.TypeIsObject(t)){throw new TypeError("Bad promise constructor")}var n=new r(t);var o=n.reject;o(e);return n.promise},resolve:function resolve(e){var t=this;if(!se.TypeIsObject(t)){throw new TypeError("Bad promise constructor")}if(se.IsPromise(e)){var n=e.constructor;if(n===t){return e}}var o=new r(t);var i=o.resolve;i(e);return o.promise}});b(T,{catch:function(e){return this.then(null,e)},then:function then(e,t){var n=this;if(!se.IsPromise(n)){throw new TypeError("not a promise")}var o=se.SpeciesConstructor(n,E);var i;var b=arguments.length>2&&arguments[2]===y;if(b&&o===E){i=y}else{i=new r(o)}var g=se.IsCallable(e)?e:a;var d=se.IsCallable(t)?t:u;var m=n._promise;var O;if(m.state===f){if(m.reactionLength===0){m.fulfillReactionHandler0=g;m.rejectReactionHandler0=d;m.reactionCapability0=i}else{var w=3*(m.reactionLength-1);m[w+l]=g;m[w+p]=d;m[w+v]=i}m.reactionLength+=1}else if(m.state===s){O=m.result;h(g,i,O)}else if(m.state===c){O=m.result;h(d,i,O)}else{throw new TypeError("unexpected Promise state")}return i.promise}});y=new r(E);I=T.then;return E}();if(S.Promise){delete S.Promise.accept;delete S.Promise.defer;delete S.Promise.prototype.chain}if(typeof kr==="function"){b(S,{Promise:kr});var Fr=w(S.Promise,function(e){return e.resolve(42).then(function(){})instanceof e});var Lr=!i(function(){S.Promise.reject(42).then(null,5).then(null,W)});var Dr=i(function(){S.Promise.call(3,W)});var zr=function(e){var t=e.resolve(5);t.constructor={};var r=e.resolve(t);try{r.then(null,W).then(null,W)}catch(e){return true}return t===r}(S.Promise);var qr=s&&function(){var e=0;var t=Object.defineProperty({},"then",{get:function(){e+=1}});Promise.resolve(t);return e===1}();var Wr=function BadResolverPromise(e){var t=new Promise(e);e(3,function(){});this.then=t.then;this.constructor=BadResolverPromise};Wr.prototype=Promise.prototype;Wr.all=Promise.all;var Gr=a(function(){return!!Wr.all([1,2])});if(!Fr||!Lr||!Dr||zr||!qr||Gr){Promise=kr;re(S,"Promise",kr)}if(Promise.all.length!==1){var Hr=Promise.all;re(Promise,"all",function all(e){return se.Call(Hr,this,arguments)})}if(Promise.race.length!==1){var Vr=Promise.race;re(Promise,"race",function race(e){return se.Call(Vr,this,arguments)})}if(Promise.resolve.length!==1){var Br=Promise.resolve;re(Promise,"resolve",function resolve(e){return se.Call(Br,this,arguments)})}if(Promise.reject.length!==1){var Ur=Promise.reject;re(Promise,"reject",function reject(e){return se.Call(Ur,this,arguments)})}Ct(Promise,"all");Ct(Promise,"race");Ct(Promise,"resolve");Ct(Promise,"reject");Pe(Promise)}var $r=function(e){var t=n(p(e,function(e,t){e[t]=true;return e},{}));return e.join(":")===t.join(":")};var Jr=$r(["z","a","bb"]);var Xr=$r(["z",1,"a","3",2]);if(s){var Kr=function fastkey(e,t){if(!t&&!Jr){return null}if(fe(e)){return"^"+se.ToString(e)}else if(typeof e==="string"){return"$"+e}else if(typeof e==="number"){if(!Xr){return"n"+e}return e}else if(typeof e==="boolean"){return"b"+e}return null};var Zr=function emptyObject(){return Object.create?Object.create(null):{}};var Yr=function addIterableToMap(e,n,o){if(r(o)||te.string(o)){l(o,function(e){if(!se.TypeIsObject(e)){throw new TypeError("Iterator value "+e+" is not an entry object")}n.set(e[0],e[1])})}else if(o instanceof e){t(e.prototype.forEach,o,function(e,t){n.set(t,e)})}else{var i,a;if(!fe(o)){a=n.set;if(!se.IsCallable(a)){throw new TypeError("bad map")}i=se.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=se.IteratorStep(i);if(u===false){break}var f=u.value;try{if(!se.TypeIsObject(f)){throw new TypeError("Iterator value "+f+" is not an entry object")}t(a,n,f[0],f[1])}catch(e){se.IteratorClose(i,true);throw e}}}}};var Qr=function addIterableToSet(e,n,o){if(r(o)||te.string(o)){l(o,function(e){n.add(e)})}else if(o instanceof e){t(e.prototype.forEach,o,function(e){n.add(e)})}else{var i,a;if(!fe(o)){a=n.add;if(!se.IsCallable(a)){throw new TypeError("bad set")}i=se.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=se.IteratorStep(i);if(u===false){break}var f=u.value;try{t(a,n,f)}catch(e){se.IteratorClose(i,true);throw e}}}}};var en={Map:function(){var e={};var r=function MapEntry(e,t){this.key=e;this.value=t;this.next=null;this.prev=null};r.prototype.isRemoved=function isRemoved(){return this.key===e};var n=function isMap(e){return!!e._es6map};var o=function requireMapSlot(e,t){if(!se.TypeIsObject(e)||!n(e)){throw new TypeError("Method Map.prototype."+t+" called on incompatible receiver "+se.ToString(e))}};var i=function MapIterator(e,t){o(e,"[[MapIterator]]");this.head=e._head;this.i=this.head;this.kind=t};i.prototype={next:function next(){var e=this.i;var t=this.kind;var r=this.head;if(typeof this.i==="undefined"){return Xe()}while(e.isRemoved()&&e!==r){e=e.prev}var n;while(e.next!==r){e=e.next;if(!e.isRemoved()){if(t==="key"){n=e.key}else if(t==="value"){n=e.value}else{n=[e.key,e.value]}this.i=e;return Xe(n)}}this.i=void 0;return Xe()}};Ce(i.prototype);var a;var u=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}if(this&&this._es6map){throw new TypeError("Bad construction")}var e=Ne(this,Map,a,{_es6map:true,_head:null,_map:G?new G:null,_size:0,_storage:Zr()});var t=new r(null,null);t.next=t.prev=t;e._head=t;if(arguments.length>0){Yr(Map,e,arguments[0])}return e};a=u.prototype;m.getter(a,"size",function(){if(typeof this._size==="undefined"){throw new TypeError("size method called on incompatible Map")}return this._size});b(a,{get:function get(e){o(this,"get");var t;var r=Kr(e,true);if(r!==null){t=this._storage[r];if(t){return t.value}else{return}}if(this._map){t=V.call(this._map,e);if(t){return t.value}else{return}}var n=this._head;var i=n;while((i=i.next)!==n){if(se.SameValueZero(i.key,e)){return i.value}}},has:function has(e){o(this,"has");var t=Kr(e,true);if(t!==null){return typeof this._storage[t]!=="undefined"}if(this._map){return B.call(this._map,e)}var r=this._head;var n=r;while((n=n.next)!==r){if(se.SameValueZero(n.key,e)){return true}}return false},set:function set(e,t){o(this,"set");var n=this._head;var i=n;var a;var u=Kr(e,true);if(u!==null){if(typeof this._storage[u]!=="undefined"){this._storage[u].value=t;return this}else{a=this._storage[u]=new r(e,t);i=n.prev}}else if(this._map){if(B.call(this._map,e)){V.call(this._map,e).value=t}else{a=new r(e,t);U.call(this._map,e,a);i=n.prev}}while((i=i.next)!==n){if(se.SameValueZero(i.key,e)){i.value=t;return this}}a=a||new r(e,t);if(se.SameValue(-0,e)){a.key=+0}a.next=this._head;a.prev=this._head.prev;a.prev.next=a;a.next.prev=a;this._size+=1;return this},delete:function(t){o(this,"delete");var r=this._head;var n=r;var i=Kr(t,true);if(i!==null){if(typeof this._storage[i]==="undefined"){return false}n=this._storage[i].prev;delete this._storage[i]}else if(this._map){if(!B.call(this._map,t)){return false}n=V.call(this._map,t).prev;H.call(this._map,t)}while((n=n.next)!==r){if(se.SameValueZero(n.key,t)){n.key=e;n.value=e;n.prev.next=n.next;n.next.prev=n.prev;this._size-=1;return true}}return false},clear:function clear(){o(this,"clear");this._map=G?new G:null;this._size=0;this._storage=Zr();var t=this._head;var r=t;var n=r.next;while((r=n)!==t){r.key=e;r.value=e;n=r.next;r.next=r.prev=t}t.next=t.prev=t},keys:function keys(){o(this,"keys");return new i(this,"key")},values:function values(){o(this,"values");return new i(this,"value")},entries:function entries(){o(this,"entries");return new i(this,"key+value")},forEach:function forEach(e){o(this,"forEach");var r=arguments.length>1?arguments[1]:null;var n=this.entries();for(var i=n.next();!i.done;i=n.next()){if(r){t(e,r,i.value[1],i.value[0],this)}else{e(i.value[1],i.value[0],this)}}}});Ce(a,a.entries);return u}(),Set:function(){var e=function isSet(e){return e._es6set&&typeof e._storage!=="undefined"};var r=function requireSetSlot(t,r){if(!se.TypeIsObject(t)||!e(t)){throw new TypeError("Set.prototype."+r+" called on incompatible receiver "+se.ToString(t))}};var o;var i=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}if(this&&this._es6set){throw new TypeError("Bad construction")}var e=Ne(this,Set,o,{_es6set:true,"[[SetData]]":null,_storage:Zr()});if(!e._es6set){throw new TypeError("bad set")}if(arguments.length>0){Qr(Set,e,arguments[0])}return e};o=i.prototype;var a=function(e){var t=e;if(t==="^null"){return null}else if(t==="^undefined"){return void 0}else{var r=t.charAt(0);if(r==="$"){return C(t,1)}else if(r==="n"){return+C(t,1)}else if(r==="b"){return t==="btrue"}}return+t};var u=function ensureMap(e){if(!e["[[SetData]]"]){var t=new en.Map;e["[[SetData]]"]=t;l(n(e._storage),function(e){var r=a(e);t.set(r,r)});e["[[SetData]]"]=t}e._storage=null};m.getter(i.prototype,"size",function(){r(this,"size");if(this._storage){return n(this._storage).length}u(this);return this["[[SetData]]"].size});b(i.prototype,{has:function has(e){r(this,"has");var t;if(this._storage&&(t=Kr(e))!==null){return!!this._storage[t]}u(this);return this["[[SetData]]"].has(e)},add:function add(e){r(this,"add");var t;if(this._storage&&(t=Kr(e))!==null){this._storage[t]=true;return this}u(this);this["[[SetData]]"].set(e,e);return this},delete:function(e){r(this,"delete");var t;if(this._storage&&(t=Kr(e))!==null){var n=z(this._storage,t);return delete this._storage[t]&&n}u(this);return this["[[SetData]]"]["delete"](e)},clear:function clear(){r(this,"clear");if(this._storage){this._storage=Zr()}if(this["[[SetData]]"]){this["[[SetData]]"].clear()}},values:function values(){r(this,"values");u(this);return this["[[SetData]]"].values()},entries:function entries(){r(this,"entries");u(this);return this["[[SetData]]"].entries()},forEach:function forEach(e){r(this,"forEach");var n=arguments.length>1?arguments[1]:null;var o=this;u(o);this["[[SetData]]"].forEach(function(r,i){if(n){t(e,n,i,i,o)}else{e(i,i,o)}})}});h(i.prototype,"keys",i.prototype.values,true);Ce(i.prototype,i.prototype.values);return i}()};if(S.Map||S.Set){var tn=a(function(){return new Map([[1,2]]).get(1)===2});if(!tn){S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new G;if(arguments.length>0){Yr(Map,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,S.Map.prototype);return e};S.Map.prototype=O(G.prototype);h(S.Map.prototype,"constructor",S.Map,true);m.preserveToString(S.Map,G)}var rn=new Map;var nn=function(){var e=new Map([[1,0],[2,0],[3,0],[4,0]]);e.set(-0,e);return e.get(0)===e&&e.get(-0)===e&&e.has(0)&&e.has(-0)}();var on=rn.set(1,2)===rn;if(!nn||!on){re(Map.prototype,"set",function set(e,r){t(U,this,e===0?0:e,r);return this})}if(!nn){b(Map.prototype,{get:function get(e){return t(V,this,e===0?0:e)},has:function has(e){return t(B,this,e===0?0:e)}},true);m.preserveToString(Map.prototype.get,V);m.preserveToString(Map.prototype.has,B)}var an=new Set;var un=function(e){e["delete"](0);e.add(-0);return!e.has(0)}(an);var fn=an.add(1)===an;if(!un||!fn){var sn=Set.prototype.add;Set.prototype.add=function add(e){t(sn,this,e===0?0:e);return this};m.preserveToString(Set.prototype.add,sn)}if(!un){var cn=Set.prototype.has;Set.prototype.has=function has(e){return t(cn,this,e===0?0:e)};m.preserveToString(Set.prototype.has,cn);var ln=Set.prototype["delete"];Set.prototype["delete"]=function SetDelete(e){return t(ln,this,e===0?0:e)};m.preserveToString(Set.prototype["delete"],ln)}var pn=w(S.Map,function(e){var t=new e([]);t.set(42,42);return t instanceof e});var vn=Object.setPrototypeOf&&!pn;var yn=function(){try{return!(S.Map()instanceof S.Map)}catch(e){return e instanceof TypeError}}();if(S.Map.length!==0||vn||!yn){S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new G;if(arguments.length>0){Yr(Map,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,Map.prototype);return e};S.Map.prototype=G.prototype;h(S.Map.prototype,"constructor",S.Map,true);m.preserveToString(S.Map,G)}var hn=w(S.Set,function(e){var t=new e([]);t.add(42,42);return t instanceof e});var bn=Object.setPrototypeOf&&!hn;var gn=function(){try{return!(S.Set()instanceof S.Set)}catch(e){return e instanceof TypeError}}();if(S.Set.length!==0||bn||!gn){var dn=S.Set;S.Set=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}var e=new dn;if(arguments.length>0){Qr(Set,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,Set.prototype);return e};S.Set.prototype=dn.prototype;h(S.Set.prototype,"constructor",S.Set,true);m.preserveToString(S.Set,dn)}var mn=new S.Map;var On=!a(function(){return mn.keys().next().done});if(typeof S.Map.prototype.clear!=="function"||(new S.Set).size!==0||mn.size!==0||typeof S.Map.prototype.keys!=="function"||typeof S.Set.prototype.keys!=="function"||typeof S.Map.prototype.forEach!=="function"||typeof S.Set.prototype.forEach!=="function"||u(S.Map)||u(S.Set)||typeof mn.keys().next!=="function"||On||!pn){b(S,{Map:en.Map,Set:en.Set},true)}if(S.Set.prototype.keys!==S.Set.prototype.values){h(S.Set.prototype,"keys",S.Set.prototype.values,true)}Ce(Object.getPrototypeOf((new S.Map).keys()));Ce(Object.getPrototypeOf((new S.Set).keys()));if(c&&S.Set.prototype.has.name!=="has"){var wn=S.Set.prototype.has;re(S.Set.prototype,"has",function has(e){return t(wn,this,e)})}}b(S,en);Pe(S.Map);Pe(S.Set)}var jn=function throwUnlessTargetIsObject(e){if(!se.TypeIsObject(e)){throw new TypeError("target must be an object")}};var Sn={apply:function apply(){return se.Call(se.Call,null,arguments)},construct:function construct(e,t){if(!se.IsConstructor(e)){throw new TypeError("First argument must be a constructor.")}var r=arguments.length>2?arguments[2]:e;if(!se.IsConstructor(r)){throw new TypeError("new.target must be a constructor.")}return se.Construct(e,t,r,"internal")},deleteProperty:function deleteProperty(e,t){jn(e);if(s){var r=Object.getOwnPropertyDescriptor(e,t);if(r&&!r.configurable){return false}}return delete e[t]},has:function has(e,t){jn(e);return t in e}};if(Object.getOwnPropertyNames){Object.assign(Sn,{ownKeys:function ownKeys(e){jn(e);var t=Object.getOwnPropertyNames(e);if(se.IsCallable(Object.getOwnPropertySymbols)){x(t,Object.getOwnPropertySymbols(e))}return t}})}var Tn=function ConvertExceptionToBoolean(e){return!i(e)};if(Object.preventExtensions){Object.assign(Sn,{isExtensible:function isExtensible(e){jn(e);return Object.isExtensible(e)},preventExtensions:function preventExtensions(e){jn(e);return Tn(function(){Object.preventExtensions(e)})}})}if(s){var In=function get(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t);if(!n){var o=Object.getPrototypeOf(e);if(o===null){return void 0}return In(o,t,r)}if("value"in n){return n.value}if(n.get){return se.Call(n.get,r)}return void 0};var En=function set(e,r,n,o){var i=Object.getOwnPropertyDescriptor(e,r);if(!i){var a=Object.getPrototypeOf(e);if(a!==null){return En(a,r,n,o)}i={value:void 0,writable:true,enumerable:true,configurable:true}}if("value"in i){if(!i.writable){return false}if(!se.TypeIsObject(o)){return false}var u=Object.getOwnPropertyDescriptor(o,r);if(u){return ie.defineProperty(o,r,{value:n})}else{return ie.defineProperty(o,r,{value:n,writable:true,enumerable:true,configurable:true})}}if(i.set){t(i.set,o,n);return true}return false};Object.assign(Sn,{defineProperty:function defineProperty(e,t,r){jn(e);return Tn(function(){Object.defineProperty(e,t,r)})},getOwnPropertyDescriptor:function getOwnPropertyDescriptor(e,t){jn(e);return Object.getOwnPropertyDescriptor(e,t)},get:function get(e,t){jn(e);var r=arguments.length>2?arguments[2]:e;return In(e,t,r)},set:function set(e,t,r){jn(e);var n=arguments.length>3?arguments[3]:e;return En(e,t,r,n)}})}if(Object.getPrototypeOf){var Pn=Object.getPrototypeOf;Sn.getPrototypeOf=function getPrototypeOf(e){jn(e);return Pn(e)}}if(Object.setPrototypeOf&&Sn.getPrototypeOf){var Cn=function(e,t){var r=t;while(r){if(e===r){return true}r=Sn.getPrototypeOf(r)}return false};Object.assign(Sn,{setPrototypeOf:function setPrototypeOf(e,t){jn(e);if(t!==null&&!se.TypeIsObject(t)){throw new TypeError("proto must be an object or null")}if(t===ie.getPrototypeOf(e)){return true}if(ie.isExtensible&&!ie.isExtensible(e)){return false}if(Cn(e,t)){return false}Object.setPrototypeOf(e,t);return true}})}var Mn=function(e,t){if(!se.IsCallable(S.Reflect[e])){h(S.Reflect,e,t)}else{var r=a(function(){S.Reflect[e](1);S.Reflect[e](NaN);S.Reflect[e](true);return true});if(r){re(S.Reflect,e,t)}}};Object.keys(Sn).forEach(function(e){Mn(e,Sn[e])});var xn=S.Reflect.getPrototypeOf;if(c&&xn&&xn.name!=="getPrototypeOf"){re(S.Reflect,"getPrototypeOf",function getPrototypeOf(e){return t(xn,S.Reflect,e)})}if(S.Reflect.setPrototypeOf){if(a(function(){S.Reflect.setPrototypeOf(1,{});return true})){re(S.Reflect,"setPrototypeOf",Sn.setPrototypeOf)}}if(S.Reflect.defineProperty){if(!a(function(){var e=!S.Reflect.defineProperty(1,"test",{value:1});var t=typeof Object.preventExtensions!=="function"||!S.Reflect.defineProperty(Object.preventExtensions({}),"test",{});return e&&t})){re(S.Reflect,"defineProperty",Sn.defineProperty)}}if(S.Reflect.construct){if(!a(function(){var e=function F(){};return S.Reflect.construct(function(){},[],e)instanceof e})){re(S.Reflect,"construct",Sn.construct)}}if(String(new Date(NaN))!=="Invalid Date"){var Nn=Date.prototype.toString;var An=function toString(){var e=+this;if(e!==e){return"Invalid Date"}return se.Call(Nn,this)};re(Date.prototype,"toString",An)}var Rn={anchor:function anchor(e){return se.CreateHTML(this,"a","name",e)},big:function big(){return se.CreateHTML(this,"big","","")},blink:function blink(){return se.CreateHTML(this,"blink","","")},bold:function bold(){return se.CreateHTML(this,"b","","")},fixed:function fixed(){return se.CreateHTML(this,"tt","","")},fontcolor:function fontcolor(e){return se.CreateHTML(this,"font","color",e)},fontsize:function fontsize(e){return se.CreateHTML(this,"font","size",e)},italics:function italics(){return se.CreateHTML(this,"i","","")},link:function link(e){return se.CreateHTML(this,"a","href",e)},small:function small(){return se.CreateHTML(this,"small","","")},strike:function strike(){return se.CreateHTML(this,"strike","","")},sub:function sub(){return se.CreateHTML(this,"sub","","")},sup:function sub(){return se.CreateHTML(this,"sup","","")}};l(Object.keys(Rn),function(e){var r=String.prototype[e];var n=false;if(se.IsCallable(r)){var o=t(r,"",' " ');var i=P([],o.match(/"/g)).length;n=o!==o.toLowerCase()||i>2}else{n=true}if(n){re(String.prototype,e,Rn[e])}});var _n=function(){if(!ne){return false}var e=typeof JSON==="object"&&typeof JSON.stringify==="function"?JSON.stringify:null;if(!e){return false}if(typeof e($())!=="undefined"){return true}if(e([$()])!=="[null]"){return true}var t={a:$()};t[$()]=true;if(e(t)!=="{}"){return true}return false}();var kn=a(function(){if(!ne){return true}return JSON.stringify(Object($()))==="{}"&&JSON.stringify([Object($())])==="[{}]"});if(_n||!kn){var Fn=JSON.stringify;re(JSON,"stringify",function stringify(e){if(typeof e==="symbol"){return}var n;if(arguments.length>1){n=arguments[1]}var o=[e];if(!r(n)){var i=se.IsCallable(n)?n:null;var a=function(e,r){var n=i?t(i,this,e,r):r;if(typeof n!=="symbol"){if(te.symbol(n)){return xt({})(n)}else{return n}}};o.push(a)}else{o.push(n)}if(arguments.length>2){o.push(arguments[2])}return Fn.apply(this,o)})}return S});
//# sourceMappingURL=es6-shim.map
/*! jQuery v3.1.1 | (c) jQuery Foundation | jquery.org/license */
!function(a,b){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){"use strict";var c=[],d=a.document,e=Object.getPrototypeOf,f=c.slice,g=c.concat,h=c.push,i=c.indexOf,j={},k=j.toString,l=j.hasOwnProperty,m=l.toString,n=m.call(Object),o={};function p(a,b){b=b||d;var c=b.createElement("script");c.text=a,b.head.appendChild(c).parentNode.removeChild(c)}var q="3.1.1",r=function(a,b){return new r.fn.init(a,b)},s=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,t=/^-ms-/,u=/-([a-z])/g,v=function(a,b){return b.toUpperCase()};r.fn=r.prototype={jquery:q,constructor:r,length:0,toArray:function(){return f.call(this)},get:function(a){return null==a?f.call(this):a<0?this[a+this.length]:this[a]},pushStack:function(a){var b=r.merge(this.constructor(),a);return b.prevObject=this,b},each:function(a){return r.each(this,a)},map:function(a){return this.pushStack(r.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(f.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(a<0?b:0);return this.pushStack(c>=0&&c<b?[this[c]]:[])},end:function(){return this.prevObject||this.constructor()},push:h,sort:c.sort,splice:c.splice},r.extend=r.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||r.isFunction(g)||(g={}),h===i&&(g=this,h--);h<i;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(r.isPlainObject(d)||(e=r.isArray(d)))?(e?(e=!1,f=c&&r.isArray(c)?c:[]):f=c&&r.isPlainObject(c)?c:{},g[b]=r.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},r.extend({expando:"jQuery"+(q+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===r.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){var b=r.type(a);return("number"===b||"string"===b)&&!isNaN(a-parseFloat(a))},isPlainObject:function(a){var b,c;return!(!a||"[object Object]"!==k.call(a))&&(!(b=e(a))||(c=l.call(b,"constructor")&&b.constructor,"function"==typeof c&&m.call(c)===n))},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?j[k.call(a)]||"object":typeof a},globalEval:function(a){p(a)},camelCase:function(a){return a.replace(t,"ms-").replace(u,v)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b){var c,d=0;if(w(a)){for(c=a.length;d<c;d++)if(b.call(a[d],d,a[d])===!1)break}else for(d in a)if(b.call(a[d],d,a[d])===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(s,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(w(Object(a))?r.merge(c,"string"==typeof a?[a]:a):h.call(c,a)),c},inArray:function(a,b,c){return null==b?-1:i.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;d<c;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;f<g;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,e,f=0,h=[];if(w(a))for(d=a.length;f<d;f++)e=b(a[f],f,c),null!=e&&h.push(e);else for(f in a)e=b(a[f],f,c),null!=e&&h.push(e);return g.apply([],h)},guid:1,proxy:function(a,b){var c,d,e;if("string"==typeof b&&(c=a[b],b=a,a=c),r.isFunction(a))return d=f.call(arguments,2),e=function(){return a.apply(b||this,d.concat(f.call(arguments)))},e.guid=a.guid=a.guid||r.guid++,e},now:Date.now,support:o}),"function"==typeof Symbol&&(r.fn[Symbol.iterator]=c[Symbol.iterator]),r.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(a,b){j["[object "+b+"]"]=b.toLowerCase()});function w(a){var b=!!a&&"length"in a&&a.length,c=r.type(a);return"function"!==c&&!r.isWindow(a)&&("array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a)}var x=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+1*new Date,v=a.document,w=0,x=0,y=ha(),z=ha(),A=ha(),B=function(a,b){return a===b&&(l=!0),0},C={}.hasOwnProperty,D=[],E=D.pop,F=D.push,G=D.push,H=D.slice,I=function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},J="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",K="[\\x20\\t\\r\\n\\f]",L="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",M="\\["+K+"*("+L+")(?:"+K+"*([*^$|!~]?=)"+K+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+L+"))|)"+K+"*\\]",N=":("+L+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+M+")*)|.*)\\)|)",O=new RegExp(K+"+","g"),P=new RegExp("^"+K+"+|((?:^|[^\\\\])(?:\\\\.)*)"+K+"+$","g"),Q=new RegExp("^"+K+"*,"+K+"*"),R=new RegExp("^"+K+"*([>+~]|"+K+")"+K+"*"),S=new RegExp("="+K+"*([^\\]'\"]*?)"+K+"*\\]","g"),T=new RegExp(N),U=new RegExp("^"+L+"$"),V={ID:new RegExp("^#("+L+")"),CLASS:new RegExp("^\\.("+L+")"),TAG:new RegExp("^("+L+"|[*])"),ATTR:new RegExp("^"+M),PSEUDO:new RegExp("^"+N),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+K+"*(even|odd|(([+-]|)(\\d*)n|)"+K+"*(?:([+-]|)"+K+"*(\\d+)|))"+K+"*\\)|)","i"),bool:new RegExp("^(?:"+J+")$","i"),needsContext:new RegExp("^"+K+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+K+"*((?:-\\d)?\\d*)"+K+"*\\)|)(?=[^-]|$)","i")},W=/^(?:input|select|textarea|button)$/i,X=/^h\d$/i,Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,$=/[+~]/,_=new RegExp("\\\\([\\da-f]{1,6}"+K+"?|("+K+")|.)","ig"),aa=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:d<0?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},ba=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ca=function(a,b){return b?"\0"===a?"\ufffd":a.slice(0,-1)+"\\"+a.charCodeAt(a.length-1).toString(16)+" ":"\\"+a},da=function(){m()},ea=ta(function(a){return a.disabled===!0&&("form"in a||"label"in a)},{dir:"parentNode",next:"legend"});try{G.apply(D=H.call(v.childNodes),v.childNodes),D[v.childNodes.length].nodeType}catch(fa){G={apply:D.length?function(a,b){F.apply(a,H.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function ga(a,b,d,e){var f,h,j,k,l,o,r,s=b&&b.ownerDocument,w=b?b.nodeType:9;if(d=d||[],"string"!=typeof a||!a||1!==w&&9!==w&&11!==w)return d;if(!e&&((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,p)){if(11!==w&&(l=Z.exec(a)))if(f=l[1]){if(9===w){if(!(j=b.getElementById(f)))return d;if(j.id===f)return d.push(j),d}else if(s&&(j=s.getElementById(f))&&t(b,j)&&j.id===f)return d.push(j),d}else{if(l[2])return G.apply(d,b.getElementsByTagName(a)),d;if((f=l[3])&&c.getElementsByClassName&&b.getElementsByClassName)return G.apply(d,b.getElementsByClassName(f)),d}if(c.qsa&&!A[a+" "]&&(!q||!q.test(a))){if(1!==w)s=b,r=a;else if("object"!==b.nodeName.toLowerCase()){(k=b.getAttribute("id"))?k=k.replace(ba,ca):b.setAttribute("id",k=u),o=g(a),h=o.length;while(h--)o[h]="#"+k+" "+sa(o[h]);r=o.join(","),s=$.test(a)&&qa(b.parentNode)||b}if(r)try{return G.apply(d,s.querySelectorAll(r)),d}catch(x){}finally{k===u&&b.removeAttribute("id")}}}return i(a.replace(P,"$1"),b,d,e)}function ha(){var a=[];function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}return b}function ia(a){return a[u]=!0,a}function ja(a){var b=n.createElement("fieldset");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function ka(a,b){var c=a.split("|"),e=c.length;while(e--)d.attrHandle[c[e]]=b}function la(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&a.sourceIndex-b.sourceIndex;if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function ma(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function na(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function oa(a){return function(b){return"form"in b?b.parentNode&&b.disabled===!1?"label"in b?"label"in b.parentNode?b.parentNode.disabled===a:b.disabled===a:b.isDisabled===a||b.isDisabled!==!a&&ea(b)===a:b.disabled===a:"label"in b&&b.disabled===a}}function pa(a){return ia(function(b){return b=+b,ia(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function qa(a){return a&&"undefined"!=typeof a.getElementsByTagName&&a}c=ga.support={},f=ga.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return!!b&&"HTML"!==b.nodeName},m=ga.setDocument=function(a){var b,e,g=a?a.ownerDocument||a:v;return g!==n&&9===g.nodeType&&g.documentElement?(n=g,o=n.documentElement,p=!f(n),v!==n&&(e=n.defaultView)&&e.top!==e&&(e.addEventListener?e.addEventListener("unload",da,!1):e.attachEvent&&e.attachEvent("onunload",da)),c.attributes=ja(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=ja(function(a){return a.appendChild(n.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=Y.test(n.getElementsByClassName),c.getById=ja(function(a){return o.appendChild(a).id=u,!n.getElementsByName||!n.getElementsByName(u).length}),c.getById?(d.filter.ID=function(a){var b=a.replace(_,aa);return function(a){return a.getAttribute("id")===b}},d.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&p){var c=b.getElementById(a);return c?[c]:[]}}):(d.filter.ID=function(a){var b=a.replace(_,aa);return function(a){var c="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}},d.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&p){var c,d,e,f=b.getElementById(a);if(f){if(c=f.getAttributeNode("id"),c&&c.value===a)return[f];e=b.getElementsByName(a),d=0;while(f=e[d++])if(c=f.getAttributeNode("id"),c&&c.value===a)return[f]}return[]}}),d.find.TAG=c.getElementsByTagName?function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a):c.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){if("undefined"!=typeof b.getElementsByClassName&&p)return b.getElementsByClassName(a)},r=[],q=[],(c.qsa=Y.test(n.querySelectorAll))&&(ja(function(a){o.appendChild(a).innerHTML="<a id='"+u+"'></a><select id='"+u+"-\r\\' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&q.push("[*^$]="+K+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+K+"*(?:value|"+J+")"),a.querySelectorAll("[id~="+u+"-]").length||q.push("~="),a.querySelectorAll(":checked").length||q.push(":checked"),a.querySelectorAll("a#"+u+"+*").length||q.push(".#.+[+~]")}),ja(function(a){a.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var b=n.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+K+"*[*^$|!~]?="),2!==a.querySelectorAll(":enabled").length&&q.push(":enabled",":disabled"),o.appendChild(a).disabled=!0,2!==a.querySelectorAll(":disabled").length&&q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:")})),(c.matchesSelector=Y.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&ja(function(a){c.disconnectedMatch=s.call(a,"*"),s.call(a,"[s!='']:x"),r.push("!=",N)}),q=q.length&&new RegExp(q.join("|")),r=r.length&&new RegExp(r.join("|")),b=Y.test(o.compareDocumentPosition),t=b||Y.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===n||a.ownerDocument===v&&t(v,a)?-1:b===n||b.ownerDocument===v&&t(v,b)?1:k?I(k,a)-I(k,b):0:4&d?-1:1)}:function(a,b){if(a===b)return l=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,g=[a],h=[b];if(!e||!f)return a===n?-1:b===n?1:e?-1:f?1:k?I(k,a)-I(k,b):0;if(e===f)return la(a,b);c=a;while(c=c.parentNode)g.unshift(c);c=b;while(c=c.parentNode)h.unshift(c);while(g[d]===h[d])d++;return d?la(g[d],h[d]):g[d]===v?-1:h[d]===v?1:0},n):n},ga.matches=function(a,b){return ga(a,null,null,b)},ga.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(S,"='$1']"),c.matchesSelector&&p&&!A[b+" "]&&(!r||!r.test(b))&&(!q||!q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return ga(b,n,null,[a]).length>0},ga.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b)},ga.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&C.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},ga.escape=function(a){return(a+"").replace(ba,ca)},ga.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},ga.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return k=null,a},e=ga.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=ga.selectors={cacheLength:50,createPseudo:ia,match:V,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(_,aa),a[3]=(a[3]||a[4]||a[5]||"").replace(_,aa),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||ga.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&ga.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return V.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&T.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(_,aa).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=y[a+" "];return b||(b=new RegExp("(^|"+K+")"+a+"("+K+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||"undefined"!=typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=ga.attr(d,a);return null==e?"!="===b:!b||(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e.replace(O," ")+" ").indexOf(c)>-1:"|="===b&&(e===c||e.slice(0,c.length+1)===c+"-"))}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h,t=!1;if(q){if(f){while(p){m=b;while(m=m[p])if(h?m.nodeName.toLowerCase()===r:1===m.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){m=q,l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===w&&j[1],t=n&&j[2],m=n&&q.childNodes[n];while(m=++n&&m&&m[p]||(t=n=0)||o.pop())if(1===m.nodeType&&++t&&m===b){k[a]=[w,n,t];break}}else if(s&&(m=b,l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===w&&j[1],t=n),t===!1)while(m=++n&&m&&m[p]||(t=n=0)||o.pop())if((h?m.nodeName.toLowerCase()===r:1===m.nodeType)&&++t&&(s&&(l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),k[a]=[w,t]),m===b))break;return t-=e,t===d||t%d===0&&t/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||ga.error("unsupported pseudo: "+a);return e[u]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?ia(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=I(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:ia(function(a){var b=[],c=[],d=h(a.replace(P,"$1"));return d[u]?ia(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),b[0]=null,!c.pop()}}),has:ia(function(a){return function(b){return ga(a,b).length>0}}),contains:ia(function(a){return a=a.replace(_,aa),function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:ia(function(a){return U.test(a||"")||ga.error("unsupported lang: "+a),a=a.replace(_,aa).toLowerCase(),function(b){var c;do if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===o},focus:function(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:oa(!1),disabled:oa(!0),checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return X.test(a.nodeName)},input:function(a){return W.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:pa(function(){return[0]}),last:pa(function(a,b){return[b-1]}),eq:pa(function(a,b,c){return[c<0?c+b:c]}),even:pa(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:pa(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:pa(function(a,b,c){for(var d=c<0?c+b:c;--d>=0;)a.push(d);return a}),gt:pa(function(a,b,c){for(var d=c<0?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=ma(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=na(b);function ra(){}ra.prototype=d.filters=d.pseudos,d.setFilters=new ra,g=ga.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){c&&!(e=Q.exec(h))||(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=R.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(P," ")}),h=h.slice(c.length));for(g in d.filter)!(e=V[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?ga.error(a):z(a,i).slice(0)};function sa(a){for(var b=0,c=a.length,d="";b<c;b++)d+=a[b].value;return d}function ta(a,b,c){var d=b.dir,e=b.next,f=e||d,g=c&&"parentNode"===f,h=x++;return b.first?function(b,c,e){while(b=b[d])if(1===b.nodeType||g)return a(b,c,e);return!1}:function(b,c,i){var j,k,l,m=[w,h];if(i){while(b=b[d])if((1===b.nodeType||g)&&a(b,c,i))return!0}else while(b=b[d])if(1===b.nodeType||g)if(l=b[u]||(b[u]={}),k=l[b.uniqueID]||(l[b.uniqueID]={}),e&&e===b.nodeName.toLowerCase())b=b[d]||b;else{if((j=k[f])&&j[0]===w&&j[1]===h)return m[2]=j[2];if(k[f]=m,m[2]=a(b,c,i))return!0}return!1}}function ua(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function va(a,b,c){for(var d=0,e=b.length;d<e;d++)ga(a,b[d],c);return c}function wa(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;h<i;h++)(f=a[h])&&(c&&!c(f,d,e)||(g.push(f),j&&b.push(h)));return g}function xa(a,b,c,d,e,f){return d&&!d[u]&&(d=xa(d)),e&&!e[u]&&(e=xa(e,f)),ia(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||va(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:wa(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=wa(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?I(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=wa(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):G.apply(g,r)})}function ya(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=ta(function(a){return a===b},h,!0),l=ta(function(a){return I(b,a)>-1},h,!0),m=[function(a,c,d){var e=!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d));return b=null,e}];i<f;i++)if(c=d.relative[a[i].type])m=[ta(ua(m),c)];else{if(c=d.filter[a[i].type].apply(null,a[i].matches),c[u]){for(e=++i;e<f;e++)if(d.relative[a[e].type])break;return xa(i>1&&ua(m),i>1&&sa(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(P,"$1"),c,i<e&&ya(a.slice(i,e)),e<f&&ya(a=a.slice(e)),e<f&&sa(a))}m.push(c)}return ua(m)}function za(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,h,i,k){var l,o,q,r=0,s="0",t=f&&[],u=[],v=j,x=f||e&&d.find.TAG("*",k),y=w+=null==v?1:Math.random()||.1,z=x.length;for(k&&(j=g===n||g||k);s!==z&&null!=(l=x[s]);s++){if(e&&l){o=0,g||l.ownerDocument===n||(m(l),h=!p);while(q=a[o++])if(q(l,g||n,h)){i.push(l);break}k&&(w=y)}c&&((l=!q&&l)&&r--,f&&t.push(l))}if(r+=s,c&&s!==r){o=0;while(q=b[o++])q(t,u,g,h);if(f){if(r>0)while(s--)t[s]||u[s]||(u[s]=E.call(i));u=wa(u)}G.apply(i,u),k&&!f&&u.length>0&&r+b.length>1&&ga.uniqueSort(i)}return k&&(w=y,j=v),t};return c?ia(f):f}return h=ga.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){b||(b=g(a)),c=b.length;while(c--)f=ya(b[c]),f[u]?d.push(f):e.push(f);f=A(a,za(e,d)),f.selector=a}return f},i=ga.select=function(a,b,c,e){var f,i,j,k,l,m="function"==typeof a&&a,n=!e&&g(a=m.selector||a);if(c=c||[],1===n.length){if(i=n[0]=n[0].slice(0),i.length>2&&"ID"===(j=i[0]).type&&9===b.nodeType&&p&&d.relative[i[1].type]){if(b=(d.find.ID(j.matches[0].replace(_,aa),b)||[])[0],!b)return c;m&&(b=b.parentNode),a=a.slice(i.shift().value.length)}f=V.needsContext.test(a)?0:i.length;while(f--){if(j=i[f],d.relative[k=j.type])break;if((l=d.find[k])&&(e=l(j.matches[0].replace(_,aa),$.test(i[0].type)&&qa(b.parentNode)||b))){if(i.splice(f,1),a=e.length&&sa(i),!a)return G.apply(c,e),c;break}}}return(m||h(a,n))(e,b,!p,c,!b||$.test(a)&&qa(b.parentNode)||b),c},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=ja(function(a){return 1&a.compareDocumentPosition(n.createElement("fieldset"))}),ja(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||ka("type|href|height|width",function(a,b,c){if(!c)return a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&ja(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||ka("value",function(a,b,c){if(!c&&"input"===a.nodeName.toLowerCase())return a.defaultValue}),ja(function(a){return null==a.getAttribute("disabled")})||ka(J,function(a,b,c){var d;if(!c)return a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),ga}(a);r.find=x,r.expr=x.selectors,r.expr[":"]=r.expr.pseudos,r.uniqueSort=r.unique=x.uniqueSort,r.text=x.getText,r.isXMLDoc=x.isXML,r.contains=x.contains,r.escapeSelector=x.escape;var y=function(a,b,c){var d=[],e=void 0!==c;while((a=a[b])&&9!==a.nodeType)if(1===a.nodeType){if(e&&r(a).is(c))break;d.push(a)}return d},z=function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c},A=r.expr.match.needsContext,B=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,C=/^.[^:#\[\.,]*$/;function D(a,b,c){return r.isFunction(b)?r.grep(a,function(a,d){return!!b.call(a,d,a)!==c}):b.nodeType?r.grep(a,function(a){return a===b!==c}):"string"!=typeof b?r.grep(a,function(a){return i.call(b,a)>-1!==c}):C.test(b)?r.filter(b,a,c):(b=r.filter(b,a),r.grep(a,function(a){return i.call(b,a)>-1!==c&&1===a.nodeType}))}r.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?r.find.matchesSelector(d,a)?[d]:[]:r.find.matches(a,r.grep(b,function(a){return 1===a.nodeType}))},r.fn.extend({find:function(a){var b,c,d=this.length,e=this;if("string"!=typeof a)return this.pushStack(r(a).filter(function(){for(b=0;b<d;b++)if(r.contains(e[b],this))return!0}));for(c=this.pushStack([]),b=0;b<d;b++)r.find(a,e[b],c);return d>1?r.uniqueSort(c):c},filter:function(a){return this.pushStack(D(this,a||[],!1))},not:function(a){return this.pushStack(D(this,a||[],!0))},is:function(a){return!!D(this,"string"==typeof a&&A.test(a)?r(a):a||[],!1).length}});var E,F=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,G=r.fn.init=function(a,b,c){var e,f;if(!a)return this;if(c=c||E,"string"==typeof a){if(e="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:F.exec(a),!e||!e[1]&&b)return!b||b.jquery?(b||c).find(a):this.constructor(b).find(a);if(e[1]){if(b=b instanceof r?b[0]:b,r.merge(this,r.parseHTML(e[1],b&&b.nodeType?b.ownerDocument||b:d,!0)),B.test(e[1])&&r.isPlainObject(b))for(e in b)r.isFunction(this[e])?this[e](b[e]):this.attr(e,b[e]);return this}return f=d.getElementById(e[2]),f&&(this[0]=f,this.length=1),this}return a.nodeType?(this[0]=a,this.length=1,this):r.isFunction(a)?void 0!==c.ready?c.ready(a):a(r):r.makeArray(a,this)};G.prototype=r.fn,E=r(d);var H=/^(?:parents|prev(?:Until|All))/,I={children:!0,contents:!0,next:!0,prev:!0};r.fn.extend({has:function(a){var b=r(a,this),c=b.length;return this.filter(function(){for(var a=0;a<c;a++)if(r.contains(this,b[a]))return!0})},closest:function(a,b){var c,d=0,e=this.length,f=[],g="string"!=typeof a&&r(a);if(!A.test(a))for(;d<e;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&r.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?r.uniqueSort(f):f)},index:function(a){return a?"string"==typeof a?i.call(r(a),this[0]):i.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(r.uniqueSort(r.merge(this.get(),r(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function J(a,b){while((a=a[b])&&1!==a.nodeType);return a}r.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return y(a,"parentNode")},parentsUntil:function(a,b,c){return y(a,"parentNode",c)},next:function(a){return J(a,"nextSibling")},prev:function(a){return J(a,"previousSibling")},nextAll:function(a){return y(a,"nextSibling")},prevAll:function(a){return y(a,"previousSibling")},nextUntil:function(a,b,c){return y(a,"nextSibling",c)},prevUntil:function(a,b,c){return y(a,"previousSibling",c)},siblings:function(a){return z((a.parentNode||{}).firstChild,a)},children:function(a){return z(a.firstChild)},contents:function(a){return a.contentDocument||r.merge([],a.childNodes)}},function(a,b){r.fn[a]=function(c,d){var e=r.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=r.filter(d,e)),this.length>1&&(I[a]||r.uniqueSort(e),H.test(a)&&e.reverse()),this.pushStack(e)}});var K=/[^\x20\t\r\n\f]+/g;function L(a){var b={};return r.each(a.match(K)||[],function(a,c){b[c]=!0}),b}r.Callbacks=function(a){a="string"==typeof a?L(a):r.extend({},a);var b,c,d,e,f=[],g=[],h=-1,i=function(){for(e=a.once,d=b=!0;g.length;h=-1){c=g.shift();while(++h<f.length)f[h].apply(c[0],c[1])===!1&&a.stopOnFalse&&(h=f.length,c=!1)}a.memory||(c=!1),b=!1,e&&(f=c?[]:"")},j={add:function(){return f&&(c&&!b&&(h=f.length-1,g.push(c)),function d(b){r.each(b,function(b,c){r.isFunction(c)?a.unique&&j.has(c)||f.push(c):c&&c.length&&"string"!==r.type(c)&&d(c)})}(arguments),c&&!b&&i()),this},remove:function(){return r.each(arguments,function(a,b){var c;while((c=r.inArray(b,f,c))>-1)f.splice(c,1),c<=h&&h--}),this},has:function(a){return a?r.inArray(a,f)>-1:f.length>0},empty:function(){return f&&(f=[]),this},disable:function(){return e=g=[],f=c="",this},disabled:function(){return!f},lock:function(){return e=g=[],c||b||(f=c=""),this},locked:function(){return!!e},fireWith:function(a,c){return e||(c=c||[],c=[a,c.slice?c.slice():c],g.push(c),b||i()),this},fire:function(){return j.fireWith(this,arguments),this},fired:function(){return!!d}};return j};function M(a){return a}function N(a){throw a}function O(a,b,c){var d;try{a&&r.isFunction(d=a.promise)?d.call(a).done(b).fail(c):a&&r.isFunction(d=a.then)?d.call(a,b,c):b.call(void 0,a)}catch(a){c.call(void 0,a)}}r.extend({Deferred:function(b){var c=[["notify","progress",r.Callbacks("memory"),r.Callbacks("memory"),2],["resolve","done",r.Callbacks("once memory"),r.Callbacks("once memory"),0,"resolved"],["reject","fail",r.Callbacks("once memory"),r.Callbacks("once memory"),1,"rejected"]],d="pending",e={state:function(){return d},always:function(){return f.done(arguments).fail(arguments),this},"catch":function(a){return e.then(null,a)},pipe:function(){var a=arguments;return r.Deferred(function(b){r.each(c,function(c,d){var e=r.isFunction(a[d[4]])&&a[d[4]];f[d[1]](function(){var a=e&&e.apply(this,arguments);a&&r.isFunction(a.promise)?a.promise().progress(b.notify).done(b.resolve).fail(b.reject):b[d[0]+"With"](this,e?[a]:arguments)})}),a=null}).promise()},then:function(b,d,e){var f=0;function g(b,c,d,e){return function(){var h=this,i=arguments,j=function(){var a,j;if(!(b<f)){if(a=d.apply(h,i),a===c.promise())throw new TypeError("Thenable self-resolution");j=a&&("object"==typeof a||"function"==typeof a)&&a.then,r.isFunction(j)?e?j.call(a,g(f,c,M,e),g(f,c,N,e)):(f++,j.call(a,g(f,c,M,e),g(f,c,N,e),g(f,c,M,c.notifyWith))):(d!==M&&(h=void 0,i=[a]),(e||c.resolveWith)(h,i))}},k=e?j:function(){try{j()}catch(a){r.Deferred.exceptionHook&&r.Deferred.exceptionHook(a,k.stackTrace),b+1>=f&&(d!==N&&(h=void 0,i=[a]),c.rejectWith(h,i))}};b?k():(r.Deferred.getStackHook&&(k.stackTrace=r.Deferred.getStackHook()),a.setTimeout(k))}}return r.Deferred(function(a){c[0][3].add(g(0,a,r.isFunction(e)?e:M,a.notifyWith)),c[1][3].add(g(0,a,r.isFunction(b)?b:M)),c[2][3].add(g(0,a,r.isFunction(d)?d:N))}).promise()},promise:function(a){return null!=a?r.extend(a,e):e}},f={};return r.each(c,function(a,b){var g=b[2],h=b[5];e[b[1]]=g.add,h&&g.add(function(){d=h},c[3-a][2].disable,c[0][2].lock),g.add(b[3].fire),f[b[0]]=function(){return f[b[0]+"With"](this===f?void 0:this,arguments),this},f[b[0]+"With"]=g.fireWith}),e.promise(f),b&&b.call(f,f),f},when:function(a){var b=arguments.length,c=b,d=Array(c),e=f.call(arguments),g=r.Deferred(),h=function(a){return function(c){d[a]=this,e[a]=arguments.length>1?f.call(arguments):c,--b||g.resolveWith(d,e)}};if(b<=1&&(O(a,g.done(h(c)).resolve,g.reject),"pending"===g.state()||r.isFunction(e[c]&&e[c].then)))return g.then();while(c--)O(e[c],h(c),g.reject);return g.promise()}});var P=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;r.Deferred.exceptionHook=function(b,c){a.console&&a.console.warn&&b&&P.test(b.name)&&a.console.warn("jQuery.Deferred exception: "+b.message,b.stack,c)},r.readyException=function(b){a.setTimeout(function(){throw b})};var Q=r.Deferred();r.fn.ready=function(a){return Q.then(a)["catch"](function(a){r.readyException(a)}),this},r.extend({isReady:!1,readyWait:1,holdReady:function(a){a?r.readyWait++:r.ready(!0)},ready:function(a){(a===!0?--r.readyWait:r.isReady)||(r.isReady=!0,a!==!0&&--r.readyWait>0||Q.resolveWith(d,[r]))}}),r.ready.then=Q.then;function R(){d.removeEventListener("DOMContentLoaded",R),
a.removeEventListener("load",R),r.ready()}"complete"===d.readyState||"loading"!==d.readyState&&!d.documentElement.doScroll?a.setTimeout(r.ready):(d.addEventListener("DOMContentLoaded",R),a.addEventListener("load",R));var S=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===r.type(c)){e=!0;for(h in c)S(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,r.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(r(a),c)})),b))for(;h<i;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},T=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType};function U(){this.expando=r.expando+U.uid++}U.uid=1,U.prototype={cache:function(a){var b=a[this.expando];return b||(b={},T(a)&&(a.nodeType?a[this.expando]=b:Object.defineProperty(a,this.expando,{value:b,configurable:!0}))),b},set:function(a,b,c){var d,e=this.cache(a);if("string"==typeof b)e[r.camelCase(b)]=c;else for(d in b)e[r.camelCase(d)]=b[d];return e},get:function(a,b){return void 0===b?this.cache(a):a[this.expando]&&a[this.expando][r.camelCase(b)]},access:function(a,b,c){return void 0===b||b&&"string"==typeof b&&void 0===c?this.get(a,b):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d=a[this.expando];if(void 0!==d){if(void 0!==b){r.isArray(b)?b=b.map(r.camelCase):(b=r.camelCase(b),b=b in d?[b]:b.match(K)||[]),c=b.length;while(c--)delete d[b[c]]}(void 0===b||r.isEmptyObject(d))&&(a.nodeType?a[this.expando]=void 0:delete a[this.expando])}},hasData:function(a){var b=a[this.expando];return void 0!==b&&!r.isEmptyObject(b)}};var V=new U,W=new U,X=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Y=/[A-Z]/g;function Z(a){return"true"===a||"false"!==a&&("null"===a?null:a===+a+""?+a:X.test(a)?JSON.parse(a):a)}function $(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(Y,"-$&").toLowerCase(),c=a.getAttribute(d),"string"==typeof c){try{c=Z(c)}catch(e){}W.set(a,b,c)}else c=void 0;return c}r.extend({hasData:function(a){return W.hasData(a)||V.hasData(a)},data:function(a,b,c){return W.access(a,b,c)},removeData:function(a,b){W.remove(a,b)},_data:function(a,b,c){return V.access(a,b,c)},_removeData:function(a,b){V.remove(a,b)}}),r.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=W.get(f),1===f.nodeType&&!V.get(f,"hasDataAttrs"))){c=g.length;while(c--)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=r.camelCase(d.slice(5)),$(f,d,e[d])));V.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){W.set(this,a)}):S(this,function(b){var c;if(f&&void 0===b){if(c=W.get(f,a),void 0!==c)return c;if(c=$(f,a),void 0!==c)return c}else this.each(function(){W.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){W.remove(this,a)})}}),r.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+"queue",d=V.get(a,b),c&&(!d||r.isArray(c)?d=V.access(a,b,r.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){b=b||"fx";var c=r.queue(a,b),d=c.length,e=c.shift(),f=r._queueHooks(a,b),g=function(){r.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return V.get(a,c)||V.access(a,c,{empty:r.Callbacks("once memory").add(function(){V.remove(a,[b+"queue",c])})})}}),r.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?r.queue(this[0],a):void 0===b?this:this.each(function(){var c=r.queue(this,a,b);r._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&r.dequeue(this,a)})},dequeue:function(a){return this.each(function(){r.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=r.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};"string"!=typeof a&&(b=a,a=void 0),a=a||"fx";while(g--)c=V.get(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var _=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,aa=new RegExp("^(?:([+-])=|)("+_+")([a-z%]*)$","i"),ba=["Top","Right","Bottom","Left"],ca=function(a,b){return a=b||a,"none"===a.style.display||""===a.style.display&&r.contains(a.ownerDocument,a)&&"none"===r.css(a,"display")},da=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};function ea(a,b,c,d){var e,f=1,g=20,h=d?function(){return d.cur()}:function(){return r.css(a,b,"")},i=h(),j=c&&c[3]||(r.cssNumber[b]?"":"px"),k=(r.cssNumber[b]||"px"!==j&&+i)&&aa.exec(r.css(a,b));if(k&&k[3]!==j){j=j||k[3],c=c||[],k=+i||1;do f=f||".5",k/=f,r.style(a,b,k+j);while(f!==(f=h()/i)&&1!==f&&--g)}return c&&(k=+k||+i||0,e=c[1]?k+(c[1]+1)*c[2]:+c[2],d&&(d.unit=j,d.start=k,d.end=e)),e}var fa={};function ga(a){var b,c=a.ownerDocument,d=a.nodeName,e=fa[d];return e?e:(b=c.body.appendChild(c.createElement(d)),e=r.css(b,"display"),b.parentNode.removeChild(b),"none"===e&&(e="block"),fa[d]=e,e)}function ha(a,b){for(var c,d,e=[],f=0,g=a.length;f<g;f++)d=a[f],d.style&&(c=d.style.display,b?("none"===c&&(e[f]=V.get(d,"display")||null,e[f]||(d.style.display="")),""===d.style.display&&ca(d)&&(e[f]=ga(d))):"none"!==c&&(e[f]="none",V.set(d,"display",c)));for(f=0;f<g;f++)null!=e[f]&&(a[f].style.display=e[f]);return a}r.fn.extend({show:function(){return ha(this,!0)},hide:function(){return ha(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){ca(this)?r(this).show():r(this).hide()})}});var ia=/^(?:checkbox|radio)$/i,ja=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,ka=/^$|\/(?:java|ecma)script/i,la={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};la.optgroup=la.option,la.tbody=la.tfoot=la.colgroup=la.caption=la.thead,la.th=la.td;function ma(a,b){var c;return c="undefined"!=typeof a.getElementsByTagName?a.getElementsByTagName(b||"*"):"undefined"!=typeof a.querySelectorAll?a.querySelectorAll(b||"*"):[],void 0===b||b&&r.nodeName(a,b)?r.merge([a],c):c}function na(a,b){for(var c=0,d=a.length;c<d;c++)V.set(a[c],"globalEval",!b||V.get(b[c],"globalEval"))}var oa=/<|&#?\w+;/;function pa(a,b,c,d,e){for(var f,g,h,i,j,k,l=b.createDocumentFragment(),m=[],n=0,o=a.length;n<o;n++)if(f=a[n],f||0===f)if("object"===r.type(f))r.merge(m,f.nodeType?[f]:f);else if(oa.test(f)){g=g||l.appendChild(b.createElement("div")),h=(ja.exec(f)||["",""])[1].toLowerCase(),i=la[h]||la._default,g.innerHTML=i[1]+r.htmlPrefilter(f)+i[2],k=i[0];while(k--)g=g.lastChild;r.merge(m,g.childNodes),g=l.firstChild,g.textContent=""}else m.push(b.createTextNode(f));l.textContent="",n=0;while(f=m[n++])if(d&&r.inArray(f,d)>-1)e&&e.push(f);else if(j=r.contains(f.ownerDocument,f),g=ma(l.appendChild(f),"script"),j&&na(g),c){k=0;while(f=g[k++])ka.test(f.type||"")&&c.push(f)}return l}!function(){var a=d.createDocumentFragment(),b=a.appendChild(d.createElement("div")),c=d.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),o.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",o.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var qa=d.documentElement,ra=/^key/,sa=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,ta=/^([^.]*)(?:\.(.+)|)/;function ua(){return!0}function va(){return!1}function wa(){try{return d.activeElement}catch(a){}}function xa(a,b,c,d,e,f){var g,h;if("object"==typeof b){"string"!=typeof c&&(d=d||c,c=void 0);for(h in b)xa(a,h,c,d,b[h],f);return a}if(null==d&&null==e?(e=c,d=c=void 0):null==e&&("string"==typeof c?(e=d,d=void 0):(e=d,d=c,c=void 0)),e===!1)e=va;else if(!e)return a;return 1===f&&(g=e,e=function(a){return r().off(a),g.apply(this,arguments)},e.guid=g.guid||(g.guid=r.guid++)),a.each(function(){r.event.add(this,b,e,d,c)})}r.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=V.get(a);if(q){c.handler&&(f=c,c=f.handler,e=f.selector),e&&r.find.matchesSelector(qa,e),c.guid||(c.guid=r.guid++),(i=q.events)||(i=q.events={}),(g=q.handle)||(g=q.handle=function(b){return"undefined"!=typeof r&&r.event.triggered!==b.type?r.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(K)||[""],j=b.length;while(j--)h=ta.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n&&(l=r.event.special[n]||{},n=(e?l.delegateType:l.bindType)||n,l=r.event.special[n]||{},k=r.extend({type:n,origType:p,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&r.expr.match.needsContext.test(e),namespace:o.join(".")},f),(m=i[n])||(m=i[n]=[],m.delegateCount=0,l.setup&&l.setup.call(a,d,o,g)!==!1||a.addEventListener&&a.addEventListener(n,g)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),r.event.global[n]=!0)}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=V.hasData(a)&&V.get(a);if(q&&(i=q.events)){b=(b||"").match(K)||[""],j=b.length;while(j--)if(h=ta.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){l=r.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=i[n]||[],h=h[2]&&new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;while(f--)k=m[f],!e&&p!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&l.teardown.call(a,o,q.handle)!==!1||r.removeEvent(a,n,q.handle),delete i[n])}else for(n in i)r.event.remove(a,n+b[j],c,d,!0);r.isEmptyObject(i)&&V.remove(a,"handle events")}},dispatch:function(a){var b=r.event.fix(a),c,d,e,f,g,h,i=new Array(arguments.length),j=(V.get(this,"events")||{})[b.type]||[],k=r.event.special[b.type]||{};for(i[0]=b,c=1;c<arguments.length;c++)i[c]=arguments[c];if(b.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,b)!==!1){h=r.event.handlers.call(this,b,j),c=0;while((f=h[c++])&&!b.isPropagationStopped()){b.currentTarget=f.elem,d=0;while((g=f.handlers[d++])&&!b.isImmediatePropagationStopped())b.rnamespace&&!b.rnamespace.test(g.namespace)||(b.handleObj=g,b.data=g.data,e=((r.event.special[g.origType]||{}).handle||g.handler).apply(f.elem,i),void 0!==e&&(b.result=e)===!1&&(b.preventDefault(),b.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,b),b.result}},handlers:function(a,b){var c,d,e,f,g,h=[],i=b.delegateCount,j=a.target;if(i&&j.nodeType&&!("click"===a.type&&a.button>=1))for(;j!==this;j=j.parentNode||this)if(1===j.nodeType&&("click"!==a.type||j.disabled!==!0)){for(f=[],g={},c=0;c<i;c++)d=b[c],e=d.selector+" ",void 0===g[e]&&(g[e]=d.needsContext?r(e,this).index(j)>-1:r.find(e,this,null,[j]).length),g[e]&&f.push(d);f.length&&h.push({elem:j,handlers:f})}return j=this,i<b.length&&h.push({elem:j,handlers:b.slice(i)}),h},addProp:function(a,b){Object.defineProperty(r.Event.prototype,a,{enumerable:!0,configurable:!0,get:r.isFunction(b)?function(){if(this.originalEvent)return b(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[a]},set:function(b){Object.defineProperty(this,a,{enumerable:!0,configurable:!0,writable:!0,value:b})}})},fix:function(a){return a[r.expando]?a:new r.Event(a)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==wa()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===wa()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&r.nodeName(this,"input"))return this.click(),!1},_default:function(a){return r.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}}},r.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c)},r.Event=function(a,b){return this instanceof r.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?ua:va,this.target=a.target&&3===a.target.nodeType?a.target.parentNode:a.target,this.currentTarget=a.currentTarget,this.relatedTarget=a.relatedTarget):this.type=a,b&&r.extend(this,b),this.timeStamp=a&&a.timeStamp||r.now(),void(this[r.expando]=!0)):new r.Event(a,b)},r.Event.prototype={constructor:r.Event,isDefaultPrevented:va,isPropagationStopped:va,isImmediatePropagationStopped:va,isSimulated:!1,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=ua,a&&!this.isSimulated&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=ua,a&&!this.isSimulated&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=ua,a&&!this.isSimulated&&a.stopImmediatePropagation(),this.stopPropagation()}},r.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(a){var b=a.button;return null==a.which&&ra.test(a.type)?null!=a.charCode?a.charCode:a.keyCode:!a.which&&void 0!==b&&sa.test(a.type)?1&b?1:2&b?3:4&b?2:0:a.which}},r.event.addProp),r.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){r.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return e&&(e===d||r.contains(d,e))||(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),r.fn.extend({on:function(a,b,c,d){return xa(this,a,b,c,d)},one:function(a,b,c,d){return xa(this,a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,r(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return b!==!1&&"function"!=typeof b||(c=b,b=void 0),c===!1&&(c=va),this.each(function(){r.event.remove(this,a,c,b)})}});var ya=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,za=/<script|<style|<link/i,Aa=/checked\s*(?:[^=]|=\s*.checked.)/i,Ba=/^true\/(.*)/,Ca=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Da(a,b){return r.nodeName(a,"table")&&r.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a:a}function Ea(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function Fa(a){var b=Ba.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function Ga(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(V.hasData(a)&&(f=V.access(a),g=V.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;c<d;c++)r.event.add(b,e,j[e][c])}W.hasData(a)&&(h=W.access(a),i=r.extend({},h),W.set(b,i))}}function Ha(a,b){var c=b.nodeName.toLowerCase();"input"===c&&ia.test(a.type)?b.checked=a.checked:"input"!==c&&"textarea"!==c||(b.defaultValue=a.defaultValue)}function Ia(a,b,c,d){b=g.apply([],b);var e,f,h,i,j,k,l=0,m=a.length,n=m-1,q=b[0],s=r.isFunction(q);if(s||m>1&&"string"==typeof q&&!o.checkClone&&Aa.test(q))return a.each(function(e){var f=a.eq(e);s&&(b[0]=q.call(this,e,f.html())),Ia(f,b,c,d)});if(m&&(e=pa(b,a[0].ownerDocument,!1,a,d),f=e.firstChild,1===e.childNodes.length&&(e=f),f||d)){for(h=r.map(ma(e,"script"),Ea),i=h.length;l<m;l++)j=e,l!==n&&(j=r.clone(j,!0,!0),i&&r.merge(h,ma(j,"script"))),c.call(a[l],j,l);if(i)for(k=h[h.length-1].ownerDocument,r.map(h,Fa),l=0;l<i;l++)j=h[l],ka.test(j.type||"")&&!V.access(j,"globalEval")&&r.contains(k,j)&&(j.src?r._evalUrl&&r._evalUrl(j.src):p(j.textContent.replace(Ca,""),k))}return a}function Ja(a,b,c){for(var d,e=b?r.filter(b,a):a,f=0;null!=(d=e[f]);f++)c||1!==d.nodeType||r.cleanData(ma(d)),d.parentNode&&(c&&r.contains(d.ownerDocument,d)&&na(ma(d,"script")),d.parentNode.removeChild(d));return a}r.extend({htmlPrefilter:function(a){return a.replace(ya,"<$1></$2>")},clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=r.contains(a.ownerDocument,a);if(!(o.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||r.isXMLDoc(a)))for(g=ma(h),f=ma(a),d=0,e=f.length;d<e;d++)Ha(f[d],g[d]);if(b)if(c)for(f=f||ma(a),g=g||ma(h),d=0,e=f.length;d<e;d++)Ga(f[d],g[d]);else Ga(a,h);return g=ma(h,"script"),g.length>0&&na(g,!i&&ma(a,"script")),h},cleanData:function(a){for(var b,c,d,e=r.event.special,f=0;void 0!==(c=a[f]);f++)if(T(c)){if(b=c[V.expando]){if(b.events)for(d in b.events)e[d]?r.event.remove(c,d):r.removeEvent(c,d,b.handle);c[V.expando]=void 0}c[W.expando]&&(c[W.expando]=void 0)}}}),r.fn.extend({detach:function(a){return Ja(this,a,!0)},remove:function(a){return Ja(this,a)},text:function(a){return S(this,function(a){return void 0===a?r.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=a)})},null,a,arguments.length)},append:function(){return Ia(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=Da(this,a);b.appendChild(a)}})},prepend:function(){return Ia(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=Da(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return Ia(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return Ia(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(r.cleanData(ma(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null!=a&&a,b=null==b?a:b,this.map(function(){return r.clone(this,a,b)})},html:function(a){return S(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!za.test(a)&&!la[(ja.exec(a)||["",""])[1].toLowerCase()]){a=r.htmlPrefilter(a);try{for(;c<d;c++)b=this[c]||{},1===b.nodeType&&(r.cleanData(ma(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=[];return Ia(this,arguments,function(b){var c=this.parentNode;r.inArray(this,a)<0&&(r.cleanData(ma(this)),c&&c.replaceChild(b,this))},a)}}),r.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){r.fn[a]=function(a){for(var c,d=[],e=r(a),f=e.length-1,g=0;g<=f;g++)c=g===f?this:this.clone(!0),r(e[g])[b](c),h.apply(d,c.get());return this.pushStack(d)}});var Ka=/^margin/,La=new RegExp("^("+_+")(?!px)[a-z%]+$","i"),Ma=function(b){var c=b.ownerDocument.defaultView;return c&&c.opener||(c=a),c.getComputedStyle(b)};!function(){function b(){if(i){i.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",i.innerHTML="",qa.appendChild(h);var b=a.getComputedStyle(i);c="1%"!==b.top,g="2px"===b.marginLeft,e="4px"===b.width,i.style.marginRight="50%",f="4px"===b.marginRight,qa.removeChild(h),i=null}}var c,e,f,g,h=d.createElement("div"),i=d.createElement("div");i.style&&(i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",o.clearCloneStyle="content-box"===i.style.backgroundClip,h.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",h.appendChild(i),r.extend(o,{pixelPosition:function(){return b(),c},boxSizingReliable:function(){return b(),e},pixelMarginRight:function(){return b(),f},reliableMarginLeft:function(){return b(),g}}))}();function Na(a,b,c){var d,e,f,g,h=a.style;return c=c||Ma(a),c&&(g=c.getPropertyValue(b)||c[b],""!==g||r.contains(a.ownerDocument,a)||(g=r.style(a,b)),!o.pixelMarginRight()&&La.test(g)&&Ka.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+"":g}function Oa(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}var Pa=/^(none|table(?!-c[ea]).+)/,Qa={position:"absolute",visibility:"hidden",display:"block"},Ra={letterSpacing:"0",fontWeight:"400"},Sa=["Webkit","Moz","ms"],Ta=d.createElement("div").style;function Ua(a){if(a in Ta)return a;var b=a[0].toUpperCase()+a.slice(1),c=Sa.length;while(c--)if(a=Sa[c]+b,a in Ta)return a}function Va(a,b,c){var d=aa.exec(b);return d?Math.max(0,d[2]-(c||0))+(d[3]||"px"):b}function Wa(a,b,c,d,e){var f,g=0;for(f=c===(d?"border":"content")?4:"width"===b?1:0;f<4;f+=2)"margin"===c&&(g+=r.css(a,c+ba[f],!0,e)),d?("content"===c&&(g-=r.css(a,"padding"+ba[f],!0,e)),"margin"!==c&&(g-=r.css(a,"border"+ba[f]+"Width",!0,e))):(g+=r.css(a,"padding"+ba[f],!0,e),"padding"!==c&&(g+=r.css(a,"border"+ba[f]+"Width",!0,e)));return g}function Xa(a,b,c){var d,e=!0,f=Ma(a),g="border-box"===r.css(a,"boxSizing",!1,f);if(a.getClientRects().length&&(d=a.getBoundingClientRect()[b]),d<=0||null==d){if(d=Na(a,b,f),(d<0||null==d)&&(d=a.style[b]),La.test(d))return d;e=g&&(o.boxSizingReliable()||d===a.style[b]),d=parseFloat(d)||0}return d+Wa(a,b,c||(g?"border":"content"),e,f)+"px"}r.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Na(a,"opacity");return""===c?"1":c}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=r.camelCase(b),i=a.style;return b=r.cssProps[h]||(r.cssProps[h]=Ua(h)||h),g=r.cssHooks[b]||r.cssHooks[h],void 0===c?g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b]:(f=typeof c,"string"===f&&(e=aa.exec(c))&&e[1]&&(c=ea(a,b,e),f="number"),null!=c&&c===c&&("number"===f&&(c+=e&&e[3]||(r.cssNumber[h]?"":"px")),o.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c)),void 0)}},css:function(a,b,c,d){var e,f,g,h=r.camelCase(b);return b=r.cssProps[h]||(r.cssProps[h]=Ua(h)||h),g=r.cssHooks[b]||r.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=Na(a,b,d)),"normal"===e&&b in Ra&&(e=Ra[b]),""===c||c?(f=parseFloat(e),c===!0||isFinite(f)?f||0:e):e}}),r.each(["height","width"],function(a,b){r.cssHooks[b]={get:function(a,c,d){if(c)return!Pa.test(r.css(a,"display"))||a.getClientRects().length&&a.getBoundingClientRect().width?Xa(a,b,d):da(a,Qa,function(){return Xa(a,b,d)})},set:function(a,c,d){var e,f=d&&Ma(a),g=d&&Wa(a,b,d,"border-box"===r.css(a,"boxSizing",!1,f),f);return g&&(e=aa.exec(c))&&"px"!==(e[3]||"px")&&(a.style[b]=c,c=r.css(a,b)),Va(a,c,g)}}}),r.cssHooks.marginLeft=Oa(o.reliableMarginLeft,function(a,b){if(b)return(parseFloat(Na(a,"marginLeft"))||a.getBoundingClientRect().left-da(a,{marginLeft:0},function(){return a.getBoundingClientRect().left}))+"px"}),r.each({margin:"",padding:"",border:"Width"},function(a,b){r.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];d<4;d++)e[a+ba[d]+b]=f[d]||f[d-2]||f[0];return e}},Ka.test(a)||(r.cssHooks[a+b].set=Va)}),r.fn.extend({css:function(a,b){return S(this,function(a,b,c){var d,e,f={},g=0;if(r.isArray(b)){for(d=Ma(a),e=b.length;g<e;g++)f[b[g]]=r.css(a,b[g],!1,d);return f}return void 0!==c?r.style(a,b,c):r.css(a,b)},a,b,arguments.length>1)}});function Ya(a,b,c,d,e){return new Ya.prototype.init(a,b,c,d,e)}r.Tween=Ya,Ya.prototype={constructor:Ya,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||r.easing._default,this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(r.cssNumber[c]?"":"px")},cur:function(){var a=Ya.propHooks[this.prop];return a&&a.get?a.get(this):Ya.propHooks._default.get(this)},run:function(a){var b,c=Ya.propHooks[this.prop];return this.options.duration?this.pos=b=r.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Ya.propHooks._default.set(this),this}},Ya.prototype.init.prototype=Ya.prototype,Ya.propHooks={_default:{get:function(a){var b;return 1!==a.elem.nodeType||null!=a.elem[a.prop]&&null==a.elem.style[a.prop]?a.elem[a.prop]:(b=r.css(a.elem,a.prop,""),b&&"auto"!==b?b:0)},set:function(a){r.fx.step[a.prop]?r.fx.step[a.prop](a):1!==a.elem.nodeType||null==a.elem.style[r.cssProps[a.prop]]&&!r.cssHooks[a.prop]?a.elem[a.prop]=a.now:r.style(a.elem,a.prop,a.now+a.unit)}}},Ya.propHooks.scrollTop=Ya.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},r.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2},_default:"swing"},r.fx=Ya.prototype.init,r.fx.step={};var Za,$a,_a=/^(?:toggle|show|hide)$/,ab=/queueHooks$/;function bb(){$a&&(a.requestAnimationFrame(bb),r.fx.tick())}function cb(){return a.setTimeout(function(){Za=void 0}),Za=r.now()}function db(a,b){var c,d=0,e={height:a};for(b=b?1:0;d<4;d+=2-b)c=ba[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function eb(a,b,c){for(var d,e=(hb.tweeners[b]||[]).concat(hb.tweeners["*"]),f=0,g=e.length;f<g;f++)if(d=e[f].call(c,b,a))return d}function fb(a,b,c){var d,e,f,g,h,i,j,k,l="width"in b||"height"in b,m=this,n={},o=a.style,p=a.nodeType&&ca(a),q=V.get(a,"fxshow");c.queue||(g=r._queueHooks(a,"fx"),null==g.unqueued&&(g.unqueued=0,h=g.empty.fire,g.empty.fire=function(){g.unqueued||h()}),g.unqueued++,m.always(function(){m.always(function(){g.unqueued--,r.queue(a,"fx").length||g.empty.fire()})}));for(d in b)if(e=b[d],_a.test(e)){if(delete b[d],f=f||"toggle"===e,e===(p?"hide":"show")){if("show"!==e||!q||void 0===q[d])continue;p=!0}n[d]=q&&q[d]||r.style(a,d)}if(i=!r.isEmptyObject(b),i||!r.isEmptyObject(n)){l&&1===a.nodeType&&(c.overflow=[o.overflow,o.overflowX,o.overflowY],j=q&&q.display,null==j&&(j=V.get(a,"display")),k=r.css(a,"display"),"none"===k&&(j?k=j:(ha([a],!0),j=a.style.display||j,k=r.css(a,"display"),ha([a]))),("inline"===k||"inline-block"===k&&null!=j)&&"none"===r.css(a,"float")&&(i||(m.done(function(){o.display=j}),null==j&&(k=o.display,j="none"===k?"":k)),o.display="inline-block")),c.overflow&&(o.overflow="hidden",m.always(function(){o.overflow=c.overflow[0],o.overflowX=c.overflow[1],o.overflowY=c.overflow[2]})),i=!1;for(d in n)i||(q?"hidden"in q&&(p=q.hidden):q=V.access(a,"fxshow",{display:j}),f&&(q.hidden=!p),p&&ha([a],!0),m.done(function(){p||ha([a]),V.remove(a,"fxshow");for(d in n)r.style(a,d,n[d])})),i=eb(p?q[d]:0,d,m),d in q||(q[d]=i.start,p&&(i.end=i.start,i.start=0))}}function gb(a,b){var c,d,e,f,g;for(c in a)if(d=r.camelCase(c),e=b[d],f=a[c],r.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=r.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function hb(a,b,c){var d,e,f=0,g=hb.prefilters.length,h=r.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=Za||cb(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;g<i;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),f<1&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:r.extend({},b),opts:r.extend(!0,{specialEasing:{},easing:r.easing._default},c),originalProperties:b,originalOptions:c,startTime:Za||cb(),duration:c.duration,tweens:[],createTween:function(b,c){var d=r.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;c<d;c++)j.tweens[c].run(1);return b?(h.notifyWith(a,[j,1,0]),h.resolveWith(a,[j,b])):h.rejectWith(a,[j,b]),this}}),k=j.props;for(gb(k,j.opts.specialEasing);f<g;f++)if(d=hb.prefilters[f].call(j,a,k,j.opts))return r.isFunction(d.stop)&&(r._queueHooks(j.elem,j.opts.queue).stop=r.proxy(d.stop,d)),d;return r.map(k,eb,j),r.isFunction(j.opts.start)&&j.opts.start.call(a,j),r.fx.timer(r.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}r.Animation=r.extend(hb,{tweeners:{"*":[function(a,b){var c=this.createTween(a,b);return ea(c.elem,a,aa.exec(b),c),c}]},tweener:function(a,b){r.isFunction(a)?(b=a,a=["*"]):a=a.match(K);for(var c,d=0,e=a.length;d<e;d++)c=a[d],hb.tweeners[c]=hb.tweeners[c]||[],hb.tweeners[c].unshift(b)},prefilters:[fb],prefilter:function(a,b){b?hb.prefilters.unshift(a):hb.prefilters.push(a)}}),r.speed=function(a,b,c){var e=a&&"object"==typeof a?r.extend({},a):{complete:c||!c&&b||r.isFunction(a)&&a,duration:a,easing:c&&b||b&&!r.isFunction(b)&&b};return r.fx.off||d.hidden?e.duration=0:"number"!=typeof e.duration&&(e.duration in r.fx.speeds?e.duration=r.fx.speeds[e.duration]:e.duration=r.fx.speeds._default),null!=e.queue&&e.queue!==!0||(e.queue="fx"),e.old=e.complete,e.complete=function(){r.isFunction(e.old)&&e.old.call(this),e.queue&&r.dequeue(this,e.queue)},e},r.fn.extend({fadeTo:function(a,b,c,d){return this.filter(ca).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=r.isEmptyObject(a),f=r.speed(b,c,d),g=function(){var b=hb(this,r.extend({},a),f);(e||V.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=r.timers,g=V.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&ab.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));!b&&c||r.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=V.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=r.timers,g=d?d.length:0;for(c.finish=!0,r.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;b<g;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),r.each(["toggle","show","hide"],function(a,b){var c=r.fn[b];r.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(db(b,!0),a,d,e)}}),r.each({slideDown:db("show"),slideUp:db("hide"),slideToggle:db("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){r.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),r.timers=[],r.fx.tick=function(){var a,b=0,c=r.timers;for(Za=r.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||r.fx.stop(),Za=void 0},r.fx.timer=function(a){r.timers.push(a),a()?r.fx.start():r.timers.pop()},r.fx.interval=13,r.fx.start=function(){$a||($a=a.requestAnimationFrame?a.requestAnimationFrame(bb):a.setInterval(r.fx.tick,r.fx.interval))},r.fx.stop=function(){a.cancelAnimationFrame?a.cancelAnimationFrame($a):a.clearInterval($a),$a=null},r.fx.speeds={slow:600,fast:200,_default:400},r.fn.delay=function(b,c){return b=r.fx?r.fx.speeds[b]||b:b,c=c||"fx",this.queue(c,function(c,d){var e=a.setTimeout(c,b);d.stop=function(){a.clearTimeout(e)}})},function(){var a=d.createElement("input"),b=d.createElement("select"),c=b.appendChild(d.createElement("option"));a.type="checkbox",o.checkOn=""!==a.value,o.optSelected=c.selected,a=d.createElement("input"),a.value="t",a.type="radio",o.radioValue="t"===a.value}();var ib,jb=r.expr.attrHandle;r.fn.extend({attr:function(a,b){return S(this,r.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){r.removeAttr(this,a)})}}),r.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return"undefined"==typeof a.getAttribute?r.prop(a,b,c):(1===f&&r.isXMLDoc(a)||(e=r.attrHooks[b.toLowerCase()]||(r.expr.match.bool.test(b)?ib:void 0)),
void 0!==c?null===c?void r.removeAttr(a,b):e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:(a.setAttribute(b,c+""),c):e&&"get"in e&&null!==(d=e.get(a,b))?d:(d=r.find.attr(a,b),null==d?void 0:d))},attrHooks:{type:{set:function(a,b){if(!o.radioValue&&"radio"===b&&r.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}},removeAttr:function(a,b){var c,d=0,e=b&&b.match(K);if(e&&1===a.nodeType)while(c=e[d++])a.removeAttribute(c)}}),ib={set:function(a,b,c){return b===!1?r.removeAttr(a,c):a.setAttribute(c,c),c}},r.each(r.expr.match.bool.source.match(/\w+/g),function(a,b){var c=jb[b]||r.find.attr;jb[b]=function(a,b,d){var e,f,g=b.toLowerCase();return d||(f=jb[g],jb[g]=e,e=null!=c(a,b,d)?g:null,jb[g]=f),e}});var kb=/^(?:input|select|textarea|button)$/i,lb=/^(?:a|area)$/i;r.fn.extend({prop:function(a,b){return S(this,r.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[r.propFix[a]||a]})}}),r.extend({prop:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return 1===f&&r.isXMLDoc(a)||(b=r.propFix[b]||b,e=r.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=r.find.attr(a,"tabindex");return b?parseInt(b,10):kb.test(a.nodeName)||lb.test(a.nodeName)&&a.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),o.optSelected||(r.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null},set:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex)}}),r.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){r.propFix[this.toLowerCase()]=this});function mb(a){var b=a.match(K)||[];return b.join(" ")}function nb(a){return a.getAttribute&&a.getAttribute("class")||""}r.fn.extend({addClass:function(a){var b,c,d,e,f,g,h,i=0;if(r.isFunction(a))return this.each(function(b){r(this).addClass(a.call(this,b,nb(this)))});if("string"==typeof a&&a){b=a.match(K)||[];while(c=this[i++])if(e=nb(c),d=1===c.nodeType&&" "+mb(e)+" "){g=0;while(f=b[g++])d.indexOf(" "+f+" ")<0&&(d+=f+" ");h=mb(d),e!==h&&c.setAttribute("class",h)}}return this},removeClass:function(a){var b,c,d,e,f,g,h,i=0;if(r.isFunction(a))return this.each(function(b){r(this).removeClass(a.call(this,b,nb(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof a&&a){b=a.match(K)||[];while(c=this[i++])if(e=nb(c),d=1===c.nodeType&&" "+mb(e)+" "){g=0;while(f=b[g++])while(d.indexOf(" "+f+" ")>-1)d=d.replace(" "+f+" "," ");h=mb(d),e!==h&&c.setAttribute("class",h)}}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):r.isFunction(a)?this.each(function(c){r(this).toggleClass(a.call(this,c,nb(this),b),b)}):this.each(function(){var b,d,e,f;if("string"===c){d=0,e=r(this),f=a.match(K)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else void 0!==a&&"boolean"!==c||(b=nb(this),b&&V.set(this,"__className__",b),this.setAttribute&&this.setAttribute("class",b||a===!1?"":V.get(this,"__className__")||""))})},hasClass:function(a){var b,c,d=0;b=" "+a+" ";while(c=this[d++])if(1===c.nodeType&&(" "+mb(nb(c))+" ").indexOf(b)>-1)return!0;return!1}});var ob=/\r/g;r.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=r.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,r(this).val()):a,null==e?e="":"number"==typeof e?e+="":r.isArray(e)&&(e=r.map(e,function(a){return null==a?"":a+""})),b=r.valHooks[this.type]||r.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=r.valHooks[e.type]||r.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(ob,""):null==c?"":c)}}}),r.extend({valHooks:{option:{get:function(a){var b=r.find.attr(a,"value");return null!=b?b:mb(r.text(a))}},select:{get:function(a){var b,c,d,e=a.options,f=a.selectedIndex,g="select-one"===a.type,h=g?null:[],i=g?f+1:e.length;for(d=f<0?i:g?f:0;d<i;d++)if(c=e[d],(c.selected||d===f)&&!c.disabled&&(!c.parentNode.disabled||!r.nodeName(c.parentNode,"optgroup"))){if(b=r(c).val(),g)return b;h.push(b)}return h},set:function(a,b){var c,d,e=a.options,f=r.makeArray(b),g=e.length;while(g--)d=e[g],(d.selected=r.inArray(r.valHooks.option.get(d),f)>-1)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),r.each(["radio","checkbox"],function(){r.valHooks[this]={set:function(a,b){if(r.isArray(b))return a.checked=r.inArray(r(a).val(),b)>-1}},o.checkOn||(r.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var pb=/^(?:focusinfocus|focusoutblur)$/;r.extend(r.event,{trigger:function(b,c,e,f){var g,h,i,j,k,m,n,o=[e||d],p=l.call(b,"type")?b.type:b,q=l.call(b,"namespace")?b.namespace.split("."):[];if(h=i=e=e||d,3!==e.nodeType&&8!==e.nodeType&&!pb.test(p+r.event.triggered)&&(p.indexOf(".")>-1&&(q=p.split("."),p=q.shift(),q.sort()),k=p.indexOf(":")<0&&"on"+p,b=b[r.expando]?b:new r.Event(p,"object"==typeof b&&b),b.isTrigger=f?2:3,b.namespace=q.join("."),b.rnamespace=b.namespace?new RegExp("(^|\\.)"+q.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=e),c=null==c?[b]:r.makeArray(c,[b]),n=r.event.special[p]||{},f||!n.trigger||n.trigger.apply(e,c)!==!1)){if(!f&&!n.noBubble&&!r.isWindow(e)){for(j=n.delegateType||p,pb.test(j+p)||(h=h.parentNode);h;h=h.parentNode)o.push(h),i=h;i===(e.ownerDocument||d)&&o.push(i.defaultView||i.parentWindow||a)}g=0;while((h=o[g++])&&!b.isPropagationStopped())b.type=g>1?j:n.bindType||p,m=(V.get(h,"events")||{})[b.type]&&V.get(h,"handle"),m&&m.apply(h,c),m=k&&h[k],m&&m.apply&&T(h)&&(b.result=m.apply(h,c),b.result===!1&&b.preventDefault());return b.type=p,f||b.isDefaultPrevented()||n._default&&n._default.apply(o.pop(),c)!==!1||!T(e)||k&&r.isFunction(e[p])&&!r.isWindow(e)&&(i=e[k],i&&(e[k]=null),r.event.triggered=p,e[p](),r.event.triggered=void 0,i&&(e[k]=i)),b.result}},simulate:function(a,b,c){var d=r.extend(new r.Event,c,{type:a,isSimulated:!0});r.event.trigger(d,null,b)}}),r.fn.extend({trigger:function(a,b){return this.each(function(){r.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];if(c)return r.event.trigger(a,b,c,!0)}}),r.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(a,b){r.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),r.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),o.focusin="onfocusin"in a,o.focusin||r.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){r.event.simulate(b,a.target,r.event.fix(a))};r.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=V.access(d,b);e||d.addEventListener(a,c,!0),V.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=V.access(d,b)-1;e?V.access(d,b,e):(d.removeEventListener(a,c,!0),V.remove(d,b))}}});var qb=a.location,rb=r.now(),sb=/\?/;r.parseXML=function(b){var c;if(!b||"string"!=typeof b)return null;try{c=(new a.DOMParser).parseFromString(b,"text/xml")}catch(d){c=void 0}return c&&!c.getElementsByTagName("parsererror").length||r.error("Invalid XML: "+b),c};var tb=/\[\]$/,ub=/\r?\n/g,vb=/^(?:submit|button|image|reset|file)$/i,wb=/^(?:input|select|textarea|keygen)/i;function xb(a,b,c,d){var e;if(r.isArray(b))r.each(b,function(b,e){c||tb.test(a)?d(a,e):xb(a+"["+("object"==typeof e&&null!=e?b:"")+"]",e,c,d)});else if(c||"object"!==r.type(b))d(a,b);else for(e in b)xb(a+"["+e+"]",b[e],c,d)}r.param=function(a,b){var c,d=[],e=function(a,b){var c=r.isFunction(b)?b():b;d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(null==c?"":c)};if(r.isArray(a)||a.jquery&&!r.isPlainObject(a))r.each(a,function(){e(this.name,this.value)});else for(c in a)xb(c,a[c],b,e);return d.join("&")},r.fn.extend({serialize:function(){return r.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=r.prop(this,"elements");return a?r.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!r(this).is(":disabled")&&wb.test(this.nodeName)&&!vb.test(a)&&(this.checked||!ia.test(a))}).map(function(a,b){var c=r(this).val();return null==c?null:r.isArray(c)?r.map(c,function(a){return{name:b.name,value:a.replace(ub,"\r\n")}}):{name:b.name,value:c.replace(ub,"\r\n")}}).get()}});var yb=/%20/g,zb=/#.*$/,Ab=/([?&])_=[^&]*/,Bb=/^(.*?):[ \t]*([^\r\n]*)$/gm,Cb=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Db=/^(?:GET|HEAD)$/,Eb=/^\/\//,Fb={},Gb={},Hb="*/".concat("*"),Ib=d.createElement("a");Ib.href=qb.href;function Jb(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(K)||[];if(r.isFunction(c))while(d=f[e++])"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function Kb(a,b,c,d){var e={},f=a===Gb;function g(h){var i;return e[h]=!0,r.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e["*"]&&g("*")}function Lb(a,b){var c,d,e=r.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&r.extend(!0,a,d),a}function Mb(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while("*"===i[0])i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}if(f)return f!==i[0]&&i.unshift(f),c[f]}function Nb(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}r.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:qb.href,type:"GET",isLocal:Cb.test(qb.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Hb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":r.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Lb(Lb(a,r.ajaxSettings),b):Lb(r.ajaxSettings,a)},ajaxPrefilter:Jb(Fb),ajaxTransport:Jb(Gb),ajax:function(b,c){"object"==typeof b&&(c=b,b=void 0),c=c||{};var e,f,g,h,i,j,k,l,m,n,o=r.ajaxSetup({},c),p=o.context||o,q=o.context&&(p.nodeType||p.jquery)?r(p):r.event,s=r.Deferred(),t=r.Callbacks("once memory"),u=o.statusCode||{},v={},w={},x="canceled",y={readyState:0,getResponseHeader:function(a){var b;if(k){if(!h){h={};while(b=Bb.exec(g))h[b[1].toLowerCase()]=b[2]}b=h[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return k?g:null},setRequestHeader:function(a,b){return null==k&&(a=w[a.toLowerCase()]=w[a.toLowerCase()]||a,v[a]=b),this},overrideMimeType:function(a){return null==k&&(o.mimeType=a),this},statusCode:function(a){var b;if(a)if(k)y.always(a[y.status]);else for(b in a)u[b]=[u[b],a[b]];return this},abort:function(a){var b=a||x;return e&&e.abort(b),A(0,b),this}};if(s.promise(y),o.url=((b||o.url||qb.href)+"").replace(Eb,qb.protocol+"//"),o.type=c.method||c.type||o.method||o.type,o.dataTypes=(o.dataType||"*").toLowerCase().match(K)||[""],null==o.crossDomain){j=d.createElement("a");try{j.href=o.url,j.href=j.href,o.crossDomain=Ib.protocol+"//"+Ib.host!=j.protocol+"//"+j.host}catch(z){o.crossDomain=!0}}if(o.data&&o.processData&&"string"!=typeof o.data&&(o.data=r.param(o.data,o.traditional)),Kb(Fb,o,c,y),k)return y;l=r.event&&o.global,l&&0===r.active++&&r.event.trigger("ajaxStart"),o.type=o.type.toUpperCase(),o.hasContent=!Db.test(o.type),f=o.url.replace(zb,""),o.hasContent?o.data&&o.processData&&0===(o.contentType||"").indexOf("application/x-www-form-urlencoded")&&(o.data=o.data.replace(yb,"+")):(n=o.url.slice(f.length),o.data&&(f+=(sb.test(f)?"&":"?")+o.data,delete o.data),o.cache===!1&&(f=f.replace(Ab,"$1"),n=(sb.test(f)?"&":"?")+"_="+rb++ +n),o.url=f+n),o.ifModified&&(r.lastModified[f]&&y.setRequestHeader("If-Modified-Since",r.lastModified[f]),r.etag[f]&&y.setRequestHeader("If-None-Match",r.etag[f])),(o.data&&o.hasContent&&o.contentType!==!1||c.contentType)&&y.setRequestHeader("Content-Type",o.contentType),y.setRequestHeader("Accept",o.dataTypes[0]&&o.accepts[o.dataTypes[0]]?o.accepts[o.dataTypes[0]]+("*"!==o.dataTypes[0]?", "+Hb+"; q=0.01":""):o.accepts["*"]);for(m in o.headers)y.setRequestHeader(m,o.headers[m]);if(o.beforeSend&&(o.beforeSend.call(p,y,o)===!1||k))return y.abort();if(x="abort",t.add(o.complete),y.done(o.success),y.fail(o.error),e=Kb(Gb,o,c,y)){if(y.readyState=1,l&&q.trigger("ajaxSend",[y,o]),k)return y;o.async&&o.timeout>0&&(i=a.setTimeout(function(){y.abort("timeout")},o.timeout));try{k=!1,e.send(v,A)}catch(z){if(k)throw z;A(-1,z)}}else A(-1,"No Transport");function A(b,c,d,h){var j,m,n,v,w,x=c;k||(k=!0,i&&a.clearTimeout(i),e=void 0,g=h||"",y.readyState=b>0?4:0,j=b>=200&&b<300||304===b,d&&(v=Mb(o,y,d)),v=Nb(o,v,y,j),j?(o.ifModified&&(w=y.getResponseHeader("Last-Modified"),w&&(r.lastModified[f]=w),w=y.getResponseHeader("etag"),w&&(r.etag[f]=w)),204===b||"HEAD"===o.type?x="nocontent":304===b?x="notmodified":(x=v.state,m=v.data,n=v.error,j=!n)):(n=x,!b&&x||(x="error",b<0&&(b=0))),y.status=b,y.statusText=(c||x)+"",j?s.resolveWith(p,[m,x,y]):s.rejectWith(p,[y,x,n]),y.statusCode(u),u=void 0,l&&q.trigger(j?"ajaxSuccess":"ajaxError",[y,o,j?m:n]),t.fireWith(p,[y,x]),l&&(q.trigger("ajaxComplete",[y,o]),--r.active||r.event.trigger("ajaxStop")))}return y},getJSON:function(a,b,c){return r.get(a,b,c,"json")},getScript:function(a,b){return r.get(a,void 0,b,"script")}}),r.each(["get","post"],function(a,b){r[b]=function(a,c,d,e){return r.isFunction(c)&&(e=e||d,d=c,c=void 0),r.ajax(r.extend({url:a,type:b,dataType:e,data:c,success:d},r.isPlainObject(a)&&a))}}),r._evalUrl=function(a){return r.ajax({url:a,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})},r.fn.extend({wrapAll:function(a){var b;return this[0]&&(r.isFunction(a)&&(a=a.call(this[0])),b=r(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstElementChild)a=a.firstElementChild;return a}).append(this)),this},wrapInner:function(a){return r.isFunction(a)?this.each(function(b){r(this).wrapInner(a.call(this,b))}):this.each(function(){var b=r(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=r.isFunction(a);return this.each(function(c){r(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(a){return this.parent(a).not("body").each(function(){r(this).replaceWith(this.childNodes)}),this}}),r.expr.pseudos.hidden=function(a){return!r.expr.pseudos.visible(a)},r.expr.pseudos.visible=function(a){return!!(a.offsetWidth||a.offsetHeight||a.getClientRects().length)},r.ajaxSettings.xhr=function(){try{return new a.XMLHttpRequest}catch(b){}};var Ob={0:200,1223:204},Pb=r.ajaxSettings.xhr();o.cors=!!Pb&&"withCredentials"in Pb,o.ajax=Pb=!!Pb,r.ajaxTransport(function(b){var c,d;if(o.cors||Pb&&!b.crossDomain)return{send:function(e,f){var g,h=b.xhr();if(h.open(b.type,b.url,b.async,b.username,b.password),b.xhrFields)for(g in b.xhrFields)h[g]=b.xhrFields[g];b.mimeType&&h.overrideMimeType&&h.overrideMimeType(b.mimeType),b.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");for(g in e)h.setRequestHeader(g,e[g]);c=function(a){return function(){c&&(c=d=h.onload=h.onerror=h.onabort=h.onreadystatechange=null,"abort"===a?h.abort():"error"===a?"number"!=typeof h.status?f(0,"error"):f(h.status,h.statusText):f(Ob[h.status]||h.status,h.statusText,"text"!==(h.responseType||"text")||"string"!=typeof h.responseText?{binary:h.response}:{text:h.responseText},h.getAllResponseHeaders()))}},h.onload=c(),d=h.onerror=c("error"),void 0!==h.onabort?h.onabort=d:h.onreadystatechange=function(){4===h.readyState&&a.setTimeout(function(){c&&d()})},c=c("abort");try{h.send(b.hasContent&&b.data||null)}catch(i){if(c)throw i}},abort:function(){c&&c()}}}),r.ajaxPrefilter(function(a){a.crossDomain&&(a.contents.script=!1)}),r.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(a){return r.globalEval(a),a}}}),r.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),r.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(e,f){b=r("<script>").prop({charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&f("error"===a.type?404:200,a.type)}),d.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Qb=[],Rb=/(=)\?(?=&|$)|\?\?/;r.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Qb.pop()||r.expando+"_"+rb++;return this[a]=!0,a}}),r.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(Rb.test(b.url)?"url":"string"==typeof b.data&&0===(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Rb.test(b.data)&&"data");if(h||"jsonp"===b.dataTypes[0])return e=b.jsonpCallback=r.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Rb,"$1"+e):b.jsonp!==!1&&(b.url+=(sb.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||r.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){void 0===f?r(a).removeProp(e):a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Qb.push(e)),g&&r.isFunction(f)&&f(g[0]),g=f=void 0}),"script"}),o.createHTMLDocument=function(){var a=d.implementation.createHTMLDocument("").body;return a.innerHTML="<form></form><form></form>",2===a.childNodes.length}(),r.parseHTML=function(a,b,c){if("string"!=typeof a)return[];"boolean"==typeof b&&(c=b,b=!1);var e,f,g;return b||(o.createHTMLDocument?(b=d.implementation.createHTMLDocument(""),e=b.createElement("base"),e.href=d.location.href,b.head.appendChild(e)):b=d),f=B.exec(a),g=!c&&[],f?[b.createElement(f[1])]:(f=pa([a],b,g),g&&g.length&&r(g).remove(),r.merge([],f.childNodes))},r.fn.load=function(a,b,c){var d,e,f,g=this,h=a.indexOf(" ");return h>-1&&(d=mb(a.slice(h)),a=a.slice(0,h)),r.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&r.ajax({url:a,type:e||"GET",dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?r("<div>").append(r.parseHTML(a)).find(d):a)}).always(c&&function(a,b){g.each(function(){c.apply(this,f||[a.responseText,b,a])})}),this},r.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){r.fn[b]=function(a){return this.on(b,a)}}),r.expr.pseudos.animated=function(a){return r.grep(r.timers,function(b){return a===b.elem}).length};function Sb(a){return r.isWindow(a)?a:9===a.nodeType&&a.defaultView}r.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=r.css(a,"position"),l=r(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=r.css(a,"top"),i=r.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),r.isFunction(b)&&(b=b.call(a,c,r.extend({},h))),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},r.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){r.offset.setOffset(this,a,b)});var b,c,d,e,f=this[0];if(f)return f.getClientRects().length?(d=f.getBoundingClientRect(),d.width||d.height?(e=f.ownerDocument,c=Sb(e),b=e.documentElement,{top:d.top+c.pageYOffset-b.clientTop,left:d.left+c.pageXOffset-b.clientLeft}):d):{top:0,left:0}},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===r.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),r.nodeName(a[0],"html")||(d=a.offset()),d={top:d.top+r.css(a[0],"borderTopWidth",!0),left:d.left+r.css(a[0],"borderLeftWidth",!0)}),{top:b.top-d.top-r.css(c,"marginTop",!0),left:b.left-d.left-r.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent;while(a&&"static"===r.css(a,"position"))a=a.offsetParent;return a||qa})}}),r.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c="pageYOffset"===b;r.fn[a]=function(d){return S(this,function(a,d,e){var f=Sb(a);return void 0===e?f?f[b]:a[d]:void(f?f.scrollTo(c?f.pageXOffset:e,c?e:f.pageYOffset):a[d]=e)},a,d,arguments.length)}}),r.each(["top","left"],function(a,b){r.cssHooks[b]=Oa(o.pixelPosition,function(a,c){if(c)return c=Na(a,b),La.test(c)?r(a).position()[b]+"px":c})}),r.each({Height:"height",Width:"width"},function(a,b){r.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){r.fn[d]=function(e,f){var g=arguments.length&&(c||"boolean"!=typeof e),h=c||(e===!0||f===!0?"margin":"border");return S(this,function(b,c,e){var f;return r.isWindow(b)?0===d.indexOf("outer")?b["inner"+a]:b.document.documentElement["client"+a]:9===b.nodeType?(f=b.documentElement,Math.max(b.body["scroll"+a],f["scroll"+a],b.body["offset"+a],f["offset"+a],f["client"+a])):void 0===e?r.css(b,c,h):r.style(b,c,e,h)},b,g?e:void 0,g)}})}),r.fn.extend({bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}}),r.parseJSON=JSON.parse,"function"==typeof define&&define.amd&&define("jquery",[],function(){return r});var Tb=a.jQuery,Ub=a.$;return r.noConflict=function(b){return a.$===r&&(a.$=Ub),b&&a.jQuery===r&&(a.jQuery=Tb),r},b||(a.jQuery=a.$=r),r});
/*
 * jQuery throttle / debounce - v1.1 - 3/7/2010
 * http://benalman.com/projects/jquery-throttle-debounce-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function(b,c){var $=b.jQuery||b.Cowboy||(b.Cowboy={}),a;$.throttle=a=function(e,f,j,i){var h,d=0;if(typeof f!=="boolean"){i=j;j=f;f=c}function g(){var o=this,m=+new Date()-d,n=arguments;function l(){d=+new Date();j.apply(o,n)}function k(){h=c}if(i&&!h){l()}h&&clearTimeout(h);if(i===c&&m>e){l()}else{if(f!==true){h=setTimeout(i?k:l,i===c?e-m:e)}}}if($.guid){g.guid=j.guid=j.guid||$.guid++}return g};$.debounce=function(d,e,f){return f===c?a(d,e,false):a(d,f,e!==false)}})(this);
/*!
 * imagesLoaded PACKAGED v4.1.0
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */
!function(t,e){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",e):"object"==typeof module&&module.exports?module.exports=e():t.EvEmitter=e()}(this,function(){function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var i=this._events=this._events||{},n=i[t]=i[t]||[];return-1==n.indexOf(e)&&n.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var i=this._onceEvents=this._onceEvents||{},n=i[t]=i[t]||[];return n[e]=!0,this}},e.off=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=i.indexOf(e);return-1!=n&&i.splice(n,1),this}},e.emitEvent=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=0,o=i[n];e=e||[];for(var r=this._onceEvents&&this._onceEvents[t];o;){var s=r&&r[o];s&&(this.off(t,o),delete r[o]),o.apply(this,e),n+=s?0:1,o=i[n]}return this}},t}),function(t,e){"use strict";"function"==typeof define&&define.amd?define(["ev-emitter/ev-emitter"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("ev-emitter")):t.imagesLoaded=e(t,t.EvEmitter)}(window,function(t,e){function i(t,e){for(var i in e)t[i]=e[i];return t}function n(t){var e=[];if(Array.isArray(t))e=t;else if("number"==typeof t.length)for(var i=0;i<t.length;i++)e.push(t[i]);else e.push(t);return e}function o(t,e,r){return this instanceof o?("string"==typeof t&&(t=document.querySelectorAll(t)),this.elements=n(t),this.options=i({},this.options),"function"==typeof e?r=e:i(this.options,e),r&&this.on("always",r),this.getImages(),h&&(this.jqDeferred=new h.Deferred),void setTimeout(function(){this.check()}.bind(this))):new o(t,e,r)}function r(t){this.img=t}function s(t,e){this.url=t,this.element=e,this.img=new Image}var h=t.jQuery,a=t.console;o.prototype=Object.create(e.prototype),o.prototype.options={},o.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},o.prototype.addElementImages=function(t){"IMG"==t.nodeName&&this.addImage(t),this.options.background===!0&&this.addElementBackgroundImages(t);var e=t.nodeType;if(e&&d[e]){for(var i=t.querySelectorAll("img"),n=0;n<i.length;n++){var o=i[n];this.addImage(o)}if("string"==typeof this.options.background){var r=t.querySelectorAll(this.options.background);for(n=0;n<r.length;n++){var s=r[n];this.addElementBackgroundImages(s)}}}};var d={1:!0,9:!0,11:!0};return o.prototype.addElementBackgroundImages=function(t){var e=getComputedStyle(t);if(e)for(var i=/url\((['"])?(.*?)\1\)/gi,n=i.exec(e.backgroundImage);null!==n;){var o=n&&n[2];o&&this.addBackground(o,t),n=i.exec(e.backgroundImage)}},o.prototype.addImage=function(t){var e=new r(t);this.images.push(e)},o.prototype.addBackground=function(t,e){var i=new s(t,e);this.images.push(i)},o.prototype.check=function(){function t(t,i,n){setTimeout(function(){e.progress(t,i,n)})}var e=this;return this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?void this.images.forEach(function(e){e.once("progress",t),e.check()}):void this.complete()},o.prototype.progress=function(t,e,i){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!t.isLoaded,this.emitEvent("progress",[this,t,e]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,t),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&a&&a.log("progress: "+i,t,e)},o.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(t,[this]),this.emitEvent("always",[this]),this.jqDeferred){var e=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[e](this)}},r.prototype=Object.create(e.prototype),r.prototype.check=function(){var t=this.getIsImageComplete();return t?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),void(this.proxyImage.src=this.img.src))},r.prototype.getIsImageComplete=function(){return this.img.complete&&void 0!==this.img.naturalWidth},r.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.img,e])},r.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},r.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},r.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},r.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},s.prototype=Object.create(r.prototype),s.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url;var t=this.getIsImageComplete();t&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},s.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},s.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.element,e])},o.makeJQueryPlugin=function(e){e=e||t.jQuery,e&&(h=e,h.fn.imagesLoaded=function(t,e){var i=new o(this,t,e);return i.jqDeferred.promise(h(this))})},o.makeJQueryPlugin(),o});
/*! lz-string-1.3.3-min.js | (c) 2013 Pieroxy | Licensed under a WTFPL license */
var LZString={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(e){if(e==null)return"";var t="";var n,r,i,s,o,u,a;var f=0;e=LZString.compress(e);while(f<e.length*2){if(f%2==0){n=e.charCodeAt(f/2)>>8;r=e.charCodeAt(f/2)&255;if(f/2+1<e.length)i=e.charCodeAt(f/2+1)>>8;else i=NaN}else{n=e.charCodeAt((f-1)/2)&255;if((f+1)/2<e.length){r=e.charCodeAt((f+1)/2)>>8;i=e.charCodeAt((f+1)/2)&255}else r=i=NaN}f+=3;s=n>>2;o=(n&3)<<4|r>>4;u=(r&15)<<2|i>>6;a=i&63;if(isNaN(r)){u=a=64}else if(isNaN(i)){a=64}t=t+LZString._keyStr.charAt(s)+LZString._keyStr.charAt(o)+LZString._keyStr.charAt(u)+LZString._keyStr.charAt(a)}return t},decompressFromBase64:function(e){if(e==null)return"";var t="",n=0,r,i,s,o,u,a,f,l,c=0,h=LZString._f;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(c<e.length){u=LZString._keyStr.indexOf(e.charAt(c++));a=LZString._keyStr.indexOf(e.charAt(c++));f=LZString._keyStr.indexOf(e.charAt(c++));l=LZString._keyStr.indexOf(e.charAt(c++));i=u<<2|a>>4;s=(a&15)<<4|f>>2;o=(f&3)<<6|l;if(n%2==0){r=i<<8;if(f!=64){t+=h(r|s)}if(l!=64){r=o<<8}}else{t=t+h(r|i);if(f!=64){r=s<<8}if(l!=64){t+=h(r|o)}}n+=3}return LZString.decompress(t)},compressToUTF16:function(e){if(e==null)return"";var t="",n,r,i,s=0,o=LZString._f;e=LZString.compress(e);for(n=0;n<e.length;n++){r=e.charCodeAt(n);switch(s++){case 0:t+=o((r>>1)+32);i=(r&1)<<14;break;case 1:t+=o(i+(r>>2)+32);i=(r&3)<<13;break;case 2:t+=o(i+(r>>3)+32);i=(r&7)<<12;break;case 3:t+=o(i+(r>>4)+32);i=(r&15)<<11;break;case 4:t+=o(i+(r>>5)+32);i=(r&31)<<10;break;case 5:t+=o(i+(r>>6)+32);i=(r&63)<<9;break;case 6:t+=o(i+(r>>7)+32);i=(r&127)<<8;break;case 7:t+=o(i+(r>>8)+32);i=(r&255)<<7;break;case 8:t+=o(i+(r>>9)+32);i=(r&511)<<6;break;case 9:t+=o(i+(r>>10)+32);i=(r&1023)<<5;break;case 10:t+=o(i+(r>>11)+32);i=(r&2047)<<4;break;case 11:t+=o(i+(r>>12)+32);i=(r&4095)<<3;break;case 12:t+=o(i+(r>>13)+32);i=(r&8191)<<2;break;case 13:t+=o(i+(r>>14)+32);i=(r&16383)<<1;break;case 14:t+=o(i+(r>>15)+32,(r&32767)+32);s=0;break}}return t+o(i+32)},decompressFromUTF16:function(e){if(e==null)return"";var t="",n,r,i=0,s=0,o=LZString._f;while(s<e.length){r=e.charCodeAt(s)-32;switch(i++){case 0:n=r<<1;break;case 1:t+=o(n|r>>14);n=(r&16383)<<2;break;case 2:t+=o(n|r>>13);n=(r&8191)<<3;break;case 3:t+=o(n|r>>12);n=(r&4095)<<4;break;case 4:t+=o(n|r>>11);n=(r&2047)<<5;break;case 5:t+=o(n|r>>10);n=(r&1023)<<6;break;case 6:t+=o(n|r>>9);n=(r&511)<<7;break;case 7:t+=o(n|r>>8);n=(r&255)<<8;break;case 8:t+=o(n|r>>7);n=(r&127)<<9;break;case 9:t+=o(n|r>>6);n=(r&63)<<10;break;case 10:t+=o(n|r>>5);n=(r&31)<<11;break;case 11:t+=o(n|r>>4);n=(r&15)<<12;break;case 12:t+=o(n|r>>3);n=(r&7)<<13;break;case 13:t+=o(n|r>>2);n=(r&3)<<14;break;case 14:t+=o(n|r>>1);n=(r&1)<<15;break;case 15:t+=o(n|r);i=0;break}s++}return LZString.decompress(t)},compress:function(e){if(e==null)return"";var t,n,r={},i={},s="",o="",u="",a=2,f=3,l=2,c="",h=0,p=0,d,v=LZString._f;for(d=0;d<e.length;d+=1){s=e.charAt(d);if(!Object.prototype.hasOwnProperty.call(r,s)){r[s]=f++;i[s]=true}o=u+s;if(Object.prototype.hasOwnProperty.call(r,o)){u=o}else{if(Object.prototype.hasOwnProperty.call(i,u)){if(u.charCodeAt(0)<256){for(t=0;t<l;t++){h=h<<1;if(p==15){p=0;c+=v(h);h=0}else{p++}}n=u.charCodeAt(0);for(t=0;t<8;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}else{n=1;for(t=0;t<l;t++){h=h<<1|n;if(p==15){p=0;c+=v(h);h=0}else{p++}n=0}n=u.charCodeAt(0);for(t=0;t<16;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}delete i[u]}else{n=r[u];for(t=0;t<l;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}r[o]=f++;u=String(s)}}if(u!==""){if(Object.prototype.hasOwnProperty.call(i,u)){if(u.charCodeAt(0)<256){for(t=0;t<l;t++){h=h<<1;if(p==15){p=0;c+=v(h);h=0}else{p++}}n=u.charCodeAt(0);for(t=0;t<8;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}else{n=1;for(t=0;t<l;t++){h=h<<1|n;if(p==15){p=0;c+=v(h);h=0}else{p++}n=0}n=u.charCodeAt(0);for(t=0;t<16;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}delete i[u]}else{n=r[u];for(t=0;t<l;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}}n=2;for(t=0;t<l;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}while(true){h=h<<1;if(p==15){c+=v(h);break}else p++}return c},decompress:function(e){if(e==null)return"";if(e=="")return null;var t=[],n,r=4,i=4,s=3,o="",u="",a,f,l,c,h,p,d,v=LZString._f,m={string:e,val:e.charCodeAt(0),position:32768,index:1};for(a=0;a<3;a+=1){t[a]=a}l=0;h=Math.pow(2,2);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}switch(n=l){case 0:l=0;h=Math.pow(2,8);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}d=v(l);break;case 1:l=0;h=Math.pow(2,16);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}d=v(l);break;case 2:return""}t[3]=d;f=u=d;while(true){if(m.index>m.string.length){return""}l=0;h=Math.pow(2,s);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}switch(d=l){case 0:l=0;h=Math.pow(2,8);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}t[i++]=v(l);d=i-1;r--;break;case 1:l=0;h=Math.pow(2,16);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}t[i++]=v(l);d=i-1;r--;break;case 2:return u}if(r==0){r=Math.pow(2,s);s++}if(t[d]){o=t[d]}else{if(d===i){o=f+f.charAt(0)}else{return null}}u+=o;t[i++]=f+o.charAt(0);r--;f=o;if(r==0){r=Math.pow(2,s);s++}}}};if(typeof module!=="undefined"&&module!=null){module.exports=LZString}
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */
var saveAs=saveAs||navigator.msSaveBlob&&navigator.msSaveBlob.bind(navigator)||function(e){"use strict";var t=e.document,n=function(){return e.URL||e.webkitURL||e},r=e.URL||e.webkitURL||e,i=t.createElementNS("http://www.w3.org/1999/xhtml","a"),s="download"in i,o=function(n){var r=t.createEvent("MouseEvents");r.initMouseEvent("click",true,false,e,0,0,0,0,0,false,false,false,false,0,null);n.dispatchEvent(r)},u=e.webkitRequestFileSystem,a=e.requestFileSystem||u||e.mozRequestFileSystem,f=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},l="application/octet-stream",c=0,h=[],p=function(){var e=h.length;while(e--){var t=h[e];if(typeof t==="string"){r.revokeObjectURL(t)}else{t.remove()}}h.length=0},d=function(e,t,n){t=[].concat(t);var r=t.length;while(r--){var i=e["on"+t[r]];if(typeof i==="function"){try{i.call(e,n||e)}catch(s){f(s)}}}},v=function(t,r){var f=this,p=t.type,v=false,m,g,y=function(){var e=n().createObjectURL(t);h.push(e);return e},b=function(){d(f,"writestart progress write writeend".split(" "))},w=function(){if(v||!m){m=y(t)}if(g){g.location.href=m}else{window.open(m,"_blank")}f.readyState=f.DONE;b()},E=function(e){return function(){if(f.readyState!==f.DONE){return e.apply(this,arguments)}}},S={create:true,exclusive:false},x;f.readyState=f.INIT;if(!r){r="download"}if(s){m=y(t);i.href=m;i.download=r;o(i);f.readyState=f.DONE;b();return}if(e.chrome&&p&&p!==l){x=t.slice||t.webkitSlice;t=x.call(t,0,t.size,l);v=true}if(u&&r!=="download"){r+=".download"}if(p===l||u){g=e}if(!a){w();return}c+=t.size;a(e.TEMPORARY,c,E(function(e){e.root.getDirectory("saved",S,E(function(e){var n=function(){e.getFile(r,S,E(function(e){e.createWriter(E(function(n){n.onwriteend=function(t){g.location.href=e.toURL();h.push(e);f.readyState=f.DONE;d(f,"writeend",t)};n.onerror=function(){var e=n.error;if(e.code!==e.ABORT_ERR){w()}};"writestart progress write abort".split(" ").forEach(function(e){n["on"+e]=f["on"+e]});n.write(t);f.abort=function(){n.abort();f.readyState=f.DONE};f.readyState=f.WRITING}),w)}),w)};e.getFile(r,{create:false},E(function(e){e.remove();n()}),E(function(e){if(e.code===e.NOT_FOUND_ERR){n()}else{w()}}))}),w)}),w)},m=v.prototype,g=function(e,t){return new v(e,t)};m.abort=function(){var e=this;e.readyState=e.DONE;d(e,"abort")};m.readyState=m.INIT=0;m.WRITING=1;m.DONE=2;m.error=m.onwritestart=m.onprogress=m.onwrite=m.onabort=m.onerror=m.onwriteend=null;e.addEventListener("unload",p,false);return g}(self)
/*! seedrandom.js v2.3.3 | (c) 2013 David Bau, all rights reserved. | Licensed under a BSD-style license */
!function(a,b,c,d,e,f,g,h,i){function j(a){var b,c=a.length,e=this,f=0,g=e.i=e.j=0,h=e.S=[];for(c||(a=[c++]);d>f;)h[f]=f++;for(f=0;d>f;f++)h[f]=h[g=r&g+a[f%c]+(b=h[f])],h[g]=b;(e.g=function(a){for(var b,c=0,f=e.i,g=e.j,h=e.S;a--;)b=h[f=r&f+1],c=c*d+h[r&(h[f]=h[g=r&g+b])+(h[g]=b)];return e.i=f,e.j=g,c})(d)}function k(a,b){var c,d=[],e=typeof a;if(b&&"object"==e)for(c in a)try{d.push(k(a[c],b-1))}catch(f){}return d.length?d:"string"==e?a:a+"\0"}function l(a,b){for(var c,d=a+"",e=0;e<d.length;)b[r&e]=r&(c^=19*b[r&e])+d.charCodeAt(e++);return n(b)}function m(c){try{return a.crypto.getRandomValues(c=new Uint8Array(d)),n(c)}catch(e){return[+new Date,a,(c=a.navigator)&&c.plugins,a.screen,n(b)]}}function n(a){return String.fromCharCode.apply(0,a)}var o=c.pow(d,e),p=c.pow(2,f),q=2*p,r=d-1,s=c["seed"+i]=function(a,f,g){var h=[],r=l(k(f?[a,n(b)]:null==a?m():a,3),h),s=new j(h);return l(n(s.S),b),(g||function(a,b,d){return d?(c[i]=a,b):a})(function(){for(var a=s.g(e),b=o,c=0;p>a;)a=(a+c)*d,b*=d,c=s.g(1);for(;a>=q;)a/=2,b/=2,c>>>=1;return(a+c)/b},r,this==c)};l(c[i](),b),g&&g.exports?g.exports=s:h&&h.amd&&h(function(){return s})}(this,[],Math,256,6,52,"object"==typeof module&&module,"function"==typeof define&&define,"random");
/*! console_hack.js | (c) 2015 Thomas Michael Edwards | Licensed under SugarCube's Simple BSD license */
!function(){for(var methods=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],length=methods.length,noop=function(){},console=window.console=window.console||{};length--;){var method=methods[length];console[method]||(console[method]=noop)}}();
}else{document.documentElement.setAttribute("data-init", "lacking");}
</script>
<style id="style-normalize" type="text/css">/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}</style>
<style id="style-init-screen" type="text/css">@-webkit-keyframes init-loading-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes init-loading-spin{0%{-o-transform:rotate(0);transform:rotate(0)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes init-loading-spin{0%{-webkit-transform:rotate(0);-o-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}#init-screen{display:none;z-index:100000;position:fixed;top:0;left:0;height:100%;width:100%;font:28px/1 Helmet,Freesans,sans-serif;font-weight:700;color:#eee;background-color:#111;text-align:center}#init-screen>div{display:none;position:relative;margin:0 auto;max-width:1136px;top:25%}html[data-init=lacking] #init-screen,html[data-init=loading] #init-screen,html[data-init=no-js] #init-screen{display:block}html[data-init=lacking] #init-lacking,html[data-init=no-js] #init-no-js{display:block;padding:0 1em}html[data-init=no-js] #init-no-js{color:red}html[data-init=loading] #init-loading{display:block;border:24px solid transparent;border-radius:50%;border-top-color:#7f7f7f;border-bottom-color:#7f7f7f;width:100px;height:100px;-webkit-animation:init-loading-spin 2s linear infinite;-o-animation:init-loading-spin 2s linear infinite;animation:init-loading-spin 2s linear infinite}html[data-init=loading] #init-loading>div{text-indent:9999em;overflow:hidden;white-space:nowrap}html[data-init=loading] #passages,html[data-init=loading] #ui-bar{display:none}</style>
<style id="style-font" type="text/css">@font-face{font-family:tme-fa-icons;src:url(data:application/octet-stream;base64,d09GRgABAAAAACWoAA4AAAAAQhQAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABPUy8yAAABRAAAAEQAAABWPihI/2NtYXAAAAGIAAAAOgAAAUrQXRm3Y3Z0IAAAAcQAAAAKAAAACgAAAABmcGdtAAAB0AAABZQAAAtwiJCQWWdhc3AAAAdkAAAACAAAAAgAAAAQZ2x5ZgAAB2wAABjCAAAq+uJ4WNtoZWFkAAAgMAAAADQAAAA2BZlJs2hoZWEAACBkAAAAIAAAACQIJwQZaG10eAAAIIQAAABuAAABOPTeAABsb2NhAAAg9AAAAJ4AAACeojKW6m1heHAAACGUAAAAIAAAACAA6gvwbmFtZQAAIbQAAAGPAAAC/eLsyKlwb3N0AAAjRAAAAfwAAAM0412SIHByZXAAACVAAAAAZQAAAHvdawOFeJxjYGRWYZzAwMrAwVTFtIeBgaEHQjM+YDBkZGJgYGJgZWbACgLSXFMYHF4wvPBhDvqfxRDFHMQwDSjMCJIDANLeC6V4nGNgYGBmgGAZBkYGEHAB8hjBfBYGDSDNBqQZGZgYGF74/P8PUvCCAURLMELVAwEjG8OIBwC4Ywb6AAAAAAAAAAAAAAAAAAB4nK1WaXMTRxCd1WHLNj6CDxI2gVnGcox2VpjLCBDG7EoW4BzylexCjl1Ldu6LT/wG/ZpekVSRb/y0vB4d2GAnVVQoSv2m9+1M9+ueXpPQksReWI+k3HwpprY2aWTnSUg3bFqO4kPZ2QspU0z+LoiCaLXUvu04JCISgap1hSWC2PfI0iTjQ48yWrYlvWpSbulJd9kaD+qt+vbT0FGO3QklNZuhQ+uRLanCqBJFMu2RkjYtw9VfSVrh5yvMfNUMJYLoJJLGm2EMj+Rn44xWGa3GdhxFkU2WG0WKRDM8iCKPslpin1wxQUD5oBlSXvk0onyEH5EVe5TTCnHJdprf9yU/6R3OvyTieouyJQf+QHZkB3unK/ki0toK46adbEehivB0fSfEI5uT6p/sUV7TaOB2RaYnzQiWyleQWPkJZfYPyWrhfMqXPBrVkoOcCFovc2Jf8g60HkdMiWsmyILujk6IoO6XnKHYY/q4+OO9XSwXIQTIOJb1jkq4EEYpYbOaJG0EOYiSskWV1HpHTJzyOi3iLWG/Tu3oS2e0Sag7MZ6th46tnKjkeDSp00ymTu2k5tGUBlFKOhM85tcBlB/RJK+2sZrEyqNpbDNjJJFQoIVzaSqIZSeWNAXRPJrRm7thmmvXokWaPFDPPXpPb26Fmzs9p+3AP2v8Z3UqpoO9MJ2eDshKfJp2uUnRun56hn8m8UPWAiqRLTbDlMVDtn4H5eVjS47CawNs957zK+h99kTIpIH4G/AeL9UpBUyFmFVQC9201rUsy9RqVotUZOq7IU0rX9ZpAk05Dn1jX8Y4/q+ZGUtMCd/vxOnZEZeeufYlyDSH3GZdj+Z1arFdgM5sz+k0y/Z9nebYfqDTPNvzOh1ha+t0lO2HOi2w/UinY2wvaEGT7jsEchGBXMAGEoGwdRAI20sIhK1CIGwXEQjbIgJhu4RA2H6MQNguIxC2l7Wsmn4qaRw7E8sARYgDoznuyGVuKldTyaUSrotGpzbkKXKrpKJ4Vv0rA/3ikTesgbVAukTW/IpJrnxUleOPrmh508S5Ao5Vf3tzXJ8TD2W/WPhT8L/amqqkV6x5ZHIVeSPQk+NE1yYVj67p8rmqR9f/i4oOa4F+A6UQC0VZlg2+mZDwUafTUA1c5RAzGzMP1/W6Zc3P4fybGCEL6H78NxQaC9yDTllJWe1gr9XXj2W5twflsCdYkmK+zOtb4YuMzEr7RWYpez7yecAVMCqVYasNXK3gzXsS85DpTfJMELcVZYOkjceZILGBYx4wb76TICRMXbWB2imcsIG8YMwp2O+EQ1RvlOVwe6F9Ho2Uf2tX7MgZFU0Q+G32Rtjrs1DyW6yBhCe/1NdAVSFNxbipgEsj5YZq8GFcrdtGMk6gr6jYDcuyig8fR9x3So5lIPlIEatHRz+tvUKd1Ln9yihu3zv9CIJBaWL+9r6Z4qCUd7WSZVZtA1O3GpVT15rDxasO3c2j7nvH2Sdy1jTddE/c9L6mVbeDg7lZEO3bHJSlTC6o68MOG6jLzaXQ6mVckt52DzAsMKDfoRUb/1f3cfg8V6oKo+NIvZ2oH6PPYgzyDzh/R/UF6OcxTLmGlOd7lxOfbtzD2TJdxV2sn+LfwKy15mbpGnBD0w2Yh6xaHbrKDXynBjo90tyO9BDwse4K8QBgE8Bi8InuWsbzKYDxfMYcH+Bz5jBoMofBFnMYbDNnDWCHOQx2mcNgjzkMvmDOOsCXzGEQModBxBwGT5gTADxlDoOvmMPga+Yw+IY59wG+ZQ6DmDkMEuYw2Nd0ayhzixd0F6htUBXowPQTFvewONRUGbK/44Vhf28Qs38wiKk/aro9pP7EC0P92SCm/mIQU3/VdGdI/Y0Xhvq7QUz9wyCmPtMvxnKZwV9GvkuFA8ouNp/z98T7B8IaQLYAAQAB//8AD3icrToNcBzVefe9/b3dvd29u909/dyd7ke6k86yLEunOyHJsrCxJWyJGmEcLMDYxBhHNsZQBzOAkjQmFDrGIq5gHEIcCILOAGZq3IQO04RkIGkgaUMKMbQznSlJW0wgJtOQHxRr1e+93TvJwq7JTD3y2/f//bzvfX/vAhAIzL3KPcYNBFIB8UR9EJYuAcuAqGNbOiwDSczkuorlaJ6WTeVSRwMIDveY8aN20GztjzMhW4P2H+kNUPM5NaVNQE0K3tWM77vv8rJqgnT33VJE4WWIfd/QbKHZjcXcZiFAqjCDgUJA/mZTWOIIwi0vAwNiUjkW9THIZs6DAbnj6ffGP/P+0y2vv+5SXGLKuXHJPJH92c+yT7x3883wnI9W/DxI4T9+bm7uOL+MUwNywAg0BJYFQgNKa2NDzFBEjqeM0SFXLHU4YKe7yjFoSmdEKWw5nemOUj5czMXCliilM7lyuFgqp3HaDf1j/fhH+s6cfm4MEpA8c0BSQBO5CUkD5fJi05kDjSUoNnETTUUSXtpPVm0aGHDdmV0nNkPiMUWeHZMVRSZPSlp0dqypCKVG8iT9IK5AEeamyZGAjecW5tm5SSBm8ojiSqBsYoXDTRtuymw13V8axjB+p2EPlsMGcRzTTRkGOLRpmk/AzSZ+A97ecx+QN8g9gUbc26F7N+GJiN5pLGMA8hUo7EQcHI455A0PwrS3I37N+bZhTE8bex1aeeIJ4+MTjTY6gcH+iIvgGWQRdh2TR9sS81kspCzytguLfBcyuBOLXuhwYnZnh8NFUs6plLPLScGpWBKwkYztwsop7Hie9r7rYK/9brWXTg9U+RiBX+GJiyc0rgIv7UNJe3vPjrFdyZOV/byNUkyW/0AuIi/h+h6U5a64SmW5ieGcya2AYimG+EUtnZN08ImgveV+KOYykiiJVMrbkI+dHUkC9+nyPUFdD94j639r1uTq7FiSNrR1hXS8uLbGapYUSbpaJvzmp5aODbU9iJNBU1gJa5LFTCqihNpDigmWWtc2GjUy7Y2m3hHk14qmPJXp2cTInZudO85dhzw2AuXAJQHl+Yt7l0RVjkO8u4q5JZARE2A5yNxStNgGWcQSj7izA1HucCgJOsRsb7xYWgn9XAwvRqaN4HAS4ENF3kXFFovJ/muW3zsYDK3jxaCQbOouOPXZPmBDNZG4krS0N2/9wakf7hHv+IcPX/jcaGWZAp9fvrFtv66UeSlXn4zYdZo5kLNwIJJRTbEu3jz62Zf37Xv5l7RAeugZfAQ7kJ5koA3PoJB1eP8MpHRVWqpygyITpiKz4DCoHMENlun+wrDA0bNZ9jmJZdZwhhx9UnewMKztg2yAlie9j6O7Lzrks7tYdRdOO4u/FJ9e5G93RyFTJ1f5G17IZDs7z25uEfuFBYwlvYpUUuTnKJO6umg5IymD88yGGxbycjN2JOkIVk6wUoEzm/0O5T/Owb92Jg8NyL/6qFrl30IZ5nSgMp3nch7DkvOMCaMeoQ1U4JZxQncenmAMmcAei/S7V9CvAccW8mczwtMCceSQ8nwhXWuKAeQPJbRCc9RnhoSyhvBL+WgxTzsk0Y567IFj+35wa4Xq7ykS5YIm7UIdq4iCfKcsiIoSvFFWONUnFovZoXHKhXE69R9hTOIEgZPcJ0VZRrx+i3j9hhtFPqQDnYjX8uaEpS2+F4twiVkOylSJAwfvBZO3XBnoTaEHtltSWAGKIEl3SJIQ1CRESIRnLFtJRc88GckEbQuOBTO5zBXziL0JIPKiyMtzggwiMc+czmbDEbDMbJaLhC3LPzPuFOKaD6zEM+tt15gNxTPLIg5dvglCfGmbmakYmqmKsEfRVOWWAXjqvEzVeamT6botq9321Vu2rIb7KOrufmZ24LWmoiI3yspJJ65e704JprBSFGH3pxXLhAQe9fBzbM1rq7YAm1dsctvZSiqu8G94rxwS/LQ7JYorRR0XXq/GmSh4dJADKAsSk70ajQ8gHdE0MhzVjOCbVDSvKINd1PhKVN+fgMTG2zYCvIaq+V2mmsNTP36IRLD6xO7ejWTDisfc7zCVD6tQW+/eMTW1Y3fSt20foe+hBZpQ3zfGfH3vyzmCZNvHFoJFVPrRjj7m6I26M3r7KHQxgD5c2H/4tQdIeJLJ+yQDvTsZOwv4jYfJQxVaxxmtKtNTTVaQnRmS6kkWvfBoNvCeIT55jt41PJZwpg3YYeJYGK+dppgK/sF+R/8ggZIOBlnyNoK/qpwokLZ6uCFRKCTKV8HeGaYksPg2Xj/3fyQZb6dhGWv2QLLQU4DW7lZwf77Hw+vb3AjzexKIVywkEXoGlB1JUqr4FW3A7BZlDzgzhZ5W0tyfI1da7mmn13JvsZOFxLuJIRsmLXJVskByA41iu/uvSds9bWOnPZQ4lSgANm+xqQ6gMPlGH2YR79rSDIXLXQBujHZSxkCpSIeynwCdNxEFJ2HVmSDaFPxQYoIN2BfCM8E6zTCu66VDSQ97KkPfIa8i7nGUITNAZagDhYFJjeg5rXh+bcBuYamT/JWmRVE8Iopeb/3ud1ZdSIs4TkQLcaogJ63Z5dGUxEfefz8qSKko+Qm2PB/ZgyEEMngmjkjovYB0GBog+n9COzD7MiQ73pfOA5S8NLseIst+QWbPC9y/J8dRv7QFliCNWcnzAYlI3fE8hdNVbBPY1WEeZxm8m5mKOdypQRG1qhiRgQBnZbr7N20qT1ipoPsLVYWEGq8hE3BoLPn2tV8PhWVe0WTB4nIN3WMD7cmIiDZEhaSSROulWMbk2+sX4LIs0Iq4NNdUfV3mDeqCbaEOligmbYSFCaU0VRVULrhTKoKlIMubNvV3ZyyOByWMilXkBpNjcIjihTjBrwzF/bmKF1iMJNsHxrobcnxElDVF0C3u69fevP5txIsEcUrVZyR96DPqiI/C+zGTp0uZGkXVP6PG1RncET7Ey/eKjnX885QeWw83krsCIVyvMp8TD9P3rEvMFUkFZxS6Rw25ytWQJ/52/tqLyQSDrc7Dpiq/H2XDgYsVBgjnK7BF95EwLKLNKLh0bg5x74VXPNwJO1fq7raB588j7pbhat78pDKjPE1td1Jl6Hhn8Q73LdISsCrrgwuijljQ28Tinnavx+Xu9ap6jYqn2QzNaly7RoVJ99MoBl/DvmtU1X0Lu3FCnO37XXKEW832Nai8BYnDKKvIF92W3F9dotK94ahCNyJPuW+5b2L1WrQ2X6fSc1TBejLg77uvsm8FX2b1ghWk6cbjuB1FUIVm9y0f6aMKfMbdhjshNGihFKgIgE7044ZvkbXz+zbh3chXN/f35Z6mOyF2b/m7H6V7HVV3XYOYtiDOig/J25bh+xPuAPMdxRPRc8V1YU8Z2mEv9OIO2O6DTg8Wtt2C3+lCcjBRmEaNVbDhi0nLnUK1ttvqdVpsexruQ93WGnf3T9s47N+te7nN5FeohRGeChUfIvZx5htAPYTNjQl/ea/tTlkW7LZ7nIK3dyNsGUwWpq0+a4k/ALvozB5nurkCqwthUdrq5mnzBD/tu5rpfPVYuC6L0VZwnMfd/YnGxgTc97jjFNjGFvRQ6iyrYPfZjyPVyQJM233YRF5YVb1xgLzjwVMX3NOwZ/K7wtJZx4W8pGRNNzf4ZOBeCKgPCxuKcUYmxQNycbjP5wGlEJGk8OZc369tR3gtaZ+X6CbmVkIONRVJcugpluk1TQL1Fqmfy1ELVi4hYy1zJhYNj4zu7RkfbuebN17fv+q2Fj4sDgtE7Hv2uk89uneIH7j9yNWjR1YMmUvJSzO6s9QcGWkbHt83PtzW0yWCMMLr4roNcMm+o88e3XdJ/0VDkWiFDxSv5YhXq8d3nVAryjjtoDXp7Ojn2gg6ijGHIUxDpQZ0Y2lQym2+5NZHN219to8XhsUw33Lb6p6dG9DVGN598/bmkXA0NoPeR2t4qO/h0U8d3bcKtmB5yeilos6PCCB29fgINjeNmEsdfaYmGhm6qB9RrPhEx7mrEbfGwCDauZXNJo09wLJ1oAhSe1NxWkUDKKJofMqeE+szt8S4K9JYmjbLXRRtylOU1vWN//mVy4/0DVGNqM9QJT7SvL287ot5MSZoGC/oyHTWO7p3vdd5s6RB439/5fKH6aIaEDh46AVkpMqWo1YdaWpe1690hzT4e79jxGuLvD+R0iUwuiJ+TLUM4+yrA8aAdsVAsX1JFgMsTkCF4ceBdtgLZ8oXaENnPpfPipLA6A57nn4+XI1hUbCoYmig1KP5pH44Kybnq4cUyatKivvTmXpeOC7y8J4il3yHncWVz+SDrc5zTqucPyYro3Af7XP30/I8ddJxsQAgXIFbz37QdsmqNhJl0K6145C0rkWzExAX8aM3sDpwYyA8oF83PNBXWu7xRPQMIT1E6syw7M4F2tFwOmyhVKQ7+uH/lz9DribLBF4jsuze94lYBc+7LzLOXMw4c+66u52EZz/QLEWxyA0XZFuA9+OVUfSTwyzWCw0o3a0Jx9BYTrKp2AZiEi9qGSs6OFhZkPboRDXesZKpbcd3UOjV8dMgNNQhr1pJh0Qy5petVIQ48Zq1KefMj7zIhluf3pQeBs5JfUuJMGcgHFRik16gP1mzHX2EmroaYhmVysETLOo54aSGU/gHzbEwdRvCMXuGhUczHj3HkZ42Rk9LYIDS07c8YRuqSBg91Pmnwo8VghFR2Y9oKTmxziSwi0HTN2I1cMvT3E7Fezk/Pae1UnYyUwqdRnqCNZPoXSJSk6hxGWmRBKqBSMqyTP97/wmaJcQCGpqbG5Iw6vhEtHpEVWihepULpFG3rqG0rOha2qTxJIC0YOSYFjrxEtP8nlSlIxvu7PLcRKmS76mk04Sq0HoTqJ04CcfcK+DDIU34mhCX/dByaAiDy58ibicVeRdNJrNyezI2G/ESlUKsZDxiOtLJk/ChXCc9Imp+1nO2xL6QZIkkWiizM7SHIF9q9K8ZpQDx8zOjgWaMzORvdrSGPJ2sEzRYZer9O2gmWD4zSTr6sSuH8Uc/IGjmyLIMOHUV0G48840967ixy2v6zIhcU+pr3bDj9u0bc1xfqUbO9sUuH3O/iqEbFPqaPbOBZuFTO57rx7mxvnDL7avRFLah/ei55LZCpKddjqz4OxhyH6YRLuzA0rcfY5yC8rQTcb08JdLYleZW8TZ0lGgSCyVfQoQtRDiPV6BqKLryzL7kqRmkuoGdE5UzlKWy39mJQlU1OChf1KrEHOYcsdMhvaO3j5JN+zZBXJZ2Kmq0WRSMDSFJGqmtC0q8eZesmfWxPxNNca3DC3KzYsg7MBBXhJ2yHmvy5sojNXVBmQvfhUdoxJ0NgiENWTzfqwd3SOjC927ceNvGjbfTUTNp13eIumhvAKEvJA/HTUW6Maj1CeJAUtBFrcOI1xugSWxubV1qqaRJ1gZvqiHLbKqwOo5TR9hELw7/iBsjL/t6WXl+SWN9VOO5RfnTtJcwreTFY35bWthGB+bMB+yOcGEDg4bztxbkUR0wh1h2kJWgV0awMR+Hjvn5mlrmu9BMCMpYsZynmQC8KR2xco4maZIg5jN5CU86ViJ/s27nzqlxgFc6167fuXP92s5XYOdDO8j4pYNYw16IjR8eH79U0ra3Y6V9uyat20l2P7AbsKpjJ81Tzs39nt9PXgqYeL9LNB+Yi9uMN1BEZ0knnvijDiZLEDg6dJ30NuA9oQEVh9U0uk/kgO8A+R94pvWy8YveWn0ZWbfmLepJXdqz5Z5B94qhu7d2k75r7l0Lx2gVtvTMr6FXgDY7p56d6qSNS+/e0ke6r//CQ1/YXiTdW++u+FK/529HfC3klvzNhK3Te4txIUFlkuQ8tIjguXrUG6WAPWgMsIcDF664d3v3DHXwhQ07YMul2I9QDvtQXz+bokoej3uUo5mt1Qi7f/m58pGoIAyavsnnFiUl8cbhKTpRmI+CKw9Y1oKc5GvZZJCT6kWJcCHNzzDS3KTQKEocr/6Fe1GoUf+1rq/QG/W/hs9goz8E649Xc5M6HxXjAnDV9OT9spBFuwOC26Prv2bzQ3RhCHfwaYpW8+LxqOzlYOZR7/Kf/RbmXMktCzAr3jWP/Kqt5KUqZDq4uTqyBbYGfL17HcuL19KcjykyePSoAP2bNgILH1qOXXFwA9l471P3bOIvOwRXL8j+k0OjB6cPjrLCfe2sXP/824QcsAMZlOmGWiMo0rwb4K1qo+mH/LkBVlXdA+cFXFFWvz0//AXvbZ6+ac3GoyzHHvXfzCqvNILfLi9qV7KBJ/03OPbql/A+XlcDa3g9C1/rnPPU/XzkR4E3q/4p6kHES6V3vVx1M7x3EG4RnpwfhuT9B8mTF4BG6w/vZp7SbtoL4oJBkCuYe2+LL3GT6CtdzGKjNas6FGaHETyqOIeljCSdy4azYTwkLxFIL08OHSKaM+7sonl9vERpGguhHaS5bUgz24xu3ETTPsVKqntkIZfpqR1MdBfQKd6hmiFHviU1QZ260MQ2FSOcbfDmVoyFeHkb9rq/db9KFWsP6uutqz6LgZW6R+JrIjp86Gp6jSXL+7RoUv38yjEracH0NiVpKdu2ISBl27QDRdTKAT9WHoc/IL/p7w4sptcdmtpFR6IcZRnNXDnaT909x7Ykjj6PwmlFdP9FMuWgQvb8nAiKpHB7iS4/r+pk678LRCWOGpq9QwfOlOGlbpDkEPwThngKL7puibAY5LvMl+ZQQ8Yx4mxF/wZjkGJ7a3NjKl5jyjiJ/hAhLzVVExN+9qMpZsAyWImhu/eF2NlfcmS6bxq6lNlO9CZvxpjon/G7R5k1SqVwuFwOv3HTTZn0TTelSQs2wtjpPkNH8D/RH++b3mkosx0KLkzSlfi92qSrzPKX2arMTe692ChjJ7T5I75t3I487EIe5jXKQ6pg6Q83qs/lEn3noSFynmb4aOrBF9sEoBuHhKFYcL11up41emofLCQGE60wVdeDClSvn5qqM41Go7t+iuWUHqzrNrOGWTsFst5TtwLXXPk0Syc9fSX2rsBFmzadY6C/Fge8d+e5uXHkfyiQRc6vwTu2Ylkhz95Fq2/8+YVv/CxSqb7xxyqhDjDBRxFBxcQnSYzeBfrYNqGJjej4TLDfWEywII42hqZ+/BB/6I2DkCn0WS9uv3PD4Z0DpG/3oemDe7u5NS/aMOWtol60t2qCusYTSi19uHn1iHiQOpz2i2v6xx/4xqE9PfyqHQ+N3Ln9RftsmoxADcYAyvMt9Y73lr7wdwTUmb8g/u53GOaw6pPizJC9MJrEj7noG9sG1CNhmWN2BcF2dpRzGBfz5XrojEWZRxuj6aCYY0tiLJOTMmK2uJJQjxj/8hjKEB1iGHCj4JTpxczQzEtehAevG+5pUO12twtCjfG4I979yJB4a7RlZbDdVGV1OMgDQPZQY+ERm1wqiVyYJwJHMrGaP+o9YKbUlE2ApL6YEiyylNT9ESff74qtvCgqNSZcBVOa+2Hr9q9E70rVikGTcxRJ4BSQa6ImzpQIEXk+OFbqhvQRQ4souDWotqAiL2Xqm+AZ/Yz0kXcCOnvfqg1779vzOXtqtvPMii9Ig5+dwj87Kf4bQ6EJfdRt4PyQZYFY0/NXERbE5vPzi+As2njhToFqfp7h6ufXYTFiZ6MCryyG/xQX5qIBFddLfr6b+SYsHc3P1ocikRD5rxCMuNslxeBKuiZjzQpUY6kFvwNgPtyioHRxkEr9fv+HE5AwHFc9q0neOXOa/kiAi9ByQX3et1fZb2+q7yCL914QN5y1GVt/DOVaR29JPCECXV9iGaI84A7sQ9W3Y4dLZe4vVR1Mxd3Hc7rq7lNVOKjqHM9xqmiceVWXNTgoiO6fswpN0R/EfnefyHtnMvcsdw1nzMOJiSzGpQ+SPmclxmVRqlVM0HG5wNFSQYAIRhjE3ZDTsobwJbifVegTxj7sx7mCRwvp5XSWh6/QYs/TwjyMahKsVCYZVaeECMTR56MplPyzCfrSPO/dL0m8RwvpQ1oS56aF7i/58Mpn0eOHaKxcTNGd84cLd4oCvXPu3B+4a8kPUA7rmSzJ7E3Zy7OzuJEm/Mt+7Eh/pyDPMx7xF7luuh/CY9hDe4WZYLqvW+YhFlJiWX1PO0aOB6L0t3AVOUK7V/XSqP8Dx/CavHCY8erwC3jhyKHZR2nu9wXvpz4vKN4dwOIA22sZ/S1RTbhyBxbvF/XeXzEQpfEUTa0hLTTE+RigN9vzQhBp0RzT5OUaKazwlhEU8u0fx8D9XmGdwVmmZmpavDGuichhJJUz1nn5pp9yj5H3GG7DgZtovmnn5YNFiiT/JyIZqw6Uvd+i0TRIFwumFw7SVEg/TYvQDM/8hE9O4uTWEVlECuyU2tLW1oKK3jIk+bItDxy6TZKw36mttdZgKDxo1fIRzrFMSbrt0J/Cl8KVh1OcozuqGUyO7RxLBk3UrA6XfmDTF97qwAErpOl655GnjnTqOidyIQsHO08G/hcLt/j/AAB4nGNgZGBgAOLaW41M8fw2Xxm4mV8ARRguss1QhNC5H/9//Z/FUsEcBORyMDCBRAFTFwxveJxjYGRgYA76n8UQxVLGwPD/FUsFA1AEBfgBAHyYBUh4nGN+wcDAvACCWfSBNIgviMBM1kA6koGBMRWVBqsDYqYmiF4wHQkxg+kUBMPVWEP0gTDYvBdoahZAzYxEY0ciuWUBFjkoZimDYLC8IKpehmsQccYvSGYgYZB7YBhFL5o8cxTQjDUI/wIArpclrwAAAAAAAAA6AIYA3AEKAUgBgAGgAfoCYgKqAwIDOgOGA9wEQAR4BLYFAgU8BZoFzAYMBlIGmga6BtgG+AcYB0QHcAecB8gIAAg2CG4IpgjyCUAJrAo0CtALOAueDAoMYA0ADVANjg3mDiQOjg7GDvgPOA+ED84QPBB2EN4RNhGgEfISchKoEsgS6BMGEz4TXhOSE8QT+BQsFGIUiBTWFX0AAAABAAAATgBuAAYAAAAAAAIAAAAQAHMAAAAiC3AAAAAAeJx1kctOGzEUhn9DoIKgLloJdcdZIRDK5CKhSqyoogJrhLJDwgyeSzpjRx4HlGfgLcoz8Dp9j+76Z2KhqFJmZM93Ph/bxx4AX/AHCqvnnG3FCgeMVryFT/gReZv+JnKHfBd5B108RN6l/xV5H2d4idzFV/zmCqqzx2iK98gK39RR5C18Vt8jb9P/jNwh30fewaGaR96lf428j4l6i9zFsfo7drOFL/MiyMn4VEaD4bk8LsRRlVZXouehcL6RS8mcDaaqXJK6OtSml+lemTrb3Jp8Xmm/rtZ5YnxTOivDZLCur401XgfztNytec5HIWSSeVfLVdxHZt5NTRqSIoTZRb+/vj/GcJhhAY8SOQoECE5oT/kdYYAhf4zgkRnCzFVWCQuNikZjzhlFO9IwvmTLGFlaw4yKnCBlX9PUdD2Oa/Zlay1n3dLmXKei9xuzNvkJ7XLvso2F9SaselP2Na1tZ+i2wqePszV4ZhUj2sBZy1P4tmrB1X/nEd7XcmxKk9In7a0F2gv0+W44/z/KQo7lAHicbZLnlpswEIW5Bgy4bLLpvfeE9N57z76DLARWEJKOEEucpw8CO/kTncOdT6PhnlHxRt4wJt7/x47nYQQfAUKMESFGggmmmGGOLezBXmxjH/bjAA7iEA7jCI7iGI7jBE7iFE7jDM7iHM7jAi7iEi7jCq7iGq7jBlLcxC3cxh3cxT3cxwM8xCM8xhM8xTM8xwu8xCu8xhu8xTu8xwd8xCd8xhd8xTd8xw/sBLUlZuIkZZW2q0hzahvDRqocUyIpE4EWTR1WXDZ1sGRCz5yklBsqWBZwmauZk01mTqxl0nIlUyLs9r/Zej35m4kFl2XKftlAKFomTlKlmfQ1l74lRdB9dbxQqqyIKbc2MPQZGqbFKsqVaYnJ4ky1Ms24iQXLrYPE8GLZ07jRfaIvcf5JX+NoMhQ5jLoqFwenBS8Gpw7WTh05py6MaOtT2ibEGNXWKW1Da0i9nPY6dNe7CEWy7pc+5EJpvfJVnvtUFUHFZBPWS2LYxKqiECztVpINypAuGS2nvQ6Gs+H0hsk0U3ZznDETguua1/MNpLvMWH/RFGEuuobCihScxqS2zPC6jH4rVaVcxn1UjQ1yJW1QK2MTJ6nrPOqp0d3Vk1WoSVOz7p0oHeWdTbpoh5i3sVWpezp23AGTWch+Mmonu0o0Vb+l6RqdabLmRnveH9ru7j54nGPw3sFwIihiIyNjX+QGxp0cDBwMyQUbGVidNjIwaEFoDhR6JwMDAycyi5nBZaMKY0dgxAaHjoiNzCkuG9VAvF0cDQyMLA4dySERICWRQLCRgUdrB+P/1g0svRuZGFwAB9MiuAAAAA==) format('woff')}</style>
<style id="style-core" type="text/css">html{font:16px/1 Helmet,Freesans,sans-serif}#store-area,tw-storydata{display:none!important;z-index:0}.no-transition{-webkit-transition:none!important;-o-transition:none!important;transition:none!important}:focus{outline:thin dotted}body{color:#eee;background-color:#111}a{cursor:pointer;color:#68d;text-decoration:none;-webkit-transition-duration:.2s;-o-transition-duration:.2s;transition-duration:.2s}a:hover{color:#8af;text-decoration:underline}a.link-broken{color:#c22}a.link-broken:hover{color:#e44}span.link-disabled{color:#aaa}area{cursor:pointer}button{cursor:pointer;color:#eee;background-color:#35a;border:1px solid #57c;line-height:normal;padding:.4em;-webkit-transition-duration:.2s;-o-transition-duration:.2s;transition-duration:.2s;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}button:hover{background-color:#57c;border-color:#79e}button:disabled{cursor:not-allowed;background-color:#444;border:1px solid #666}input,select,textarea{color:#eee;background-color:transparent;border:1px solid #444;padding:.4em}select{padding:.34em .4em}input[type=text]{min-width:18em}textarea{min-width:30em}input[type=checkbox],input[type=file],input[type=radio],select{cursor:pointer}input:focus,input:hover,select:focus,select:hover,textarea:focus,textarea:hover{background-color:#333;border-color:#eee}hr{display:block;height:1px;border:none;border-top:1px solid #eee;margin:1em 0;padding:0}textarea{resize:vertical}audio,canvas,progress,video{max-width:100%;vertical-align:middle}.error{padding:.25em;background-color:#511;border-left:.5em solid #c22}.error[title]{cursor:help}.highlight,.marked{color:#ff0;font-weight:700;font-style:italic}.nobr{white-space:nowrap}.error:before,[data-icon-after]:after,[data-icon-before]:before,[data-icon]:before,a.link-external:after{font-family:tme-fa-icons;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;speak:none}[data-icon]:before{content:attr(data-icon)}[data-icon-before]:before{content:attr(data-icon-before) "\00a0"}[data-icon-after]:after{content:"\00a0" attr(data-icon-after)}.error:before{content:"\00a0\e80d\00a0\00a0"}a.link-external:after{content:"\00a0\e80e"}</style>
<style id="style-core-display" type="text/css">#story{z-index:10;margin:2.5em;-webkit-transition:margin-left .2s ease-in;-o-transition:margin-left .2s ease-in;transition:margin-left .2s ease-in}@media screen and (max-width:1136px){#story{margin-right:1.5em}}#passages{max-width:54em;margin:0 auto}</style>
<style id="style-core-passage" type="text/css">.passage{line-height:1.75;text-align:left;-webkit-transition:opacity .4s ease-in;-o-transition:opacity .4s ease-in;transition:opacity .4s ease-in}.passage-in{opacity:0}.passage ol,.passage ul{margin-left:.5em;padding-left:1.5em}.passage table{margin:1em 0;border-collapse:collapse;font-size:100%}.passage caption,.passage td,.passage th,.passage tr{padding:3px}.passage .error{white-space:nowrap}</style>
<style id="style-core-macro" type="text/css">.macro-linkappend-insert,.macro-linkprepend-insert,.macro-linkreplace-insert,.macro-repeat-insert,.macro-timed-insert{-webkit-transition:opacity .4s ease-in;-o-transition:opacity .4s ease-in;transition:opacity .4s ease-in}.macro-linkappend-in,.macro-linkprepend-in,.macro-linkreplace-in,.macro-repeat-in,.macro-timed-in{opacity:0}</style>
<style id="style-ui-dialog" type="text/css">html[data-dialog] body{overflow:hidden}#ui-overlay.open{visibility:visible;-webkit-transition:opacity .2s ease-in;-o-transition:opacity .2s ease-in;transition:opacity .2s ease-in}#ui-overlay:not(.open){-webkit-transition:visibility .2s step-end,opacity .2s ease-in;-o-transition:visibility .2s step-end,opacity .2s ease-in;transition:visibility .2s step-end,opacity .2s ease-in}#ui-overlay{visibility:hidden;opacity:0;z-index:1000;position:fixed;top:0;left:0;height:100%;width:100%}#ui-dialog.open{display:block;-webkit-transition:opacity .2s ease-in;-o-transition:opacity .2s ease-in;transition:opacity .2s ease-in}#ui-dialog{display:none;opacity:0;z-index:1100;position:fixed;top:50px;margin:0;padding:0}#ui-dialog-titlebar{position:relative}#ui-dialog-close{display:block;position:absolute;right:0;top:0;white-space:nowrap}#ui-dialog-body{overflow:auto;min-width:280px;height:90%;height:calc(100% - 2.1em - 34px)}#ui-overlay{background-color:#000}#ui-overlay.open{opacity:.8}#ui-dialog{max-width:66em}#ui-dialog.open{opacity:1}#ui-dialog-titlebar{background-color:#444;min-height:24px}#ui-dialog-title{margin:0;padding:.2em 3.5em .2em .5em;font-size:1.5em;text-align:center;text-transform:uppercase}#ui-dialog-close{cursor:pointer;font-size:120%;margin:0;padding:0;width:3.6em;height:92%;background-color:transparent;border:1px solid transparent;-webkit-transition-duration:.2s;-o-transition-duration:.2s;transition-duration:.2s}#ui-dialog-close:hover{background-color:#b44;border-color:#d66}#ui-dialog-body{background-color:#111;border:1px solid #444;text-align:left;line-height:1.5;padding:1em}#ui-dialog-body>:first-child{margin-top:0}#ui-dialog-body hr{background-color:#444}#ui-dialog-body ul.buttons{margin:0;padding:0;list-style:none}#ui-dialog-body ul.buttons li{display:inline-block;margin:0;padding:.4em .4em 0 0}#ui-dialog-body ul.buttons>li+li>button{margin-left:1em}#ui-dialog-close{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#ui-dialog-close{font-family:tme-fa-icons;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;speak:none}</style>
<style id="style-ui" type="text/css">#ui-dialog-body.settings [id|=setting-body]{display:table;width:100%}#ui-dialog-body.settings [id|=setting-label]{display:table-cell;padding:.4em 2em .4em 0}#ui-dialog-body.settings [id|=setting-label]+div{display:table-cell;min-width:8em;text-align:right;vertical-align:middle;white-space:nowrap}#ui-dialog-body.list{padding:0;min-width:140px}#ui-dialog-body.list ul{margin:0;padding:0;list-style:none;border:1px solid transparent}#ui-dialog-body.list li{margin:0}#ui-dialog-body.list li:not(:first-child){border-top:1px solid #444}#ui-dialog-body.list li a{display:block;padding:.25em .75em;border:1px solid transparent;color:#eee;text-decoration:none}#ui-dialog-body.list li a:hover{background-color:#333;border-color:#eee}#ui-dialog-body.saves{padding:0 0 1px}#ui-dialog-body.saves>:not(:first-child){border-top:1px solid #444}#ui-dialog-body.saves table{border-spacing:0;min-width:340px;width:100%}#ui-dialog-body.saves tr:not(:first-child){border-top:1px solid #444}#ui-dialog-body.saves td{padding:.33em .33em}#ui-dialog-body.saves td:first-child{min-width:1.5em;text-align:center}#ui-dialog-body.saves td:nth-child(3){line-height:1.2}#ui-dialog-body.saves td:last-child{text-align:right}#ui-dialog-body.saves .empty{color:#999}#ui-dialog-body.saves .datestamp{font-size:75%}#ui-dialog-body.saves ul.buttons li{padding:.4em}#ui-dialog-body.saves ul.buttons>li+li>button{margin-left:.2em}#ui-dialog-body.saves ul.buttons li:last-child{float:right}#ui-dialog-body.settings div[id|=header-body]{margin:1em 0}#ui-dialog-body.settings div[id|=header-body]:first-child{margin-top:0}#ui-dialog-body.settings div[id|=header-body]:not(:first-child){border-top:1px solid #444;padding-top:1em}#ui-dialog-body.settings div[id|=header-body]>*{margin:0}#ui-dialog-body.settings h2[id|=header-heading]{font-size:1.375em}#ui-dialog-body.settings p[id|=header-label]{font-size:87.5%}#ui-dialog-body.settings div[id|=setting-body]+div[id|=setting-body]{margin:.5em 0}#ui-dialog-body.settings [id|=setting-control]{white-space:nowrap}#ui-dialog-body.settings button[id|=setting-control]{color:#eee;background-color:transparent;border:1px solid #444;padding:.4em}#ui-dialog-body.settings button[id|=setting-control]:hover{background-color:#333;border-color:#eee}#ui-dialog-body.settings button[id|=setting-control].enabled{background-color:#282;border-color:#4a4}#ui-dialog-body.settings button[id|=setting-control].enabled:hover{background-color:#4a4;border-color:#6c6}#ui-dialog-body.share{min-width:140px}#ui-dialog-body.list a,#ui-dialog-body.settings span[id|=setting-input]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#ui-dialog-body.saves button[id=saves-clear]:before,#ui-dialog-body.saves button[id=saves-export]:before,#ui-dialog-body.saves button[id=saves-import]:before,#ui-dialog-body.settings button[id|=setting-control].enabled:after,#ui-dialog-body.settings button[id|=setting-control]:after{font-family:tme-fa-icons;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;speak:none}#ui-dialog-body.saves button[id=saves-export]:before{content:"\e829\00a0"}#ui-dialog-body.saves button[id=saves-import]:before{content:"\e82a\00a0"}#ui-dialog-body.saves button[id=saves-clear]:before{content:"\e827\00a0"}#ui-dialog-body.settings button[id|=setting-control]:after{content:"\00a0\00a0\e830"}#ui-dialog-body.settings button[id|=setting-control].enabled:after{content:"\00a0\00a0\e831"}</style>
<style id="style-ui-bar" type="text/css">#story{margin-left:20em}#ui-bar.stowed~#story{margin-left:4.5em}@media screen and (max-width:1136px){#story{margin-left:19em}#ui-bar.stowed~#story{margin-left:3.5em}}@media screen and (max-width:768px){#story{margin-left:3.5em}}#ui-bar{position:fixed;z-index:50;top:0;left:0;width:17.5em;height:100%;margin:0;padding:0;-webkit-transition:left .2s ease-in;-o-transition:left .2s ease-in;transition:left .2s ease-in}#ui-bar.stowed{left:-15.5em}#ui-bar-body{height:90%;height:calc(100% - 2.5em);margin:2.5em 0;padding:0 1.5em}#ui-bar.stowed #ui-bar-body,#ui-bar.stowed #ui-bar-history{visibility:hidden;-webkit-transition:visibility .2s step-end;-o-transition:visibility .2s step-end;transition:visibility .2s step-end}#ui-bar{background-color:#222;border-right:1px solid #444;text-align:center}#ui-bar-tray{position:absolute;top:.2em;left:0;right:0}#ui-bar a{text-decoration:none}#ui-bar hr{border-color:#444}#ui-bar-history [id|=history],#ui-bar-toggle{font-size:1.2em;line-height:inherit;color:#eee;background-color:transparent;border:1px solid #444}#ui-bar-toggle{display:block;position:absolute;top:0;right:0;border-right:none;padding:.3em .45em .25em}#ui-bar.stowed #ui-bar-toggle{padding:.3em .35em .25em .55em}#ui-bar-toggle:hover{background-color:#444;border-color:#eee}#ui-bar-history{margin:0 auto}#ui-bar-history [id|=history]{padding:.2em .45em .35em}#ui-bar-history #history-jumpto{padding:.2em .665em .35em}#ui-bar-history [id|=history]:not(:first-child){margin-left:1.2em}#ui-bar-history [id|=history]:hover{background-color:#444;border-color:#eee}#ui-bar-history [id|=history]:disabled{color:#444;background-color:transparent;border-color:#444}#ui-bar-body{line-height:1.5;overflow:auto}#ui-bar-body>:not(:first-child){margin-top:2em}#story-title{margin:0;font-size:162.5%}#story-author{margin-top:2em;font-weight:700}#menu ul{margin:1em 0 0;padding:0;list-style:none;border:1px solid #444}#menu ul:empty{display:none}#menu li{margin:0}#menu li:not(:first-child){border-top:1px solid #444}#menu li a{display:block;padding:.25em .75em;border:1px solid transparent;color:#eee;text-transform:uppercase}#menu li a:hover{background-color:#444;border-color:#eee}#menu a,#ui-bar-history [id|=history],#ui-bar-toggle{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#menu-core li[id|=menu-item] a:before,#ui-bar-history [id|=history],#ui-bar-toggle:before{font-family:tme-fa-icons;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;speak:none}#ui-bar-toggle:before{content:"\e81d"}#ui-bar.stowed #ui-bar-toggle:before{content:"\e81e"}#menu-item-saves a:before{content:"\e82b\00a0"}#menu-item-settings a:before{content:"\e82d\00a0"}#menu-item-restart a:before{content:"\e82c\00a0"}#menu-item-share a:before{content:"\e82f\00a0"}</style>
<style id="style-debugview" type="text/css">#ui-bar-body>#debug-view-toggle:first-child{margin-top:1em}#ui-bar-body>#debug-view-toggle:first-child+*{margin-top:1em}#debug-view-toggle{text-transform:uppercase}#debug-view-toggle:after,#debug-view-toggle:before{font-family:tme-fa-icons;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;speak:none}#debug-view-toggle:before{content:"\e838\00a0"}html:not([data-debug-view]) #debug-view-toggle{color:#eee;background-color:transparent;border:1px solid #444;padding:.4em}html:not([data-debug-view]) #debug-view-toggle:hover{background-color:#333;border-color:#eee}html:not([data-debug-view]) #debug-view-toggle:after{content:"\00a0\00a0\e830"}html[data-debug-view] #debug-view-toggle{background-color:#282;border-color:#4a4}html[data-debug-view] #debug-view-toggle:hover{background-color:#4a4;border-color:#6c6}html[data-debug-view] #debug-view-toggle:after{content:"\00a0\00a0\e831"}html[data-debug-view] .debug{padding:.25em;background-color:#234}html[data-debug-view] .debug[title]{cursor:help}html[data-debug-view] .debug.block{display:inline-block;vertical-align:middle}html[data-debug-view] .debug.invalid{text-decoration:line-through}html[data-debug-view] .debug.hidden,html[data-debug-view] .debug.hidden .debug{background-color:#555}html:not([data-debug-view]) .debug.hidden{display:none}html[data-debug-view] .debug[data-name][data-type].nonvoid:after,html[data-debug-view] .debug[data-name][data-type]:before{background-color:rgba(0,0,0,.25);font-family:monospace,monospace;white-space:pre}html[data-debug-view] .debug[data-name][data-type]:before{content:attr(data-name)}html[data-debug-view] .debug[data-name][data-type|=macro]:before{content:"<<" attr(data-name) ">>"}html[data-debug-view] .debug[data-name][data-type|=macro].nonvoid:after{content:"<</" attr(data-name) ">>"}html[data-debug-view] .debug[data-name][data-type|=html]:before{content:"<" attr(data-name) ">"}html[data-debug-view] .debug[data-name][data-type|=html].nonvoid:after{content:"</" attr(data-name) ">"}html[data-debug-view] .debug[data-name][data-type]:not(:empty):before{margin-right:.25em}html[data-debug-view] .debug[data-name][data-type].nonvoid:not(:empty):after{margin-left:.25em}html[data-debug-view] .debug[data-name][data-type|=special],html[data-debug-view] .debug[data-name][data-type|=special]:before{display:block}</style>
</head>
<body>
	<div id="init-screen">
		<div id="init-no-js"><noscript>JavaScript is required. Please enable it to continue.</noscript></div>
		<div id="init-lacking">Your browser lacks required capabilities. Please upgrade it or switch to another to continue.</div>
		<div id="init-loading"><div>Loading&hellip;</div></div>
	</div>
	<div id="store-area" hidden><tw-storydata name="Queen of the Seas" startnode="101" creator="Tweego" creator-version="1.0.1" ifid="2281ACF9-AFF5-4833-BD11-9D4317BCE5AE" format="SugarCube" format-version="2.19.0" options="" hidden><style role="stylesheet" id="twine-user-stylesheet" type="text/twine-css">/* twine-user-stylesheet #1: "custom.css" */
/* MY specific styles */

#story-title { 
	font-size:large;
	text-align: center;
}

#fixed-font {
	font-family: monospace;
	font-size: 14px;
	font-style: normal;
	font-variant: normal;
	font-weight: 400;
	line-height: 20px
}
#Energy {
	font-family: monospace;
	font-size: 14px;
	font-style: normal;
	font-variant: normal;
	font-weight: 400;
	line-height: 20px
}

#Health {
	font-family: monospace;
	font-size: 14px;
	font-style: normal;
	font-variant: normal;
	font-weight: 400;
	line-height: 20px
}

#Nutrition {
	font-family: monospace;
	font-size: 14px;
	font-style: normal;
	font-variant: normal;
	font-weight: 400;
	line-height: 20px
}

#ui-bar {
	padding: 0 0 0 0;
}

#ui-bar header {
	text-align: left;
}
#ui-bar-body>:not(:first-child) {
	margin-top: 0.5em;
}

#menu {
	position: absolute;
	bottom: 10px;
	width: 215px;
}

#story-caption {
	padding: 0;
	text-align: left;
}

#story-author {
	display:none;
}

input[type="text"] {
	min-width: 10em;
}


#score-table table, td {
	  padding: 1px 5px 1px 5px;
	  text-align: left;
}

.storeButton button {
	width: 100px; !important;
	color: White;
	background-color: CornflowerBlue;
	font-size: smaller;
	border-radius: 12px;
	padding: 4px;
	width: 100px;
}

.disabledStoreButton button {
	width: 100px; !important;
  opacity: 0.6; 
  cursor: not-allowed !important;
	color: White;
	background-color: CornflowerBlue;
	font-size: smaller;
	border-radius: 12px;
	padding: 4px;	
}

.wardrobeButton button {
	width: 80px; !important;
	color: White;
	background-color: CornflowerBlue;
	font-size: smaller;
	border-radius: 12px;
	padding: 4px;
}

.disabledWardrobeButton button {
	width: 80px; !important;
  opacity: 0.6; 
  cursor: not-allowed !important;
	color: White;
	background-color: CornflowerBlue;
	font-size: smaller;
	border-radius: 12px;
	padding: 4px;	
}


.cmdButton button {
	width: 140px; !important;
	color: White;
	background-color: SlateGrey;
	font-size: smaller;
	padding: 4px;
}

.cmdDisabledButton button {
	opacity: 0.6; 
  cursor: not-allowed !important;
	width: 140px; !important;
	color: White;
	background-color: SlateGrey;
	font-size: smaller;
	padding: 4px;
}

.passage {
	line-height: 1.50;
	text-align: left;
}
.passage-in {
	opacity: 0;
}
.passage ul, .passage ol {
	margin-left: 0.5em;
	padding-left: 1.5em;
}
.passage table {
	margin: 0;
	border-collapse: collapse;
  border: 0;
  font-size: 100%;
  font: inherit;
  vertical-align: baseline;	
}
.passage tr, .passage th, .passage td, .passage caption {
	line-height: 1.0; !important;
	padding: 2px 3px 2px 3px; !important;
}
/* twine-user-stylesheet #2: "Story Stylesheet" */
</style><script role="script" id="twine-user-script" type="text/twine-javascript">/* twine-user-script #1: "CombatEngine.js" */
window.App = window.App || { Data: { }, Entity: { } };


window.App.CombatEngine = new function()
{
    /** Array of current enemies.
     * @type {Array}
     * @private */
    this._Enemies = [ ];

    /** Returns the enemies for the encounter.
     * @returns {Array.<Enemy>}
     */
    this.GetEnemies = function() {
      return this._Enemies;
    };

    /**
     * Load an encounter into the _Enemies array.
     * @param {string} Key
     */
    this.LoadEncounter = function(Key)
    {
        this._Enemies = [ ];

        var EncounterList = App.Data.Encounters[Key];
        var Encounter;
        var Chance = Math.floor((Math.random() * 99)+1);

        for (var i = 0; i < EncounterList.length; i++) {
            Encounter = EncounterList[i];
            if (Chance <=  Encounter["CHANCE"]) break;
        }

        for (var j = 0; j < Encounter["ENEMIES"].length; j++)
            this._MakeEnemy( Encounter["ENEMIES"][j] );

    };

    /**
     * Make an enemy object.
     * @param {object} EnemyData
     * @private
     */
    this._MakeEnemy = function(EnemyData)
    {
        console.log(JSON.stringify(EnemyData));

        var NumberAppearing = Math.max(EnemyData["MIN"], Math.min(Math.floor( (Math.random() * EnemyData["MAX"]) +1), EnemyData["MAX"]));

        for (var c = 0; c < NumberAppearing; c++)
            this._Enemies.push( new this.Enemy( App.Data.Enemies[EnemyData["ENEMY"]]));
    };

    /**
     * An "ENEMY" to fight in combat.
     * @param {Object} Data
     * @constructor
     */
    this.Enemy = function(Data)
    {
        /** @type {Object}
         * @private */
        this._Data = Data;

        /** @returns {string} */
        this.Name = function() { return  this._Data["NAME"]; };

        /** @returns {string} */
        this.ShortDesc = function() { return this._Data["NAME"]; };

        /** @returns {*} */
        this.GetStat = function(StatName) { return this._Data[StatName]; };

        /** @param {string} StatName
         * @param {number} Value */
        this.AdjustStat = function(StatName, Value) { this._Data[StatName] += Value; };

        /** @returns {string} */
        this.HealthMeter = function() { return App.PR.pMeter( this.GetStat("Health"), this.GetStat("MaxHealth"), 0); };

        /** @returns {string} */
        this.EnergyMeter = function() { return App.PR.pMeter( this.GetStat("Energy"), this.GetStat("MaxEnergy"), 0); };

    };
};


/* twine-user-script #2: "Helpers.js" */
window.App = window.App || { Data: { }, Entity: { } };

window.App.PR = new function() {

    /**
     * Fetch a rating for a statistic/value
     * @param Type
     * @param Value
     * @param [Colorize]
     * @returns {string}
     */
	    this.GetRating = function (Type, Value, Colorize) {
            Colorize    = Colorize || false;
            var Rating  = window.App.Data.Ratings[Type];

            for (var prop in Rating) {
                if (!Rating.hasOwnProperty(prop)) continue;

                if ((Value <= prop) && (Colorize == true)) return this.ColorizeString(Value, Rating[prop]);
                if (Value <= prop) return Rating[prop];
            }

            return "Untyped rating: " + Type + "," + Value;
        };

    /**
     * Helper function. Checks relevant statistic config and returns an ADJECTIVE (colorized) for use if one exists.
     * @param {string} Type
     * @param {string} Stat
     * @param {number} Value
     * @returns {string}
     */
        this.GetAdjective = function(Type, Stat, Value)
        {
            var Ratings = this.GetStatConfig(Type)[Stat]["LEVELING"];
            var Arr = window.App.Data.Lists.ColorScale;
            for (var prop in Ratings) {
                if (!Ratings.hasOwnProperty(prop)) continue;
                if (Value <= prop)
                    return "@@color:" + Arr[Ratings[prop]["COLOR"]] + ";" + Ratings[prop]["ADJECTIVE"] +"@@";
            }
            return "";
        };

    /**
     *
     * @param {App.Entity.Player} Player
     * @param {string} Type
     * @param {string} Stat
     * @param {string} String
     * @returns {string}
     */
    this.TokenizeRating = function(Player, Type, Stat, String)
    {
        String = String.replace(/PLAYER_NAME/g, Player.SlaveName);
        String = String.replace(/pBUST/g, this.pBust(Player, 1));
        String = String.replace(/pASS/g, this.pBust(Player, 1));
        String = String.replace(/pCUP/g, this.pCup(Player));
        String = String.replace(/pHIPS/g, this.pHips(Player, 1));
        String = String.replace(/pHORMONES/g, this.pHormones(Player, 1));
        String = String.replace(/ADJECTIVE/g, this.GetAdjective(Type, Stat, Player.GetStat(Type, Stat)));
        String = String.replace(/INCHES/g, this.CMtoINCH(this.StatToCM(Player,Stat)).toString());

        return String;
    };

    /**
     * Helper function for getting stat configurations.
     * @param Type
     * @returns {*}
     */
        this.GetStatConfig = function (Type) {
            if (Type == "STAT") return window.App.Data.Lists.StatConfig;
            if (Type == "SKILL") return window.App.Data.Lists.SkillConfig;
            if (Type == "BODY") return window.App.Data.Lists.BodyConfig;
        };

    /**
     * Colorizes and returns a string primitive
     * @param {number} Value
     * @param {string} String
     * @param {number} [Opt]
     * @returns {string}
     */
        this.ColorizeString = function (Value, String, Opt) {
                //return "@@color:" + this.ColorScale(Value, Opt) + ";" + String + "@@("+Value+")";
                return "@@color:" + this.ColorScale(Value, Opt) + ";" + String + "@@";
        };

		this.ColorizeMeter = function (n, s) {
                var Colors = ["red", "brown", "yellow", "cyan", "lime"];
                var cIndex = Math.max(0, Math.min(Math.round(((n / 20) - 1)), 4));
                return "@@color:" + Colors[cIndex] + ";" + s + "@@";
        };

    /**
     * Returns a color that defines the percentage type of the "Value" passed.
     * @param {number} Value
     * @param {number} [Opt] - Defaults to 100, Percent = Value / Opt
     * @returns {string}
     */
        this.ColorScale = function(Value, Opt) {
            var Max = Opt || 100;
            var Arr = window.App.Data.Lists.ColorScale;
            if (Value > Opt ) Value = Opt;
            return Arr[Math.floor( Math.max(0, Math.min((Arr.length * (Value/Max)-1),(Arr.length-1))))];
        };

    /**
     * Prints out a 10 star meter surrounded with brackets.
     * @param {number} Score - Current stat/score
     * @param {number} MaxScore - Maximum stat/score
     * @param {number} InvertMeter - reverse direction of stars relative to score so that high scores are less stars.
     * @returns {string}
     */
        this.pMeter = function (Score, MaxScore, InvertMeter) {
				Score = Math.max(0, Math.min(Score, MaxScore));
                var units = (MaxScore / 10);
                var Stars = Math.floor((Score / units));
                var sMeter = "";
				var nMeter = (InvertMeter == 1) ? (100 - (10 * Stars)) : (10 * Stars);
				var i = 0;

				for (i = 0; i < Stars; i++)
					sMeter += "&#9733;";
				sMeter = this.ColorizeMeter(nMeter, sMeter);

				if ( (10 - Stars ) != 0) {
					sMeter += "@@color:grey;";
					for (i = 0; i < (10 - Stars); i++)
						sMeter += "&#9733;";
						sMeter += "@@";
					}

				return "[" + sMeter + "]"
        };

    /**
     * Simple calculator turns CM into Inches.
     * @param {number} n
     * @returns {number}
     */
        this.CMtoINCH = function (n) {
            return Math.round(n * 0.393700);
        };

    /**
     * Lookup a body part's configuration entry and figure out the current CM size of it for the player.
     * @param {App.Entity.Player} Player
     * @param {string} StatName - currently supported: Bust, Ass, Hips, Waist, Penis
     * @param {number} [Adjust] - Optional arg: adjust stat by this and report figure.
     * @returns {number}
     */
        this.StatToCM = function(Player, StatName, Adjust)
        {
            if (typeof Adjust === 'undefined') Adjust = 0;
            if (typeof Player.GetStatConfig("BODY")[StatName] === 'undefined') return 0;

            var CMScale = Player.GetStatConfig("BODY")[StatName]["CM_MAX"] - Player.GetStatConfig("BODY")[StatName]["CM_MIN"];
            return ( CMScale * ( (Player.GetStatPercent("BODY", StatName)+Adjust) / 100)) + Player.GetStatConfig("BODY")[StatName]["CM_MIN"];
        };

    /**
     * Convert Ass stat into CM
     * @param {App.Entity.Player} Player
     * @returns {number}
     */
        this.AssCCtoCM = function (Player) { return this.StatToCM(Player, "Ass"); };

    /**
     * Convert Waist Stat into CM.
     * @param Player
     * @returns {number}
     */
        this.WaistInCM = function (Player) { return this.StatToCM(Player, "Waist"); };

    /**
     * Convert Hips Stat into CM.
     * @param {window.App.Entity.Player} Player
     * @returns {number}
     */
        this.HipsInCM = function (Player) { return this.StatToCM(Player, "Hips"); };

    /**
     * Convert Bust Stat into CM.
     * @param {App.Entity.Player} Player
     * @returns {number}
     */
        this.BustCCtoCM = function (Player) { return this.StatToCM(Player, "Bust"); };

    /**
     * Print out a 10 star colorized stat meter for a statistic.
     * @param {string} StatName
     * @param {App.Entity.Player} Player
     * @param {number} [Invert] - reverse direction of stars relative to score so that high scores are less stars.
     */
		this.pStatMeter = function(StatName, Player, Invert) {
            var Opt = Invert || 0;
            var StatValue = Player.GetStat("STAT", StatName);

            if (StatName == "Hormones" ) {
                if (StatValue > 100 ) // Return "Female" version of this meter.
                    return this.pMeter( (Player.GetStat("STAT", "Hormones") - 100), 100, 0);
                if (StatValue <= 100)
                    return this.pMeter( (100 - StatValue), 100, 0);
            }

            return this.pMeter( Player.GetStat("STAT", StatName), Player.GetMaxStat("STAT", StatName), Opt);
        };

    /**
     * Print out a 10 star colorized stat meter for a skill.
     * @param {string} StatName
     * @param {App.Entity.Player} Player
     * @param {number} [Invert] - reverse direction of stars relative to score so that high scores are less stars.
     */
        this.pSkillMeter = function(StatName, Player, Invert) { return this.pMeter( Player.GetStat("SKILL", StatName), 100, Invert); };

    /**
     * Print out a 10 start colorized state meter for a particular fashion style
     * @param {string} Style
     * @param {App.Entity.Player} Player
     * @returns {string}
     */
        this.pStyleMeter = function(Style, Player) { return this.pMeter( Player.GetStyleSpecRating(Style), 100, 0); };

    /**
     * Print out a 10 star colorized stat meter for a body part.
     * @param {string} StatName
     * @param {App.Entity.Player} Player
     * @param {number} [Invert] - reverse direction of stars relative to score so that high scores are less stars.
     */
        this.pBodyMeter = function(StatName, Player, Invert) { return this.pMeter( Player.GetStat("BODY", StatName), 100, Invert);};

    /**
     * Finds and prints out the NPC quest dialog as a string.
     * @param {string} QuestID - ID of the Quest.
     * @param {string} Stage - INTRO, MIDDLE, FINISH
     * @param {App.Entity.Player} Player
     * @param {string} NPC - String, ID of the NPC in Player.NPCS array.
     */
        this.pQuestDialog = function(QuestID, Stage, Player, NPC) { return this.TokenizeString(Player, NPC, window.App.Data.Quests[QuestID][Stage]); };

    /**
     * Prints out the requirements for completion of a quest.
     * @param {string} QuestID
     * @param {App.Entity.Player} Player
     * @returns {string}
     */
        this.pQuestRequirements = function(QuestID, Player)
		{
			var checks = window.App.Data.Quests[QuestID]["CHECKS"];
			var Out = [];
			var Meter = "";
            var Percent = 0;
            var Val = 0;
            var Name = "";
			var pString  = "";
            var Invert = 0;
            var bMeter = false;

			for (var i = 0; i < checks.length; i++) {
                Name = checks[i]["NAME"];
                Invert = 0;
                bMeter = false;

                if (Name.charAt(0) == '-') {
                    Name = Name.slice(1);
                    Invert = 1;
                }

                switch (checks[i]["TYPE"]) {
                    case "FLAG":
                        continue;
                        break;
                    case "NPC_MOOD":
                        bMeter = true;
                        Val = Player.NPCS[Name].Mood();
                        pString = Player.NPCS[Name].pName();
                        break;
                    case "MONEY":
                        bMeter = true;
                        Val = Player.Money;
                        pString = "@@color:yellow;Coins@@";
                        break;
                    case "STAT_BODY":
                        bMeter = true;
                        Val = Player.GetStatPercent("BODY", Name);
                        pString = Name;
                        break;
                    case "STAT_CORE":
                        bMeter = true;
                        Val = Player.GetStatPercent("STAT", Name);
                        pString = Name;
                        break;
                    case "STAT_SKILL":
                        bMeter = true;
                        Val = Player.GetStatPercent("SKILL", Name);
                        pString = Name;
                        break;
                    case "STYLE_CATEGORY":
                        bMeter = true;
                        Val = Math.max(0, Math.min(Player.GetStyleSpecRating(Name), 100));
                        pString = Name;
                        break;
                    case "HAIR_STYLE":
                        bMeter = false;
                        Val = ((Player.GetHairStyle() == Name) == checks[i]["VALUE"]);
                        pString = "Hair style - "+Name;
                        break;
                    case "HAIR_COLOR":
                        bMeter = false;
                        Val = ((Player.GetHairColor() == Name) == checks[i]["VALUE"]);
                        pString = "Hair color - "+Name;
                        break;
                }

                if (bMeter == true) {
                    Out.push(this.pQuestMeter(Player, pString, Val, checks[i]["VALUE"], Invert));
                } else {
                    Out.push(this.pQuestCheckbox(Player, pString, Val));
                }

			}

			return Out.join("\n");
		};

        this.pQuestCheckbox = function(Player, pString, Val)
        {
            var Out = pString + " ";
            Out = Out + (Val == true ? "@@color:lime; &#9745; @@" : "@@color:red; &#9746; @@");
            return Out;
        };

        this.pQuestMeter = function(Player, Name, PlayerValue, GoalValue, Invert )
        {
            var c, m;
            if (typeof Invert !== 'undefined' && Invert == 1) {
                c = GoalValue;
                m = PlayerValue;
            }  else {
                c = PlayerValue;
                m = GoalValue;
            }
            //console.log("pMeter("+c+","+m+",0) called by pQuestMeter");

            return "<span id=\"fixed-font\">" + this.pMeter(c, m, 0) +"</span>&nbsp;"+Math.floor( ((c/m)*100)) +"% "+Name;
        };

        this.pQuestRewards = function(QuestID)
		{
			var Rewards = window.App.Data.Quests[QuestID]["REWARD"];
			var Output = [ ];
			var oItem;

			for (var i = 0; i < Rewards.length; i++)
			{
				if (Rewards[i]["REWARD_TYPE"] == "MONEY") Output.push( "@@color:yellow;"+ Rewards[i]["AMOUNT"] + " coins@@.");
				if (Rewards[i]["REWARD_TYPE"] == "ITEM" ) {
					oItem = window.App.Item.Factory( Rewards[i]["TYPE"], Rewards[i]["NAME"], Rewards[i]["AMOUNT"]);
					Output.push( oItem.Description() + " x " + Rewards[i]["AMOUNT"]);
				}
			}

			return Output;
		};

        this.pItemDesc = function(ItemType, ItemTag, ItemAmount)
		{
			var oItem = window.App.Item.Factory( ItemType, ItemTag, ItemAmount);
			return oItem.Description();
		};

    /**
     * Print out a description of the players Ass statistic.
     * @param {App.Entity.Player} Player
     * @param {number} Arg
     * @returns {string}
     */
        this.pAss = function (Player, Arg) {
            var aPercent = Player.GetStatPercent("BODY", "Ass");
            var hPercent = Player.GetStatPercent("BODY", "Hips");

            if (typeof Arg !== 'undefined') return this.GetAdjective("BODY", "Ass", aPercent);

            var Output = this.TokenizeRating(Player, "BODY", "Ass", this.GetRating("Ass", aPercent));

            if ((aPercent > 30) || (hPercent > 30)) {
                if ( aPercent  < ( hPercent - 15) ) {
                    Output += " It is @@color:yellow;disproportionately small@@ for your ";
                } else if ( aPercent > ( hPercent + 15)) {
                    Output += " It is @@color:yellow;disproportionately big@@ for your ";
                } else {
                    Output += " It is @@color:lime;flattered@@ by your ";
                }
                Output += this.GetAdjective("BODY", "Hips", hPercent) + " hips.";
            }

            return Output;
        };

    /**
     * Print out a description of the players Penis statistic.
     * @param {App.Entity.Player} Player
     * @param {number} [Arg]
     * @returns {XML|string|void}
     */
        this.pPenis = function (Player, Arg) {
            var pPercent = Player.GetStatPercent("BODY", "Penis");
            var iLength = this.CMtoINCH(Player.GetStat("BODY", "Penis"));
            if (typeof Arg !== 'undefined') return this.GetAdjective("BODY", "Penis", pPercent);
            return this.TokenizeRating(Player, "BODY", "Penis", this.GetRating("Penis", pPercent));
        };

    /**
     * Prints out a description of the Player's height statistic.
     * @param {App.Entity.Player} Player
     * @returns {string}
     */
        this.pHeight = function (Player) {
            var pHeight = this.StatToCM(Player, "Height");
            var realFeet = (this.CMtoINCH(pHeight) / 12);
            var feet = Math.floor(realFeet);
            var inches = Math.round((realFeet - feet) * 12);
            return feet + "&prime;" + inches + "&Prime; tall";
        };

    this.pFetish = function (Player) {
            return this.ColorizeString(Player.Fetish(), this.GetRating("Fetish", Player.Fetish()));
        };

    this.pBeauty = function (Player) {
            return this.ColorizeString(Player.Beauty(), this.GetRating("Beauty", Player.Beauty()));
        };

    /**
     * Print out a description of the Player's Balls statistic.
     * @param {App.Entity.Player} Player
     * @param {number|null} Arg
     * @returns {string}
     */
    this.pBalls = function (Player, Arg) {
            var bPercent = Player.GetStatPercent("BODY", "Balls");
            if (typeof Arg !== 'undefined') return this.GetAdjective("BODY", "Balls", bPercent);
            return this.TokenizeRating(Player, "BODY", "Balls", this.GetRating("Balls", bPercent));
        };

    /**
     * Print out a description of the Player's Waist statistic.
     * @param {App.Entity.Player} Player
     * @param {number|null} Arg
     * @returns {XML|string|void}
     */
    this.pWaist = function (Player, Arg) {
            var wPercent = Player.GetStatPercent("BODY", "Waist");
            var iLength = this.CMtoINCH(this.WaistInCM(Player));
            if (typeof Arg !== 'undefined') return this.GetAdjective("BODY", "Waist", wPercent);
            return this.TokenizeRating(Player, "BODY", "Waist", this.GetRating("Waist", wPercent));
        };

    /**
     * Print out a description of the Player's Waist statistic.
     * @param {App.Entity.Player} Player
     * @param {number|null} Arg
     * @returns {XML|string|void}
     */
    this.pBust = function (Player, Arg) {
            var bPercent = Player.GetStatPercent("BODY", "Bust");
            if (typeof Arg !== 'undefined') return this.GetAdjective("BODY", "Bust", bPercent);
            return this.TokenizeRating(Player, "BODY", "Bust", this.GetRating("Bust", bPercent));
        };

    /**
     * Print out a description of the Player's Bust (CUP) statistic.
     * @param {App.Entity.Player} Player
     * @returns {XML|string|void}
     */
    this.pCup = function (Player) {
        var bPercent = Player.GetStatPercent("BODY", "Bust");
        return this.GetRating("Cup", bPercent) + " cup";
    };

    /**
     * Print out a description of the Player's Lips statistic.
     * @param {App.Entity.Player} Player
     * @param {number|null} Arg
     * @returns {string}
     */
    this.pLips = function (Player, Arg) {
            var lPercent = Player.GetStatPercent("BODY", "Lips");
            if (typeof Arg !== 'undefined') return this.GetAdjective("BODY", "Lips", lPercent);
        return this.TokenizeRating(Player, "BODY", "Lips", this.GetRating("Lips", lPercent));
        };
    /**
     * Print out a description of the Player's Hips statistic.
     * @param {App.Entity.Player} Player
     * @param {number|null} Arg
     * @returns {string}
     */
    this.pHips = function (Player, Arg) {
            var hPercent = Player.GetStatPercent("BODY", "Hips");
            if (typeof Arg !== 'undefined') return this.GetAdjective("BODY", "Hips", hPercent);
            return this.TokenizeRating(Player, "BODY", "Hips", this.GetRating("Hips", hPercent));
        };

    /**
     * Print out a description of the Player's Eyes.
     * @param {App.Entity.Player} Player
     * @param {number|null} Arg
     * @returns {string}
     */
    this.pEyes = function (Player, Arg) {
            var lashes = Player.GetStatPercent("STAT","Hormones") >= 75 ? "long" : "average length";
            return "You have " + lashes + " eyelashes and " + Player.EyeColor + " colored eyes.";
        };
    /**
     * Print out a description of the Player's Style.
     * @param {App.Entity.Player} Player
     * @param {number|null} Arg
     * @returns {string}
     */
    this.pStyle = function (Player, Arg) {
            return this.ColorizeString(Player.Style(), this.GetRating("Style", Player.Style()));
        };

    /**
     * Print out a description of the Player's Clothing.
     * @param {App.Entity.Player} Player
     * @param {number|null} Arg
     * @returns {string}
     */
    this.pClothing = function (Player, Arg) {
            return this.ColorizeString(Player.ClothesRating(), this.GetRating("Clothing", Player.ClothesRating()));
        };

    /**
     * Print out a description of the Player's Makeup.
     * @param {App.Entity.Player} Player
     * @param {number|null} Arg
     * @returns {string}
     */
    this.pMakeup = function (Player, Arg) {
            if (Player.MakeupStyle == "plain faced") return "You are plain faced and not wearing any makeup";
            return "You are wearing " + this.ColorizeString(Player.MakeupRating(), Player.MakeupStyle) + " makeup";
        };

    /**
     * Print out a description of the Player's Face.
     * @param {App.Entity.Player} Player
     * @param {number|null} Arg
     * @returns {string}
     */
    this.pFace = function (Player, Arg) {
            var fPercent = Player.GetStatPercent("BODY", "Face");
            if (typeof Arg !== 'undefined') return this.GetAdjective("BODY", "Face", fPercent);
            var Output = this.TokenizeRating(Player, "BODY", "Face", this.GetRating("Face", fPercent));
            if (Player.MakeupRating() == 0) {
                Output += " it is bare and devoid of cosmetics.";
            } else if (Player.MakeupRating() < 40 ) {
                Output += " it is poorly done up in " + this.ColorizeString(Player.MakeupRating(), Player.MakeupStyle) + " makeup.";
            } else if (Player.MakeupRating() < 60 ) {
                Output += " it is moderately well done up in " + this.ColorizeString(Player.MakeupRating(), Player.MakeupStyle) + " makeup, somewhat enhancing your appeal.";
            } else if (Player.MakeupRating() < 80 ) {
                Output += " it is expertly done up in " + this.ColorizeString(Player.MakeupRating(), Player.MakeupStyle) + " makeup, enhancing your appeal.";
            } else {
                Output += " it is flawlessly painted in " + this.ColorizeString(Player.MakeupRating(), Player.MakeupStyle) + " makeup, greatly enhancing your appeal.";
            }
            return Output;
        };

    /**
     * Print out a description of the Player's Fitness.
     * @param {App.Entity.Player} Player
     * @param {number|null} Arg
     * @returns {string}
     */
    this.pFitness = function (Player, Arg) {
            var fPercent = Player.GetStatPercent("STAT", "Fitness");
            if (typeof Arg !== 'undefined') return this.GetAdjective("STAT", "Fitness", fPercent);
            return this.TokenizeRating(Player, "STAT", "Fitness", this.GetRating("Fitness", fPercent));
        };

    /**
     * Print out a description of the Player's Hormones.
     * @param {App.Entity.Player} Player
     * @param {number|null} Arg
     * @returns {string}
     */
    this.pHormones = function (Player, Arg) {
        return this.GetAdjective("STAT", "Hormones", Player.GetStat("STAT", "Hormones"));
    };

    /**
     * Print out a description of the Player's Hair.
     * @param {App.Entity.Player} Player
     * @returns {string}
     */
    this.pHair = function (Player) {
            var Wig = Player.Equipment["Wig"];
            if (Wig!= 0)
                return "You are wearing a wig to hide your natural hair. It is " +Wig.HairColor()+ " and " +
                    this.CMtoINCH(Wig.HairLength()) + " inches long, styled in " +
                    this.ColorizeString(Wig.HairBonus(), Wig.HairStyle()) + ".";

                return "Your hair is " + Player.HairColor + " and " + this.CMtoINCH(this.StatToCM(Player,"Hair")) +
                    " inches long, styled in " + this.ColorizeString(Player.HairRating(), Player.HairStyle) +".";
        };

    /**
     * Print out a description of the Player's Figure.
     * @param {App.Entity.Player} Player
     * @returns {string}
     */
    this.pFigure = function (Player) {
            var pBust = Player.GetStatPercent("BODY", "Bust");
            var pWaist = Player.GetStatPercent("BODY", "Waist");
            var pHips = Player.GetStatPercent("BODY", "Hips");
            var sCurve = "a @@color:yellow;waifish@@ figure";

            if (pWaist >= 20) sCurve = "a @@color:yellow;small@@ figure";
            if (pWaist >= 30) sCurve = "a @@color:yellow;thin@@ figure";
            if (pWaist >= 40) sCurve = "an @@color:yellow;average@@ figure";
            if (pWaist >= 60) sCurve = "a @@color:yellow;chubby@@ figure";
            if (pWaist >= 80) sCurve = "an @@color:red;obese@@ figure";

            if ( (pWaist + 10 < pBust) && (pWaist + 10 < pHips )) sCurve = "a @@color:lime;slightly curvy@@ figure";
            if ( (pWaist + 20 < pBust) && (pWaist + 20 < pHips )) sCurve = "a @@color:cyan;sexy and curvy@@ figure";
            if ( (pWaist + 30 < pBust) && (pWaist + 30 < pHips )) sCurve = "an @@color:magenta;hourglass@@ figure";
            if ( (pWaist + 40 < pBust) && (pWaist + 40 < pHips )) sCurve = "an @@color:DeepPink;extreme hourglass@@ figure";

            return sCurve;
        };


    /**
     * Replace tokens in string with calculated/derived literals and return it.
     * @param {App.Entity.Player} Player
     * @param {object} NPC
     * @param {string}String
     * @param {object} [Opt]
     * @returns {string}
     */
    this.TokenizeString = function(Player, NPC, String, Opt)
        {
            if (typeof NPC !== 'undefined' ) {
                String = String.replace(/NPC_NAME/g, NPC.pName());
            }

            String = String.replace(/PLAYER_NAME/g, "@@color:DeepPink;"+Player.SlaveName+"@@");
            String = String.replace(/GF_NAME/g, "@@color:pink;"+Player.GirlfriendName+"@@");
            String = String.replace(/pBUST/g, this.pBust(Player, 1));
            String = String.replace(/pASS/g, this.pAss(Player, 1));
            String = String.replace(/pCUP/g, this.pCup(Player));
            String = String.replace(/pHIPS/g, this.pHips(Player, 1));
            String = String.replace(/pLIPS/g, this.pLips(Player, 1));
            String = String.replace(/pHORMONES/g, this.pHormones(Player, 1));
            String = String.replace(/pBLOWJOBS/g, this.GetAdjective("SKILL", "BlowJobs", Player.GetStat("SKILL", "BlowJobs")));
            String = String.replace(/pPHASE/g, Player.GetPhase(false));
            String = String.replace(/pPENIS/g, this.pPenis(Player,1));
            String = String.replace(/pWAIST/g, this.pWaist(Player, 1));
            String = String.replace(/pFACE/g, this.pFace(Player, 1));

            return String;
        };

    this.pSkillName = function (Skill) {
        return window.App.Data.Lists["SkillDictionary"][Skill];
    };
};
/* twine-user-script #3: "Items.js" */
window.App = window.App || { Data: { }, Entity: { } };

window.App.Item = new function() {

        this.Factory = function(Type, Name, Count) {

            var d = 0;
            var o;

            if (Type == "DRUGS") d = window.App.Data.Drugs[Name];
            if (Type == "FOOD") d = window.App.Data.Food[Name];
            if (Type == "COSMETICS") d = window.App.Data.Cosmetics[Name];
            if (Type == "CLOTHES") d = window.App.Data.Clothes[Name];
            if (Type == "STORE") d = window.App.Data.Stores[Name];
			if (Type == "NPC") d = window.App.Data.NPCS[Name];
            if (Type == "QUEST") d = window.App.Data.QuestItems[Name];

            if (d == 0 || (typeof d === 'undefined')) alert("Factory Failed: (" + Type + "," + Name + "," + Count + ")");


            if (Type == "CLOTHES") o = new this.Clothing(d);

			if (Type == "NPC") o = new window.App.Entity.NPC(d);

            if (Type == "STORE")
            {
                o = new this.Store(d);
                o.Init();
                return o;
            }

            if (Type == "QUEST") o = new this.QuestItem(d);

            if (Type == "DRUGS" || Type == "FOOD" || Type == "COSMETICS" ) o = new this.Consumable(d);
            if ((Count != 0) && (typeof d["Charges"] !== 'undefined')) o.Data["Charges"] = Count;

            return o;
        };

        this.Clothing = function(d) {
            this.o = $.extend( true, {}, d );
            var timestamp = new Date().getTime();
            this._id = this.o["Name"] + ":" + timestamp;

            this.Id = function () {
                return this._id;
            };
            this.Name = function () {
                return this.o["Name"];
            };
            this.Description = function () {
                var _d = this.o["ShortDesc"].replace("{COLOR}", this.o["Color"]);
                if (this.o["Locked"] && this.o["Locked"] == 1) _d += " @@color:red;(Locked)@@";
                return _d;
            };

            this.Examine = function () {
                var Output = this.o["LongDesc"];
                Output += "\n\n";

                Output += "@@color:yellow;Style Categories  @@ ";
                Output += this.Category().join(", ");
                Output += "\n\n";
                Output += "@@color:yellow;Rank @@ " + this.Rank();

                return Output;
            };

            this.Category = function()
            {
              if (this.o.hasOwnProperty("Category") == false) return [ "Ordinary" ];
                return this.o["Category"];
            };

            this.CategoryBonus = function(Cat)
            {
                if ( $.inArray(Cat, this.Category()) != -1 ) return this.Style();
                return 0;
            };

            this.Slot = function () {
                return this.o["Slot"];
            };
            this.Restrict = function () {
                return this.o["Restrict"];
            };
            this.WearEffect = function () {
                return this.o["WearEffect"] ? this.o["WearEffect"] : {};
            };
            this.SkillBonus = function () {
                return this.o["SkillBonus"];
            };
            this.Price = function () {
                return this.o["Price"];
            };
            this.Color = function () {
                return this.o["Color"];
            };

            this.Type = function() {
                return this.o["Type"];
            };

// STYLE TABLE
// TYPE         COMMON  UNCOMMON    RARE    LEGENDARY
// ACCESSORY    3       6           9       12
// CLOTHING     5       10          15      20
// ONE PIECE    10      20          30      40
            this.Style = function () {
                var bonus = {
                    "ACCESSORY" : { "COMMON" : 3, "UNCOMMON" : 6, "RARE" : 9, "LEGENDARY" : 12 },
                    "CLOTHING"  : { "COMMON" : 5, "UNCOMMON" : 10, "RARE" : 15, "LEGENDARY" : 20 },
                    "ONE PIECE" : { "COMMON" : 10, "UNCOMMON" : 20, "RARE" : 30, "LEGENDARY" : 40 }
                };

                return bonus[this.Type()][this.o["Style"]];
            };

            this.Rank = function() {
                if (this.o["Style"] == "COMMON") return "@@color:gold;&#9733;@@";
                if (this.o["Style"] == "UNCOMMON") return "@@color:gold;&#9733;&#9733;@@";
                if (this.o["Style"] == "RARE") return "@@color:gold;&#9733;&#9733;&#9733;@@";
                if (this.o["Style"] == "LEGENDARY") return "@@color:gold;&#9733;&#9733;&#9733;&#9733;@@";
                return "@@color:gold;&#9733;@@";
            };

            this.HairColor = function () {
                return this.o["Color"] ? this.o["Color"] : "black";
            };

            this.HairLength = function () {
                return this.o["HairLength"] ? this.o["HairLength"] : 0;
            };

            this.HairStyle = function () {
                return this.o["HairStyle"] ? this.o["HairStyle"] : "";
            };
            this.HairBonus = function () {
                return this.o["HairBonus"] ? this.o["HairBonus"] : 0;
            };
            this.IsLocked = function () {
                return this.o["Locked"] ? this.o["Locked"] : 0;
            };

            this.HasBonus = function (b) {
                if (this.o.hasOwnProperty("SkillBonus") == false) return false;
                return this.o["SkillBonus"].hasOwnProperty(b);
            };

            this.GetBonus = function (b) {
                if (this.o.hasOwnProperty("SkillBonus") == false) return [0, 0, 0];
                if (this.o["SkillBonus"].hasOwnProperty(b) == false) return [0, 0, 0];
                return this.o["SkillBonus"][b];
            };
        };

        this.Consumable = function(d) {
            this.Data = $.extend( true, {}, d );

            var timestamp = new Date().getTime();
            this._id = this.Data["Name"] + ":" + timestamp;

            this.Id = function () {
                return this._id;
            };
            this.Name = function () {
                return this.Data["Name"];
            };
            this.Description = function () {
                return this.Data["ShortDesc"];
            };
            this.Examine = function (Player) {
                var Output = this.Data["LongDesc"];
                var Usages = Player.GetHistory("ITEMS", this.Name());
                var Effects = Object.keys(this.Data["UseEffect"]);

                if (Usages == 0) return Output;

                Output += "\n\n";
                var max = Math.min(Usages, Effects.length);
                var EDict = [ ];

                for(var i = 0; i < max; i++) {
                    EDict = this.Data["UseEffect"][Effects[i]];
                    if (EDict[0] > 0 || EDict[1] > 0 ) {
                        Output += "@@color:lime;&uArr;"+Effects[i]+"@@ ";
                    } else {
                        Output +=  "@@color:red;&dArr;"+Effects[i]+"@@ ";
                    }
                }
                return Output;
            };

            this.Type = function () {
                return this.Data["Type"];
            };
            this.Charges = function () {
                return this.Data["Charges"];
            };
            this.UseEffect = function () {
                return this.Data["UseEffect"];
            };
            /** This message is printed when a player uses an item
             * @returns {string} */
            this.Message = function (Player) {
                var Output = this.Data["Message"];
                var Usages = Player.GetHistory("ITEMS", this.Name());
                var Effects = Object.keys(this.Data["UseEffect"]);
                console.log("Item usages:" + Usages);
                if (Usages >= Effects.length ) return Output;

                var EffectLearn = "";
                var EDict = this.Data["UseEffect"][Effects[Usages]];
                if (EDict[0] > 0 || EDict[1] > 0 ) {
                    EffectLearn = "@@color:lime;&uArr;"+Effects[Usages]+"@@";
                } else {
                    EffectLearn = "@@color:red;&dArr;"+Effects[Usages]+"@@";
                }

                Output = Output + "\n\nYou learn something... This item has an effect: " +EffectLearn;
                return Output;
            };

            this.Price = function () {
                return this.Data["Price"];
            };

            this.RemoveCharge = function (n) {
                this.Data["Charges"] = Math.max(0, Math.min((this.Charges() - n), 100));
            };

            this.AddCharge = function (n) {
                this.Data["Charges"] = Math.max(0, Math.min((this.Data["Charges"] + n), 100));
            };

            this.IsFull = function () {
                return this.Data["Charges"] == 100;
            };

            this.HasBonus = function (b) {
                if (this.Data.hasOwnProperty("SkillBonus") == false) return false;
                return this.Data["SkillBonus"].hasOwnProperty(b);
            };

            this.GetBonus = function (b) {
                if (this.Data.hasOwnProperty("SkillBonus") == false) return [0, 0, 0];
                if (this.Data["SkillBonus"].hasOwnProperty(b) == false) return [0, 0, 0];
                return this.Data["SkillBonus"][b];
            };
        };

    this.QuestItem = function(d) {
        this.Data = $.extend( true, {}, d );

        var timestamp = new Date().getTime();
        this._id = this.Data["Name"] + ":" + timestamp;

        this.Id = function () {
            return this._id;
        };
        this.Name = function () {
            return this.Data["Name"];
        };
        this.Description = function () {
            return this.Data["ShortDesc"];
        };
        this.Examine = function (Player) {
            return this.Data["LongDesc"];
        };
        this.Type = function () {
            return this.Data["Type"];
        };

        this.Charges = function() { return 1; }

    }
};



/* twine-user-script #4: "JobEngine.js" */
window.App = window.App || { Data: { }, Entity: { } };

/**
 * This class manages the "job" system. Basically short term repeatable quests.
 * They are not tracked by the journal and focus mostly on earning cheap rewards and flavor text.
 * @constructor
 */
window.App.JobEngine = new function() {

    /** @type {Array.<App.Job>}
     * @private */
    this._Jobs = [ ];

    /**
     * Loads the job data into an array of Job objects. Can be called again if necessary.
     */
    this.LoadJobs = function() {

        if (this._Jobs.length < 1) {
        var oKeys = Object.keys(App.Data.JobData);
        for (var i = 0; i < oKeys.length; i++) this._Jobs.push( new App.Job( App.Data.JobData[oKeys[i]]) );
        }
    };

    /**
     * Lists all jobs at person/location
     * @param {window.App.Entity.Player} Player
     * @param {string} Giver
     * @returns {Array.<Job>}
     */
    this.GetJobs = function(Player, Giver) {
        this.LoadJobs();
        return $.grep(this._Jobs, function(j) { return j.Giver() == Giver; }).sort();
    };

    /**
     * Return a Job by it's id property.
     * @param JobID
     * @returns {Job}
     */
    this.GetJob = function(JobID) {
        this.LoadJobs();
        return $.grep(this._Jobs, function(j) { return j.ID() == JobID; })[0];
    };

    this.JobAvailable = function(Player, NPC, JobID) {
        this.LoadJobs();
        return $.grep(this._Jobs, function(j) { return j.ID() == JobID && j.Available(Player) ; })[0];
    };
    /**
     * Lists all AVAILABLE jobs at a person
     * @param {window.App.Entity.Player} Player
     * @param {string} Giver
     * @returns {Array.<Job>}
     */
    this.GetAvailableJobs = function(Player, Giver) {
        return $.grep(this.GetJobs(Player, Giver), function(j) { return j.Available(Player, Player.NPCS[Giver]) == true; });
    };

    /**
     * Lists available jobs at a location
     * @param {App.Entity.Player} Player
     * @param {string} Giver
     * @returns {*}
     */
    this.GetAvailableLocationJobs = function(Player, Giver)
    {
        return $.grep(this.GetJobs(Player, Giver), function(j) { return j.Requirements(Player, Giver) == true; });
    };

    /**
     * Lists all UNAVAILABLE jobs at person/location
     * @param {App.Entity.Player} Player
     * @param {string} Giver
     * @returns {Array.<Job>}
     */
    this.GetUnavailableJobs = function(Player, Giver) {
        return $.grep(this.GetJobs(Player, Giver), function(j) {
            return j.Available(Player, Player.NPCS[Giver]) == false && j.Hidden() != true;
        }).sort();
    };

    /**
     * True if there are AVAILABLE jobs at this person/location
     * @param {App.Entity.Player} Player
     * @param {string} Giver
     * @returns {boolean}
     */
    this.JobsAvailable = function(Player, Giver) {
        return this.GetAvailableJobs(Player, Giver).length != 0;
    };

    /**
     * True if there are ANY jobs at this person/location
     * @param {App.Entity.Player} Player
     * @param {string} Giver
     * @returns {boolean}
     */
    this.HasJobs = function(Player, Giver ) {
        return (this.GetAvailableJobs(Player, Giver).length != 0) || (this.GetUnavailableJobs(Player,Giver).length != 0);
    };

    //this.Init(window.App.Data.JobData);
};

/**
 * Represents a job.
 * @param {Object} Data
 * @constructor
 */
window.App.Job = function(Data) {

    /** @type {boolean}
     *  @private */
    this._Debug     = false;
    /** @type {object}
     *  @private */
    this._JobData   = Data;
    /** @type {Array.<App.Scene>}
     *  @private */
    this._SceneBuffer = [ ];
    /** @type {Array.<string>}
     * @private */
    this._MissingRequirements = [ ];
    /** @private
     *  @returns {number} */
    this._Cost      = function() { return this._JobData["COST"]; };
    /** @private
     *  @returns {Array.<object>} */
    this._Req       = function() { return this._JobData["REQUIREMENTS"]; };
    /** @private
     *  @param {number} X
     *  @param {number} Y
     *  @returns {boolean} */
    this._gte       = function(X, Y) { return (X >= Y); };
    /** @private
     *  @param {number} X
     *  @param {number} Y
     *  @returns {boolean} */
    this._lte       = function(X, Y) { return (X <= Y); };
    /** @private
     *  @param {number} X
     *  @param {number} Y
     *  @returns {boolean} */
    this._gt        = function(X, Y) { return (X > Y);  };
    /** @private
     *  @param {number} X
     *  @param {number} Y
     *  @returns {boolean} */
    this._lt        = function(X, Y) { return (X < Y);  };
    /** @private
     *  @param {number} X
     *  @param {number} Y
     *  @returns {boolean} */
    this._eq        = function(X, Y) { return (X == Y); };
    /** @private
     *  @param {number} X
     *  @param {number} Y
     *  @returns {boolean} */
    this._ne        = function(X, Y) { return (X != Y); };

    /** @returns {string} */
    this.ID         = function() { return this._JobData["ID"]; };
    /** @returns {string} */
    this.Giver      = function() { return this._JobData["GIVER"]; };
    /** @returns {number} */
    this.Pay        = function() { return this._JobData["PAY"]; };
    /** @returns {Array.<number>} */
    this.Phases     = function() { return this._JobData["PHASES"]; };
    /** @returns {boolean} */
    this.Hidden     = function() { return this._JobData["HIDDEN"];};
    /**
     * Print the intro to a job.
     * @param {App.Entity.Player}Player
     * @param {App.Entity.NPC} Npc
     * @returns {string}
     */
    this.Intro      = function(Player, Npc) {
        if (this.Requirements(Player, Npc) == false) return "@@color:red;Requirements not met.@@";
        return  window.App.PR.TokenizeString(Player, Npc, this._JobData["INTRO"]);
    };

    /**
     * Calculate cost of a job
     * @param {string} Type
     * @param {string} [Name]
     * @returns {number}
     * @private
     */
    this._GetCost = function(Type, Name) {
        var Check = [];
        if (typeof Name !== 'undefined') {
            Check = $.grep(this._Cost(), function (c) {
                return c["TYPE"] == Type && c["NAME"] == Name;
            });
        } else {
            Check = $.grep(this._Cost(), function (c) {
                return c["TYPE"] == Type;
            });
        }
        if (typeof Check !== 'undefined' && Check.length > 0) return Check[0]["VALUE"];
        return 0;
    };

    /**
     * Print the title of a job.
     * @param {boolean} [Opt]
     * @returns {string}
     */
    this.Title = function(Opt) {
        var Output = this._JobData["TITLE"];
        if (Opt) return Output;

        for (var i = 0; i < this._JobData["RATING"];i++) Output += " &#9733;";
        Output = window.App.PR.ColorizeString(this._JobData["RATING"], Output, 5);

        var Time    = this._GetCost("TIME");
        var Energy  = this._GetCost("STAT", "Energy");
        var Money   = this._GetCost("MONEY");
        var Strings = [];

        if (Time != 0) Strings.push("@@color:lime;Time " + Time + "@@");
        if (Energy != 0) Strings.push("@@color:yellow;Energy " + Energy + "@@");
        if (Money != 0) Strings.push("@@color:orange;Money " + Money + "@@");

        if (Strings.length != 0) Output = Output + " [" + Strings.join("&nbsp;") + "]";
        return Output;
    };

    /**
     * Check to see if the player meets the "Cost" requirement for a job. Usually energy as this
     * is subtracted from their status upon taking the job.
     * @param {App.Entity.Player} Player
     * @returns {boolean}
     */
    this.Cost = function(Player)
    {
        if (typeof this._Cost() === 'undefined') return true;

        for(var i = 0; i < this._Cost().length; i++) {
            switch(this._Cost()[i]["TYPE"]) {
                case "STAT" :
                case "SKILL" :
                case "BODY" :
                    if (Player.GetStat(this._Cost()[i]["TYPE"], this._Cost()[i]["NAME"]) < this._Cost()[i]["VALUE"]) return false;
                    break;
                case "MONEY":
                    if (Player.Money < this._Cost()[i]["VALUE"]) return false;
                    break;
            }
        }
        return true;
    };

    /**
     * Deduct the costs of the Job from the player (usually energy, but could be other stats)
     * @param {App.Entity.Player} Player
     * @private
     */
    this._DeductCosts = function(Player)
    {
        if (typeof this._Cost() === 'undefined') return;
        var Type, Name, Value;

        for(var i = 0; i < this._Cost().length; i++) {
            Type = this._Cost()[i]["TYPE"];
            Name = this._Cost()[i]["NAME"];
            Value = this._Cost()[i]["VALUE"];

            this.Debug("_DeductCosts","Type="+ Type + ",Name="+Name+",VALUE="+Value);
            switch(Type) {
                case "STAT" :
                    Player.AdjustStat(Name, Math.floor(Value * -1.0));
                    break;
                case "SKILL" :
                    Player.AdjustSkill(Name, Math.floor(Value * -1.0));
                    break;
                case "BODY" :
                    Player.AdjustBody(Name, Math.floor(Value * -1.0));
                    break;
                case "MONEY":
                    Player.AdjustMoney(Math.floor(Value * -1.0));
                    break;
                case "ITEM":
                    var o = Player.GetItemByName(Name);
                    o.RemoveCharge(Value);
                    if (o.Charges() <= 0) Player.DeleteItem(o);
                    break;
                case "TIME":
                    Player.NextPhase(Value);
                    break;
            }
        }
    };

    /**
     * Check to see if the player meets the other requirements to take the job. Usually skill, stat, body related or quest flags.
     * @param {App.Entity.Player} Player
     * @param {App.Entity.NPC|String} NPC
     * @returns {boolean}
     */
    this.Requirements = function(Player, NPC) {

        var Type, Name, Value, Condition, Option;
        var StatusFlag              = true;
        var ReqString               = "";
        this._MissingRequirements   = [ ];

        for(var i = 0; i < this._Req().length; i++) {
            Type        = this._Req()[i]["TYPE"];
            Name        = this._Req()[i]["NAME"];
            Value       = this._Req()[i]["VALUE"];
            Condition   = this._Req()[i]["CONDITION"];
            Option      = this._Req()[i]["OPT"];
            ReqString   = "";

            switch(Type) {
                case "STAT" :
                    if (this._Cmp( Player.GetStat(Type, Name), Value, Condition) == false) {
                        StatusFlag = false;
                        if (Condition == "lt" || Condition == "lte" ) {
                            ReqString = window.App.PR.ColorizeString(Value, Name + " stat is too high");
                        } else {
                            ReqString = window.App.PR.ColorizeString(Value, Name + " stat is too low");
                        }
                    }
                    break;
                case "SKILL" :
                    if (this._Cmp( Player.GetStat(Type, Name), Value, Condition) == false) {
                        StatusFlag = false;
                        if (Condition == "lt" || Condition == "lte" ) {
                            ReqString = window.App.PR.ColorizeString(Value, Name  + " skill is too high");
                        } else {
                            ReqString = window.App.PR.ColorizeString(Value, Name + " skill is too low");
                        }
                    }
                    break;
                case "BODY" :
                    if (this._Cmp( Player.GetStat(Type, Name), Value, Condition) == false) {
                        StatusFlag = false;
                        if (Condition == "lt" || Condition == "lte" ) {
                            ReqString = window.App.PR.ColorizeString(Value, "Too much "+ Name);
                        } else {
                            ReqString = window.App.PR.ColorizeString(Value, "Not enough " + Name);
                        }
                    }
                    break;
                case "MONEY":
                    if (this._Cmp( Player.Money, Value, Condition) == false) {
                        StatusFlag = false;
                        ReqString = "@@color:orange;Need Money ("+( Value - Player.Money())+")";
                    }
                    break;
                case "NPC_STAT":
                    if (typeof NPC === 'undefined' && typeof Option !== 'undefined') NPC = Player.NPCS[Option];
                    if (typeof NPC !== 'undefined') {
                        if (this._Cmp( NPC.GetStat(Name), Value, Condition ) == false) {
                            StatusFlag = false;
                            if (Condition == "lt" || Condition == "lte" ) {
                                ReqString = window.App.PR.ColorizeString(Value, NPC.Name() +"'s " + Name  + " is too high");
                            } else {
                                ReqString = window.App.PR.ColorizeString(Value, NPC.Name() + "'s " + Name + " is too low");
                            }
                        }
                    }
                    break;
                case "QUEST":
                    if (this._Cmp( Player.QuestFlags[Name], Value, Condition) == false) {

                        ReqString += "@@color:gold;Quest '"+ window.App.Data.Quests[Name]["Title"]+"' not complete@@";
                        StatusFlag = false;
                    }
                    break;
                case "ITEM":
                    if (Player.GetItemByName(Name) === undefined) {
                        StatusFlag = false;
                        ReqString = "@@color:red;Missing item '" + Name + "' x" + Value + "@@";
                    } else if ( this._Cmp( Player.GetItemByName(Name).Charges(), Value, Condition) == false) {
                        StatusFlag = false;
                        ReqString = "@@color:red;Missing item '" + Name + "' x" + Value + "@@";
                    }
                    break;
                case "STYLE_CATEGORY":
                    if (this._Cmp( Player.GetStyleSpecRating(Name), Value, Condition) == false ){
                        StatusFlag = false;
                        if (Condition == "lt" || Condition == "lte" ) {
                            ReqString = window.App.PR.ColorizeString(Value, "Too much style '"+Name+"'");
                        } else {
                            ReqString = window.App.PR.ColorizeString(Value, "Not enough style '"+Name+"'");
                        }
                    }
                    break;
                case "STYLE":
                    if (this._Cmp( Player.Style(), Value, Condition) == false) {
                        StatusFlag = false;
                        if (Condition == "lt" || Condition == "lte" ) {
                            ReqString = window.App.PR.ColorizeString(Value, "Style and Grooming too high");
                        } else {
                            ReqString = window.App.PR.ColorizeString(Value, "Style and Grooming too low");
                        }
                    }
                    break;
                case "HAIR_STYLE":
                    if ( (Player.GetHairStyle() == Name ) != Value ) {
                        StatusFlag = false;
                        ReqString = "@@color:Need '"+Name+"' hair style";
                    }
                    break;
                case "HAIR_COLOR":
                    if ( (Player.GetHairColor() == Name ) != Value ) {
                        StatusFlag = false;
                        ReqString = "@@color:Need '"+Name+"' hair color";
                    }
                    break;

            }

            if (ReqString != "") this._MissingRequirements.push(ReqString);
        }

        return StatusFlag;
    };

    /**
     * Helper function - runs comparisons.
     * @param {number|string} A
     * @param {number|string} B
     * @param {string} C
     * @returns {boolean}
     * @private
     */
    this._Cmp = function(A, B, C)
    {
        switch(C) {
            case "gte":
                return this._gte(A, B);
            case "lte":
                return this._lte(A, B);
            case "gt" :
                return this._gt(A, B);
            case "lt" :
                return this._lt(A, B);
            case "eq" :
                return this._eq(A, B);
            case "ne" :
                return this._ne(A, B);
            default:
                return this._lt(A, B);
        }

    };

    /**
     * Check to see if the time cost falls within the open/allowed phases of the activity and that there
     * is enough time in the day to complete it.
     * @param {App.Entity.Player} Player
     * @returns {boolean}
     * @private
     */
    this._CheckTime = function(Player) {
        return (($.inArray(Player.Phase, this.Phases()) != -1) && (this._GetCost("TIME") + Player.Phase <= 4));
    };

    /**
     * Check to see if the time cost falls within the open/allowed phases of the activity
     * @param {App.Entity.Player} Player
     * @param {boolean} [Opt]
     * @returns {boolean|number}
     * @private
     */
    this._CheckReady = function(Player, Opt) {
            Opt         = Opt || false;
        var Key         = this.ID()+"_LastCompleted";
        var FlagValue   = Player.JobFlags[Key] ? Player.JobFlags[Key] : 0;
        if (Opt) return (FlagValue + this._JobData["DAYS"] - Player.Day);
        return ((FlagValue == 0) || (FlagValue + this._JobData["DAYS"] <= Player.Day));
    };

    /**
     * Set's the last completed flag for the quest.
     * @param {App.Entity.Player} Player
     * @private
     */
    this._SetLastCompleted = function(Player) {
        var Key = this.ID()+"_LastCompleted";
        Player.JobFlags[Key] = Player.Day;
    };

    /**
     * Check to see if this job is available to be used.
     * @param {App.Entity.Player} Player
     * @param {App.Entity.NPC} [NPC]
     * @returns {boolean}
     */
    this.Available = function(Player, NPC) {

        this.Debug("Job.Available:", this.ID());
        this.Debug("Cost:", ""+this.Cost(Player));
        this.Debug("Requirements:", ""+this.Requirements(Player, NPC));
        this.Debug("_CheckTime:", ""+this._CheckTime(Player));
        this.Debug("_CheckReady:", ""+this._CheckReady(Player));

        return ((this.Cost(Player) == true) && (this.Requirements(Player, NPC) == true) && (this._CheckTime(Player) == true) && (this._CheckReady(Player) == true));
    };

    /**
     * Check to see if a job is ready (if it's known about).
     * @param {App.Entity.Player} Player
     * @returns {boolean}
     */
    this.Ready = function(Player) {
      return ((this.Cost(Player) == true)  && (this._CheckTime(Player) == true) && (this._CheckReady(Player) == true));
    };

    /**
     * Return if the job is on cool down.
     * @param {App.Entity.Player} Player
     * @returns {boolean}
     */
    this.OnCoolDown = function(Player) {
        this.Debug("OnCoolDown", JSON.stringify(Player.JobFlags));
        return (this._CheckReady(Player) != true);
    };

    /**
     * Print out the requirements (missing) string for a job.
     * @param {App.Entity.Player} Player
     * @param {App.Entity.NPC} NPC
     * @returns {string}
     */
    this.ReqString = function(Player, NPC) {
        var Output  = "";

        var CoolDown = this._CheckReady(Player, true);
        if (this.OnCoolDown(Player))
            Output = "@@color:yellow;Available in " + CoolDown + " day" + (CoolDown > 1 ? "s@@" :"@@");

        if (this.OnCoolDown(Player) == false && this._CheckTime(Player) == false) {
          Output = "@@color:yellow;Only Available@@ ";
            for (var i = 0; i < this.Phases().length; i++)
                Output += Player.GetPhaseIcon(this.Phases()[i]) + " ";
        }

        if (this._MissingRequirements.length > 0)
            Output += "\n" + this._MissingRequirements.join(", ");

        return Output;
    };

    /**
     * Play the selected job scenes.
     * @param {App.Entity.Player} Player
     * @param {App.Entity.NPC} NPC
     * @returns {Array.<App.Scene>}
     */
    this.PlayScenes = function(Player, NPC)
    {
        var Results = { };

        this.Debug("PlayScenes", "Started");
        this._SceneBuffer = [ ];
        this._SetLastCompleted(Player);

        Player.AdjustMoney(this._JobData["PAY"]);
        this._DeductCosts(Player);

        for (var i = 0; i < this._JobData["SCENES"].length; i++) {
            /** @type {App.Scene} Scene */
            var Scene = new window.App.Scene(Player, NPC, this._JobData["SCENES"][i], Results);
            Results = Scene.Results(); //Pass along results from previous scenes to future scenes.
            this._SceneBuffer.push(Scene);
        }

        this.Debug("PlayScenes", "Ended");
        return $.grep(this._SceneBuffer, function(s) { return s.Triggered() == true; });
    };

    /**
     * Match a result to a string and return the colorized version.
     * @param {string} Tag
     * @param {number} Result
     * @param {number} Value
     * @returns {string}
     * @private
     */
    this._MatchResult = function(Tag, Result, Value)
    {
        var Output = "";
        var Percent = Math.floor( ((Result / Value) * 100)/2);

        /**
         * @param {string} a
         * @returns {string}
         */
        var Colorize = function(a) { return  (typeof a !== 'undefined') ? window.App.PR.ColorizeString(Percent, a.slice(2,-2), 100) : ""; };

        for ( var i = 0; i < this._JobData["JOB_RESULTS"].length; i++)
            if (Percent <= this._JobData["JOB_RESULTS"][i][Tag])
                return this._JobData["JOB_RESULTS"][i]["TEXT"].replace(/(@@.*@@)/g, Colorize );

        return Output;
    };

    /**
     * Print the "job results" at the end of a job.
     * @returns {string}
     * @private
     */
    this._PrintJobResults = function() {
        var Checks = this._SceneBuffer[this._SceneBuffer.length-1].Results();
        console.log(JSON.stringify(Checks)+"\n");
        var cKeys = Object.keys(Checks);
        var Results = [ ];

        for ( var i = 0; i < cKeys.length; i++)
            Results.push(this._MatchResult(cKeys[i], Checks[cKeys[i]]["RESULT"], Checks[cKeys[i]]["VALUE"]));
        Results = Results.filter( function(r) { return r != ""; });
        return Results.length > 0 ? " " + Results.join(" ") : Results.join("");
    };

    /**
     * Calculate the total pay from all scenes for the job.
     * @returns {string}
     * @private
     */
    this._PrintPay = function() {
        var Pay = this._JobData["PAY"];
        for (var i = 0; i < this._SceneBuffer.length; i++) Pay += this._SceneBuffer[i].Pay();
        return "@@color:yellow;"+Pay+"@@";
    };

    /**
     * Tokenize a string and return result.
     * @param {App.Entity.Player} Player
     * @param {App.Entity.NPC} NPC
     * @param {string} String
     * @returns {*}
     * @private
     */
    this._Tokenize = function(Player, NPC, String)
    {
        if (typeof String == 'undefined') return "";
        String = String.replace(/JOB_PAY/g, this._PrintPay());

        if (String.indexOf("JOB_RESULTS") != -1) { // Kludge because replace evaluates function even if no pattern match. Dumb.
            String = String.replace(/JOB_RESULTS/g, this._PrintJobResults());
        }
        String = window.App.PR.TokenizeString(Player, NPC, String);
        return String;
    };

    /**
     * Print the "start" scene of a job.
     * @param {App.Entity.Player} Player
     * @param {App.Entity.NPC} NPC
     * @returns {string}
     */
    this.PrintStart = function(Player, NPC) {
        return this._JobData["START"] == "" ? "" : this._Tokenize(Player, NPC, this._JobData["START"]) + "\n";
    };

    /**
     * Print the "end" scene of a job.
     * @param {App.Entity.Player} Player
     * @param {App.Entity.NPC} NPC
     * @returns {string}
     */
    this.PrintEnd = function(Player, NPC) {
        return this._JobData["END"] == "" ? "" :  this._Tokenize(Player, NPC, this._JobData["END"])+ "\n";
    };

    /**
     *
     * @param {string} Fun
     * @param {string} String
     */
    this.Debug = function(Fun, String)
    {
        if (this._Debug == true)
        console.log(Fun+":"+String+"\n");
    };
};

/**
 * Stores and plays a "scene" from a job.
 * @param {window.App.Entity.Player} Player
 * @param {window.App.Entity.NPC} NPC
 * @param {object} SceneData
 * @param {object} Checks
 * @constructor
 */
window.App.Scene = function(Player, NPC, SceneData, Checks) {

    /** @type {boolean}
     *  @private */
    this._Debug     = true;
    /** @type {App.Entity.Player}
     *  @private */
    this._Player    = Player;
    /** @type {App.Entity.NPC}
     *  @private */
    this._NPC       = NPC;
    /** @type {object}
     *  @private */
    this._SceneData = SceneData;
    /** @type {object}
     *  @private */
    this._Flags     = Player.JobFlags;
    /** @type {number}
     *  @private */
    this._Pay       = 0;
    /** @type {boolean}
     *  @private */
    this._Triggered = false;
    /** @type {string}
     *  @private */
    this._StrBuffer = "";
    /** @type {object}
     *  @private */
    this._Checks    = Checks || { };

    /** @returns {string} */
    this.Id         = function() { return this._SceneData["ID"]; };
    /** @returns {boolean} */
    this.Triggered  = function() { return (this._Triggered != false && this._StrBuffer != ""); };
    /** @returns {string} */
    this.Print      = function() { return (this._StrBuffer != "") ? this._StrBuffer + "\n" : ""; };
    /** @returns {number} */
    this.Pay        = function() { return this._Pay; };
    /** @returns {object} */
    this.Results    = function() { return this._Checks; };

    /** @private
     *  @param {number} X
     *  @param {number} Y
     *  @returns {boolean} */
    this._gte       = function(X, Y) { return (X >= Y); };
    /** @private
     *  @param {number} X
     *  @param {number} Y
     *  @returns {boolean} */
    this._lte       = function(X, Y) { return (X <= Y); };
    /** @private
     *  @param {number} X
     *  @param {number} Y
     *  @returns {boolean} */
    this._gt        = function(X, Y) { return (X > Y);  };
    /** @private
     *  @param {number} X
     *  @param {number} Y
     *  @returns {boolean} */
    this._lt        = function(X, Y) { return (X < Y);  };
    /** @private
     *  @param {number} X
     *  @param {number} Y
     *  @returns {boolean} */
    this._eq        = function(X, Y) { return (X == Y); };
    /** @private
     *  @param {number} X
     *  @param {number} Y
     *  @returns {boolean} */
    this._ne        = function(X, Y) { return (X != Y); };
    /** @private
     *  @param {number} A
     *  @param {number} B
     *  @param {string} C
     *  @returns {boolean} */
    this._Cmp = function(A, B, C)
    {
        this.Debug("_Cmp", "A="+A+",B="+B+",C="+C);

        switch(C) {
            case "gte":
                return this._gte(A, B);
            case "lte":
                return this._lte(A, B);
            case "gt" :
                return this._gt(A, B);
            case "lt" :
                return this._lt(A, B);
            case "ne" :
                return this._ne(A, B);
            case "eq" :
                return this._eq(A, B);
            default:
                return this._lt(A, B);
        }
    };

    /**
     * Process a Trigger rule and return true/false state on if it fires.
     * @param {string} Type
     * @param {string} Name
     * @param {number} Value
     * @param {string} Condition
     * @param {string} Opt
     * @returns {boolean}
     * @private
     */
    this._ProcessTrigger = function(Type, Name, Value, Condition, Opt)
    {
        this.Debug("_ProcessTrigger", "Type="+Type+",Name="+Name+",Value="+Value+",Condition="+Condition+",Opt="+Opt);

        switch(Type)
        {
            case "NPC_STAT":
                return this._Cmp(this._NPC.GetStat(Name), Value, Condition);
                break;
            case "RANDOM-100":
                return this._Cmp(Math.ceil((100 * Math.random())+1), Value, Condition);
                break;
            case "COUNTER":
                if ( (typeof Opt !== 'undefined') && (Opt == "RANDOM"))
                    return this._Cmp(this._Player.JobFlags[Name], Math.ceil(Value * Math.random()), Condition);
                return this._Cmp(this._Player.JobFlags[Name], Value, Condition);
                break;
            case "STAT_BODY":
                if ((typeof Opt !== 'undefined') && (Opt == "RANDOM"))
                    return this._Cmp(this._Player.GetStatPercent("BODY", Name), Math.ceil((100 * Math.random())+1), Condition);
                    return this._Cmp(this._Player.GetStatPercent("BODY", Name), Value, Condition);
                break;
            case "STAT_SKILL":
                if ((typeof Opt !== 'undefined') && (Opt == "RANDOM"))
                    return this._Cmp(this._Player.GetStatPercent("SKILL", Name), Math.ceil((100 * Math.random())+1), Condition);
                return this._Cmp(this._Player.GetStatPercent("SKILL", Name), Value, Condition);
                break;
            case "FLAG":
                if ( (typeof Opt !== 'undefined') && (Opt == "NOT_SET"))
                    return (this._Player.JobFlags.hasOwnProperty(Name) == false);

                if ( (typeof Opt !== 'undefined') && (Opt == "SET"))
                    return (this._Player.JobFlags.hasOwnProperty(Name) == true);

                return this._Cmp(this._Player.JobFlags[Name], Value, Condition);
                break;
            case "TAG":
                var Percent = Math.ceil( (this._Checks[Name]["RESULT"] / this._Checks[Name]["VALUE"]) * 100);
                return this._Cmp(Percent, Value, Condition);
                break;
        }

        return true;
    };

    /**
     * Check the status of each trigger in a group and return true/false on if the scene fires
     * @param {Array.<object>} Triggers
     * @returns {boolean}
     * @private
     */
    this._ProcessTriggers = function(Triggers)
    {

        for (var i = 0; i < Triggers.length; i++)
            if (this._ProcessTrigger(Triggers[i]["TYPE"], Triggers[i]["NAME"], Triggers[i]["VALUE"], Triggers[i]["CONDITION"], Triggers[i]["OPT"]) == false) return false;

        return true;
    };

    /**
     * Check the status of each trigger in a group and return true/false on if the scene fires
     * @param {Array.<object>} Triggers
     * @returns {boolean}
     * @private
     */
    this._ProcessTriggersAny = function(Triggers)
    {

        for (var i = 0; i < Triggers.length; i++)
            if (this._ProcessTrigger(Triggers[i]["TYPE"], Triggers[i]["NAME"], Triggers[i]["VALUE"], Triggers[i]["CONDITION"], Triggers[i]["OPT"]) == true) return true;

        return false;
    };

    /**
     * Process a reward rule from a scene.
     * @param {string} Type
     * @param {string} Name
     * @param {number|string} Value
     * @param {string} Opt
     * @private
     */
    this._ProcessReward = function(Type, Name, Value, Opt)
    {
        if (Opt == 'RANDOM' ) Value = Math.floor((Value * Math.random())+1);

        // Retrieve the result of another check and modify the value of this reward by that scaling percentage.
        if ((typeof Opt === 'string') && (Opt.indexOf( "TAG_" ) > -1) ) {
            Value = Math.ceil( Value * (this._Checks[Opt.slice(Opt.indexOf("_")+1)]["RESULT"] / this._Checks[Opt.slice(Opt.indexOf("_")+1)]["VALUE"]));
        }

        this.Debug("_ProcessReward", "Type="+Type+",Name="+Name+",Value="+Value+",Opt="+Opt);

        switch(Type)
        {
            case "MONEY":
                this._Pay += Value;
                this._Player.AdjustMoney(Value);
                break;
            case "FOOD":
            case "DRUGS":
            case "CLOTHES":
            case "COSMETICS":
                this._Player.AddItem(Type, Name, Value, Opt);
                break;
            case "QUEST_ITEM":
                this._Player.AddItem("QUEST", Name, Value, Opt);
                break;
            case "STAT_XP":
            case "BODY_XP":
            case "SKILL_XP":
                this._Player.AdjustXP(Type.slice(0,-3), Name, Value);
                break;
            case "STAT":
                this._Player.AdjustStat(Name, Value);
                break;
            case "BODY":
                this._Player.AdjustStat(Name, Value);
                break;
            case "SKILL":
                this._Player.AdjustStat(Name, Value);
                break;
            case "FLAG":
                if (Opt == "DELETE")    delete this._Player.JobFlags[Name];
                if (Opt == "SET" )      this._Player.JobFlags[Name] = Value;
                if (Opt == "ADD" )      this._Player.JobFlags[Name] += Value;
                break;
            case "QUEST_FLAG":
                if (Opt == "DELETE")    delete this._Player.QuestFlags[Name];
                if (Opt == "SET" )      this._Player.QuestFlags[Name] = Value;
                if (Opt == "ADD" )      this._Player.QuestFlags[Name] += Value;
                break;
            case "COUNTER":
                if (typeof this._Player.JobFlags[Name] === 'undefined') this._Player.JobFlags[Name] = 0;
                this._Player.JobFlags[Name] += 1;
                break;
            case "STORE":
                if (this._Player.StoreInventory[Name]["INVENTORY"].length < 1) {
                    window.App.StoreEngine.OpenStore(this._Player, this._NPC);
                }
                
                if (Opt == "LOCK") window.App.StoreEngine.ToggleStoreItem(this._Player, Name, Value, 1);
                if (Opt == "UNLOCK") window.App.StoreEngine.ToggleStoreItem(this._Player, Name, Value, 0);
                break;
            case "NPC_STAT":
                this._NPC.AdjustStat(Name, Value);
                break;
            case "PIRATE_STATS":
                this._Player.NPCS["Crew"].AdjustStat(Name, Value);
                this._Player.NPCS["Cook"].AdjustStat(Name, Value);
                this._Player.NPCS["Quartermaster"].AdjustStat(Name, Value);
                this._Player.NPCS["FirstMate"].AdjustStat(Name, Value);
                this._Player.NPCS["Captain"].AdjustStat(Name, Value);
                break;
        }
    };

    /**
     * Process a check rule on a a scene, store results in this._Checks[Tag]
     * @param {string} Tag
     * @param {string} Type
     * @param {string} Name
     * @param {number} Difficulty
     * @param {string} Reward
     * @param {string} RewardName
     * @param {number} Value
     * @param {string} Opt
     * @private
     */
    this._ProcessCheck = function(Tag, Type, Name, Difficulty, Reward, RewardName, Value, Opt)
    {
        var Scaling     = (Opt != "NO_SCALING");
            Value       = Value || 100;
        var Result      = 0;

        switch(Type)
        {
            case "STAT":
            case "BODY":
                Result = this._Player.StatRoll(Type, Name, Difficulty, Value, Scaling);
                break;
            case "SKILL":
                Result = this._Player.SkillRoll(Name, Difficulty, Value, Scaling);
                break;
        }

        this._Checks[Tag] = { "RESULT" : Result, "VALUE" : Value };
        this._ProcessReward(Reward, RewardName, Result, Opt);
    };

    /**
     * Process all the checks in a scene.
     * @param {Array.<object>} Checks
     * @private
     */
    this._ProcessChecks = function(Checks)
    {
        for (var i = 0; i < Checks.length; i++)
            this._ProcessCheck( Checks[i]["TAG"], Checks[i]["TYPE"], Checks[i]["NAME"], Checks[i]["DIFFICULTY"],
                                Checks[i]["REWARD"], Checks[i]["R_NAME"], Checks[i]["VALUE"], Checks[i]["OPT"] );
    };

    /**
     * Process all the "POST" flags in a scene. Generally they give rewards/set status flags.
     * @param Posts
     * @private
     */
    this._ProcessPost = function(Posts)
    {
        this.Debug("_ProcessPost", JSON.stringify(this._Checks));

        for (var i = 0; i < Posts.length; i++)
            this._ProcessReward(Posts[i]["TYPE"], Posts[i]["NAME"], Posts[i]["VALUE"], Posts[i]["OPT"]);

    };

    /**
     * Pass a result value from a Check and find the appropriate flavor text and colorize it.
     * @param {string} Tag
     * @param {number} Result
     * @param {string} Value
     * @returns {string}
     * @private
     */
    this._MatchResult = function(Tag, Result, Value)
    {
        var Output = "";
        var Percent = Math.floor(((Result / Value) * 100)/2);
        /**
         * @param {string} a
         * @returns {string}
         */
        var Colorize = function(a) { return  (typeof a !== 'undefined') ? window.App.PR.ColorizeString(Percent, a.slice(2,-2), 100) : ""; };

        for ( var i = 0; i < this._SceneData["RESULTS"].length; i++)
            if ( Percent <= this._SceneData["RESULTS"][i][Tag] )
                return this._SceneData["RESULTS"][i]["TEXT"].replace(/(@@.*@@)/g, Colorize );

        return Output;
    };

    /**
     * Iterate through all of the Check results for a scene and then find their appropriate flavor text.
     * @returns {string}
     * @private
     */
    this._SceneResults = function()
    {
        var cKeys = Object.keys(this._Checks);
        var Results = [ ];

        for ( var i = 0; i < cKeys.length; i++)
            Results.push( this._Tokenize(this._MatchResult(cKeys[i], this._Checks[cKeys[i]]["RESULT"], this._Checks[cKeys[i]]["VALUE"])));

        Results = Results.filter( function(r) { return r != ""; });
        return Results.length > 0 ? " " + Results.join(" ") : "";
    };

    /**
     * Tokenize a string
     * @param String
     * @returns {string}
     * @private
     */
    this._Tokenize = function(String)
    {
        String = String.replace(/JOB_PAY/g, this.Pay());
        String = window.App.PR.TokenizeString(this._Player, this._NPC, String);
        return String;
    };

    /**
     * Process all the rules in a scene and store the results in the object.
     * @private
     */
    this._CalculateScene = function() {

        this.Debug(this.Id() + ":_CalculateScene", "Started");

        if ((this._SceneData["TRIGGERS"].length > 0) && (this._ProcessTriggers(this._SceneData["TRIGGERS"]) == false)) return;
        if ((this._SceneData["TRIGGERS_ANY"].length > 0) && (this._ProcessTriggersAny(this._SceneData["TRIGGERS_ANY"]) == false)) return;

        this._Triggered = true;

        if (this._SceneData["CHECKS"].length > 0) this._ProcessChecks(this._SceneData["CHECKS"]);

        if (this._SceneData["POST"].length > 0) this._ProcessPost(this._SceneData["POST"]);

        this._StrBuffer =   this._SceneData["START"] != "" ? this._Tokenize(this._SceneData["START"]) : "";
        this._StrBuffer +=  this._SceneResults();
        this._StrBuffer +=  this._SceneData["END"] != "" ? " " + this._Tokenize(this._SceneData["END"]) : "";

        this.Debug(this.Id() + ":_CalculateScene", "Ended");
    };

    /**
     * @param {string} Fun
     * @param {string} String
     */
    this.Debug = function(Fun,String)
    {
        if (this._Debug == true)
            console.log(Fun +":"+String+"\n");
    };

    this._CalculateScene();

};
/* twine-user-script #5: "NPCS.js" */
window.App = window.App || { Data: { }, Entity: { } };
/**
 * Customer object for whoring.
 * @param {string} Name
 * @param {number} Mood
 * @param {number}Lust
 * @param {number}Coins
 * @constructor
 */
window.App.Entity.Customer = function(Name, Mood, Lust, Coins) {
            this.Name = Name;
            this.Mood = Mood;
            this.Lust = Lust;
            this.Coins = Coins;
            this.ServiceRating = 0;
            this.Refused = [ ];
            this.Arousal = Math.ceil(Lust/2);
            this.RapeMode = false;
            this.GetRandomListItem = function (List) {
                return List[Math.floor(Math.random() * List.length)];
            };

            this.pName = function() { return "@@color:cyan;"+this.Name+"@@"; };
            this.GetServiceRating = function() { return Math.max(0, Math.min(this.ServiceRating, 100)); };
            this.GetArousal = function() {return Math.max(0, Math.min(this.Arousal, 100)); };

            this.SexAct = this.GetRandomListItem(window.App.Data.Lists["SexActFrequency"]);

            this.AdjustMood = function (m) {
                this.Mood = Math.max(0, Math.min(m, 100));
            };
            this.AdjustLust = function (m) {
                this.Lust = Math.max(0, Math.min(m, 100));
            };
    /**
     * Fuck a customer. Returns a chat dialog
     * @param {App.Entity.Player} Player
     * @param {Object} SexCommand
     * @returns {string}
     */
            this.Fuck = function(Player, SexCommand) {
                var Difficulty  = SexCommand["DIFFICULTY"] + (100 - this.GetArousal());
                var Effective = Player._SkillRoll(SexCommand["SKILL"], Difficulty, true); // Get the modifier without an amount and scale instead of returning 0 on failure.

                if (this.SexAct == "HandJobs" )     Effective += (Player.FaceRating() / 100);
                if (this.SexAct == "BlowJobs" )     Effective += (Player.LipsRating() / 100);
                if (this.SexAct == "TitFucking" )   Effective += (Player.BustRating() / 100);
                if (this.SexAct == "AssFucking" )   Effective += (Player.AssRating()  / 100);

                Player.AdjustStatXP("Perversion", (SexCommand["DIFFICULTY"] / 10));

                var toArousal = Math.ceil( SexCommand["Arousal"] * Effective );
                this.Arousal += toArousal;
                var toService = Math.ceil( SexCommand["Satisfaction"] * (Effective + (this.Arousal / 200)));
                this.ServiceRating += toService;

                console.log("Fuck("+SexCommand["Name"]+"): Effectiveness:"+Effective+", toArousal:"+toArousal+", toService:"+toService+"\n");

                var MessageType = SexCommand["Name"]+"Basic";
                var Skill = Player.GetStat("SKILL", SexCommand["SKILL"]);
                if ( Skill >= SexCommand["Advanced"]) MessageType = SexCommand["Name"]+"Advanced";
                if ( Skill >= SexCommand["Expert"]) MessageType = SexCommand["Name"]+"Expert";

                var Output = this.GetRandomListItem(window.App.Data.Lists["SexChats"][SexCommand["SKILL"]][MessageType]);
                //var Output = window.App.PR.TokenizeString(Player, this, this.GetRandomListItem(window.App.Data.Lists["SexChats"][SexCommand["SKILL"]][MessageType]));

                if (this.RapeMode == true && Effective < 1.0 ) {
                    Player.AdjustStat("Health", (Math.floor(Math.random() * 5) * -1.0));
                    Output += "\n\nNPC_NAME is angered by your lack of skill and @@color:red;hits you@@!\n\n";
                    if (Player.GetStat("STAT", "Health") < 1) Output += "\n\nThe beating is too much for your fragile body! You die!\n\n"
                }

                return window.App.PR.TokenizeString(Player, this, Output);
            };

            this.DoChat = function (Player, Type, OptAct) {
                var Act =  (typeof OptAct !== 'undefined') ? OptAct : this.SexAct;
                return window.App.PR.TokenizeString(Player, this, this.GetRandomListItem(window.App.Data.Lists["SexChats"][Act][Type]));
            };

    /**
     * Calculates payout from whoring job.
     * @param {App.Entity.Player} Player
     * @returns {number}
     */
			this.PayOut = function(Player) {
				var BasePay     =   Math.round( this.Coins * (this.ServiceRating / 100));
                var BeautyBonus =   Math.floor(Math.random() * ( this.Coins * (Player.Beauty() / 100)));
                var StyleBonus  =   Math.floor(Math.random() * ( this.Coins * (Player.Style() / 100)));
                var FetishBonus =   Math.floor(Math.random() * ( this.Coins * (Player.Fetish() / 100)));
                var FemBonus    =   Math.floor(Math.random() * ( this.Coins * (Player.GetStatPercent("STAT", "Femininity") / 100)));
				
				if (this.Arousal >= 90) BasePay = ( BasePay * ( 1 + (this.Arousal/100)));				
				
				var Pay = Math.round( BasePay + BeautyBonus + ( StyleBonus * 0.5 ) + (FetishBonus * 0.5) + (FemBonus * 0.5));
                return Math.ceil(Math.max((this.Coins / 10), Math.min(Pay, (this.Coins * 6))));
			};

            this.HasRefused = function(Act)
            {
                return ( $.inArray(Act, this.Refused) != -1);
            };

    /**
     * Used when the player needs to negotiate a new sex act.
     * @param {string} Act
     * @param {App.Entity.Player} Player
     * @returns {number}
     */
            this.Negotiate = function (Act, Player) {
                var res = Player._SkillRoll("Seduction", (25 + (100 - this.Mood)));
                if (res == 0 && (Math.floor(Math.random() * 100) + 1) < (100 - this.Mood)) {
                    this.ServiceRating -= 10;
                    return -1;
                } else if (res == 0) {
                    this.ServiceRating -= 5;
                    this.Refused.push(Act);
                    return 0;
                } else {
                    this.SexAct = Act;
                    return 1;
                }
            };
        };

/**
 * NPC Entity
 * @param {Object} Data
 * @constructor
 */
window.App.Entity.NPC = function(Data) {

			this.Data = Data;
			this.QuestFlags = { };
			this.Name = function() { return this.Data["Name"]; };
            this.pName = function() { return "@@color:cyan;" + this.Name() + "@@"; };
			this.Mood = function() { return this.Data["Mood"]; };
			this.pMood = function() { return window.App.PR.GetRating("Mood", this.Mood(), true); };
			this.Lust = function() { return this.Data["Lust"]; };
			this.pLust = function() { return window.App.PR.GetRating("Lust", this.Lust(), true); };
			this.Title = function() {
                return this.Data["Title"].replace("{NAME}", this.Name());
            };
			this.ShortDesc = function() { return this.Title() + " (" + this.pMood() + ", " + this.pLust() +")"; };
			this.LongDesc = function() { return this.Data["LongDesc"].replace("{NAME}", this.Name()); };
			this.HasStore = function() { return (typeof this.Data["Store"] !== 'undefined'); };
			this.StoreName = function() { return this.Data["Store"]; };
            this.Wealth = function() { return this.Data["Wealth"]; };

            this.GetFlag = function(Flag) {
                if (typeof this.QuestFlags[Flag] === 'undefined') return 0;
                return this.QuestFlags[Flag]["Value"];
            };

            this.SetFlag = function(Flag, Value, Tmp) {
                if (typeof Tmp === 'undefined') Tmp = 0;
                this.QuestFlags[Flag] = { "Value" : Value, "TMP" : Tmp };
            };

            this.ClearFlag = function(Flag) {
                if (typeof this.QuestFlags[Flag] === 'undefined') return;
                delete this.QuestFlags[Flag];
            };

            this.ResetFlags = function() {
                for (var prop in this.QuestFlags ) {
                    if (!this.QuestFlags.hasOwnProperty(prop)) continue;
                    if (this.QuestFlags[prop]["TMP"] != 0) delete this.QuestFlags[prop];
                }
            };
    /**
     * Adjust an NPC statistic (dictionary value)
     * @param {string} Stat
     * @param {number} Number
     */
			this.AdjustStat = function(Stat, Number)
			{
                this.Data[Stat] = Math.ceil(Math.max(0, Math.min((this.Data[Stat]+Number), 100)));
			};
    /**
     * Get the value of an NPC stat.
     * @param {string} Stat
     * @returns {*}
     */
            this.GetStat = function(Stat) {
                return this.Data[Stat];
            };

			this.AdjustFeelings = function()
			{
				this.AdjustStat("Mood", this.Data["DailyMood"]);
				this.AdjustStat("Lust", this.Data["DailyLust"]);
			};
		};


/* twine-user-script #6: "Player.js" */
window.App = window.App || { Data: { }, Entity: { } };

/**
 * The basic player object.
 * @constructor
 */
window.App.Entity.Player = function (){
    // Player Basic Variables
    this.OriginalName = "Joseph";
    this.SlaveName = "Josie";
    this.GirlfriendName = "Annette";
    this.NickName = "";
    this.HairColor = "black";
    this.HairStyle = "a boy cut";
    this.HairBonus = 0;
    this.MakeupStyle = "plain faced";
    this.MakeupBonus = 0;
    this.EyeColor = "brown";
    this.Money = 0;
    this.SleepLog = [];
    /** @type {number} */
    this.SailDays = 1;
    this.LastUsedMakeup = "minimal";
    this.LastUsedHair = "boy cut";

    this.JobFlags = { };
    this.QuestFlags = { "Q001": "ACTIVE" }; // Default Quest.

    this.History = {
        "ITEMS" : { },
        "SEX" : { },
        "MONEY" :{ }
    };

    // Game/Environment Variables
    this.Day = 1;
    this.Phase = 0; // 0 morning, 1 afternoon, 2 evening, 3 night, 4 late night

    this.Init = function() {

        this.OriginalName = window.App.Data.Names["Male"][Math.floor(Math.random() * window.App.Data.Names["Male"].length)];
        this.SlaveName = window.App.Data.Names["Female"][Math.floor(Math.random() * window.App.Data.Names["Female"].length)];
        var GfName = window.App.Data.Names["Female"][Math.floor(Math.random() * window.App.Data.Names["Female"].length)];

        while (GfName == this.SlaveName) {
            GfName = window.App.Data.Names["Female"][Math.floor(Math.random() * window.App.Data.Names["Female"].length)];
        }

        this.GirlfriendName = GfName;

        this.SetStartingStats("STAT");
        this.SetStartingStats("BODY");
        this.SetStartingStats("SKILL");

        this.Inventory = [  window.App.Item.Factory("COSMETICS", "hair accessories",    10),
            window.App.Item.Factory("COSMETICS", "hair products",       10),
            window.App.Item.Factory("COSMETICS", "basic makeup",        10)];

        this.Equipment = {
            "Wig":              window.App.Item.Factory("CLOTHES", "cheap wig"),
            "Hat":              0,
            "Neck":             window.App.Item.Factory("CLOTHES", "collar"),
            "Nipples":          0,
            "Bra":              window.App.Item.Factory("CLOTHES", "chemise"),
            "Corset":           0,
            "Panty":            window.App.Item.Factory("CLOTHES", "cotton bloomers"),
            "Stockings":        window.App.Item.Factory("CLOTHES", "cotton stockings"),
            "Shirt":            0,
            "Pants":            0,
            "Dress":            window.App.Item.Factory("CLOTHES", "cotton dress"),
            "Costume":          0,
            "Shoes":            window.App.Item.Factory("CLOTHES", "worn boots"),
            "Butt":             0,
            "Penis":            window.App.Item.Factory("CLOTHES", "chastity cage")
        };

        this.NPCS = {
            "Crew":                 window.App.Item.Factory("NPC",     "Crew"),
            "Cook":                 window.App.Item.Factory("NPC",     "Cook"),
            "Captain":              window.App.Item.Factory("NPC",     "Captain"),
            "Quartermaster":        window.App.Item.Factory("NPC",     "Quartermaster"),
            "FirstMate":            window.App.Item.Factory("NPC",     "FirstMate"),
            "IslaTavernKeeper" :    window.App.Item.Factory("NPC",     "IslaTavernKeeper"),
            "IslaShopKeeper" :      window.App.Item.Factory("NPC",     "IslaShopKeeper"),
            "Jarvis" :              window.App.Item.Factory("NPC",     "Jarvis"),
            "LordRowe":             window.App.Item.Factory("NPC",     "LordRowe")
        };

        this.StoreInventory = {
            "GALLEY":           { "LAST_STOCKED" : 0, "INVENTORY" : [ ], "RARE" : [ ]},
            "CARGO":            { "LAST_STOCKED" : 0, "INVENTORY" : [ ], "RARE" : [ ]},
            "ISLATAVERN":       { "LAST_STOCKED" : 0, "INVENTORY" : [ ], "RARE" : [ ]},
            "ISLASTORE":        { "LAST_STOCKED" : 0, "INVENTORY" : [ ], "RARE" : [ ]}
        };
    };

    /**
     * Helper function. Sets the starting statistics for a player from the config objects.
     * @param Type
     */
    this.SetStartingStats = function (Type) {
        var Prop;
        var ConfigOb;

        ConfigOb = this.GetStatConfig(Type);

        for (Prop in ConfigOb) {
            if(!ConfigOb.hasOwnProperty(Prop)) continue;
            if (Type == "BODY") this.AdjustBody(Prop, ConfigOb[Prop]["START"]);
            if (Type == "SKILL") this.AdjustSkill(Prop, ConfigOb[Prop]["START"]);
            if (Type == "STAT") this.AdjustStat(Prop, ConfigOb[Prop]["START"]);
        }
    };

    /**
     * Helping function to get the starting value of a statistic.
     * @param {string} Type
     * @param {string} Stat
     * @returns {number}
     */
    this.GetStartStat = function(Type, Stat) {
        return this.GetStatConfig(Type)[Stat]["START"];
    };

    /**
     * With Icon = true then return string time with Icon.
     * With Icon = false return numerical time of day.
     * @param {boolean} Icon
     * @returns {*}
     */
    this.GetPhase = function (Icon) {
        if (typeof Icon === 'undefined') Icon = false;
        if (this.Phase == 0) return Icon ? "morning @@color:yellow;&#9788;@@" : "morning";
        if (this.Phase == 1) return Icon ? "afternoon @@color:orange;&#9728;@@" : "afternoon";
        if (this.Phase == 2) return Icon ? "evening @@color:azure;&#9734;@@" : "evening";
        if (this.Phase == 3) return Icon ? "night @@color:cornflowerblue;&#9789;@@" : "night";
        if (this.Phase == 4) return Icon ? "late night @@color:DeepPink;&#9789;@@" : "late night";
        return this.Phase;
    };

    /**
     * Returns the phase icon for the current phase.
     * @param {number} Arg
     * @returns {string}
     */
    this.GetPhaseIcon = function(Arg) {
        if (Arg == 0) return "@@color:yellow;&#9788;@@";
        if (Arg == 1) return "@@color:orange;&#9728;@@";
        if (Arg == 2) return "@@color:azure;&#9734;@@";
        if (Arg == 3) return "@@color:cornflowerblue;&#9789;@@";
        if (Arg == 4) return "@@color:DeepPink;&#9789;@@";
        return "@@color:DeepPink;&#9789;@@";
    };

    // Player Statistic Variables
    this.CoreStats = {
        "Health":           0,
        "Nutrition":        0,
        "WillPower":        0,
        "Perversion":       0,
        "Femininity":       0,
        "Fitness":          0,
        "Toxicity":         0,
        "Hormones":         0,
        "Energy":           0
    };

    this.CoreStatsXP = {
        "Health":           0,
        "Nutrition":        0,
        "WillPower":        0,
        "Perversion":       0,
        "Femininity":       0,
        "Fitness":          0,
        "Toxicity":         0,
        "Hormones":         0,
        "Energy":           0
    };

    this.BodyStats = {
        "Face":             0,
        "Lips":             0,
        "Bust":             0,
        "Ass":              0,
        "Waist":            0,
        "Hips":             0,
        "Penis":            0,
        "Hair":             0,
        "Height":           0,
        "Balls":            0
    };

    this.BodyXP = {
        "Face":             0,
        "Lips":             0,
        "Bust":             0,
        "Ass":              0,
        "Waist":            0,
        "Hips":             0,
        "Penis":            0,
        "Hair":             0,
        "Height":           0,
        "Balls":            0
    };

    this.Skills = {
        "HandJobs":         0,
        "TitFucking":       0,
        "BlowJobs":         0,
        "AssFucking":       0,
        "Dancing":          0,
        "Singing":          0,
        "Seduction":        0,
        "Cleaning":         0,
        "Cooking":          0,
        "Serving":          0,
        "Swashbuckling":    0,
        "Sailing":          0,
        "Navigating":       0,
        "Styling":          0
    };

    this.SkillsXP = {
        "HandJobs":         0,
        "TitFucking":       0,
        "BlowJobs":         0,
        "AssFucking":       0,
        "Dancing":          0,
        "Singing":          0,
        "Seduction":        0,
        "Cleaning":         0,
        "Cooking":          0,
        "Serving":          0,
        "Swashbuckling":    0,
        "Sailing":          0,
        "Navigating":       0,
        "Styling":          0
    };


    /**
     * Clothing items the Player owns.
     * @type {Array}
     */
    this.Wardrobe = [ ];

    /**
     * Performs a skill roll.
     * @param {string} SkillName - Skill to check.
     * @param {number} Difficulty - Test difficulty.
     * @param {boolean} [Scaling] - Return value is always the XpMod and never 0.
     * @returns {number} - result of check.
     */
    this._SkillRoll = function (SkillName, Difficulty, Scaling) {
        Scaling = Scaling || false;
        var Target      = this.CalculateSkillTarget(SkillName, Difficulty);
        var DiceRoll    = Math.floor(Math.random() * 100);
        var Synergy     = this.GetSynergyBonus(SkillName);

        DiceRoll += Math.max(0, Math.min(Synergy, 100)); // Cap 100

        var BaseXp      = Math.max(10, Math.min((Difficulty - this.GetStat("SKILL", SkillName)), 50));
        var XpMod       = Math.max(0.25, Math.min((DiceRoll  / Target), 2.0)); // 0.25 - 2.0
        var XpEarned    = Math.ceil(BaseXp * XpMod);

        this.AdjustSkillXP(SkillName, XpEarned);

        console.log("SkillRoll(" + SkillName + "," + Difficulty + "):  Target = " + Target + ", DiceRoll = " + DiceRoll + " XPMod="+XpMod+"\n");

        if (Scaling == true) return XpMod;
        if (DiceRoll >= Target ) return 1;
        return 0;
    };

    /**
     * Performs a skill roll with a value amount which is modified when returned.
     * @param {string} SkillName
     * @param {number} Difficulty
     * @param {number} Amount
     * @param {boolean} [Scaling]
     * @returns {number}
     */
    this.SkillRoll = function(SkillName, Difficulty, Amount, Scaling)
    {
        var Mod = this._SkillRoll(SkillName, Difficulty, Scaling);
        var ret = Math.ceil(Amount * Mod);
        console.log("SkillRoll: Mod="+Mod+",Amount="+Amount+",Ret="+ret+"\n");
        return Math.ceil(Amount * Mod);
    };

    /**
     * Like a skill roll, but a simple check for a statistic (BODY or STAT).
     * @param {string} Type
     * @param {string} Name
     * @param {number} Difficulty
     * @param {number} Amount
     * @param {boolean} Scaling
     * @returns {number}
     */
    this.StatRoll = function(Type, Name, Difficulty, Amount, Scaling)
    {
        Scaling = Scaling || false;
        var Target      = this.CalculateSkillTarget(Name, Difficulty, Type);
        var DiceRoll    = ( Math.floor(Math.random() * 100) + 1);
        var Mod         = (DiceRoll  / Target); // 0.01 - 2.1

        console.log("StatRoll(" + Name + "," + Difficulty + "):  Target = " + Target + ", DiceRoll = " + DiceRoll + " Mod="+Mod+"\n");

        if (Scaling == true) return Math.ceil(Amount * Mod);
        if (DiceRoll >= Target) return 1;
        return 0;

    };
    /**
     * Calculate the target of the 1-100 dice roll for a skill check. Always a 5% chance of success/failure.
     * @param {string} SkillName
     * @param {number} Difficulty
     * @param {string} [Alternate]
     * @returns {number}
     */
    this.CalculateSkillTarget = function(SkillName, Difficulty, Alternate) {
        Alternate = Alternate || "SKILL";

        var SkillVal = this.GetStat(Alternate, SkillName) + this.GetWornSkillBonus(SkillName);
        return (100 - Math.max(5, Math.min((50 + (SkillVal - Difficulty)), 95)));
    };

    /**
     * Checks the SkillSynergy dictionary and adds any skill bonuses to dice rolls on
     * skill checks. For example, TitFucking gets a bonus for the size of the Players Bust score.
     * @param {string} SkillName
     * @returns {number}
     */
    this.GetSynergyBonus = function (SkillName) {
        if (!window.App.Data.Lists["SkillSynergy"].hasOwnProperty(SkillName)) return 0;
        var Bonus = 0;
        var Synergy = window.App.Data.Lists["SkillSynergy"][SkillName];
        for (var i = 0; i < Synergy.length; i++) {
            Bonus += Math.ceil(this.GetStatPercent(Synergy[i]["TYPE"], Synergy[i]["NAME"]) * Synergy[i]["BONUS"]);
        }
        return Bonus;
    };

    /**
     * Style hair and makeup.
     * @param {string} HairID
     * @param {string} MakeupID
     */
    this.DoStyling = function(HairID, MakeupID )
    {
        if (HairID.indexOf(':') > -1) { // We passed an Item Id.
            if ((this.Equipment["Wig"] == 0) || (this.Equipment["Wig"].Id() != HairID))
                this.Wear( this.WardrobeItem(HairID));
        } else {
            if (this.Equipment["Wig"] != 0) this.Remove(this.Equipment["Wig"]);

            var Hair = window.App.Data.Lists["HairStyles"].filter(function(Item) { return Item["NAME"] == HairID; })[0];

            if ( this.GetItemCharges("hair tool") >= Hair["RESOURCE1"] && this.GetItemCharges("hair treatment") >= Hair["RESOURCE2"]) {
                this.HairStyle = Hair["SHORT"];
                this.HairBonus = this.SkillRoll("Styling", Hair["DIFFICULTY"], Hair["STYLE"], true);
                this.LastUsedHair = Hair["NAME"];
                this.UseItemCharges("hair tool", Hair["RESOURCE1"]);
                this.UseItemCharges("hair treatment", Hair["RESOURCE2"]);
            }
        }

        var Makeup = window.App.Data.Lists["MakeupStyles"].filter(function(Item) { return Item["NAME"] == MakeupID; })[0];

        if ( this.GetItemCharges("basic makeup") >= Makeup["RESOURCE1"] && this.GetItemCharges("expensive makeup") >= Makeup["RESOURCE2"]) {
            this.MakeupStyle = Makeup["SHORT"];
            this.MakeupBonus = this.SkillRoll("Styling", Makeup["DIFFICULTY"], Makeup["STYLE"], true);
            this.LastUsedMakeup = Makeup["NAME"];
            this.UseItemCharges("basic makeup", Makeup["RESOURCE1"]);
            this.UseItemCharges("expensive makeup", Makeup["RESOURCE2"]);
        }
    };

    /**
     * Returns an array of Customer objects as the result of solicitation for whoring customers.
     * @param {number} Opt
     * @param {number} rLust
     * @param {number} rMood
     * @param {number} rWealth
     * @returns {Array}
     */
    this.SolicitCustomer = function (Opt, rLust, rMood, rWealth) {
        var rBonus = this.GetSolicitationBonus(Opt);
        var Customers = Math.max(0, Math.min((Math.round(((rLust + rBonus) / 33)) - 1), 4));
        var name = "Fred";
        var CustomerList = [];

        for (var i = 0; i < Customers; i++) {
            name = window.App.Data.Names["Male"][Math.floor(Math.random() * window.App.Data.Names["Male"].length)];
            var co = new window.App.Entity.Customer(name, rMood, rLust, rWealth);
            CustomerList.push(co);
        }
        return CustomerList;
    };

    /**
     * Selects a style of solicitation for customers and then returns a bonus used by SolicitCustomer
     * @param {number} opt
     * @returns {number}
     */
    this.GetSolicitationBonus = function (opt) {
        var baseScore = Math.round((this.Beauty() * 0.5 ) + (this.GetStat("STAT", "Femininity") * 0.3) + (this.Style() * 0.2));
        baseScore = Math.round(baseScore * (1 + (this.GetStat("SKILL","Seduction") / 100)));

        switch (opt) {
            case 1:
                this.AdjustStatXP("Femininity", 25, 40);
                baseScore += Math.max(0, Math.min((this.GetStat("STAT", "Femininity") * 0.75), 100));
                break;
            case 2:
                this.AdjustStatXP("Perversion", 25, 40);
                this.AdjustStatXP("WillPower", -10, 60);
                baseScore += Math.max(0, Math.min((this.GetStat("STAT", "Perversion") * 0.75), 100));
                break;
            case 3:
                this.AdjustStatXP("Perversion", 50, 50);
                this.AdjustStatXP("Femininity", 25, 40);
                this.AdjustStatXP("WillPower", -20, 40);
                baseScore += Math.max(0, Math.min((this.GetStat("STAT", "Perversion") * 0.25), 100));
                baseScore += Math.max(0, Math.min((this.GetStat("STAT", "Femininity") * 0.25), 100));
                baseScore += Math.max(0, Math.min((this.Fetish() * 0.5), 100));
                break;

            default:
                this.AdjustStatXP("Femininity", 25, 40);
                baseScore += Math.max(0, Math.min((this.GetStat("STAT", "Femininity") * 0.75), 100));
                break;
        }

        return Math.floor(baseScore);
    };

    /**
     * Calculates the Players "Beauty" based on other statistics.
     * @returns {number}
     */
    this.Beauty = function () {
        var cBeauty = Math.round((this.GetStat("BODY", "Face") * 0.4) + (this.Figure() * 0.3 ) + (this.GetStat("STAT", "Fitness") * 0.3));
        return Math.max(1, Math.min(cBeauty, 100));
    };

    /**
     * Fetish rating is derived from the enlarged (or minimized) size of the Players body parts.
     * Generally however, bigger (what) means more points. Used to calculate whoring pay and some
     * other activities.
     * @returns {number}
     */
    this.Fetish = function () {
        var score = 0;
        // 5 - 15 for boobs and ass each   (30 pts)
        if (this.GetStatPercent("BODY", "Bust") >= 60)  score += Math.round ((5 + (this.GetStatPercent("BODY", "Bust")/10)));
        if (this.GetStatPercent("BODY", "Ass") >= 60)   score += Math.round ((5 + (this.GetStatPercent("BODY", "Ass")/10)));

        // up to 10 each for lips and waist and hips (35 pts)
        if (this.GetStatPercent("BODY", "Lips") >= 80)  score += Math.round((this.GetStatPercent("BODY", "Lips")/10));
        if (this.GetStatPercent("BODY", "Hips") >= 80)  score += Math.round((this.GetStatPercent("BODY", "Hips")/10));
        if (this.GetStatPercent("BODY", "Waist") <= 30) score += 5;
        if (this.GetStatPercent("BODY", "Waist") <= 15) score += 5;
        if (this.GetStatPercent("BODY", "Waist") <= 1)  score += 5;

        // Penis and Balls, 10 each. (20 pts)
        if ((this.GetStatPercent("BODY", "Penis") <= 10) && (this.GetStatPercent("BODY", "Balls") <= 10)) score += 10; // tiny genitals!
        if ((this.GetStatPercent("BODY", "Penis") >= 90) && (this.GetStatPercent("BODY", "Balls") >= 90)) score += 10; // big genitals

        return Math.max(0, Math.min(Math.round((( score / 85 ) * 100)), 100)); // clamp 1 - 100 rating
    };

    /**
     * Derived statistic that reports "style" made up out of hair, makeup and clothing.
     * @returns {number}
     */
    this.Style = function () {
        var cStyle = Math.round(( this.HairRating() * 0.25 ) + ( this.MakeupRating() * 0.25 ) + (this.ClothesRating() * 0.5));
        return Math.max(0, Math.min(cStyle, 100));
    };

    /**
     * shim function that returns the "hair rating" of the player, but checks first if they are wearing
     * a wig and then reports that number instead.
     * @returns {number}
     */
    this.HairRating = function () {
        if (this.Equipment["Wig"] != 0) return Math.max(0, Math.min(this.Equipment["Wig"].HairBonus(), 100));
        return Math.max(0, Math.min(this.HairBonus, 100));
    };

    /**
     * @returns {string}
     */
    this.GetHairStyle = function () {
        if (this.Equipment["Wig"] != 0) return this.Equipment["Wig"].HairStyle();
        return this.HairStyle;
    };

    /**
     * @returns {string}
     */
    this.GetHairColor = function () {
        if (this.Equipment["Wig"] != 0) return this.Equipment["Wig"].HairColor();
        return this.HairColor;
    };

    /**
     * The makeup rating of the player.
     * @returns {number}
     */
    this.MakeupRating = function () {
        return Math.max(0, Math.min(this.MakeupBonus, 100));
    };

    /**
     * Derived statistic (face + makeup). Bonus payout for hand jobs if you have a good face.
     * @returns {number}
     */
    this.FaceRating = function () {
        return Math.ceil(Math.max(0, Math.min((( this.MakeupRating() + this.GetStat("BODY", "Face")) / 2), 100)));
    };

    /**
     * Iterates through players worn items and sums .Style() property.
     * @returns {number}
     */
    this.ClothesRating = function () {
        var cStyle = 0;

        for (var prop in this.Equipment) {
            if (!this.Equipment.hasOwnProperty(prop)) continue;
            if (this.Equipment[prop] == 0) continue;
            cStyle += this.Equipment[prop].Style();
        }
        return Math.max(1, Math.min(Math.round(((cStyle / 100 ) * 100)), 100)); // 1 - 100 rating
    };

    /**
     *
     * @param {string} Spec
     * @returns {number}
     */
    this.GetStyleSpecRating = function(Spec){
        var Rating = 0;

        for (var prop in this.Equipment)
        {
            if (!this.Equipment.hasOwnProperty(prop)) continue;
            if (this.Equipment[prop] == 0) continue;

            Rating += this.Equipment[prop].CategoryBonus(Spec);
        }
        return Rating;
    };

    /**
     * Derived statistic, lends itself to Beauty. WaistRating, BustRating, HipsRating and AssRating contribute.
     * @returns {number}
     */
    this.Figure = function () {
        var tFig = Math.round((this.WaistRating() + this.BustRating() + this.HipsRating() + this.AssRating()) / 4);
        return Math.max(1, Math.min(tFig, 100)); // Normalize between 1 - 100
    };

    /**
     * Calculates "golden ratio" for waist @ Player's height and then returns a score relative their current waist.
     * @returns {number}
     */
    this.WaistRating = function () {
        var GoldenWaist = Math.round((window.App.PR.StatToCM(this, "Height") * 0.375)); // 54cm to 78cm
        return Math.round(((GoldenWaist / window.App.PR.WaistInCM(this)) / 1.8) * 100);
    };

    /**
     * Calculates "golden ratio" for bust @ Player's height and then returns a score relative their current bust.
     * @returns {number}
     */
    this.BustRating = function () {
        var GoldenBust = (Math.round((window.App.PR.StatToCM(this, "Height") * 0.375)) * 1.5 );
        return Math.round(((window.App.PR.BustCCtoCM(this) / GoldenBust) / 1.6) * 100);
    };

    /**
     * Calculates "golden ratio" for hips @ Player's height and then returns a score relative their current bust.
     * @returns {number}
     */
    this.HipsRating = function () {
        var GoldenHips = (Math.round((window.App.PR.StatToCM(this, "Height") * 0.375)) * 1.5 );
        return Math.round(((window.App.PR.HipsInCM(this) / GoldenHips) / 1.6) * 100);
    };

    /**
     * Combination of Ass + Hips.
     * @returns {number}
     */
    this.AssRating = function () {
        return Math.round((this.GetStatPercent("BODY", "Ass") + this.GetStatPercent("BODY", "Hips")) / 2);
    };

    /**
     * For now just the percentage of the lips 1-100.
     * @returns {number}
     */
    this.LipsRating = function () {
        return this.GetStatPercent("BODY", "Lips");
    };

    /**
     * Returns the config settings for a statistic type.
     * @param {string} Type - STAT | SKILL | BODY
     * @returns {*}
     */
    this.GetStatConfig = function (Type) {
        if (Type == "STAT") return window.App.Data.Lists.StatConfig;
        if (Type == "SKILL") return window.App.Data.Lists.SkillConfig;
        if (Type == "BODY") return window.App.Data.Lists.BodyConfig;
    };
    /**
     * Return a statistic value (raw)
     * @param {string} Type
     * @param {string} StatName
     * @returns {number}
     */
    this.GetStat = function (Type, StatName) {
        if (Type == "STAT") return this.CoreStats[StatName];
        if (Type == "SKILL") return this.Skills[StatName];
        if (Type == "BODY") return this.BodyStats[StatName];
    };

    /**
     * Returns the current XP of a statistic.
     * @param {string} Type
     * @param {string} StatName
     * @returns {number}
     */
    this.GetStatXP = function (Type, StatName) {
        if (Type == "STAT") return this.CoreStatsXP[StatName];
        if (Type == "SKILL") return this.SkillsXP[StatName];
        if (Type == "BODY") return this.BodyXP[StatName];
    };

    this.GetMaxStat = function (Type, StatName) {
        return this.GetStatConfig(Type)[StatName]["MAX"];
    };
    this.GetMinStat = function (Type, StatName) {
        return this.GetStatConfig(Type)[StatName]["MIN"];
    };

    /**
     * @param {string} Type
     * @param {string} StatName
     * @returns {number}
     */
    this.GetStatPercent = function (Type, StatName) {
        return Math.floor(((this.GetStat(Type, StatName) - this.GetMinStat(Type, StatName)) / ((this.GetMaxStat(Type, StatName) - this.GetMinStat(Type, StatName)))) * 100);
    };

    this.GetLeveling = function (Type, StatName, TargetScore) {
        var Levels = this.GetStatConfig(Type)[StatName]["LEVELING"];
        //var Percent = Math.round(( (( TargetScore - this.GetMinStat(Type, StatName)) / ( this.GetMaxStat(Type, StatName) - this.GetMinStat(Type,StatName))) * 100));
        var Percent = this.GetStatPercent(Type, StatName) + TargetScore;
        var Level = {"COST": 100, "STEP": 1};

        for (var prop in Levels) {
            if (!Levels.hasOwnProperty(prop)) continue;
            if ((Levels[prop] == 'FIXED') || (Levels[prop] == 'NONE') || (Percent <= prop)) {
                Level = {
                    "COST": Levels[prop]["COST"],
                    "STEP": ((this.GetMaxStat(Type, StatName) / 100) * Levels[prop]["STEP"])
                };
                break;
            }
        }

        return Level;
    };

    /**
     * @param {string} Type
     * @param {string} StatName
     * @param {number} Amount
     * @returns {number}
     */
    this.GetCapStat = function (Type, StatName, Amount) {
        return Math.round((Math.max(this.GetMinStat(Type, StatName), Math.min(Amount, this.GetMaxStat(Type, StatName)))) * 100) / 100;
    };

    this.AdjustStat = function (StatName, Amount) {
        this.CoreStats[StatName] = this.GetCapStat("STAT", StatName, ( this.CoreStats[StatName] + Amount));
    };

    this.AdjustBody = function (StatName, Amount) {
        this.BodyStats[StatName] = this.GetCapStat("BODY", StatName, ( this.BodyStats[StatName] + Amount));
    };

    this.AdjustSkill = function (StatName, Amount) {
        this.Skills[StatName] = this.GetCapStat("SKILL", StatName, ( this.Skills[StatName] + Amount));
    };

    this.AdjustXP = function (Type, StatName, Amount, Limiter) {
        Amount = Math.ceil(Amount); // No floats.

        if ((Amount > 0) && (this.GetStat(Type, StatName) >= Limiter) && (Limiter != 0)) return;
        if ((Amount < 0) && (this.GetStat(Type, StatName) <= Limiter) && (Limiter != 0)) return;
        if ((Amount > 0) && (this.GetStat(Type, StatName) >= this.GetMaxStat(Type, StatName))) return;
        if ((Amount < 0) && (this.GetStat(Type, StatName) <= this.GetMinStat(Type, StatName))) return;
        if (Math.abs(this.GetStatXP(Type, StatName)) >= 250) Amount = Math.ceil(Amount / 2);
        if (Math.abs(this.GetStatXP(Type, StatName)) >= 500) Amount = Math.ceil(Amount / 4);
        if (Math.abs(this.GetStatXP(Type, StatName)) >= 1000) Amount = Math.ceil(Amount / 10);
        if (Type == "STAT")  this.CoreStatsXP[StatName] += Amount;
        if (Type == "SKILL") this.SkillsXP[StatName] += Amount;
        if (Type == "BODY")  this.BodyXP[StatName] += Amount;

    };

    this.AdjustStatXP = function (StatName, Amount, Limiter) {
        return this.AdjustXP("STAT", StatName, Amount, Limiter);
    };
    this.AdjustBodyXP = function (StatName, Amount, Limiter) {
        return this.AdjustXP("BODY", StatName, Amount, Limiter);
    };
    this.AdjustSkillXP = function (StatName, Amount, Limiter) {
        return this.AdjustXP("SKILL", StatName, Amount, Limiter);
    };

    this.LevelStat = function (Type, StatName) {
        var TargetScore = this.GetStatXP(Type, StatName) < 0 ? -1 : 1;
        var Leveling = this.GetLeveling(Type, StatName, TargetScore);
        if ((Math.abs(this.GetStatXP(Type, StatName))) < Leveling["COST"]) return;

        if (TargetScore < 0 && this.GetStat(Type, StatName) == this.GetMinStat(Type, StatName)) return;
        if (TargetScore > 0 && this.GetStat(Type, StatName) == this.GetMaxStat(Type, StatName)) return;

        console.log("Leveling Stat:"+StatName+"("+this.GetStat(Type, StatName)+")");

        var Cost = (TargetScore < 0) ? Leveling["COST"] : (Leveling["COST"] * -1.0);
        var Step = (TargetScore < 0) ? (Leveling["STEP"] * -1.0) : Leveling["STEP"];

        if (Type == "STAT") {
            if (StatName == "WillPower") {
                if (Step < 0) {
                    this.SleepLog.push(this.pBodyChange("WillPower", "Shrink"));
                } else {
                    this.SleepLog.push(this.pBodyChange("WillPower", "Grow"));
                }
            }

            if (StatName == "Hormones") {
                if (Step < 0 ) {
                    this.SleepLog.push(this.pBodyChange("Hormones", "Shrink"));
                } else {
                    this.SleepLog.push(this.pBodyChange("Hormones", "Grow"));
                }
            }
            this.AdjustStat(StatName, Step);
        }

        if (Type == "SKILL") this.AdjustSkill(StatName, Step);
        if (Type == "BODY") {
            this.AdjustBody(StatName, Step);
            if (Step < 0) {
                this.SleepLog.push(this.pBodyChange(StatName, "Shrink"));
            } else {
                this.SleepLog.push(this.pBodyChange(StatName, "Grow"));
            }
        }
        this.AdjustXP(Type, StatName, Cost);

    };

    this.LevelStatGroup = function (Type) {
        var Keys;
        if (Type == "STAT") Keys = Object.keys(this.CoreStats);
        if (Type == "SKILL") Keys = Object.keys(this.Skills);
        if (Type == "BODY") Keys = Object.keys(this.BodyStats);

        for (var i = 0; i < Keys.length; i++) this.LevelStat(Type, Keys[i]);
    };

    this.AdjustMoney = function (m) {
        this.Money = Math.max(0, (this.Money + m));
    };

    this.RandomAdjustBodyXP = function (Amount) {
        this.AdjustBodyXP(Object.keys(this.BodyStats)[Math.floor(Math.random() * Object.keys(this.BodyStats).length)], Amount, 0);
    };

    this.DoHealing = function (OvernightFlag) {
        var Heal = 5 + ( (this.GetStat("STAT", "Energy")*2) + (this.GetStat("STAT", "Fitness") / 10));
        Heal = Heal * (( 100 - Math.max(0, Math.min(this.GetStat("STAT", "Toxicity"), 100))) / 100); // Toxicity up to 100 reduces natural healing.

        if (OvernightFlag == 0) Heal = Heal / 2;
        if (OvernightFlag == 1) this.AdjustStat("Energy", ( Math.floor((this.GetStat("STAT", "Nutrition") / 20) + (this.GetStat("STAT", "Fitness") / 20))));

        this.AdjustStat("Health",   Math.ceil(Heal));

        if (OvernightFlag == 1) {
            var PoisonDamage = Math.ceil((this.GetStat("STAT", "Health") * ((Math.max(0, Math.min((this.GetStat("STAT", "Toxicity") - 100), 200)) / 10) * 0.1))); // 0 - .2
            if (PoisonDamage > 0) {
                this.AdjustStat("Health", (PoisonDamage * -0.5));
                this.SleepLog.push("@@color:red;&dArr;You feel slightly sick@@... your current " + window.App.PR.ColorizeString(this.GetStatPercent("STAT", "Toxicity"), "Toxicity") +
                    " is probably to blame.");
            }
        }
    };

    // Resting and Sleeping functions.
    this.NextDay = function () {
        this.SleepLog = []; // Null the overnight results text log.

        // Basic Stat Mods
        this.AdjustStat("Nutrition", -5);
        this.AdjustStat("Toxicity", -( (5 + (this.CoreStats["Fitness"] / 10)))*2);
        this.DoHealing(1);

        // Basic XP Adding
        this.AdjustStatXP("Hormones", ((this.GetStat("BODY", "Balls") / 5) * -1.0)); // Bigger balls add more male hormones.
        this.AdjustBodyXP("Hair", 4, 0); // Hair grows about 0.05 CM per day.

        this.LevelStatGroup("STAT");

        //Adjust physical characteristics based on hormone balance.
        var HormoneShift = 0;

        if (this.GetStat("STAT", "Hormones") > 100) {
            HormoneShift = ( this.GetStat("STAT", "Hormones") - 100 );
            this.AdjustBodyXP("Face",   HormoneShift            ,     40);
            this.AdjustBodyXP("Bust",   HormoneShift            ,     20);
            this.AdjustBodyXP("Lips",   HormoneShift            ,     50);
            this.AdjustBodyXP("Ass",    HormoneShift            ,     20);
            this.AdjustBodyXP("Hips",   HormoneShift            ,     20);
            this.AdjustBodyXP("Penis", (HormoneShift * -1.0)    ,      1);
            this.AdjustBodyXP("Balls", (HormoneShift * -1.0)    ,      0);
        } else {
            HormoneShift = ( 100 - this.GetStat("STAT", "Hormones"));
            this.AdjustBodyXP("Face",  (HormoneShift * -1.0)    ,   this.GetStartStat("BODY", "Face"));
            this.AdjustBodyXP("Bust",  (HormoneShift * -1.0)    ,   this.GetStartStat("BODY", "Bust"));
            this.AdjustBodyXP("Lips",  (HormoneShift * -1.0)    ,   this.GetStartStat("BODY", "Lips"));
            this.AdjustBodyXP("Ass",   (HormoneShift * -1.0)    ,   this.GetStartStat("BODY", "Ass"));
            this.AdjustBodyXP("Hips",  (HormoneShift * -1.0)    ,   this.GetStartStat("BODY", "Hips"));
            this.AdjustBodyXP("Penis",  HormoneShift            ,   this.GetStartStat("BODY", "Penis"));
            this.AdjustBodyXP("Balls",  HormoneShift            ,   this.GetStartStat("BODY", "Balls"));
        }

        this.ApplyClothingEffects();

        //Level remaining stats
        if ( this.GetStatXP("STAT", "Nutrition") > 150) this.AdjustBodyXP("Waist", (150 - this.GetStatXP("STAT", "Nutrition"))); // Get Fatter!?
        this.LevelStatGroup("BODY");
        this.LevelStatGroup("SKILL");

        this.HairBonus = 0;
        this.MakeupBonus = 0;
        this.HairStyle = "bed head";
        this.MakeupStyle = "plain faced";

        this.Day++;
        this.SailDays = (this.SailDays + 1) > 49 ? 1 : (this.SailDays + 1);
        this.Phase = 0;

        if (this.CoreStats["Nutrition"] < 20) {
            this.SleepLog.push("@@color:red;You are starving!@@");
            this.AdjustStat("Energy", -1); // Reduce Energy.
            this.AdjustStat("Health", -15);
            this.AdjustBodyXP("Waist", -50, 30);
        }

        this.NPCNextDay();

    }; // NextDay

    /**
     * Move time counter to next phase of day.
     * @param [Opt] - Number of phases to increment.
     */
    this.NextPhase = function (Opt) {
        Opt = Opt || 1;

        for (var i = 0; i < Opt; i++ ) {
            this.Phase++;
            this.AdjustStat("Nutrition", -5);
            this.LevelStat("STAT", "Nutrition");
            if (this.Phase == 4) break;
        }
    };

    this.Rest = function () {
        this.SleepLog = [];
        this.NextPhase(1);
        this.DoHealing(0);
        this.AdjustStat("Energy", 1);
        this.LevelStatGroup("SKILL");
    };

    this.NPCNextDay = function () {
        for (var prop in this.NPCS) { // NPC mood/desire/quest flags.
            if (!this.NPCS.hasOwnProperty(prop)) continue;
            if (this.NPCS[prop] == 0) continue;
            this.NPCS[prop].AdjustFeelings();
            this.NPCS[prop].ResetFlags();
        }
    };

    /**
     * @returns {*}
     */
    this.GetShipLocation = function () {
        var Routes = window.App.Data.Lists["ShipRoute"];
        if (!Routes.hasOwnProperty(this.SailDays)) return 0;
        return Routes[this.SailDays];
    };

    this.ApplyClothingEffects = function () {
        for (var prop in this.Equipment) {
            if (!this.Equipment.hasOwnProperty(prop)) continue;
            if (this.Equipment[prop] == 0) continue;
            this.ApplyEffects(this.Equipment[prop].WearEffect());
        }
    };

    // Equipment and Inventory Related Functions

    /**
     *
     * @param ItemDict
     * @returns {boolean}
     */
    this.OwnsWardrobeItem = function(ItemDict)
    {
        if (ItemDict["TYPE"] != "CLOTHES") return false;
        if (this.Wardrobe.filter( function(o){return o.Name() == ItemDict["TAG"];}).length > 0 ) return true;
        var Slot = window.App.Data.Clothes[ItemDict["TAG"]]["Slot"];
        if ((this.Equipment[Slot] === undefined) || (this.Equipment[Slot] == 0)) return false;
        if (this.Equipment[Slot].Name() == ItemDict["TAG"]) return true;
    };

    /**
     * @param ItemDict
     * @returns {boolean}
     */
    this.MaxItemCapacity = function(ItemDict)
    {
        var o = this.GetItemByName(ItemDict["TAG"]);

        if (o != undefined) {
            if ( o.Charges() >= 100 ) return true;
        }
        return false;
    };

    this.WardrobeItem = function (id) {
        return this.Wardrobe.filter(function (o) {
            return o.Id() == id;
        })[0];
    };

    this.WardrobeItemsBySlot = function(Slot) {
        return this.Wardrobe.filter(function(Item) { return Item.Slot() == Slot;});
    };

    /**
     * @param {string} Slot
     * @returns {string}
     */
    this.PrintEquipment = function(Slot)
    {
        if (!this.Equipment.hasOwnProperty(Slot)) return "@@color:grey;Nothing@@";
        if (this.Equipment[Slot] == 0 ) return "@@color:grey;Nothing@@";
        return this.Equipment[Slot].Description();
    };

    /**
     * @param {string} Slot
     * @returns {*}
     */
    this.GetEquipmentInSlot = function(Slot) {
        if ( (!this.Equipment.hasOwnProperty(Slot)) || (this.Equipment[Slot] == 0 )) return 0;
        return this.Equipment[Slot];
    };

    this.Wear = function (item) {
        for (var i = 0; i < item.Restrict().length; i++) this.Remove(this.Equipment[item.Restrict()[i]]);
        this.Equipment[item.Slot()] = item;
        this.Wardrobe = this.Wardrobe.filter(function (o) {
            return o.Id() != item.Id();
        });
    };

    this.Strip = function() {
        for (var prop in this.Equipment) {
            if (!this.Equipment.hasOwnProperty(prop)) continue;
            if (this.Equipment[prop] == 0) continue;
            if (this.Equipment[prop].IsLocked() == 1) continue;

            this.Remove(this.Equipment[prop]);
        }
    };

    this.Remove = function (item) {
        if (item == 0) return;
        this.Equipment[item.Slot()] = 0;
        this.Wardrobe.push(item);
    };

    this.HasItemByType = function (Type) {
        return this.Inventory.filter(function (o) {
            return o.Type() == Type;
        });
    };
    this.GetItemByName = function (Name) {
        return this.Inventory.filter(function (o) {
            return o.Name() == Name;
        })[0];
    };
    this.GetItemById = function (Id) {
        return this.Inventory.filter(function (o) {
            return o.Id() == Id;
        })[0];
    };
    this.GetItemByTypes = function (Types) {
        return this.Inventory.filter(function (o) {
            return Types.indexOf(o.Type()) != -1;
        });
    };

    /**
     * @param {string} Type
     * @param {string} Bonus
     * @returns {number}
     */
    this.GetBestItem = function (Type, Bonus) {
        var items = this.GetItemByTypes([Type]);
        var o = 0;
        for (var i = 0; i < items.length; i++) {
            if (o == 0) {
                o = items[i];
            } else if (items[i].GetBonus(Bonus)[0] > o.GetBonus(Bonus)[0]) {
                o = items[i];
            }
        }
        return o;
    };

    /**
     * Returns the total number of charges across all items belonging to a certain type.
     * @param {string} Type
     * @returns {number}
     */
    this.GetItemCharges = function(Type) {
        var Items = this.Inventory.filter(function (o) { return o.Type() == Type; });
        var Count = 0;
        for (var i = 0; i < Items.length; i++) Count += Items[i].Charges();
        return Count;
    };

    /**
     * Attempt to iterate through all items of same type and consume charges from them until Amount has been
     * satisfied. It will delete items if it consumes all their charges.
     * @param {string} Type
     * @param {number} Amount
     */
    this.UseItemCharges = function(Type, Amount) {
        if (Amount <= 0) return ;
        var Items = this.Inventory.filter(function (o) { return o.Type() == Type; });
        var Count = 0;

        while(Amount > 0 && Count < Items.length) {
            var Item = Items[Count];
            if (Item.Charges() <= 0) {
                this.DeleteItem(Item);
                Count++;
            } else {
                Item.RemoveCharge(1);
                Amount -= 1;
            }
        }
    };

    this.DeleteItem = function (item) {
        this.Inventory = this.Inventory.filter(function (o) {
            return o.Id() != item.Id();
        });
    };

    /**
     * Create and add an item to the player.
     * @param {string} Category
     * @param {string} Name
     * @param {number} Count
     * @param {string} [Opt]
     */
    this.AddItem = function (Category, Name, Count, Opt) {
        //Count = Count || 1;

        var Item = window.App.Item.Factory(Category, Name, Count);

        if (Category == "CLOTHES") {
            this.Wardrobe.push(Item);
            if (Opt == "WEAR") this.Wear(Item);
            return;
        }

        var ItemArray = $.grep(this.Inventory, function(o) { return o.Name() == Item.Name(); });

        if (ItemArray.length != 0) {
            console.log("Charges="+Item.Charges());
            ItemArray[0].AddCharge(Item.Charges());
        } else {
            this.Inventory.push(Item);
        }
    };

    /**
     * @param {string} Skill
     * @returns {number}
     */
    this.GetWornSkillBonus = function (Skill) {
        var bonus = 0;
        for (var prop in this.Equipment) {
            if (!this.Equipment.hasOwnProperty(prop)) continue;
            if (this.Equipment[prop] == 0) continue;
            if (this.Equipment[prop].HasBonus(Skill) == 0) continue;
            bonus += this.Equipment[prop].GetBonus(Skill)[0];
        }
        return 0;
    };

    this.ApplyEffects = function (Effects) {
        for (var prop in Effects) {
            if (!Effects.hasOwnProperty(prop)) continue;

            if (prop in this.CoreStats) {
                this.AdjustStat(prop, Effects[prop][0]);
                this.AdjustStatXP(prop, Effects[prop][1], Effects[prop][2]);
            } else if (prop in this.BodyStats) {
                this.AdjustBody(prop, Effects[prop][0]);
                this.AdjustBodyXP(prop, Effects[prop][1], Effects[prop][2]);
            } else if (prop in this.Skills) {
                this.AdjustSkill(prop, Effects[prop][0]);
                this.AdjustSkillXP(prop, Effects[prop][1], Effects[prop][2]);
            }
        }
    };

    this.UseItem = function (ItemId) {
        var o = this.GetItemById(ItemId);
        this.AddHistory("ITEMS", o.Name(), 1);
        this.ApplyEffects(o.UseEffect());
        o.RemoveCharge(1);
        if (o.Charges() <= 0) this.DeleteItem(o);
    };

    this.pBodyChange = function (BodyPart, Direction) {
        return window.App.Data.Lists["BodyChanges"][BodyPart][Direction];
    };

    /**
     * @param {string} Type
     * @param {string} Flag
     * @returns {*}
     */
    this.GetHistory = function(Type, Flag) {
        if ((typeof this.History[Type] === 'undefined')) return 0;
        if ((typeof this.History[Type][Flag] === 'undefined')) return 0;

        return this.History[Type][Flag];
    };

    this.AddHistory = function(Type, Flag, Amount) {
        if ((typeof this.History[Type] === 'undefined')) this.History[Type] = { };
        if ((typeof this.History[Type][Flag] === 'undefined')) this.History[Type][Flag] = 0;

        var t = this.GetHistory(Type, Flag);
        this.History[Type][Flag] = (t + Amount);
    };
};

/* twine-user-script #7: "QuestEngine.js" */
window.App = window.App || { Data: { }, Entity: { } };
/**
 * This class manages the tracking of quests and handing out of rewards.
 * @constructor
 */
window.App.QuestEngine = new function() {

    /**
     * Retrieve a quest related flag.
     * @param {App.Entity.Player} Player
     * @param {string} Flag
     * @returns {*}
     */
    this.GetQuestFlag = function (Player, Flag) {
        if ((typeof Player.QuestFlags[Flag] === 'undefined')) return false;
        return Player.QuestFlags[Flag];
    };

    /**
     * Set a quest flag value.
     * @param {App.Entity.Player} Player
     * @param {String} Flag
     * @param {String} Value
     */
    this.SetQuestFlag = function (Player, Flag, Value) {
        Player.QuestFlags[Flag] = Value;
    };

    /**
     * Helper function for parsing evaluating quest checks.
     * @param {App.Entity.Player} Player - player being checked.
     * @param {String} Type - the type of check to perform.
     * @param {String} Key - key from check entry.
     * @param {Number} Value - value to check against.
     * @param {Number} Reverse - checking less than instead of greater than.
     * @returns {boolean}
     */
    this.CheckCondition = function(Player, Type, Key, Value, Reverse)
    {
        var NPC;

        if (Key.charAt(0) == '-')
            Key = Key.slice(1);

        switch (Type) {
            case "NPC_MOOD":
                NPC = Player.NPCS[Key];
                if ((NPC.Mood() < Value) && (Reverse == 0)) return false;
                if ((NPC.Mood() > Value) && (Reverse == 1)) return false;
                break;
            case "MONEY":
                if ((Player.Money < Value) && (Reverse == 0)) return false;
                if ((Player.Money > Value) && (Reverse == 1)) return false;
                break;
            case "STAT_BODY":
                if ((Player.GetStatPercent("BODY", Key) < Value) && (Reverse == 0)) return false;
                if ((Player.GetStatPercent("BODY", Key) >= Value) && (Reverse == 1)) return false;
                break;
            case "STAT_SKILL":
                if ((Player.GetStatPercent("SKILL", Key) < Value) && (Reverse == 0)) return false;
                if ((Player.GetStatPercent("SKILL", Key) >= Value) && (Reverse == 1)) return false;
                break;
            case "STAT_CORE":
                if ((Player.GetStatPercent("STAT", Key) < Value) && (Reverse == 0)) return false;
                if ((Player.GetStatPercent("STAT", Key) >= Value) && (Reverse == 1)) return false;
                break;
            case "HAS_ITEM":
                if ((Player.GetItemByName(Key).length < 1)) return false;
                if ((Player.GetItemByName(Key).Charges() < Value )) return false;
                break;
            case "FLAG":
                if (this.GetQuestFlag(Player, Key) != Value) return false;
                break;
            case "STYLE_CATEGORY":
                if ((Player.GetStyleSpecRating(Key) < Value) && (Reverse == 0)) return false;
                if ((Player.GetStyleSpecRating(Key) >= Value) && (Reverse == 1)) return false;
                break;
            case "HAIR_STYLE":
                if ( (Player.GetHairStyle() == Key) != Value) return false;
                break;
            case "HAIR_COLOR":
                if ( (Player.GetHairColor() == Key) != Value) return false;
                break;

        }
        return true;
    };

    /**
     * Returns an array of objects that represent reward entries.
     * @param {string} QuestID
     * @param {string} RewardType
     * @returns {*}
     */
    this.GetQuestRewards = function (QuestID, RewardType) {
        var r = window.App.Data.Quests[QuestID]["REWARD"];
        if (typeof RewardType === 'undefined') return r;
        return r.filter(function (o) {
            return o["REWARD_TYPE"] == RewardType;
        });
    };

    /**
     * Completes the quest. Pass optional arg of ChoiceItem to add an item from a selection dialogue.
     * Will add rewards from the REWARD array automatically that are not defined as TYPE=ITEM_CHOICE.
     * @param {App.Entity.Player} Player
     * @param {string} QuestID
     * @param {string} ChoiceItem
     */
    this.CompleteQuest = function (Player, QuestID, ChoiceItem) {
        Player.QuestFlags[QuestID] = "COMPLETED";
        var r = window.App.Data.Quests[QuestID]["REWARD"];
        var p = window.App.Data.Quests[QuestID]["POST"];
        var i = 0;

        for (i = 0; i < r.length; i++) {
            if (r[i]["REWARD_TYPE"] != "ITEM_CHOICE") {
                this.GiveQuestReward(Player, r[i]);
            } else if ((typeof ChoiceItem !== 'undefined') && (r[i]["NAME"] == ChoiceItem)) {
                Player.AddItem(r[i]["TYPE"], r[i]["NAME"], r[i]["AMOUNT"]);
            }
        }

        for (i = 0; i < p.length; i++) Player.QuestFlags[p[i]["NAME"]] = p[i]["VALUE"];

    };

    /**
     * Gives a reward to a player.
     * @param {App.Entity.Player} Player
     * @param {Object} QuestReward
     */
    this.GiveQuestReward = function (Player, QuestReward) {
        if (QuestReward["REWARD_TYPE"] == "MONEY") {
            Player.AdjustMoney(QuestReward["AMOUNT"]);
        } else if (QuestReward["REWARD_TYPE"] == "ITEM") {
            Player.AddItem(QuestReward["TYPE"], QuestReward["NAME"], QuestReward["AMOUNT"]);
        }
    };

    /**
     * Returns a list of quest entries that fit the criteria on the "flag" option.
     * cancomplete - Player can possibly complete these now.
     * available - Player can accept these quests.
     * completed - Quests the player has completed.
     * active - Quests that are currently active.
     * any - return all quests that match the above criteria.
     * @param {string} Flag
     * @param {App.Entity.Player} Player
     * @param {string} [NPC] - The NPC ID of the quest giver. Optional.
     * @returns {Array}
     */
    this.GetQuests = function (Flag, Player, NPC)
    {
        var Quests = [];
        var List = Object.keys(window.App.Data.Quests);

        for (var i = 0; i < List.length; i++) {
            var o = window.App.Data.Quests[List[i]];
            if (typeof NPC === 'undefined') {
                if ((Flag == 'cancomplete') && (this.CanCompleteQuest(Player, o["ID"]) == true)) Quests.push(o);
                if ((Flag == 'available' ) && (this.QuestAvailable(Player, o["ID"]) == true)) Quests.push(o);
                if ((Flag == 'completed' ) && (this.QuestCompleted(Player, o["ID"]) == true)) Quests.push(o);
                if ((Flag == 'active') && (this.QuestActive(Player, o["ID"]) == true)) Quests.push(o);
                if ((Flag == 'any') &&
                    ( (this.QuestActive(Player, o["ID"]) == true) || (this.QuestCompleted(Player, o["ID"]) == true) ||
                    (this.QuestAvailable(Player, o["ID"]) == true) || (this.CanCompleteQuest(Player, o["ID"]) == true))) Quests.push(o);
            } else {
                if ((Flag == 'cancomplete') && (o["GIVER"] == NPC) && (this.CanCompleteQuest(Player, o["ID"]) == true)) Quests.push(o);
                if ((Flag == 'available' ) && (o["GIVER"] == NPC) && (this.QuestAvailable(Player, o["ID"]) == true)) Quests.push(o);
                if ((Flag == 'completed' ) && (o["GIVER"] == NPC) && (this.QuestCompleted(Player, o["ID"]) == true)) Quests.push(o);
                if ((Flag == 'active') && (o["GIVER"] == NPC) && (this.QuestActive(Player, o["ID"]) == true)) Quests.push(o);
                if (((Flag == 'any') && (o["GIVER"] == NPC)) &&
                    ( (this.QuestActive(Player, o["ID"]) == true) || (this.QuestCompleted(Player, o["ID"]) == true) ||
                    (this.QuestAvailable(Player, o["ID"]) == true) || (this.CanCompleteQuest(Player, o["ID"]) == true))) Quests.push(o);
            }
        }

        return Quests;
    };

    /**
     * Returns if a quest is available to be accepted.
     * @param {App.Entity.Player} Player
     * @param {string} QuestID
     * @returns {boolean}
     */
    this.QuestAvailable = function (Player, QuestID) {
        if ((this.QuestCompleted(Player, QuestID) == true) || (this.QuestActive(Player, QuestID) == true)) return false;
        var PRE = window.App.Data.Quests[QuestID]["PRE"];
        for (var i = 0; i < PRE.length; i++)
            if (!this.QuestCompleted(Player, PRE[i])) return false;
        return true;
    };

    /**
     * Returns if the quest has been completed.
     * @param {App.Entity.Player} Player
     * @param {string} QuestID
     * @returns {boolean}
     */
    this.QuestCompleted = function (Player, QuestID) {
        return ((typeof Player.QuestFlags[QuestID] !== 'undefined') && (Player.QuestFlags[QuestID] == 'COMPLETED'));
    };

    /**
     * Returns if the quest is currently active (in progress).
     * @param {App.Entity.Player} Player
     * @param QuestID
     * @returns {boolean}
     */
    this.QuestActive = function (Player, QuestID) {
        return ((typeof Player.QuestFlags[QuestID] !== 'undefined') && (Player.QuestFlags[QuestID] == 'ACTIVE'));
    };

    /**
     * Checks to see if player can complete a quest as defined by Flag.
     * @param {App.Entity.Player} Player
     * @param {String} Flag
     * @returns {boolean}
     */
    this.CanCompleteQuest = function (Player, Flag) {
        if ((typeof Player.QuestFlags[Flag] === 'undefined')) return false;
        if (Player.QuestFlags[Flag] == 'COMPLETED') return false; // Should never happen eh??
        var checks = window.App.Data.Quests[Flag]["CHECKS"];
        var Name;
        var Reverse;

        for (var i = 0; i < checks.length; i++) {
            Name = checks[i]["NAME"];
            Reverse = 0;

            if (Name.charAt(0) == '-') {
                Name = Name.slice(1);
                Reverse = 1;
            }

            if ( this.CheckCondition(Player, checks[i]["TYPE"], Name, checks[i]["VALUE"], Reverse ) == false ) return false;

        }
        return true;
    };
};
/* twine-user-script #8: "StoreEngine.js" */
window.App = window.App || { Data: { }, Entity: { } };

window.App.StoreEngine = new function() {

    /**
     * Creates a store object and returns it to the Twine engine.
     * @param {App.Entity.Player} Player
     * @param {App.Entity.NPC} NPC
     * @returns {Store}
     */
    this.OpenStore = function(Player, NPC)
    {
        return new Store(Player, NPC, window.App.Data.Stores[NPC.StoreName()]);
    };

    /**
     * Checks to see if an NPC has a store inventory or not attached to them.
     * @param {App.Entity.NPC} NPC
     * @returns {boolean}
     */
    this.HasStore = function(NPC) {
        return (window.App.Data.Stores.hasOwnProperty(NPC.StoreName()));
    };

    /**
     * Is the NPCs store open.
     * @param {App.Entity.Player} Player
     * @param {App.Entity.NPC} NPC
     * @returns {boolean}
     */
    this.IsOpen = function(Player, NPC) {
        return ($.inArray(Player.Phase, window.App.Data.Stores[NPC.StoreName()]["OPEN"]) != -1);
    };

    /**
     * Lock/unlock a store item.
     * @param {App.Entity.Player} Player
     * @param {string} StoreKey
     * @param {string} ItemTag
     * @param {number} Locked
     * @constructor
     */
    this.ToggleStoreItem = function(Player, StoreKey, ItemTag, Locked)
    {
        var Match = Player.StoreInventory[StoreKey]["INVENTORY"].filter(
            function(Item) {
                return Item["TAG"] == ItemTag;
            });

        for (var i = 0; i < Match.length; i++)
            Match[i]["LOCK"] = Locked;
    };
};

/**
 * Store Container Object
 * @param {App.Entity.Player} Player
 * @param {App.Entity.NPC} NPC
 * @param {object} StoreData
 * @constructor
 */
var Store = function(Player, NPC, StoreData) {

    this._Player = Player;
    this._NPC = NPC;
    this._Data = StoreData;

    this.GetName = function() { return this._Data["NAME"]; };

    this.GetInventory = function(Category)
    {
        var Mood =  this._NPC.Mood();
        var Player = this._Player;

        var Inventory = $.grep( this._Player.StoreInventory[this._Data["ID"]]["INVENTORY"], function(Item) {
           return ((Item["LOCK"] != 1) && (Item["CATEGORY"] == Category) && (Mood >= Item["MOOD"]));
        });

        return Inventory.filter(function (Item) { return Player.OwnsWardrobeItem(Item) == false});
    };

    this.GetCommonInventory = function() {
        return this.GetInventory("COMMON");
    };

    this.GetRareInventory = function() {
        var Mood = this._NPC.Mood();
        return $.grep(this._Player.StoreInventory[this._Data["ID"]]["RARE"],
            function(Item) {
                return ((Item["LOCK"] != 1) && (Item["CATEGORY"] == "RARE") && (Mood >= Item["MOOD"]))
            });
    };

    this.PlayerCanAfford = function(Item)
    {
        return (this._Player.Money >= this.GetPrice(Item));
    };

    this.GetPrice = function(Item)
    {
        // Up to 50% discount with maximum NPC mood.
        return Math.round( (Item["PRICE"] - ((Item["PRICE"] / 2) * (this._NPC.Mood() / 100))));
    };

    this.BuyItem = function(Item)
    {
        Item["QTY"] = Math.max(0, (Item["QTY"] - 1));
        this._Player.AddItem(Item["TYPE"], Item["TAG"], 0);
        this._Player.AdjustMoney((this.GetPrice(Item) * -1.0));
    };

    this.StockInventory = function()
    {
        if ( ( this._Player.StoreInventory[this._Data["ID"]]["LAST_STOCKED"] == 0)
            || (this._Player.StoreInventory[this._Data["ID"]]["LAST_STOCKED"] + this._Data["RESTOCK"] <= this._Player.Day) ) {

            if (this._Player.StoreInventory[this._Data["ID"]]["INVENTORY"].length == 0)
                this._Player.StoreInventory[this._Data["ID"]]["INVENTORY"] = this._Data["INVENTORY"];

            for (var i = 0; i < this._Player.StoreInventory[this._Data["ID"]]["INVENTORY"].length; i++)
                this._Player.StoreInventory[this._Data["ID"]]["INVENTORY"][i]["QTY"] = this._Player.StoreInventory[this._Data["ID"]]["INVENTORY"][i]["MAX"];

            this._Player.StoreInventory[this._Data["ID"]]["RARE"] = [ ];

            var Mood = this._NPC.Mood();
            var Rares = $.grep(this._Player.StoreInventory[this._Data["ID"]]["INVENTORY"], function(Item) {
                return ((Item["CATEGORY"] == "RARE") && (Mood >= Item["MOOD"]) && (Item["LOCKED"] != 1));
            });

            if (Rares.length > 0) this._Player.StoreInventory[this._Data["ID"]]["RARE"].push($.extend({},Rares[Math.floor(Math.random() * Rares.length)]));

            this._Player.StoreInventory[this._Data["ID"]]["LAST_STOCKED"] = this._Player.Day;
        }
    };

    this.PrintItem = function(Item)
    {
        var oItem = window.App.Item.Factory( Item["TYPE"], Item["TAG"], 1);
        return oItem.Description();
    };

    this.StockInventory();

};
/* twine-user-script #9: "GameData.js" */
window.App = window.App || { Data: { }, Entity: { } };

window.App.Data.NPCS = {
			"Crew" : {
				"Name" : "Crew", // This is a place holder and not meant to be used as an actual NPC.
				"Mood" : 0,
                "Wealth" : 20,
				"DailyMood" : -5,
				"Lust" : 100,
				"DailyLust" : 20,
				"Title" : "Crew of the Salty Mermaid",
				"LongDesc" : "The crew of the Salty Mermaid are a murderous and ruthless bunch interested in killing... and plugging your sissy ass."
			},
			"Cook" : {
				"Name" : "Cookie",
				"Mood" : 20,
                "Wealth" : 30,
				"DailyMood" : -2,
				"Lust" : 50,
				"DailyLust" : 10,
				"Title" : "NPC_NAME, the Ship's Cook",
				"LongDesc" : "NPC_NAME is an older, balding and overweight man with a massive paunch. His clothes are usually filthy, covered in food and other mysterious substances. He leers at you with an evil grin.",
				"Store" : "GALLEY"
			},
			"Captain" : {
				"Name" : "Captain Reginald",
				"Mood" : 20,
                "Wealth" : 60,
				"DailyMood" : -2,
				"Lust" : 50,
				"DailyLust" : 10,
				"Title" : "NPC_NAME, plunderer of the Lost Coast",
				"LongDesc" : "NPC_NAME is an older, elegantly dressed man with well coiffed mane of long black hair and an almost aristocratic demeanor. He certainly doesn't look the part of a blood thirsty pirate, which is probably why he was so easily able to fool you."
			},
			"FirstMate" : {
				"Name" : "Kipler",
				"Mood" : 20,
                "Wealth" : 50,
				"DailyMood" : -2,
				"Lust" : 60,
				"DailyLust" : 10,
				"Title" : "First Mate NPC_NAME",
				"LongDesc" : "First Mate NPC_NAME is a huge man in his early 30's. Clean shaved and with a bald head, his massive muscles strike an imposing figure."
			},
			"Quartermaster" : {
				"Name" : "Julius",
				"Mood" : 20,
                "Wealth" : 40,
				"DailyMood" : -2,
				"Lust" : 50,
				"DailyLust" : 10,
				"Title" : "Quartermaster NPC_NAME",
				"LongDesc" : "NPC_NAME is a young man with freckles and a shock of red hair. He looks almost rodent-line in appearance and demeanor.",
				"Store" : "CARGO"
			},
            "IslaTavernKeeper" :  {
                "Name" : "Bosun",
                "Mood" : 40,
                "Wealth" : 40,
                "DailyMood" : 0,
                "Lust" : 40,
                "DailyLust" : 10,
                "Title" : "NPC_NAME, the Tavern Owner",
                "LongDesc" : "NPC_NAME is a grim faced middle aged man with a lazy eye and a poor disposition. He doesn't talk much and his customers like it that way.",
                "Store" : "ISLATAVERN"
            },
            "IslaShopKeeper" :  {
                "Name" : "Heddy",
                "Mood" : 40,
                "Wealth" : 40,
                "DailyMood" : 0,
                "Lust" : 40,
                "DailyLust" : 10,
                "Title" : "NPC_NAME, the Shopkeeper",
                "LongDesc" : "NPC_NAME is a popular town gossip and the proprietor of the only store on Isla Harbor. She is a sturdy middle aged woman with a heaving bosom and a wild crown of blond hair.",
                "Store" : "ISLASTORE"
            },
            "Jarvis" : {
                "Name" : "Jarvis",
                "Mood" : 40,
                "Wealth" : 60,
                "DailyMood" : 0,
                "Lust" : 50,
                "DailyLust" : 0,
                "Title" : "NPC_NAME, his Lordships Butler",
                "LongDesc" : "Despite having a few run-ins with NPC_NAME before your abduction, he doesn't seem to recognize you in your current state. He's an older gentleman with salt and pepper hair and a stern demeanor. As far as you know he's never been derelict in his duties, but then again there's always a first time..."
            },
            "LordRowe" : {
                "Name" : "Lord Rowe",
                "Mood" : 40,
                "Wealth" : 100,
                "DailyMood" : 0,
                "Lust" : 50,
                "DailyLust" : 1,
                "Title" : "NPC_NAME, Governor of Isla Harbor",
                "LongDesc" : "Despite being the father of GF_NAME, you don't know NPC_NAME any better than any of the other residents of Isla Harbor. His reputation however is one of being stern, "+
                    "fair, honest and plain spoken - all relatively rare traits for a member of the aristocracy. Due to concealing your relationship with his daughter he never took much notice of you, "+
                    "which is probably a good thing considering how you stumbled into Captain Reginald's trap. NPC_NAME is an older man, well into middle age, but still retaining an air of vitality. His "+
                    "hair is still full and he sports a salt-and-pepper colored beard."
            }
                };

window.App.Data.Names = {
            "Male": ["Ailen", "Aldritch", "Allan", "Arnold", "Austyn", "Ayden",
                "Bobby", "Brennan", "Brewster", "Brod", "Barthon",
                "Cal", "Clifford", "Colby", "Conner", "Creighton", "Cruz",
                "Dale", "Devyn", "Dexter", "Dylan", "Dover", "Dwight",
                "Elfred", "Erick",
                "Fredrich", "Felix", "Faustino",
                "Garfield", "Gerard", "Granger", "Gimedon", "Grumdonore", "Gulgurn",
                "Harman", "Hawthorne", "Hector", "Howard", "Hulfahgrum", "Hjoluadren",
                "Johan", "Jon", "Josef", "Junior",
                "Kameron", "Keanu", "Keegan", "Kramahnam",
                "Leroy", "Larry", "Leonard",
                "Marc", "Manton", "Milton", "Magtharn", "Muirrus",
                "Neddy", "Newman", "Normand", "Norris",
                "Oswald", "Oxton",
                "Ransford", "Regnauld", "Ridley", "Rinaldo", "Rochester", "Ryman",
                "Scot", "Seabright", "Shawn", "Stephen",
                "Taylor", "Townes", "Theramyr",
                "William", "Welsh", "Wescott", "Wheeler"],
            "Female": [
                "Abbie", "Aubree", "Arianna", "Alissa", "Astrid", "Alena", "Alice",
                "Bobbi", "Brianne", "Brittney", "Bailey", "Blossom", "Bianca", "Buttercup", "Bubbles",
                "Clovis", "Carly", "Catie", "Chloe",
                "Dixie", "Delilah", "Dellie", "Dinah", "Demi", "Daisy",
                "Edlyn", "Emi", "Evie", "Emma",
                "Fanny", "Felicia", "Fossie", "Fina",
                "Gretchen", "Gabbi",
                "Heidi", "Hayley",
                "Isabelle", "Isolde",
                "Josie", "Joelle", "Jenni", "Jacki", "Jynri",
                "Kimmi", "Kelli", "Kylie", "Kyla", "Kailee", "Kitty",
                "Luella", "Lisbeth", "Lisa", "Lizzie", "Lenora",
                "Missy", "Miranda", "Molly", "Mitsi", "Maya", "Macie", "Mina",
                "Nikki", "Nadia",
                "Ophelia",
                "Penny", "Paula", "Priss", "Peaches",
                "Rosie", "Robin",
                "Sylvie", "Shelli", "Suzy", "Svetlana",
                "Tessa", "Tanis", "Taffy", "Telia", "Tabbi",
                "Uma", "Ursula", "Uta", "Ursula",
                "Vannesa", "Vixen", "Vicki", "Victoria",
                "Wanda", "Winnie",
                "Yvette", "Yolanda", "Yessica",
                "Zoe"]
        };

window.App.Data.Lists = {
            "SkillSynergy" : {
                "HandJobs"      : [ { "TYPE" : "BODY", "NAME" : "Face" ,        "BONUS" : 0.50},
                                    { "TYPE" : "STAT", "NAME" : "Femininity" ,  "BONUS" : 0.25}],
                "BlowJobs"      : [ { "TYPE" : "BODY", "NAME" : "Lips" ,        "BONUS" : 0.50},
                                    { "TYPE" : "STAT", "NAME" : "Femininity" ,  "BONUS" : 0.25}],
                "TitFucking"    : [ { "TYPE" : "BODY", "NAME" : "Bust" ,        "BONUS" : 0.50},
                                    { "TYPE" : "STAT", "NAME" : "Femininity" ,  "BONUS" : 0.25}],
                "AssFucking"    : [ { "TYPE" : "BODY", "NAME" : "Ass" ,         "BONUS" : 0.50},
                                    { "TYPE" : "STAT", "NAME" : "Femininity" ,  "BONUS" : 0.25}],
                "Seduction"     : [ { "TYPE" : "STAT", "NAME" : "Femininity" ,  "BONUS" : 0.50}],
                "Dancing"       : [ { "TYPE" : "STAT", "NAME" : "Femininity" ,  "BONUS" : 0.25},
                                    { "TYPE" : "STAT", "NAME" : "Fitness" ,     "BONUS" : 0.25}],
                "Swashbuckling" : [ { "TYPE" : "STAT", "NAME" : "Fitness" ,     "BONUS" : 0.50}]
            },
            "BodyConfig" : {
                "Face": { "MIN" : 0, "MAX" : 100, "START" : 20, "CM_MIN" : 0, "CM_MAX": 0,
                    "LEVELING" : {
                         0 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "hideous",      "COLOR" :  0},
                         4 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "offensive",    "COLOR" :  1},
                         8 : { "COST" :  140, "STEP" : 1, "ADJECTIVE" : "rough",        "COLOR" :  2},
                        13 : { "COST" :  150, "STEP" : 1, "ADJECTIVE" : "coarse",       "COLOR" :  3},
                        18 : { "COST" :  175, "STEP" : 1, "ADJECTIVE" : "homely",       "COLOR" :  3},
                        24 : { "COST" :  160, "STEP" : 1, "ADJECTIVE" : "ordinary",     "COLOR" :  4},
                        29 : { "COST" :  210, "STEP" : 1, "ADJECTIVE" : "unrefined",    "COLOR" :  5},
                        34 : { "COST" :  220, "STEP" : 1, "ADJECTIVE" : "fair",         "COLOR" :  6},
                        39 : { "COST" :  240, "STEP" : 1, "ADJECTIVE" : "nice",         "COLOR" :  7},
                        44 : { "COST" :  260, "STEP" : 1, "ADJECTIVE" : "pleasing",     "COLOR" :  8},
                        49 : { "COST" :  280, "STEP" : 1, "ADJECTIVE" : "appealing",    "COLOR" :  8},
                        54 : { "COST" :  300, "STEP" : 1, "ADJECTIVE" : "delightful",   "COLOR" :  9},
                        59 : { "COST" :  320, "STEP" : 1, "ADJECTIVE" : "pretty",       "COLOR" : 10},
                        63 : { "COST" :  420, "STEP" : 1, "ADJECTIVE" : "lovely",       "COLOR" : 11},
                        67 : { "COST" :  440, "STEP" : 1, "ADJECTIVE" : "alluring",     "COLOR" : 11},
                        71 : { "COST" :  460, "STEP" : 1, "ADJECTIVE" : "stunning",     "COLOR" : 12},
                        75 : { "COST" :  480, "STEP" : 1, "ADJECTIVE" : "dazzling",     "COLOR" : 12},
                        79 : { "COST" :  500, "STEP" : 1, "ADJECTIVE" : "exquisite",    "COLOR" : 13},
                        83 : { "COST" :  520, "STEP" : 1, "ADJECTIVE" : "gorgeous",     "COLOR" : 14},
                        87 : { "COST" :  540, "STEP" : 1, "ADJECTIVE" : "beautiful",    "COLOR" : 14},
                        91 : { "COST" :  560, "STEP" : 1, "ADJECTIVE" : "magnificent",  "COLOR" : 15},
                        95 : { "COST" :  600, "STEP" : 1, "ADJECTIVE" : "radiant",      "COLOR" : 16},
                        99 : { "COST" :  650, "STEP" : 1, "ADJECTIVE" : "bewitching",   "COLOR" : 16},
                       100 : { "COST" : 2800, "STEP" : 1, "ADJECTIVE" : "angelic",      "COLOR" : 16}
                    }
                },
                "Lips": { "MIN" : 0, "MAX" : 100, "START" : 20, "CM_MIN" : 0, "CM_MAX": 0,
                    "LEVELING" : {
                       5 :  { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "withered",          "COLOR" :  1},
                       10 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "wilted",            "COLOR" :  2},
                       15 : { "COST" :  125, "STEP" : 1, "ADJECTIVE" : "wrinkled",          "COLOR" :  3},
                       20 : { "COST" :  125, "STEP" : 1, "ADJECTIVE" : "thin",              "COLOR" :  4},
                       26 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "narrow",            "COLOR" :  5},
                       32 : { "COST" :  225, "STEP" : 1, "ADJECTIVE" : "puckered",          "COLOR" :  6},
                       38 : { "COST" :  250, "STEP" : 1, "ADJECTIVE" : "rounded",           "COLOR" :  7},
                       46 : { "COST" :  300, "STEP" : 1, "ADJECTIVE" : "plump",             "COLOR" :  8},
                       54 : { "COST" :  350, "STEP" : 1, "ADJECTIVE" : "full",              "COLOR" :  9},
                       62 : { "COST" :  400, "STEP" : 1, "ADJECTIVE" : "thick",             "COLOR" : 10},
                       71 : { "COST" :  450, "STEP" : 1, "ADJECTIVE" : "prominent",         "COLOR" : 12},
                       80 : { "COST" :  500, "STEP" : 1, "ADJECTIVE" : "tremulous",         "COLOR" : 13},
                       89 : { "COST" :  550, "STEP" : 1, "ADJECTIVE" : "luscious",          "COLOR" : 15},
                       98 : { "COST" :  600, "STEP" : 1, "ADJECTIVE" : "cartoonishly huge", "COLOR" : 16},
                      100 : { "COST" : 1500, "STEP" : 1, "ADJECTIVE" : "dick sucking",      "COLOR" : 16}
                    }
                },
                "Bust": { "MIN" : 0, "MAX" : 100, "START" : 0, "CM_MIN" : 80, "CM_MAX": 130,
                    "LEVELING" : {
                        0 : { "COST" : 100, "STEP" : 1, "ADJECTIVE" : "flat",        "COLOR" :  0},
                        1 : { "COST" : 100, "STEP" : 1, "ADJECTIVE" : "swollen",     "COLOR" :  1},
                        2 : { "COST" : 100, "STEP" : 1, "ADJECTIVE" : "small",       "COLOR" :  2},
                        3 : { "COST" : 150, "STEP" : 1, "ADJECTIVE" : "perky",       "COLOR" :  3},
                        5 : { "COST" : 150, "STEP" : 1, "ADJECTIVE" : "average",     "COLOR" :  3},
                        8 : { "COST" : 150, "STEP" : 1, "ADJECTIVE" : "ample",       "COLOR" :  4},
                       11 : { "COST" : 175, "STEP" : 1, "ADJECTIVE" : "shapely",     "COLOR" :  5},
                       15 : { "COST" : 175, "STEP" : 1, "ADJECTIVE" : "sizable",     "COLOR" :  6},
                       19 : { "COST" : 200, "STEP" : 1, "ADJECTIVE" : "prominent",   "COLOR" :  7},
                       24 : { "COST" : 200, "STEP" : 1, "ADJECTIVE" : "luscious",    "COLOR" :  8},
                       29 : { "COST" : 220, "STEP" : 1, "ADJECTIVE" : "plentiful",   "COLOR" :  8},
                       34 : { "COST" : 300, "STEP" : 1, "ADJECTIVE" : "generous",    "COLOR" :  9},
                       39 : { "COST" : 325, "STEP" : 1, "ADJECTIVE" : "pendulous",   "COLOR" : 10},
                       44 : { "COST" : 350, "STEP" : 1, "ADJECTIVE" : "substantial", "COLOR" : 11},
                       49 : { "COST" : 375, "STEP" : 1, "ADJECTIVE" : "voluptuous",  "COLOR" : 11},
                       54 : { "COST" : 400, "STEP" : 1, "ADJECTIVE" : "extensive",   "COLOR" : 12},
                       59 : { "COST" : 425, "STEP" : 1, "ADJECTIVE" : "voluminous",  "COLOR" : 12},
                       64 : { "COST" : 450, "STEP" : 1, "ADJECTIVE" : "gigantic",    "COLOR" : 13},
                       70 : { "COST" : 450, "STEP" : 1, "ADJECTIVE" : "stupendous",  "COLOR" : 14},
                       76 : { "COST" : 475, "STEP" : 1, "ADJECTIVE" : "massive",     "COLOR" : 14},
                       82 : { "COST" : 500, "STEP" : 1, "ADJECTIVE" : "colossal",    "COLOR" : 15},
                       88 : { "COST" : 525, "STEP" : 1, "ADJECTIVE" : "immense",     "COLOR" : 16},
                       94 : { "COST" : 550, "STEP" : 1, "ADJECTIVE" : "enormous",    "COLOR" : 16},
                      100 : { "COST" : 575, "STEP" : 1, "ADJECTIVE" : "mountainous", "COLOR" : 16}
                    }
                },
                "Ass": { "MIN" : 0, "MAX" : 100, "START" : 2, "CM_MIN" : 80, "CM_MAX": 130,
                    "LEVELING" : {
                        0 : { "COST" : 100, "STEP" : 1, "ADJECTIVE" : "bony",        "COLOR" :  0},
                        1 : { "COST" : 100, "STEP" : 1, "ADJECTIVE" : "flat",        "COLOR" :  1},
                        2 : { "COST" : 100, "STEP" : 1, "ADJECTIVE" : "skinny",      "COLOR" :  2},
                        3 : { "COST" : 150, "STEP" : 1, "ADJECTIVE" : "tiny",        "COLOR" :  3},
                        5 : { "COST" : 150, "STEP" : 1, "ADJECTIVE" : "thin",        "COLOR" :  3},
                        8 : { "COST" : 150, "STEP" : 1, "ADJECTIVE" : "average",     "COLOR" :  4},
                       11 : { "COST" : 175, "STEP" : 1, "ADJECTIVE" : "rounded",     "COLOR" :  5},
                       15 : { "COST" : 175, "STEP" : 1, "ADJECTIVE" : "curved",      "COLOR" :  6},
                       19 : { "COST" : 200, "STEP" : 1, "ADJECTIVE" : "ample",       "COLOR" :  7},
                       24 : { "COST" : 200, "STEP" : 1, "ADJECTIVE" : "thick",       "COLOR" :  8},
                       29 : { "COST" : 220, "STEP" : 1, "ADJECTIVE" : "full",        "COLOR" :  8},
                       34 : { "COST" : 300, "STEP" : 1, "ADJECTIVE" : "heavy",       "COLOR" :  9},
                       39 : { "COST" : 325, "STEP" : 1, "ADJECTIVE" : "plentiful",   "COLOR" : 10},
                       44 : { "COST" : 350, "STEP" : 1, "ADJECTIVE" : "sizable",     "COLOR" : 11},
                       49 : { "COST" : 375, "STEP" : 1, "ADJECTIVE" : "generous",    "COLOR" : 11},
                       54 : { "COST" : 400, "STEP" : 1, "ADJECTIVE" : "substantial", "COLOR" : 12},
                       59 : { "COST" : 425, "STEP" : 1, "ADJECTIVE" : "hefty",       "COLOR" : 12},
                       64 : { "COST" : 450, "STEP" : 1, "ADJECTIVE" : "extensive",   "COLOR" : 13},
                       70 : { "COST" : 450, "STEP" : 1, "ADJECTIVE" : "voluminous",  "COLOR" : 14},
                       76 : { "COST" : 475, "STEP" : 1, "ADJECTIVE" : "gigantic",    "COLOR" : 14},
                       82 : { "COST" : 500, "STEP" : 1, "ADJECTIVE" : "stupendous",  "COLOR" : 15},
                       88 : { "COST" : 525, "STEP" : 1, "ADJECTIVE" : "massive",     "COLOR" : 16},
                       94 : { "COST" : 550, "STEP" : 1, "ADJECTIVE" : "immense",     "COLOR" : 16},
                      100 : { "COST" : 575, "STEP" : 1, "ADJECTIVE" : "enormous",    "COLOR" : 16}
                    }
                },
                "Waist": { "MIN" : 0, "MAX" : 100, "START" : 46, "CM_MIN" : 40, "CM_MAX": 130,
                    "LEVELING" : {
                        0 : { "COST" : 3000, "STEP" : 1, "ADJECTIVE" : "wasp",           "COLOR" :  1},
                        5 : { "COST" :  720, "STEP" : 1, "ADJECTIVE" : "tiny",           "COLOR" :  2},
                       10 : { "COST" :  550, "STEP" : 1, "ADJECTIVE" : "small",          "COLOR" :  3},
                       17 : { "COST" :  375, "STEP" : 1, "ADJECTIVE" : "narrow",         "COLOR" :  4},
                       25 : { "COST" :  300, "STEP" : 1, "ADJECTIVE" : "thin",           "COLOR" :  5},
                       34 : { "COST" :  240, "STEP" : 1, "ADJECTIVE" : "slender",        "COLOR" :  6},
                       44 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "boyish",         "COLOR" :  7},
                       56 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "masculine",      "COLOR" :  8},
                       66 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "thickened",      "COLOR" :  9},
                       75 : { "COST" :  240, "STEP" : 1, "ADJECTIVE" : "chubby",         "COLOR" : 10},
                       83 : { "COST" :  300, "STEP" : 1, "ADJECTIVE" : "bulging",        "COLOR" : 12},
                       90 : { "COST" :  375, "STEP" : 1, "ADJECTIVE" : "ample",          "COLOR" : 13},
                       95 : { "COST" :  550, "STEP" : 1, "ADJECTIVE" : "hefty",          "COLOR" : 15},
                       99 : { "COST" :  720, "STEP" : 1, "ADJECTIVE" : "substantial",    "COLOR" : 16},
                      100 : { "COST" : 3000, "STEP" : 1, "ADJECTIVE" : "obese",          "COLOR" : 16}
                    }
                },
                "Hips": { "MIN" : 0, "MAX" : 100, "START" : 2, "CM_MIN" : 80, "CM_MAX": 130,
                    "LEVELING" : {
                         0 : { "COST" : 100, "STEP" : 1, "ADJECTIVE" : "bony",           "COLOR" :  0},
                         1 : { "COST" : 100, "STEP" : 1, "ADJECTIVE" : "boyish",         "COLOR" :  1},
                         2 : { "COST" : 100, "STEP" : 1, "ADJECTIVE" : "narrow",         "COLOR" :  2},
                         3 : { "COST" : 150, "STEP" : 1, "ADJECTIVE" : "lean",           "COLOR" :  3},
                         5 : { "COST" : 150, "STEP" : 1, "ADJECTIVE" : "thin",           "COLOR" :  3},
                         8 : { "COST" : 150, "STEP" : 1, "ADJECTIVE" : "slender",        "COLOR" :  4},
                        11 : { "COST" : 175, "STEP" : 1, "ADJECTIVE" : "girlish",        "COLOR" :  5},
                        15 : { "COST" : 175, "STEP" : 1, "ADJECTIVE" : "curved",         "COLOR" :  6},
                        19 : { "COST" : 200, "STEP" : 1, "ADJECTIVE" : "ample",          "COLOR" :  7},
                        24 : { "COST" : 200, "STEP" : 1, "ADJECTIVE" : "rounded",        "COLOR" :  8},
                        29 : { "COST" : 220, "STEP" : 1, "ADJECTIVE" : "plump",          "COLOR" :  8},
                        34 : { "COST" : 300, "STEP" : 1, "ADJECTIVE" : "shapely",        "COLOR" :  9},
                        39 : { "COST" : 325, "STEP" : 1, "ADJECTIVE" : "womanly",        "COLOR" : 10},
                        44 : { "COST" : 350, "STEP" : 1, "ADJECTIVE" : "broad",          "COLOR" : 11},
                        49 : { "COST" : 375, "STEP" : 1, "ADJECTIVE" : "generous",       "COLOR" : 11},
                        54 : { "COST" : 400, "STEP" : 1, "ADJECTIVE" : "substantial",    "COLOR" : 12},
                        59 : { "COST" : 425, "STEP" : 1, "ADJECTIVE" : "matronly",       "COLOR" : 12},
                        64 : { "COST" : 450, "STEP" : 1, "ADJECTIVE" : "extensive",      "COLOR" : 13},
                        70 : { "COST" : 450, "STEP" : 1, "ADJECTIVE" : "voluminous",     "COLOR" : 14},
                        76 : { "COST" : 475, "STEP" : 1, "ADJECTIVE" : "gigantic",       "COLOR" : 14},
                        82 : { "COST" : 500, "STEP" : 1, "ADJECTIVE" : "stupendous",     "COLOR" : 15},
                        88 : { "COST" : 525, "STEP" : 1, "ADJECTIVE" : "massive",        "COLOR" : 16},
                        94 : { "COST" : 550, "STEP" : 1, "ADJECTIVE" : "immense",        "COLOR" : 16},
                       100 : { "COST" : 575, "STEP" : 1, "ADJECTIVE" : "enormous",       "COLOR" : 16}
                    }
                },
                "Penis": { "MIN" : 1, "MAX" : 100, "START" : 44, "CM_MIN" : 1, "CM_MAX": 36,
                    "LEVELING" : {
                        0 : { "COST" : 3000, "STEP" : 1, "ADJECTIVE" : "micro",      "COLOR" :  1},
                        5 : { "COST" :  720, "STEP" : 1, "ADJECTIVE" : "tiny",       "COLOR" :  2},
                       10 : { "COST" :  550, "STEP" : 1, "ADJECTIVE" : "shriveled",  "COLOR" :  3},
                       17 : { "COST" :  375, "STEP" : 1, "ADJECTIVE" : "shrunken",   "COLOR" :  4},
                       25 : { "COST" :  300, "STEP" : 1, "ADJECTIVE" : "diminutive", "COLOR" :  5},
                       34 : { "COST" :  240, "STEP" : 1, "ADJECTIVE" : "small",      "COLOR" :  6},
                       44 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "normal",     "COLOR" :  7},
                       56 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "swollen",    "COLOR" :  8},
                       66 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "thick",      "COLOR" :  9},
                       75 : { "COST" :  240, "STEP" : 1, "ADJECTIVE" : "bulging",    "COLOR" : 10},
                       83 : { "COST" :  300, "STEP" : 1, "ADJECTIVE" : "huge",       "COLOR" : 12},
                       90 : { "COST" :  375, "STEP" : 1, "ADJECTIVE" : "gigantic",   "COLOR" : 13},
                       95 : { "COST" :  550, "STEP" : 1, "ADJECTIVE" : "stupendous", "COLOR" : 15},
                       99 : { "COST" :  720, "STEP" : 1, "ADJECTIVE" : "massive",    "COLOR" : 16},
                      100 : { "COST" : 3000, "STEP" : 1, "ADJECTIVE" : "enormous",   "COLOR" : 16}
                    }
                },
                "Hair": { "MIN" : 0, "MAX" : 100, "START" : 10, "CM_MIN" : 5, "CM_MAX" : 180,
                    "LEVELING" : {
                         5 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        10 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        15 : { "COST" :  125, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        20 : { "COST" :  125, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        26 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        32 : { "COST" :  225, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        38 : { "COST" :  250, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        46 : { "COST" :  300, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        54 : { "COST" :  350, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        62 : { "COST" :  400, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        71 : { "COST" :  450, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        80 : { "COST" :  500, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        89 : { "COST" :  550, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        98 : { "COST" :  600, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                       100 : { "COST" : 1500, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 }
                    }
                },
                "Height": { "MIN" : 0, "MAX" : 100, "START" : 50, "CM_MIN" : 145, "CM_MAX" : 220,
                    "LEVELING" : {
                         0 : { "COST" : 3000, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                         5 : { "COST" :  720, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        10 : { "COST" :  550, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        17 : { "COST" :  375, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        25 : { "COST" :  300, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        34 : { "COST" :  240, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        44 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        56 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        66 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        75 : { "COST" :  240, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        83 : { "COST" :  300, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        90 : { "COST" :  375, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        95 : { "COST" :  550, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                        99 : { "COST" :  720, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 },
                       100 : { "COST" : 3000, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 0 }
                    }
                },
                "Balls": { "MIN" : 0, "MAX" : 100, "START" : 44, "CM_MIN" : 1, "CM_MAX": 20,
                    "LEVELING" : {
                         0 : { "COST" : 3000, "STEP" : 1, "ADJECTIVE" : "micro",      "COLOR" :  1},
                         5 : { "COST" :  720, "STEP" : 1, "ADJECTIVE" : "tiny",       "COLOR" :  2},
                        10 : { "COST" :  550, "STEP" : 1, "ADJECTIVE" : "shriveled",  "COLOR" :  3},
                        17 : { "COST" :  375, "STEP" : 1, "ADJECTIVE" : "shrunken",   "COLOR" :  4},
                        25 : { "COST" :  300, "STEP" : 1, "ADJECTIVE" : "diminutive", "COLOR" :  5},
                        34 : { "COST" :  240, "STEP" : 1, "ADJECTIVE" : "small",      "COLOR" :  6},
                        44 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "normal",     "COLOR" :  7},
                        56 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "swollen",    "COLOR" :  8},
                        66 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "thick",      "COLOR" :  9},
                        75 : { "COST" :  240, "STEP" : 1, "ADJECTIVE" : "bulging",    "COLOR" : 10},
                        83 : { "COST" :  300, "STEP" : 1, "ADJECTIVE" : "huge",       "COLOR" : 12},
                        90 : { "COST" :  375, "STEP" : 1, "ADJECTIVE" : "gigantic",   "COLOR" : 13},
                        95 : { "COST" :  550, "STEP" : 1, "ADJECTIVE" : "stupendous", "COLOR" : 15},
                        99 : { "COST" :  720, "STEP" : 1, "ADJECTIVE" : "massive",    "COLOR" : 16},
                       100 : { "COST" : 3000, "STEP" : 1, "ADJECTIVE" : "enormous",   "COLOR" : 16}
                    }
                }
            },
			"SkillConfig" : {
				"HandJobs": { "MIN" : 0, "MAX" : 100, "START" : 0,
                    "LEVELING" : {
                         5 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  1},
                        10 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  2},
                        15 : { "COST" :  125, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  3},
                        20 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  4},
                        26 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  5},
                        32 : { "COST" :  250, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  6},
                        38 : { "COST" :  250, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  7},
                        46 : { "COST" :  350, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  8},
                        54 : { "COST" :  450, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  9},
                        62 : { "COST" :  450, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 10},
                        71 : { "COST" :  500, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 12},
                        80 : { "COST" :  500, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 13},
                        89 : { "COST" :  600, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 15},
                        98 : { "COST" :  600, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16},
                       100 : { "COST" : 1500, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16}
                    }
                },
				"TitFucking": { "MIN" : 0, "MAX" : 100, "START" : 0,
                    "LEVELING" : {
                         5 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  1},
                        10 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  2},
                        15 : { "COST" :  125, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  3},
                        20 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  4},
                        26 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  5},
                        32 : { "COST" :  250, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  6},
                        38 : { "COST" :  250, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  7},
                        46 : { "COST" :  350, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  8},
                        54 : { "COST" :  450, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  9},
                        62 : { "COST" :  450, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 10},
                        71 : { "COST" :  500, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 12},
                        80 : { "COST" :  500, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 13},
                        89 : { "COST" :  600, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 15},
                        98 : { "COST" :  600, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16},
                       100 : { "COST" : 1500, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16}
                    }
                },
				"BlowJobs": { "MIN" : 0, "MAX" : 100, "START" : 0,
                    "LEVELING" : {
                         5 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "dick licker", "COLOR" :  1},
                        10 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "dick licker", "COLOR" :  2},
                        15 : { "COST" :  125, "STEP" : 1, "ADJECTIVE" : "dick sucker", "COLOR" :  3},
                        20 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "cock sucker", "COLOR" :  4},
                        26 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "cock sucker", "COLOR" :  5},
                        32 : { "COST" :  250, "STEP" : 1, "ADJECTIVE" : "cock gobbler", "COLOR" :  6},
                        38 : { "COST" :  250, "STEP" : 1, "ADJECTIVE" : "cock gobbler", "COLOR" :  7},
                        46 : { "COST" :  350, "STEP" : 1, "ADJECTIVE" : "sperm swallower", "COLOR" :  8},
                        54 : { "COST" :  450, "STEP" : 1, "ADJECTIVE" : "sperm swallower", "COLOR" :  9},
                        62 : { "COST" :  450, "STEP" : 1, "ADJECTIVE" : "jizz drinker", "COLOR" : 10},
                        71 : { "COST" :  500, "STEP" : 1, "ADJECTIVE" : "jizz drinker", "COLOR" : 12},
                        80 : { "COST" :  500, "STEP" : 1, "ADJECTIVE" : "jizz drinker", "COLOR" : 13},
                        89 : { "COST" :  600, "STEP" : 1, "ADJECTIVE" : "cum gulper", "COLOR" : 15},
                        98 : { "COST" :  600, "STEP" : 1, "ADJECTIVE" : "cum gulper", "COLOR" : 16},
                       100 : { "COST" : 1500, "STEP" : 1, "ADJECTIVE" : "cock sucking queen", "COLOR" : 16}
                    }
                },
				"AssFucking": { "MIN" : 0, "MAX" : 100, "START" : 0,
                    "LEVELING" : {
                         5 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  1},
                        10 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  2},
                        15 : { "COST" :  125, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  3},
                        20 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  4},
                        26 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  5},
                        32 : { "COST" :  250, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  6},
                        38 : { "COST" :  250, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  7},
                        46 : { "COST" :  350, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  8},
                        54 : { "COST" :  450, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  9},
                        62 : { "COST" :  450, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 10},
                        71 : { "COST" :  500, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 12},
                        80 : { "COST" :  500, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 13},
                        89 : { "COST" :  600, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 15},
                        98 : { "COST" :  600, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16},
                       100 : { "COST" : 1500, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16}
                    }
                },
				"Dancing": { "MIN" : 0, "MAX" : 100, "START" : 5,
                    "LEVELING" : {
                         5 : { "COST" :   50, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  1},
                        10 : { "COST" :   50, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  2},
                        15 : { "COST" :   62, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  3},
                        20 : { "COST" :   62, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  4},
                        26 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  5},
                        32 : { "COST" :  112, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  6},
                        38 : { "COST" :  125, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  7},
                        46 : { "COST" :  150, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  8},
                        54 : { "COST" :  175, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  9},
                        62 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 10},
                        71 : { "COST" :  225, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 12},
                        80 : { "COST" :  250, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 13},
                        89 : { "COST" :  275, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 15},
                        98 : { "COST" :  300, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16},
                       100 : { "COST" :  750, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16}
                    }
                },
				"Singing": { "MIN" : 0, "MAX" : 100, "START" : 5,
                    "LEVELING" : {
                         5 : { "COST" :   50, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  1},
                        10 : { "COST" :   50, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  2},
                        15 : { "COST" :   62, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  3},
                        20 : { "COST" :   62, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  4},
                        26 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  5},
                        32 : { "COST" :  112, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  6},
                        38 : { "COST" :  125, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  7},
                        46 : { "COST" :  150, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  8},
                        54 : { "COST" :  175, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  9},
                        62 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 10},
                        71 : { "COST" :  225, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 12},
                        80 : { "COST" :  250, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 13},
                        89 : { "COST" :  275, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 15},
                        98 : { "COST" :  300, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16},
                       100 : { "COST" :  750, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16}
                    }
                },
				"Seduction": { "MIN" : 0, "MAX" : 100, "START" : 0,
                    "LEVELING" : {
                         5 : { "COST" :   50, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  1},
                        10 : { "COST" :   50, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  2},
                        15 : { "COST" :   62, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  3},
                        20 : { "COST" :   62, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  4},
                        26 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  5},
                        32 : { "COST" :  112, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  6},
                        38 : { "COST" :  125, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  7},
                        46 : { "COST" :  150, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  8},
                        54 : { "COST" :  175, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  9},
                        62 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 10},
                        71 : { "COST" :  225, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 12},
                        80 : { "COST" :  250, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 13},
                        89 : { "COST" :  275, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 15},
                        98 : { "COST" :  300, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16},
                       100 : { "COST" :  750, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16}
                    }
                },
				"Cooking": { "MIN" : 0, "MAX" : 100, "START" : 5,
                    "LEVELING" : {
                         5 : { "COST" :   50, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  1},
                        10 : { "COST" :   50, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  2},
                        15 : { "COST" :   62, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  3},
                        20 : { "COST" :   62, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  4},
                        26 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  5},
                        32 : { "COST" :  112, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  6},
                        38 : { "COST" :  125, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  7},
                        46 : { "COST" :  150, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  8},
                        54 : { "COST" :  175, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  9},
                        62 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 10},
                        71 : { "COST" :  225, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 12},
                        80 : { "COST" :  250, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 13},
                        89 : { "COST" :  275, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 15},
                        98 : { "COST" :  300, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16},
                       100 : { "COST" :  750, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16}
                    }
                },
				"Cleaning": { "MIN" : 0, "MAX" : 100, "START" : 5,
                    "LEVELING" : {
                         5 : { "COST" :   50, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  1},
                        10 : { "COST" :   50, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  2},
                        15 : { "COST" :   62, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  3},
                        20 : { "COST" :   62, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  4},
                        26 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  5},
                        32 : { "COST" :  112, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  6},
                        38 : { "COST" :  125, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  7},
                        46 : { "COST" :  150, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  8},
                        54 : { "COST" :  175, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  9},
                        62 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 10},
                        71 : { "COST" :  225, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 12},
                        80 : { "COST" :  250, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 13},
                        89 : { "COST" :  275, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 15},
                        98 : { "COST" :  300, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16},
                       100 : { "COST" :  750, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16}
                    }
                },
                "Serving": { "MIN" : 0, "MAX" : 100, "START" : 5,
                    "LEVELING" : {
                        5 : { "COST" :   50, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  1},
                        10 : { "COST" :   50, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  2},
                        15 : { "COST" :   62, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  3},
                        20 : { "COST" :   62, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  4},
                        26 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  5},
                        32 : { "COST" :  112, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  6},
                        38 : { "COST" :  125, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  7},
                        46 : { "COST" :  150, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  8},
                        54 : { "COST" :  175, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  9},
                        62 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 10},
                        71 : { "COST" :  225, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 12},
                        80 : { "COST" :  250, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 13},
                        89 : { "COST" :  275, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 15},
                        98 : { "COST" :  300, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16},
                        100 : { "COST" :  750, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16}
                    }
                },
				"Swashbuckling": { "MIN" : 0, "MAX" : 100, "START" : 0,
                    "LEVELING" : {
                         5 : { "COST" :   50, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  1},
                        10 : { "COST" :   50, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  2},
                        15 : { "COST" :   62, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  3},
                        20 : { "COST" :   62, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  4},
                        26 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  5},
                        32 : { "COST" :  112, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  6},
                        38 : { "COST" :  125, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  7},
                        46 : { "COST" :  150, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  8},
                        54 : { "COST" :  175, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  9},
                        62 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 10},
                        71 : { "COST" :  225, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 12},
                        80 : { "COST" :  250, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 13},
                        89 : { "COST" :  275, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 15},
                        98 : { "COST" :  300, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16},
                       100 : { "COST" :  750, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16}
                    }
                },
				"Sailing": { "MIN" : 0, "MAX" : 100, "START" : 0,
                    "LEVELING" : {
                         5 : { "COST" :   50, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  1},
                        10 : { "COST" :   50, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  2},
                        15 : { "COST" :   62, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  3},
                        20 : { "COST" :   62, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  4},
                        26 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  5},
                        32 : { "COST" :  112, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  6},
                        38 : { "COST" :  125, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  7},
                        46 : { "COST" :  150, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  8},
                        54 : { "COST" :  175, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  9},
                        62 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 10},
                        71 : { "COST" :  225, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 12},
                        80 : { "COST" :  250, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 13},
                        89 : { "COST" :  275, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 15},
                        98 : { "COST" :  300, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16},
                       100 : { "COST" :  750, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16}
                    }
                },
				"Navigating": { "MIN" : 0, "MAX" : 100, "START" : 0,
                    "LEVELING" : {
                         5 : { "COST" :   50, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  1},
                        10 : { "COST" :   50, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  2},
                        15 : { "COST" :   62, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  3},
                        20 : { "COST" :   62, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  4},
                        26 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  5},
                        32 : { "COST" :  112, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  6},
                        38 : { "COST" :  125, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  7},
                        46 : { "COST" :  150, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  8},
                        54 : { "COST" :  175, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  9},
                        62 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 10},
                        71 : { "COST" :  225, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 12},
                        80 : { "COST" :  250, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 13},
                        89 : { "COST" :  275, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 15},
                        98 : { "COST" :  300, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16},
                       100 : { "COST" :  750, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16}
                    }
                },
				"Styling": { "MIN" : 0, "MAX" : 100, "START" : 0,
                    "LEVELING" : {
                         5 : { "COST" :   50, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  1},
                        10 : { "COST" :   50, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  2},
                        15 : { "COST" :   62, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  3},
                        20 : { "COST" :   62, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  4},
                        26 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  5},
                        32 : { "COST" :  112, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  6},
                        38 : { "COST" :  125, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  7},
                        46 : { "COST" :  150, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  8},
                        54 : { "COST" :  175, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  9},
                        62 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 10},
                        71 : { "COST" :  225, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 12},
                        80 : { "COST" :  250, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 13},
                        89 : { "COST" :  275, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 15},
                        98 : { "COST" :  300, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16},
                       100 : { "COST" :  750, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16}
                    }
                }
			},
			"StatConfig" : {
                "Health": { "MIN" : 0, "MAX" : 100, "START" : 80,
					"LEVELING" : { 
						"FIXED" : { "COST" : 100, "STEP" : 1 }
						}
					},
                "Nutrition": { "MIN" : 0, "MAX" : 100, "START" : 100,
					"LEVELING" : { 
						"FIXED" : { "COST" : 100, "STEP" : 10 }
						}
					},
                "WillPower": { "MIN" : 0, "MAX" : 100, "START" : 100,
					"LEVELING" : { 
						"FIXED" : { "COST" : 100, "STEP" : 1 }
						}
					},
                "Perversion": { "MIN" : 0, "MAX" : 100, "START" : 0,
                    "LEVELING" : {
                         5 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  1},
                        10 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  2},
                        15 : { "COST" :  125, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  3},
                        20 : { "COST" :  125, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  4},
                        26 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  5},
                        32 : { "COST" :  225, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  6},
                        38 : { "COST" :  250, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  7},
                        46 : { "COST" :  300, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  8},
                        54 : { "COST" :  350, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  9},
                        62 : { "COST" :  400, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 10},
                        71 : { "COST" :  450, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 12},
                        80 : { "COST" :  500, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 13},
                        89 : { "COST" :  550, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 15},
                        98 : { "COST" :  600, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16},
                       100 : { "COST" : 1500, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16}
                    }
                },
                "Femininity": { "MIN" : 0, "MAX" : 100, "START" : 0,
                    "LEVELING" : {
                         5 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  1},
                        10 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  2},
                        15 : { "COST" :  125, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  3},
                        20 : { "COST" :  125, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  4},
                        26 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  5},
                        32 : { "COST" :  225, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  6},
                        38 : { "COST" :  250, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  7},
                        46 : { "COST" :  300, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  8},
                        54 : { "COST" :  350, "STEP" : 1, "ADJECTIVE" : "", "COLOR" :  9},
                        62 : { "COST" :  400, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 10},
                        71 : { "COST" :  450, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 12},
                        80 : { "COST" :  500, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 13},
                        89 : { "COST" :  550, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 15},
                        98 : { "COST" :  600, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16},
                       100 : { "COST" : 1500, "STEP" : 1, "ADJECTIVE" : "", "COLOR" : 16}
                    }
                },
                "Fitness": { "MIN" : 0, "MAX" : 100, "START" : 20,
                    "LEVELING" : {
                         5 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "unhealthy",    "COLOR" :  1},
                        10 : { "COST" :  100, "STEP" : 1, "ADJECTIVE" : "weak",         "COLOR" :  2},
                        15 : { "COST" :  125, "STEP" : 1, "ADJECTIVE" : "flabby",       "COLOR" :  3},
                        20 : { "COST" :  125, "STEP" : 1, "ADJECTIVE" : "lethargic",    "COLOR" :  4},
                        26 : { "COST" :  200, "STEP" : 1, "ADJECTIVE" : "inactive",     "COLOR" :  5},
                        32 : { "COST" :  225, "STEP" : 1, "ADJECTIVE" : "lazy",         "COLOR" :  6},
                        38 : { "COST" :  250, "STEP" : 1, "ADJECTIVE" : "normal",       "COLOR" :  7},
                        46 : { "COST" :  300, "STEP" : 1, "ADJECTIVE" : "active",       "COLOR" :  8},
                        54 : { "COST" :  350, "STEP" : 1, "ADJECTIVE" : "trim",         "COLOR" :  9},
                        62 : { "COST" :  400, "STEP" : 1, "ADJECTIVE" : "fit",          "COLOR" : 10},
                        71 : { "COST" :  450, "STEP" : 1, "ADJECTIVE" : "athletic",     "COLOR" : 12},
                        80 : { "COST" :  500, "STEP" : 1, "ADJECTIVE" : "toned",        "COLOR" : 13},
                        89 : { "COST" :  550, "STEP" : 1, "ADJECTIVE" : "robust",       "COLOR" : 15},
                        98 : { "COST" :  600, "STEP" : 1, "ADJECTIVE" : "energetic",    "COLOR" : 16},
                       100 : { "COST" : 1500, "STEP" : 1, "ADJECTIVE" : "vigorous",     "COLOR" : 16}
                    }
                },
                "Toxicity": { "MIN" : 0, "MAX" : 300, "START" : 30,
					"LEVELING" : { 
						"FIXED" : { "COST" : 100, "STEP" : 1 }
						}
					},
                "Hormones": { "MIN" : 0, "MAX" : 200, "START" : 20,
                    "LEVELING" : {
                        0 : { "COST" : 190, "STEP" : 1, "ADJECTIVE" : "macho"       , "COLOR" : 16},
                        2 : { "COST" : 180, "STEP" : 1, "ADJECTIVE" : "manly"       , "COLOR" : 15},
                        3 : { "COST" : 170, "STEP" : 1, "ADJECTIVE" : "manly"       , "COLOR" : 14},
                        6 : { "COST" : 160, "STEP" : 1, "ADJECTIVE" : "manly"       , "COLOR" : 13},
                       10 : { "COST" : 150, "STEP" : 1, "ADJECTIVE" : "masculine"   , "COLOR" : 12},
                       15 : { "COST" : 140, "STEP" : 1, "ADJECTIVE" : "masculine"   , "COLOR" : 10},
                       22 : { "COST" : 130, "STEP" : 1, "ADJECTIVE" : "masculine"   , "COLOR" :  9},
                       30 : { "COST" : 120, "STEP" : 1, "ADJECTIVE" : "boyish"      , "COLOR" :  8},
                       38 : { "COST" : 110, "STEP" : 1, "ADJECTIVE" : "boyish"      , "COLOR" :  7},
                       47 : { "COST" : 100, "STEP" : 1, "ADJECTIVE" : "boyish"      , "COLOR" :  6},
                       56 : { "COST" :  90, "STEP" : 1, "ADJECTIVE" : "weak"        , "COLOR" :  5},
                       67 : { "COST" :  80, "STEP" : 1, "ADJECTIVE" : "weak"        , "COLOR" :  4},
                       78 : { "COST" :  70, "STEP" : 1, "ADJECTIVE" : "androgynous" , "COLOR" :  3},
                       89 : { "COST" :  60, "STEP" : 1, "ADJECTIVE" : "androgynous" , "COLOR" :  2},
                      100 : { "COST" :  50, "STEP" : 1, "ADJECTIVE" : "androgynous" , "COLOR" :  1},
                      111 : { "COST" :  50, "STEP" : 1, "ADJECTIVE" : "androgynous" , "COLOR" :  1},
                      122 : { "COST" :  60, "STEP" : 1, "ADJECTIVE" : "androgynous" , "COLOR" :  2},
                      133 : { "COST" :  70, "STEP" : 1, "ADJECTIVE" : "androgynous" , "COLOR" :  3},
                      144 : { "COST" :  80, "STEP" : 1, "ADJECTIVE" : "effeminate"  , "COLOR" :  4},
                      153 : { "COST" :  90, "STEP" : 1, "ADJECTIVE" : "effeminate"  , "COLOR" :  5},
                      162 : { "COST" : 100, "STEP" : 1, "ADJECTIVE" : "girlish"     , "COLOR" :  6},
                      170 : { "COST" : 110, "STEP" : 1, "ADJECTIVE" : "girlish"     , "COLOR" :  7},
                      178 : { "COST" : 120, "STEP" : 1, "ADJECTIVE" : "girlish"     , "COLOR" :  8},
                      185 : { "COST" : 130, "STEP" : 1, "ADJECTIVE" : "feminine"    , "COLOR" :  9},
                      190 : { "COST" : 140, "STEP" : 1, "ADJECTIVE" : "feminine"    , "COLOR" : 10},
                      194 : { "COST" : 150, "STEP" : 1, "ADJECTIVE" : "feminine"    , "COLOR" : 12},
                      197 : { "COST" : 160, "STEP" : 1, "ADJECTIVE" : "womanly"     , "COLOR" : 13},
                      198 : { "COST" : 170, "STEP" : 1, "ADJECTIVE" : "womanly"     , "COLOR" : 14},
                      199 : { "COST" : 180, "STEP" : 1, "ADJECTIVE" : "womanly"     , "COLOR" : 15},
                      200 : { "COST" : 190, "STEP" : 1, "ADJECTIVE" : "ladylike"    , "COLOR" : 16}
                    }
                },
                "Energy": { "MIN" : 0, "MAX" : 10, "START" : 3,
					"LEVELING" : {
						"NONE" : { "COST" : 0, "STEP" : 0 }
						}
					}
				},
            "MakeupStyles" : [ // RES1 = BASIC MAKEUP, RES2 = EXPENSIVE MAKEUP
                    {"NAME"  : "minimal",       "DIFFICULTY" : 20,  "RESOURCE1" : 1,    "RESOURCE2" : 0 ,   "STYLE" : 20,   "SHORT" : "minimal blush and lipstick"},
                    {"NAME"  : "basic",         "DIFFICULTY" : 30,  "RESOURCE1" : 1,    "RESOURCE2" : 0 ,   "STYLE" : 25,   "SHORT" : "basic lipstick and eyeshadow"},
                    {"NAME"  : "youthful",      "DIFFICULTY" : 40,  "RESOURCE1" : 2,    "RESOURCE2" : 0 ,   "STYLE" : 30,   "SHORT" : "bright and youthful looking"},
                    {"NAME"  : "cheap",         "DIFFICULTY" : 50,  "RESOURCE1" : 3,    "RESOURCE2" : 0 ,   "STYLE" : 35,   "SHORT" : "cheap, slutty looking"},
                    {"NAME"  : "sultry",        "DIFFICULTY" : 50,  "RESOURCE1" : 1,    "RESOURCE2" : 1 ,   "STYLE" : 40,   "SHORT" : "sultry and slightly exotic"},
                    {"NAME"  : "whorish",       "DIFFICULTY" : 60,  "RESOURCE1" : 2,    "RESOURCE2" : 1 ,   "STYLE" : 45,   "SHORT" : "overdone and whorish"},
                    {"NAME"  : "gothic",        "DIFFICULTY" : 70,  "RESOURCE1" : 0,    "RESOURCE2" : 1 ,   "STYLE" : 50,   "SHORT" : "gothic with smokey eyes and dark lips"},
                    {"NAME"  : "heavy",         "DIFFICULTY" : 80,  "RESOURCE1" : 1,    "RESOURCE2" : 1 ,   "STYLE" : 55,   "SHORT" : "heavy and mysterious with dark features"},
                    {"NAME"  : "classic",       "DIFFICULTY" : 90,  "RESOURCE1" : 0,    "RESOURCE2" : 2 ,   "STYLE" : 60,   "SHORT" : "full face, classical style"}
            ],
            "HairStyles" : [ // RES1 = ACCESSORIES, RES2 = PRODUCT
                    {"NAME"  : "boy cut",       "DIFFICULTY" : 20,  "RESOURCE1" : 0,    "RESOURCE2" : 0 ,   "MIN" :  5, "MAX" :  10,  "STYLE" : 20, "SHORT" : "a spunky boy cut"},
                    {"NAME"  : "loose cut",     "DIFFICULTY" : 30,  "RESOURCE1" : 0,    "RESOURCE2" : 0 ,   "MIN" : 10, "MAX" :  20,  "STYLE" : 25, "SHORT" : "a loose and flippy style"},
                    {"NAME"  : "bob cut",       "DIFFICULTY" : 40,  "RESOURCE1" : 0,    "RESOURCE2" : 1 ,   "MIN" : 12, "MAX" :  18,  "STYLE" : 30, "SHORT" : "a short bob style"},
                    {"NAME"  : "breezy style",  "DIFFICULTY" : 40,  "RESOURCE1" : 0,    "RESOURCE2" : 0 ,   "MIN" : 18, "MAX" :  50,  "STYLE" : 20, "SHORT" : "a breezy style"},
                    {"NAME"  : "loose curls",   "DIFFICULTY" : 50,  "RESOURCE1" : 1,    "RESOURCE2" : 1 ,   "MIN" : 20, "MAX" :  50,  "STYLE" : 35, "SHORT" : "a loose cut with flowing curls"},
                    {"NAME"  : "pig tails",     "DIFFICULTY" : 50,  "RESOURCE1" : 1,    "RESOURCE2" : 0 ,   "MIN" : 25, "MAX" :  50,  "STYLE" : 40, "SHORT" : "cute pig tails"},
                    {"NAME"  : "pony tail",     "DIFFICULTY" : 60,  "RESOURCE1" : 1,    "RESOURCE2" : 1 ,   "MIN" : 32, "MAX" : 100,  "STYLE" : 45, "SHORT" : "a long pony tail"},
                    {"NAME"  : "slick up-do",   "DIFFICULTY" : 70,  "RESOURCE1" : 2,    "RESOURCE2" : 1 ,   "MIN" :  5, "MAX" :  20,  "STYLE" : 50, "SHORT" : "a slick up-do style"},
                    {"NAME"  : "braided",       "DIFFICULTY" : 80,  "RESOURCE1" : 0,    "RESOURCE2" : 0 ,   "MIN" : 40, "MAX" : 100,  "STYLE" : 35, "SHORT" : "extravagantly long braids"},
                    {"NAME"  : "twin tails",    "DIFFICULTY" : 90,  "RESOURCE1" : 1,    "RESOURCE2" : 1 ,   "MIN" : 50, "MAX" :  80,  "STYLE" : 75, "SHORT" : "extremely long twin tails"}
            ],
            "SexActFrequency": ["HandJobs", "BlowJobs", "BlowJobs", "TitFucking", "AssFucking", "AssFucking"],
            "SkillDictionary": { "HandJobs" : "Hand Job", "BlowJobs" : "Blow Job", "TitFucking" : "Titty Fuck", "AssFucking" : "Ass Fuck" },
            "SexCommands" : {
                "HandJobs" : [
                    { "Name": "Stroke", "SKILL" : "HandJobs", "DIFFICULTY" : 20, "Basic" : 0, "Advanced" : 30, "Expert" : 60, "Arousal" : 4, "Satisfaction" : 8 },
                    { "Name": "Lubricate", "SKILL" : "HandJobs", "DIFFICULTY" : 20, "Basic" : 5, "Advanced" : 30, "Expert" : 60, "Arousal" : 8, "Satisfaction" : 4 },
                    { "Name": "Wank", "SKILL" : "HandJobs", "DIFFICULTY" : 30, "Basic" : 20, "Advanced" : 40, "Expert" : 70, "Arousal" : 8, "Satisfaction" : 12 },
                    { "Name": "Encourage", "SKILL" : "HandJobs", "DIFFICULTY" : 30, "Basic" : 40, "Advanced" : 60, "Expert" : 80, "Arousal" : 12, "Satisfaction" : 8 },
                    { "Name": "Finish", "SKILL" : "HandJobs", "DIFFICULTY" : 40, "Basic" : 0, "Advanced" : 60, "Expert" : 80, "Arousal" : 4, "Satisfaction" : 8 }],
                "BlowJobs" : [
                    { "Name": "Suck", "SKILL" : "BlowJobs", "DIFFICULTY" : 20, "Basic" : 0, "Advanced" : 30, "Expert" : 60, "Arousal" : 4, "Satisfaction" : 8 },
                    { "Name": "Lick", "SKILL" : "BlowJobs", "DIFFICULTY" : 20, "Basic" : 5, "Advanced" : 30, "Expert" : 60, "Arousal" : 8, "Satisfaction" : 4 },
                    { "Name": "Tease", "SKILL" : "BlowJobs", "DIFFICULTY" : 30, "Basic" : 20, "Advanced" : 40, "Expert" : 70, "Arousal" : 12, "Satisfaction" : 8 },
                    { "Name": "Throat", "SKILL" : "BlowJobs", "DIFFICULTY" : 30, "Basic" : 40, "Advanced" : 60, "Expert" : 80, "Arousal" : 8, "Satisfaction" : 12 },
                    { "Name": "Finish", "SKILL" : "BlowJobs", "DIFFICULTY" : 40, "Basic" : 0, "Advanced" : 60, "Expert" : 80, "Arousal" : 12, "Satisfaction" : 8 }],
                "TitFucking" : [
                    { "Name": "Stroke","SKILL" : "TitFucking", "DIFFICULTY" : 20, "Basic" : 0, "Advanced" : 30, "Expert" : 60, "Arousal" : 4, "Satisfaction" : 8 },
                    { "Name": "Lubricate", "SKILL" : "TitFucking", "DIFFICULTY" : 20, "Basic" : 5, "Advanced" : 30, "Expert" : 60, "Arousal" : 8, "Satisfaction" : 12 },
                    { "Name": "Wank", "SKILL" : "TitFucking", "DIFFICULTY" : 30, "Basic" : 20, "Advanced" : 40, "Expert" : 70, "Arousal" : 8, "Satisfaction" : 12 },
                    { "Name": "Encourage", "SKILL" : "TitFucking", "DIFFICULTY" : 30, "Basic" : 40, "Advanced" : 60, "Expert" : 80, "Arousal" : 12, "Satisfaction" : 8 },
                    { "Name": "Finish", "SKILL" : "TitFucking", "DIFFICULTY" : 40, "Basic" : 0, "Advanced" : 60, "Expert" : 80, "Arousal" : 12, "Satisfaction" : 8 }],
                "AssFucking" : [
                    { "Name": "Spread", "SKILL" : "AssFucking", "DIFFICULTY" : 20, "Basic" : 0, "Advanced" : 30, "Expert" : 60, "Arousal" : 4, "Satisfaction" : 8 },
                    { "Name": "Encourage", "SKILL" : "AssFucking", "DIFFICULTY" : 20, "Basic" : 5, "Advanced" : 30, "Expert" : 60, "Arousal" : 8, "Satisfaction" : 4 },
                    { "Name": "Sway", "SKILL" : "AssFucking", "DIFFICULTY" : 30, "Basic" : 20, "Advanced" : 40, "Expert" : 70, "Arousal" : 8, "Satisfaction" : 12 },
                    { "Name": "Pound", "SKILL" : "AssFucking", "DIFFICULTY" : 30, "Basic" : 40, "Advanced" : 60, "Expert" : 80, "Arousal" : 12, "Satisfaction" : 8 },
                    { "Name": "Finish", "SKILL" : "AssFucking", "DIFFICULTY" : 40, "Basic" : 0, "Advanced" : 60, "Expert" : 80, "Arousal" : 12, "Satisfaction" : 8 }]
            },
            "SexChats": {
                "HandJobs": {
                    "CustomerIntro": [
                        "Come here PLAYER_NAME, ya slutty bitch and give me a handy.",
                        "Hey PLAYER_NAME, I want you to give me a nice and slow hand job.",
                        "Talk dirty to me and wank me off.",
                        "Be a good little PLAYER_NAME-slut and pull my meat til I blow a load on your whore face."],
                    "Negotiate": [
                        "How about you come over here and let me stroke your cock?",
                        "Hmm... how about I wank you off all over my face instead?"],
                    "Angry" : [
                        "Bitch, I'm not in the mood for your sass. Do what I say now!" ],
                    "Disagree" : [
                        "Not this time, I really want a hand job and that's it.",
                        "Stop talking foolishness and start stroking cock." ],
                    "Agree" : [
                        "Alright PLAYER_NAME, we'll try it your way. This better be a damn good hand job."],
                    "StrokeBasic" : [
                        "You hesitantly stroke NPC_NAME's cock with your hands. It stiffens slightly under your touch.",
                        "You gingerly pump your fingers along the shaft of NPC_NAME's cock. He groans slightly."],
                    "StrokeAdvanced" : [
                        "You grab NPC_NAME's cock with both hands and pump your fingers up and down while looking him in the eye.",
                        "You let out a slight moan as you start pumping NPC_NAME's cock towards your face."],
                    "StrokeExpert" : [
                        "You stare NPC_NAME in the eyes and lick your lips while furiously jacking his cock towards your face.",
                        "You expertly pump your fingers along the shaft of NPC_NAME's cock. He groans slightly."],
                    "LubricateBasic" : [
                        "You spit and drool on NPC_NAME's cock while trying to maintain eye contact and softly begin to stroke him."],
                    "LubricateAdvanced" : [
                        "You gently lick NPC_NAME's cock up and down making sure to get it slick and wet with copious amounts of drool, once finished you start pumping him seductively." ],
                    "LubricateExpert" : [
                        "You passionately lick and slobber up and down NPC_NAME's clock, sucking on his balls and the tip of his cock. Once finished, you start expertly pumping him while maintaining eye contact."],
                    "WankBasic" : [
                        "You awkwardly run your hands up and down NPC_NAME's shaft, trying hard to arouse him."],
                    "WankAdvanced" : [
                        "You vigorously wank NPC_NAME's cock all over your face and massage his balls." ],
                    "WankExpert" : [
                        "You expertly wank NPC_NAME's cock over your chest and face while massaging his balls and licking his shaft."],
                    "EncourageBasic" : [
                        "You awkwardly run your hands up and down NPC_NAME's cock and balls, taking your time to try and arouse him."],
                    "EncourageAdvanced" : [
                        "You gently rub NPC_NAME's cock all over your face and massage his balls." ],
                    "EncourageExpert" : [
                        "You expertly rub NPC_NAME's cock over your chest and face while massaging his balls and licking his shaft."],
                    "FinishBasic" : [
                        "You concentrate on furiously stroking NPC_NAME's cock. Eventually you feel his body shudder and he climaxes, spurting long ropes of cum into your hair." ],
                    "FinishAdvanced" : [
                        "You maintain eye contact while quickly pumping NPC_NAME's cock and encouraging him to give you a big load of cum. After a few moments you feel his dick pulse and shoot a large stream of semen all over your face."],
                    "FinishExpert" : [
                        "You gaze sexily at NPC_NAME while stroking his dick expertly. You encourage him, begging him to release his load on you and eventually you feel his dick start to spasm. The first gushes of his semen land on your face and you quickly cover the tip of his dick with your mouth to catch the rest of it. He pumps for a long time, jism filling your cheeks. When his orgasm subsides you open your mouth, showing off the cum you've collected and then you swallow and lick your lips." ]
                },
                "BlowJobs": {
                    "CustomerIntro": [
                        "Come here PLAYER_NAME, ya whore and suck me off.",
                        "Oi, PLAYER_NAME! Gimme a blow job with that slutty mouth o' yours.",
                        "Damn it PLAYER_NAME, get your whore mouth over here and suck my cock.",
                        "Hey slut, get over here and swallow my load."],
                    "Negotiate": [
                        "How about I suck that cock of yours instead?",
                        "Why don't you try blowing a load in my mouth?"],
                    "Angry" : [
                        "You're going to choke on my meat and you're going to like it!",
                        "If you don't start sucking, then I'm going to start choking."],
                    "Disagree" : [
                        "Not this time, I really want a blow job and that's it.",
                        "Stop talking foolishness and start sucking cock." ],
                    "Agree" : [
                        "Alright PLAYER_NAME, we'll try it your way. This better be a damn good blow job."],
                    "SuckBasic" : [
                        "You hesitantly suck on NPC_NAME's dick, slowly bobbing your head up and down on his shaft.",
                        "You lick and suck on the head of NPC_NAME's cock and then take him fully in your mouth."],
                    "SuckAdvanced" : [
                        "You lick the end of NPC_NAME's dick and run your lips over the head of his cock before taking it in your mouth.",
                        "You languidly suck on NPC_NAME's cock, wrapping your lips around his turgid meat and using your tongue to pleasure him."],
                    "SuckExpert" : [
                        "Your expertly roll NPC_NAME's cock around in your mouth and suck him with a noisy slurping sound.",
                        "You vigorously bob your head up and down on NPC_NAME's shaft and work your tongue around the head of his cock."],
                    "LickBasic" : [
                        "You lick and drool on NPC_NAME's cock while trying to maintain eye contact."],
                    "LickAdvanced" : [
                        "You gently lick NPC_NAME's cock up and down making sure to get it slick and wet with copious amounts of drool." ],
                    "LickExpert" : [
                        "You passionately lick and slobber up and down NPC_NAME's clock, sucking on his balls and the tip of his cock."],
                    "TeaseBasic" : [
                        "You softly moan while sucking on the head of NPC_NAME's cock."],
                    "TeaseAdvanced" : [
                        "You take NPC_NAME's cock deep in your mouth and moan while maintaining eye contact with him." ],
                    "TeaseExpert" : [
                        "You stare at NPC_NAME's cock and then intently attack it with your mouth while moaning and playing with yourself."],
                    "ThroatBasic" : [
                        "You slowly work NPC_NAME's cock down your throat and bob your head up and down while he fucks your mouth."],
                    "ThroatAdvanced" : [
                        "You go down as far as you can on NPC_NAME's dick until there is tears in your eyes and then proceed to let him fuck your mouth." ],
                    "ThroatExpert" : [
                        "You easily go down to the root of NPC_NAME's cock and then furiously begin bobbing your head up and down."],
                    "FinishBasic" : [
                        "You do your best to maintain suction on NPC_NAME's dick while he fucks your face. Eventually he grabs the side of your head, holding it in place as he pumps shot after shot of semen into your mouth."],
                    "FinishAdvanced" : [
                        "NPC_NAME proceeds to fuck your face with abandon and you do your best to accommodate him, eventually he grabs the side of your head and cums hard down your throat."],
                    "FinishExpert" : [
                        "You work your head up and down on NPC_NAME's cock, taking as much as you can down your throat with each pump. Eventually NPC_NAME grabs the back of your head and grinds your face into his crotch and unleashes a torrent of cum into your gullet."]
                },
                "TitFucking": {
                    "CustomerIntro": [
                        "Come here and let me fuck those titties!",
                        "Oi, PLAYER_NAME! I want to blow a load all over those tits!"],
                    "Negotiate": [
                        "Why don't you fuck my tits and blow a load all over them?",
                        "Oh, but I was looking forward to having a load all over my jugs..."],
                    "Angry" : [
                        "Since when do pairs of tits talk back?",
                        "Dammit, I'm not in the mood for your bullshit PLAYER_NAME." ],
                    "Disagree" : [
                        "Not this time, I really want a titty fuck and that's it.",
                        "Stop talking foolishness and start stroking dick." ],
                    "Agree" : [
                        "Alright PLAYER_NAME, we'll try it your way. Now get those tits ready."],
                    "StrokeBasic" : [
                        "You hesitantly stroke NPC_NAME's cock with your tits. It stiffens slightly under your touch.",
                        "You slowly move your tits along the shaft of NPC_NAME's cock. He groans slightly."],
                    "StrokeAdvanced" : [
                        "You envelop NPC_NAME's cock with both tits and pump them up and down while looking him in the eye.",
                        "You let out a slight moan as you start pumping NPC_NAME's cock with your tits."],
                    "StrokeExpert" : [
                        "You stare NPC_NAME in the eyes and lick your lips while furiously jacking his cock with your melons.",
                        "You expertly pump your tits along the shaft of NPC_NAME's cock. He groans slightly."],
                    "LubricateBasic" : [
                        "You spit and drool on NPC_NAME's cock while trying to maintain eye contact and softly begin to stroke him."],
                    "LubricateAdvanced" : [
                        "You gently lick NPC_NAME's cock up and down making sure to get it slick and wet with copious amounts of drool, once finished you start pumping him seductively with your knockers." ],
                    "LubricateExpert" : [
                        "You passionately lick and slobber up and down NPC_NAME's clock, sucking on his balls and the tip of his cock. Once finished, you start expertly pumping him while maintaining eye contact."],
                    "WankBasic" : [
                        "You awkwardly wank your tits up and down NPC_NAME's cock and balls, taking your time to try and arouse him."],
                    "WankAdvanced" : [
                        "You vigorously wank NPC_NAME's cock with your tits. Occasionally you lick his shaft and smear the drool along your cleavage while fondling his balls." ],
                    "WankExpert" : [
                        "You wank your tits roughly up and down on NPC_NAME's dick, trying to make sure that you get as much contact as possible while drooling and licking on his cock."],
                    "EncourageBasic" : [
                        "You do your best to arouse NPC_NAME by fondling your tits and talking dirty. He slides his dick between your tits and starts to slowly pump away."],
                    "EncourageAdvanced" : [
                        "You moan and encourage NPC_NAME as he pumps away at your hooters." ],
                    "EncourageExpert" : [
                        "You beg NPC_NAME to fuck your whore tits and dump his cum all over them. He responds by pumping away furiously."],
                    "FinishBasic" : [
                        "You do your best to hold your tits together while NPC_NAME fucks away at them. Eventually his entire body shudders and he shoots rope after rope of smelly sperm on them."],
                    "FinishAdvanced" : [
                        "You jack your tits up and down on NPC_NAME's cock and encourage him to cum. He pumps furiously until he climaxes and blasts you in the face with a thick rope of semen."],
                    "FinishExpert" : [
                        "You expertly work your tits up and down on NPC_NAME's cock, encouraging him to dirty your body with his seed. The last comment sends him over the edge and he starts to cum all over your tits, only to have you put your mouth over his dick and start sucking the rest out."]
                },
                "AssFucking": {
                    "CustomerIntro": [
                        "Bend over PLAYER_NAME and let me fuck your sissy whore ass.",
                        "Prepare that sissy-slut ass for a mighty fucking!",
                        "I'm going to fuck your ass so hard you won't be able to sit down for a week!"],
                    "Negotiate": [
                        "But my slutty sissy ass is so empty right now...",
                        "Why don't you come over here and fuck my ass silly?"],
                    "Angry" : [
                        "I'm not paying for your personality. Now bend over bitch!",
                        "Shut your whore mouth and open your ass!" ],
                    "Disagree" : [
                        "Not this time, I really want to fuck your whore ass and that's it.",
                        "Stop talking foolishness and bend over, here I come, slut!" ],
                    "Agree" : [
                        "Alright PLAYER_NAME, now bend over and make way for a pounding."],
                    "SpreadBasic" : [
                        "You gasp slightly as you do your best to spread your ass checks so that NPC_NAME can pump away at your slutty sissy hole.",
                        "You spread your cheeks and try to push your sphincter open so that NPC_NAME gets better access as he pumps your butt."],
                    "SpreadAdvanced" : [
                        "You hold each of your butt cheeks and open your sphincter wide, enabling NPC_NAME to get better access as he rails your sissy ass."],
                    "SpreadExpert" : [
                        "You moan and gasp as your totally open butt hole allows NPC_NAME to plow you with abandon."],
                    "EncourageBasic" : [
                        "As NPC_NAME pounds your butt, you try to fake a moan and encourage him to fuck you."],
                    "EncourageAdvanced" : [
                        "As NPC_NAME pounds your butt, you moan and encourage him to fuck your sissy ass." ],
                    "EncourageExpert" : [
                        "As NPC_NAME pounds your butt, you buck your hips and moan passionately, begging him to fuck your dirty whore ass."],
                    "SwayBasic" : [
                        "You gently try to rock your ass back and forth on NPC_NAME's cock while he fucks you."],
                    "SwayAdvanced" : [
                        "You rock your hips and stimulate NPC_NAME's cock as he fucks your ass." ],
                    "SwayExpert" : [
                        "You sway and match the rhythm of your movements to NPC_NAME's thrusts as he fucks your ass."],
                    "PoundBasic" : [
                        "You try to push back on NPC_NAME's cock as he fucks your ass."],
                    "PoundAdvanced" : [
                        "You move your ass up and down in time with NPC_NAME's thrusts, forcing his cock deep into your sissy asshole." ],
                    "PoundExpert" : [
                        "You passionately push back in time with NPC_NAME's thrust taking every inch of his cock up your sissy hole and causing him to gasp in pleasure."],
                    "FinishBasic" : [
                        "You do your best to hold on while NPC_NAME fucks your ass. Eventually you feel his body stop and seize up and then a warm sensation as your bowels fill with cum."],
                    "FinishAdvanced" : [
                        "You move your ass vigorously in an attempt to pleasure NPC_NAME as he fucks you. Eventually he lets loose a mighty howl and rams his cock all the way up your ass, filling it with pent up cum."],
                    "FinishExpert" : [
                        "You stroke your sissy clit at NPC_NAME fucks your ass, eventually the combination of the two acts brings you to climax. The ensuing orgasm causes your sphincter to spasm and send NPC_NAME over the edge. As he buries himself up your ass, the sensation of hot cum flooding your bowels sends you into another dizzying orgasm."]
                }
            },
			"BodyChanges" : {
                "WillPower": {
                    "Grow" : "You feel @@color:lime;&uArr;renewed resolve@@ to persevere. Your Willpower has increased.",
                    "Shrink" : "Your feel your @@color:red;&dArr;willpower dwindling@@ in the face of all this abuse. Will you make it out alive and sane?"
                },
                "Hormones" : {
                    "Grow" : "Your body feels strange... as if you're becoming @@color:DeepPink;&uArr;more feminine and girly@@. Maybe there's something in the food?",
                    "Shrink" : "Your body feels more normal... as if you're becoming more @@color:Cyan;&dArr;more masculine and manly@@. Perhaps the drugs are wearing off?"
                },
				"Face" :
				{
					"Grow" 	 : "Your @@color:lime;face@@ feels warm and flush, @@color:lime;&uArr;softer and more feminine@@.",
					"Shrink" : "Your @@color:red;face@@ feels hot and sweaty, @@color:red;&dArr;harsher and more masculine@@."
				},
				"Lips" :
				{
					"Grow" : "Your @@color:lime;lips@@ feel strange, like they've been @@color:lime;&uArr;growing@@ slowly over night.",
					"Shrink" : "Your @@color:red;lips@@ feel tight, like they're becoming @@color:red;&dArr;smaller and more withdrawn@@."
				},
				"Bust" :
				{
					"Grow" : "Your chest feels warm and tender, like your @@color:lime;&uArr;breasts are growing@@.",
					"Shrink" : "Your chest feels lighter, almost as if your @@color:red;&dArr;breasts are shrinking@@."
				},
				"Ass" :
				{
					"Grow" : "Your @@color:lime;&uArr;butt feels larger@@ and more prominent, maybe you should go on a diet?",
					"Shrink" : "You notice that your @@color:red;&dArr;rump feels less prominent@@, as if it's been shrinking"
				},
				"Waist" :
				{
					"Grow" : "Your @@color:red;&dArr;waist feels thick and heavy@@, as if you've been putting on the pounds around your middle.",
					"Shrink" : "Your @@color:lime;&uArr;waist and stomach feel tighter@@, as if you are shedding mass around your middle"
				},
				"Hips" :
				{
					"Grow" : "Your @@color:lime;hips@@ feel as if they've become @@color:lime;&uArr;more broad and feminine@@ over night.",
					"Shrink" : "Your @@color:red;hips@@ feel as if they've become @@color:red;&dArr;more narrow and masculine@@ over night."
				},
				"Penis" :
				{
					"Grow" : "It might be your imagination, but did your @@color:lime;&uArr;cock seem to grow@@ recently?",
					"Shrink" : "Something is going on here... your @@color:red;&dArr;penis has shrunk@@!"
				},
				"Hair" :
				{
					"Grow" : "You brush an errant strand of @@color:lime;hair@@ out of your eyes. It's @@color:lime;&uArr;getting longer@@ it seems.",
					"Shrink" : "You brush your hand through your @@color:red;hair@@ and @@color:red;&dArr;several large clumps fall out@@. Are you going bald?"
				},
				"Height" :
				{
					"Grow" : "It seems almost impossible to believe at this age, but did you @@color:lime;&uArr;get taller over night@@?",
					"Shrink" : "Did the room around you grow, or did you somehow @@color:red;&dArr;get shorter over night@@?"
				},
				"Balls" :
				{
					"Grow" : "You feel a heavy weight between your legs. Is it possible that @@color:lime;&uArr;your balls grew@@?",
					"Shrink" : "Something feels strange down there... are @@color:red;&dArr;your balls smaller@@?"
				}
			},
			"ShipRoute" : {
                 1: { "TYPE" : "PORT", "NAME" : "Isla Harbor", "PASSAGE" : "IslaHarbor" },
                 2:	{ "TYPE" : "PORT", "NAME" : "Isla Harbor", "PASSAGE" : "IslaHarbor" },
                 3: { "TYPE" : "PORT", "NAME" : "Isla Harbor", "PASSAGE" : "IslaHarbor" },
                 4: { "TYPE" : "PORT", "NAME" : "Isla Harbor", "PASSAGE" : "IslaHarbor" },
				14: { "TYPE" : "PORT", "NAME" : "Golden Isle", "PASSAGE" : "GoldenIsle" },
                15:	{ "TYPE" : "PORT", "NAME" : "Golden Isle", "PASSAGE" : "GoldenIsle" },
                16:	{ "TYPE" : "PORT", "NAME" : "Golden Isle", "PASSAGE" : "GoldenIsle" },
                17:	{ "TYPE" : "PORT", "NAME" : "Golden Isle", "PASSAGE" : "GoldenIsle" },
				27: { "TYPE" : "PORT", "NAME" : "Abamond",     "PASSAGE" : "Abamond" },
                28: { "TYPE" : "PORT", "NAME" : "Abamond",     "PASSAGE" : "Abamond" },
                29: { "TYPE" : "PORT", "NAME" : "Abamond",     "PASSAGE" : "Abamond" },
                30: { "TYPE" : "PORT", "NAME" : "Abamond",     "PASSAGE" : "Abamond" },
				40: { "TYPE" : "PORT", "NAME" : "Port Royale", "PASSAGE" : "PortRoyale" },
                41: { "TYPE" : "PORT", "NAME" : "Port Royale", "PASSAGE" : "PortRoyale" },
                42: { "TYPE" : "PORT", "NAME" : "Port Royale", "PASSAGE" : "PortRoyale" },
                43: { "TYPE" : "PORT", "NAME" : "Port Royale", "PASSAGE" : "PortRoyale" }
			},
            "ColorScale" : [ "#FF0000", "#FF0000", "#FF4000", "#FF8000", "#FFBF00", "#FFFF00", "#BFFF00",
                             "#80FF00", "#40FF00", "#01DFD7", "#0174DF", "#0101DF", "#3A01DF", "#7401DF",
                             "#A901DB", "#DF01D7", "#DF01A5"]
		};

window.App.Data.Ratings = {
            "Lust": {
                20: "Content", 40: "Satisfied", 60: "Horny",
                80: "Lustful", 99: "Aggressive", 100: "Overpowering"
            },
            "Mood": {
                20: "Angry", 40: "Annoyed", 60: "Satisfied",
                80: "Happy", 99: "Cheerful", 100: "Ecstatic!"
            },
            "Fetish": {
                10: "completely non-existent",
                20: "barely there",
                30: "of minor notice",
                40: "worthy of attention",
                50: "eye catching and interesting",
                60: "erotic and appealing",
                70: "sexually stimulating and erotic",
                80: "highly sexualized and objectified",
                90: "sexually outrageous",
                99: "oozing perversion and sex",
                100: "utterly depraved and perverse"
            },
            "Beauty": {
                10: "masculine and ugly",
                20: "mannish and unappealing",
                30: "a perpetual wallflower",
                40: "plain and unattractive",
                50: "marginally attractive",
                60: "cute and appealing",
                70: "pretty and interesting",
                80: "sexy and attractive",
                90: "classically beautiful",
                99: "exotic and alluring",
                100: "utterly bewitching"
            },
            "Balls": {
                  1: "ADJECTIVE testes, so small they have shrunk into your abdomen",
                  5: "ADJECTIVE sissy balls",
                 10: "ADJECTIVE pitiful testicles",
                 17: "ADJECTIVE pitiful testicles",
                 25: "ADJECTIVE balls, like a child",
                 34: "ADJECTIVE balls, like a child",
                 44: "ADJECTIVE sized testicles",
                 56: "ADJECTIVE balls, they look painful",
                 66: "ADJECTIVE balls, loaded with cum",
                 75: "ADJECTIVE testicles, full of virility",
                 83: "ADJECTIVE balls that would put a bull to shame",
                 90: "balls so ADJECTIVE that it's difficult for you to move without swaying your hips",
                 95: "ADJECTIVE balls full of cum, like those on a prize breeding bull",
                 99: "ADJECTIVE balls that hang precipitously between your legs like over sized fruit",
                100: "ADJECTIVE balls that signify you are one of natures true freaks. They are so bloated with cum that even the slightest touch if painful"
            },
            "Penis": {
                 1: "a INCHES inch ADJECTIVE penis, a perfect sissy clit",
                 5: "a INCHES inch ADJECTIVE penis, a perfect sissy clit",
                10: "a INCHES inch ADJECTIVE dick or over sized sissy clit",
                17: "a INCHES inch ADJECTIVE dick or over sized sissy clit",
                25: "a humiliatingly ADJECTIVE INCHES inch dick",
                34: "a humiliatingly ADJECTIVE INCHES inch dick",
                44: "a ADJECTIVE INCHES inch dick",
                56: "a ADJECTIVE INCHES inch tool",
                66: "a ADJECTIVE INCHES inch cock",
                75: "a ADJECTIVE INCHES inch dick",
                83: "a ADJECTIVE INCHES inch cock, it dangles prominently between your legs",
                90: "a ADJECTIVE INCHES inch cock, about the size of a small farm animal",
                95: "a ADJECTIVE INCHES inch cock, it's constantly getting in the way and peeking out from under your skirts",
                99: "a ADJECTIVE INCHES inch cock, so large it's inconvenient in day to day life and impossible to conceal",
               100: "a ADJECTIVE INCHES inch tool, so big it's impossible to hide and serves as an advertisement for your perverse body"
            },
            "Waist": {
                1:  "You have a INCHES inch ADJECTIVE waist, freakishly small like a doll or small child",
                5:  "You have a INCHES inch ADJECTIVE waist, freakishly small like a doll or small child",
                10: "You have a ADJECTIVE INCHES inch waist, incredibly small for your size",
                17: "You have a ADJECTIVE INCHES inch waist, incredibly small for your size",
                25: "You have a ADJECTIVE INCHES inch waist",
                34: "You have a ADJECTIVE INCHES inch waist",
                44: "You have a ADJECTIVE INCHES inch waist",
                56: "You have a ADJECTIVE INCHES inch waist",
                66: "You have a ADJECTIVE INCHES inch waist, it looks like you've been putting on weight",
                75: "You have a ADJECTIVE INCHES inch waist, you may need to go on a diet soon",
                83: "You have a ADJECTIVE INCHES inch waist, it's floppy and protrudes in all the wrong places",
                90: "You have a ADJECTIVE INCHES inch waist, there's no doubt about it, since you're not pregnant, you're fat",
                95: "You have a ADJECTIVE INCHES inch waist, your fat belly rolls and jiggles when you walk",
                99: "You have a ADJECTIVE INCHES inch waist, it looks like a sack of jello and wobbles as you walk",
               100: "You have a ADJECTIVE INCHES inch waist, your corpulence is magnificent to behold"
            },
            "Hips": {
                 0 : "You have ADJECTIVE INCHES inch hips that make you look emaciated.",
                 1 : "You have ADJECTIVE INCHES inch hips that look more fitting on a child or teenager.",
                 2 : "You have ADJECTIVE INCHES inch hips, too small for your own health.",
                 3 : "You have ADJECTIVE INCHES inch hips. Maybe you should eat more?",
                 5 : "You have ADJECTIVE INCHES inch hips.",
                 8 : "You have ADJECTIVE INCHES inch hips.",
                11 : "You have ADJECTIVE INCHES inch hips, they have a slight curve which is almost attractive.",
                15 : "You have ADJECTIVE INCHES inch hips, they give your derriere a slight emphasis.",
                19 : "You have ADJECTIVE INCHES inch hips, they roll very slightly when you walk.",
                24 : "You have ADJECTIVE INCHES inch hips, they are slightly attractive to look at.",
                29 : "You have ADJECTIVE INCHES inch hips, they flare to the sides attractively.",
                34 : "You have ADJECTIVE INCHES inch hips, they flare to the sides attractively.",
                39 : "You have ADJECTIVE INCHES inch hips, they give you a feminine figure.",
                44 : "You have ADJECTIVE INCHES inch hips, perfect for grabbing a hold of when being fucked.",
                49 : "You have ADJECTIVE INCHES inch hips, perfect for grabbing a hold of when being fucked.",
                54 : "You have ADJECTIVE INCHES inch hips, perfect for grabbing a hold of when being fucked.",
                59 : "You have ADJECTIVE INCHES inch hips. They roll and undulate when you walk, shaking your ass.",
                64 : "You have ADJECTIVE INCHES inch hips. They roll and undulate when you walk, shaking your ass.",
                70 : "You have ADJECTIVE INCHES inch hips. They roll and undulate when you walk, shaking your ass.",
                76 : "You have ADJECTIVE INCHES inch hips. They sway back and forth, advertising your pASS for a good fuck.",
                82 : "You have ADJECTIVE INCHES inch hips. They sway back and forth, advertising your pASS for a good fuck.",
                88 : "You have ADJECTIVE INCHES inch hips. They sway back and forth, advertising your pASS for a good fuck.",
                94 : "You have ADJECTIVE INCHES inch hips. They sway back and forth constantly drawing attention to your pASS and practically begging for a good butt fuck.",
               100 : "You have ADJECTIVE INCHES inch hips. They sway back and forth constantly drawing attention to your pASS and practically begging for a good butt fuck."
            },
            "Ass": {
                 0 : "Your ADJECTIVE ass looks emaciated and unhealthy.",
                 1 : "You have a ADJECTIVE ass, it looks painful to sit on.",
                 2 : "You have a ADJECTIVE ass, it looks painful to sit on.",
                 3 : "Your ADJECTIVE butt looks almost hollow and unattractive.",
                 5 : "Your ADJECTIVE butt looks almost hollow and unattractive.",
                 8 : "You have a ADJECTIVE sized ass, neither too big or too small.",
                11 : "You have a ADJECTIVE ass, it has a slight swell but nothing special.",
                15 : "You have a pert ADJECTIVE ass that doesn't move in the slightest.",
                19 : "You have an ADJECTIVE ass that does a good job of filling out a pair of panties.",
                24 : "You have a ADJECTIVE ass that stretches sexily against your clothes.",
                29 : "You have a ADJECTIVE ass that stretches sexily against your clothes.",
                34 : "You have a ADJECTIVE ass, it's attractive enough to draw stares from men.",
                39 : "You have a ADJECTIVE ass, it's attractive enough to draw stares from men.",
                44 : "You have a ADJECTIVE ass that strains your bottoms and shakes when men slap it.",
                49 : "You have a ADJECTIVE ass that strains your bottoms and shakes when men slap it.",
                54 : "You have a ADJECTIVE ass that shakes and draws attention when you walk.",
                59 : "You have a ADJECTIVE ass that shakes and draws attention when you walk.",
                64 : "You have an ADJECTIVE ass that sways and jiggles sexily when you walk.",
                70 : "You have a ADJECTIVE ass that gyrates back and forth when you strut your stuff.",
                76 : "Your ADJECTIVE ass sensuously wobbles and jiggles at every minor movement, entrancing watchers.",
                82 : "Your ADJECTIVE ass sensuously wobbles and jiggles at every minor movement, entrancing watchers.",
                88 : "Your ADJECTIVE ass shakes and wobbles at the most minor movement of your pHIPS hips. Clothing can barely contain it and men lust after it.",
                94 : "Your ADJECTIVE ass shakes and wobbles at the most minor movement of your pHIPS hips. Clothing can barely contain it and men lust after it.",
               100 : "Your ADJECTIVE ass jiggles almost uncontrollably at the most minor prompting. A small slap sends off an 'butt quake' of jiggly ass flesh and men dream of fucking it."
            },
            "Cup": {
                  0 : "Flat",
                  1 : "A",
                  2 : "AA",
                  3 : "B",
                  5 : "C",
                  8 : "D",
                 11 : "DD",
                 15 : "E",
                 19 : "F",
                 24 : "FF",
                 29 : "G",
                 34 : "GG",
                 39 : "H",
                 44 : "HH",
                 49 : "J",
                 54 : "JJ",
                 59 : "K",
                 64 : "KK",
                 70 : "M",
                 76 : "MM",
                 82 : "MMM",
                 88 : "Q",
                 94 : "QQ",
                100 : "QQQ"
            },
            "Bust": {
                0 : "Your chest is ADJECTIVE and unappealing.",
                1 : "Your chest is ADJECTIVE and unappealing, it would barely fit an pCUP bra.",
                2 : "You have ADJECTIVE tits that would fill out a pCUP bra.",
                3 : "You have ADJECTIVE tits that would fill out a pCUP bra.",
                5 : "You have ADJECTIVE tits that would fill out a pCUP bra, they sit high and firm.",
                8 : "You have ADJECTIVE tits that would nicely fill out a pCUP bra.",
                11 : "You have ADJECTIVE pCUP sized hooters, they slightly wobble and jiggle when you walk.",
                15 : "You have ADJECTIVE pCUP sized jugs, they are fleshy, softy, jiggly and eye catching.",
                19 : "You have ADJECTIVE pCUP sized funbags, they enticingly fill out your tops and jiggle sexily when you walk.",
                24 : "You have ADJECTIVE pCUP sized tits, they enticingly fill out your tops and shimmy and quake when you walk.",
                29 : "You have ADJECTIVE pCUP sized jugs, your overwhelming cleavage attracts lustful stares from men and they shake and wobble when you strut your stuff.",
                34 : "You have ADJECTIVE pCUP sized boobies, your overwhelming cleavage attracts lustful stares from men and they jiggle and bounce when you strut your stuff.",
                39 : "You have ADJECTIVE pCUP sized knockers, they wobble when you walk and your expansive cleavage attracts lustful stares from men.",
                44 : "You have ADJECTIVE pCUP sized jugs, they wobble when you walk and your expansive cleavage attracts lustful stares from men.",
                49 : "You have ADJECTIVE pCUP sized hooters, they wobble when you walk and your expansive cleavage attracts lustful stares from men.",
                54 : "You have ADJECTIVE pCUP sized tits, they jiggle and shake constantly trying to escape your top.",
                59 : "You have ADJECTIVE pCUP sized tits, they jiggle and shake constantly trying to escape your top.",
                64 : "You have ADJECTIVE pCUP sized hooters, they spill out of your clothes and entice men to grope and grab them.",
                70 : "You have ADJECTIVE pCUP sized funbags, they spill out of your clothes and entice men to grope and grab them.",
                76 : "You have ADJECTIVE pCUP sized tits on your chest, they make every outfit you wear look obscene and men salivate at the thought of putting their cocks in between them.",
                82 : "You have ADJECTIVE pCUP sized jugs on your chest, they make every outfit you wear look obscene and men salivate at the thought of putting their cocks in between them.",
                88 : "You have ADJECTIVE pCUP sized fuck bags on your chest, you mostly have given up trying to cover them because they'll wobble and shake free of anything at the slightest provocation.",
                94 : "Your ADJECTIVE pCUP sized tits make it known to everyone that you're a total fuck slut ready for sex. They shake and jiggle at the slightest motion and spill out of your top every couple of minutes.",
               100 : "Your ADJECTIVE pCUP sized tits make it known to everyone that you're a total fuck slut ready for sex. They shake and jiggle at the slightest motion and spill out of your top every couple of minutes. When you eat, you place them on the table to avoid back strain and you have to sleep on your side or you'll suffocate."
            },
            "Lips": {
                  5: "ADJECTIVE lips like an old person or a zombie.",
                 10: "ADJECTIVE lips that look unappealing and harsh.",
                 15: "ADJECTIVE lips that look dry and parched.",
                 20: "ADJECTIVE, masculine lips that are rather unappealing.",
                 26: "ADJECTIVE, slightly masculine lips that are slightly chapped.",
                 32: "ADJECTIVE and moist, slightly feminine lips.",
                 38: "ADJECTIVE, almost girlish lips.",
                 46: "ADJECTIVE, girly lips with a cute pout.",
                 54: "ADJECTIVE, womanly lips with an enticing smile.",
                 62: "ADJECTIVE, kissable lips in a classic bow shape.",
                 71: "ADJECTIVE lips like those on an air-headed bimbo.",
                 80: "ADJECTIVE lips, almost comical in appearance. They look good wrapped around a cock.",
                 89: "ADJECTIVE lips that are so fat your mouth is in a perpetual 'o' shape, just waiting for a dick.",
                 98: "cartoonishly ADJECTIVE lips, they are always partway open and wet with your saliva. They make your face look like a sissy fuckhole.",
                100: "ADJECTIVE lips, so enormous that they look like a pair of pillows made for sucking cock. They cause you to speak with a pronounced lisp and they're always so wet with your saliva that you often find yourself constantly wiping your own drool from your pBUST tits."
            },
            "Style": {
                10: "repulsive, like a homeless person",
                20: "frumpy and unattractive",
                30: "plain and uninspired",
                40: "barely noticeable with minor sex appeal",
                50: "passably fashionable, attractive enough",
                60: "equal to a courtesan or trophy wife",
                70: "on point and attractive, stylish and sexually appealing",
                80: "sexually provocative and beautiful",
                90: "eye catching, alluring and sexually intriguing",
                99: "provocative and bewitching, sexually stimulating",
                100: "the height of sexual allure and beauty"
            },
            "Clothing": {
                10: "barely better than rags.",
                20: "horrible looking",
                30: "completely out of fashion",
                40: "unattractive and ordinary",
                50: "reasonably attractive and stylish",
                60: "stylish and cute",
                70: "stylish and sexy",
                80: "eye catching and flirty",
                90: "seductive and appealing",
                99: "emphasizing your sexual appeal",
                100: "overflowing with sex appeal"
            },
            "Face": {
                  0: "ADJECTIVE pHORMONES looking face",
                  4: "ADJECTIVE pHORMONES looking face",
                  8: "ADJECTIVE pHORMONES looking face",
                 13: "ADJECTIVE pHORMONES looking face",
                 18: "ADJECTIVE pHORMONES looking face",
                 24: "ADJECTIVE pHORMONES looking face",
                 29: "ADJECTIVE pHORMONES looking face",
                 34: "ADJECTIVE pHORMONES looking face",
                 39: "ADJECTIVE pHORMONES looking face",
                 44: "ADJECTIVE pHORMONES looking face",
                 49: "ADJECTIVE pHORMONES looking face",
                 54: "ADJECTIVE pHORMONES looking face",
                 59: "ADJECTIVE pHORMONES looking face",
                 63: "ADJECTIVE pHORMONES looking face",
                 67: "ADJECTIVE pHORMONES looking face",
                 71: "ADJECTIVE pHORMONES looking face",
                 75: "ADJECTIVE pHORMONES looking face",
                 79: "ADJECTIVE pHORMONES looking face",
                 83: "ADJECTIVE pHORMONES looking face",
                 87: "ADJECTIVE pHORMONES looking face",
                 91: "ADJECTIVE pHORMONES looking face",
                 95: "ADJECTIVE pHORMONES looking face",
                 99: "ADJECTIVE pHORMONES looking face",
                100: "ADJECTIVE pHORMONES looking face"
            },
            "Fitness": {
                5: "extremely ADJECTIVE, almost sickly and ill.",
                10: "extremely ADJECTIVE, almost sickly and ill.",
                15: "extremely ADJECTIVE, almost sickly and ill.",
                20: "ADJECTIVE, with weak muscles and a poor constitution.",
                26: "ADJECTIVE, with weak muscles and a poor constitution.",
                32: "relatively ADJECTIVE.",
                38: "ADJECTIVE level of fitness, capable of handling a moderate amount of physical activity.",
                46: "ADJECTIVE, with some muscle definition and a fair amount of endurance.",
                54: "ADJECTIVE, with some muscle definition and a fair amount of endurance.",
                62: "ADJECTIVE, with a fit body and a constitution of an intermediate athlete.",
                71: "ADJECTIVE, with well defined muscles and stamina to match.",
                80: "ADJECTIVE, with a fit and sexy body.",
                89: "ADJECTIVE, with a body close to physical perfection.",
                98: "ADJECTIVE, a virtual dynamo with a knockout body and constitution to match.",
                100: "ADJECTIVE, with an iron constitution and powerful pHORMONES muscles, the apex of physical perfection."
            }
        };

window.App.Data.Enemies = {
  "PIRATE_A" : {
      "NAME" : "Pirate", "CATEGORY" : "PIRATES", "CLASSIFICATION" : "MINOR",
      "TITLE" : "A swarthy ENEMY wielding WEAPON", "GENDER" : "MALE", "MaxHealth" : 60, "MaxEnergy" : 3,
      "Energy" : 3, "Health" : 60, "Fitness" : 40, "WillPower" : 40, "Perversion" : 40, "Swashbuckling" : 30,
      "SKILLS" : [ "Slash", "Riposte", "Impale" ],
      "WEAPONS" : [ { "NAME" : "basic cutlass", "TYPE" : "BLADED_MELEE" } ],
      "TREASURE" :
          { "A" :
              [
                  { "TYPE" : "MONEY", "NAME" : "MONEY", "AMOUNT" : 20, "OPT" : "RANDOM", "CHANCE" : 100 }
              ],
            "B" :
              [
                  { "TYPE" : "FOOD", "NAME" : "grog", "AMOUNT" : 1, "OPT" : 0, "CHANCE" : 30 }
              ]
          }
  }

};

window.App.Data.CombatSkills = {
    "Slash" : {
        "NAME" : "Slash", "COST" : 0, "SKILL" : "Swashbuckling", "TYPE" : "BLADED_MELEE", "COOL_DOWN" : 0,
        "VERB" : [ "slash at ENEMY", "slashes at you"], "TRIGGERS" : [ ], "EFFECTS" : [ ]
        },
    "Swing" : {
        "NAME" : "Swing", "COST" : 0, "SKILL" : "Swashbuckling", "TYPE" : "BLUNT_MELEE", "COOL_DOWN" : 0,
        "VERB" : [ "swing at ENEMY", "swings at you"], "TRIGGERS" : [ ], "EFFECTS" : [ ]
    },
    "Riposte" : {
        "NAME" : "Riposte", "COST" : 1, "SKILL" : "Swashbuckling", "TYPE" : "ANY_MELEE", "COOL_DOWN" : 0,
        "VERB" : [ "riposte ENEMY's blow", "ripostes your blow"], "TRIGGERS" : [ "BLOCK_BLOW" ], "EFFECTS" : [ ]
        },
    "Hack" : {
        "NAME" : "Hack", "COST" : 1, "SKILL" : "Swashbuckling", "TYPE" : "BLADED_MELEE", "COOL_DOWN" : 1,
        "VERB" : ["hack at ENEMY", "hacks at you"], "TRIGGERS" : [ ], "EFFECTS" : [ ]
        },
    "Smash" : {
        "NAME" : "Smash", "COST" : 1, "SKILL" : "Swashbuckling", "TYPE" : "BLUNT_MELEE", "COOL_DOWN" : 1,
        "VERB" : ["smash ENEMY", "smashes you"], "TRIGGERS" : [ ], "EFFECTS" : [ ]
        },
    "Impale" : {
        "NAME" : "Impale", "COST" : 1, "SKILL" : "Swashbuckling", "TYPE" : "BLADED_MELEE", "COOL_DOWN" : 1,
        "VERB" : ["smash ENEMY", "smashes you"], "TRIGGERS" : [ ], "EFFECTS" : [ "BLEED_MINOR" ]
        },
    "Clobber" : {
        "NAME" : "Clobber", "COST" : 1, "SKILL" : "Swashbuckling", "TYPE" : "BLUNT_MELEE", "COOL_DOWN" : 1,
        "VERB" : ["smash ENEMY", "smashes you"], "TRIGGERS" : [ ], "EFFECTS" : [ "DAZE_MINOR" ]
    }

};

window.App.Data.Encounters = {
    "PIRATE_PRACTICE" :
        [
            {   "CHANCE" : 100,
                "INTRO" : "Your opponent steps up for the duel.",
                "ENEMIES" : [ { "ENEMY" : "PIRATE_A", "MIN" : 1, "MAX" : 1 }]}
        ]
};
/* twine-user-script #10: "ItemData.js" */
window.App = window.App || { Data: { }, Entity: { } };

window.App.Data.Drugs = {
            "nereid philtre": {
                "Name": "nereid philtre",
                "ShortDesc": "Philter of Nereid Tears",
                "LongDesc": "This light blue potion has faint specks of silver swirling in it. It smells faintly of the sea.",
                "Message": "You quaff the philter. For a moment you feel the bite of the sea... and then tranquility so sublime you lose yourself to it.",
                "Type": "potion",
                "Charges": 1,
                "UseEffect": {
                    "Hormones": [5, 300, 0],
                    "Femininity": [5, 100, 0],
                    "Face": [0, 500, 0],
                    "Lips": [0, 500, 0],
                    "Hair": [6, 600, 0],
                    "Waist" : [0,-500,0],
                    "WillPower": [-5, -200, 0],
                    "Toxicity": [50, 0, 0]
                },
                "Price": 500
            },
            "succubus philtre": {
                "Name": "succubus philtre",
                "ShortDesc": "Philter of Succubus Lust",
                "LongDesc": "This deep purple potion pulses with an otherworldly light. It smells of roses and brimstone.",
                "Message": "You quaff the philter. Almost instantly a deep feeling of arousal surfaces and your mind is filled with perverted thoughts.",
                "Type": "potion",
                "Charges": 1,
                "UseEffect": {
                    "Hormones": [5, 500, 0],
                    "Femininity": [5, 100, 0],
                    "Bust": [5, 500, 0],
                    "Ass": [5, 500, 0],
                    "Hips": [5, 500, 0],
                    "Waist": [-5, -500, 0],
                    "Perversion": [6, 600, 0],
                    "WillPower": [-10, -500, 0],
                    "Toxicity": [50, 0, 0]
                },
                "Price": 500
            },
            "pixie dust": {
                "Name": "pixie dust",
                "ShortDesc": "Pixie Dust",
                "LongDesc": "This pile of dust looks to be made of gold and glimmers with magic. Touching it makes your fingers itch.",
                "Message": "You snort the pixie dust up your nostril. After a few moments of dizziness you feel yourself invigorated with energy!",
                "Type": "potion",
                "Charges": 1,
                "UseEffect": {"Energy": [3, 0, 0], "Height" : [0,-100,0], "WillPower": [0, -50, 0], "Toxicity": [10, 0, 0]},
                "Price": 10
            },
            "fairy dust": {
                "Name": "fairy dust",
                "ShortDesc": "Fairy Dust",
                "LongDesc": "This pile of dust looks to be made of pink metal flakes and glimmers with magic. Touching it makes your fingers itch.",
                "Message": "You snort the fairy dust up your nostril. After a few moments of dizziness you start giggling madly and feel yourself invigorated with energy!",
                "Type": "potion",
                "Charges": 1,
                "UseEffect": {"Energy": [2, 0, 0], "WillPower": [0, -50, 0], "Toxicity": [10, 0, 0], "Height" : [0,-50,0], "Hormones" : [0,100,0] },
                "Price": 5
            },
            "medicinal herbs": {
                "Name": "medicinal herbs",
                "ShortDesc": "Medicinal Herbs",
                "LongDesc": "These are common herbs from a variety of plants with medicinal properties.",
                "Message": "You apply the herbs to your wounds and feel slightly better.",
                "Type": "potion",
                "Charges": 1,
                "UseEffect": {"Health": [10, 0, 0], "Toxicity": [5, 0, 0]},
                "Price": 10
            },
            "healing potion" : {
                "Name": "healing potion",
                "ShortDesc": "Potion of Healing",
                "LongDesc": "These potions are a lot more common than most people would believe. They have the ability to cure minor wounds, combat disease and purge poisons from your system.",
                "Message": "You gulp down the potion. It's sickly sweet, like a viscous syrup made from pure sugar. Within moments you feel the effects as your body starts to rejuvenate.",
                "Type": "potion",
                "Charges": 1,
                "UseEffect": {"Health": [30, 0, 0], "Toxicity": [-20, 0, 0], "Nutrition" : [20, 0, 0]},
                "Price": 50
            },
            "hair tonic": {
                "Name": "hair tonic",
                "ShortDesc": "Old JumJum's Hair Tonic",
                "LongDesc": "Old JumJum's Hair Tonic - Guaranteed to do something. Guarantee not valid if seal broken.",
                "Message": "You pour the tonic over your head and massage it into your scalp. Moments later you feel a burning and itching sensation.",
                "Type": "potion",
                "Charges": 1,
                "UseEffect": {"Hair": [0, 100, 0], "Toxicity": [20, 0, 0]},
                "Price": 10
            },
            "siren elixir": {
                "Name": "siren elixir",
                "ShortDesc": "Siren's Elixir of the Mind and Body",
                "LongDesc": "You can see the pulsing pink liquid bubbling inside the small glass bottle. It glows faintly in the dark.",
                "Message": "You drink the elixir in one gulp and sense a feeling of peace flow through you. It has a faint, bittersweet taste.",
                "Type": "potion",
                "Charges": 1,
                "UseEffect": {"WillPower" : [0,200,0], "Perversion" : [0,-200,0], "Hormones" : [0,200,0], "Face" : [0,200,0], "Bust" : [0,200,0], "Waist" : [0,-100,0], "Ass" : [0,200,0], "Hair": [0, 200, 0], "Toxicity": [100, 0, 0]},
                "Price": 100
            },
            "khafkir": {
                "Name": "khafkir",
                "ShortDesc": "A bottle of distilled Khafkir",
                "LongDesc": "This potent liquor is famed for it's healing and regenerative abilities. Over consumption can have odd side effects.",
                "Message": "You tip back the bottle and take a drink. Surprisingly it doesn't burn, but instead tastes earthy and strong.",
                "Type": "potion",
                "Charges": 1,
                "UseEffect": {"Health": [20, 0, 0], "Nutrition" : [10,0,0], "Hormones" : [0,-200,0], "Toxicity": [5, 0, 0]},
                "Price": 20
            },
            "face cream": {
                "Name": "face cream",
                "ShortDesc": "Jojo Nut Face Cream",
                "LongDesc": "This brown, buttery face cream is popular for it's anti-aging and moisturising properties.",
                "Message": "You rub the lightly tan cream into your face. It has an earthy, almost nutty scent. Your face feels refreshed.",
                "Type": "potion",
                "Charges": 1,
                "UseEffect": {"Face" : [0,100,0], "Hormones" : [0,100,0],  "Toxicity": [5, 0, 0]},
                "Price": 30
            }
        };

window.App.Data.Food = {
            "bread crust": {
                "Name": "bread crust",
                "ShortDesc": "A stale crust of bread",
                "LongDesc": "This piece of bread has seen better days... about 5 days ago. It's still edible however.",
                "Message": "You bite into the bread. It's as hard as a rock, but eventually you manage to chew and swallow it.",
                "Type": "food",
                "Charges": 1,
                "UseEffect": {"Nutrition": [5, 10, 0] },
                "Price": 1
            },
            "slave gruel": {
                "Name": "slave gruel",
                "ShortDesc": "Slave gruel mixed with semen",
                "LongDesc": "This watery looking gruel smells and tastes disgusting. The crew has 'donated' some extra nutrition to it.",
                "Message": "You wrinkle your nose and drink down the disgusting drool. You gag occasionally as thick clumps of rancid cum slide down your throat.",
                "Type": "food",
                "Charges": 1,
                "UseEffect": {"Nutrition": [5, 50, 0], "WillPower": [0, -25, 0], "Perversion": [0, 25, 0], "Hormones" : [0, 100, 0]},
                "Price": 1
            },
            "grog": {
                "Name": "grog",
                "ShortDesc": "Low Quality Grog",
                "LongDesc": "It's the typical alcoholic drink that pirates and mariners drink on long trips. It'll keep you hydrated and won't make you too sick.",
                "Message": "You tip back the crude swill. It has an unpleasant taste.",
                "Type": "food",
                "Charges": 1,
                "UseEffect": {"Nutrition": [3, 15, 0], "Toxicity": [5, 0, 0]},
                "Price": 1
            },
            "beer": {
                "Name": "beer",
                "ShortDesc": "Common Beer",
                "LongDesc": "The typical beverage of choice for most men and some women. It's refreshingly cool and with a malty aftertaste.",
                "Message": "You tip back the beer and have a drink. It's refreshing.",
                "Type": "food",
                "Charges": 1,
                "UseEffect": {"Nutrition": [3, 20, 0], "Toxicity": [2, 0, 0]},
                "Price": 2
            },
            "cheap wine": {
                "Name": "cheap wine",
                "ShortDesc": "Cheap Wine",
                "LongDesc": "Not the best quality wine, but palatable and in abundant supply.",
                "Message": "The wine has a deep red color and an almost sweet after taste.",
                "Type": "food",
                "Charges": 1,
                "UseEffect": {"Nutrition": [5, 20, 0], "Toxicity": [3, 0, 0]},
                "Price": 2
            },
            "bread and cheese": {
                "Name": "bread and cheese",
                "ShortDesc": "A serving of bread with cheese",
                "LongDesc": "Standard and relatively wholesome food.",
                "Message": "The bread has a very yeasty taste and the cheese a sharp bite.",
                "Type": "food",
                "Charges": 1,
                "UseEffect": {"Nutrition": [20, 20, 0], "Toxicity": [-5, 0, 0]},
                "Price": 5
            },
            "roast fish": {
                "Name": "roast fish",
                "ShortDesc": "A roasted fish",
                "LongDesc": "A local type of fish, roasted on a stick.",
                "Message": "You take a bite of the fish and chew. It's bland, but wholesome.",
                "Type": "food",
                "Charges": 1,
                "UseEffect": {"Nutrition": [20, 20, 0], "Toxicity": [-5, 0, 0]},
                "Price": 5
            },
            "rum": {
                "Name": "rum",
                "ShortDesc": "A bottle of Rum",
                "LongDesc": "This cheap rum is made from sugarcane.",
                "Message": "You tip back the bottle and have a drink. It burns going down and fills your stomach with fire.",
                "Type": "food",
                "Charges": 1,
                "UseEffect": {"Nutrition": [3, 10, 0], "Toxicity": [5, 0, 0], "WillPower" : [ 0, 10, 0 ]},
                "Price": 5
            },
            "starfruit": {
                "Name": "starfruit",
                "ShortDesc": "Strange starfruit",
                "LongDesc": "This slightly pink starfruit is pulpy and contains many black seeds. It has a fragrant and intoxicating smell.",
                "Message": "You take a bite out of the starfruit and savor it's sweet, but citrus taste. You feel your body filling with energy.",
                "Type": "food",
                "Charges": 1,
                "UseEffect": {"Nutrition": [15, 50, 0],  "Energy": [1, 0, 0], "Hormones": [0, 500, 0]},
                "Price": 20
            },
            "mystery stew": {
                "Name": "mystery stew",
                "ShortDesc": "A deep brown stew of unidentifiable origin",
                "LongDesc": "This stew is so dark as to practically be mud. It has bits of unidentifiable meat and vegetables (you think?) floating in it.",
                "Message": "The stew tastes surprisingly better than you thought and certainly better than it looks.",
                "Type": "food",
                "Charges": 1,
                "UseEffect": {"Nutrition": [10, 100, 0]},
                "Price": 5
            },
            "milkdew melon": {
                "Name": "milkdew melon",
                "ShortDesc": "Milkdew Melon",
                "LongDesc": "This rare melon has a milky white interior. It's has a sweet, but creamy taste.",
                "Message": "You crack the melon open and eat the contents. It tastes delicious and thick white juice dribbles down your chin.",
                "Type": "food",
                "Charges": 1,
                "UseEffect": {
                    "Nutrition": [20, 50, 0],
                    "Bust": [0, 100, 0],
                    "Hormones": [0, 200, 0],
                    "Perversion": [0, 50, 0]
                },
                "Price": 25
            },
            "honey mead": {
                "Name": "honey mead",
                "ShortDesc": "Bzzangr Honey Mead",
                "LongDesc": "A common drink along the Lingering Coast, made from the honey of giant Bzzangr insects.",
                "Message": "The mead has a delicious taste that tingles your tongue and lips.",
                "Type": "food",
                "Charges": 1,
                "UseEffect": {"Nutrition": [20, 50, 0], "Lips": [0, 100, 0]},
                "Price": 25
            },
            "butter gourd": {
                "Name": "butter gourd",
                "ShortDesc": "An oddly shaped gourd vegetable",
                "LongDesc": "The flesh of this vegetable can easily be eaten raw and it has a pleasant, almost buttery flavor and texture.",
                "Message": "You break open the gourd and dig into the fleshy interior. It's surprisingly smooth and melts in your mouth like butter or pure fat.",
                "Type": "food",
                "Charges": 1,
                "UseEffect": {"Nutrition": [20, 200, 0], "Ass": [0, 100, 0], "Hips": [0, 100, 0]},
                "Price": 35
            },
            "pink peach": {
                "Name": "pink peach",
                "ShortDesc": "A brightly colored pink peach",
                "LongDesc": "This brightly colored fruit has a sweet and musky scent. It's bulbous exterior is dimpled with purple specks.",
                "Message": "You bite into the peach and savor the sweetness of the fruit. You feel almost as if it has a calming, or curative effect on you.",
                "Type": "food",
                "Charges": 1,
                "UseEffect": {"Nutrition": [20, 100, 0], "Hormones" : [0, 100, 0], "Toxicity" : [-40, 0, 0] },
                "Price": 25
            },
            "fortified wine": {
                "Name": "fortified wine",
                "ShortDesc": "@@color:purple;A dusty bottle of fortified wine@@",
                "LongDesc": "This dusty old bottle has an almost illegible label, but you can make out that it appears to be extremely fortified (highly alcoholic) wine",
                "Message": "You tip back the bottle and have a drink. It burns going down and fills your stomach with fire. Holy shit that's strong!",
                "Type": "food",
                "Quest" : true,
                "Charges": 1,
                "UseEffect": {"Nutrition": [10, 10, 0], "Toxicity": [25, 0, 0], "WillPower" : [ 0, 20, 0 ]},
                "Price": 500
            }
        };

// STYLE TABLE
// TYPE         COMMON  UNCOMMON    RARE    LEGENDARY
// ACCESSORY    3       6           9       12
// CLOTHING     5       10          15      20
// ONE PIECE    10      20          30      40
window.App.Data.Clothes = {
// Sissy Lolita Style
            "pink head bow": {
                "Name": "pink head bow", "ShortDesc": "a cute {COLOR} bow",
                "LongDesc": "This pink bow is a cute accessory that makes you feel like a little girl.",
                "Slot": "Hat", "Restrict": ["Hat"], "Color": "pink", "Price": 60, "Style": "UNCOMMON", "Type" : "ACCESSORY",
                "WearEffect": {"Femininity": [0, 10, 50]}, "Category" : [ "Sissy Lolita", "Daddy's Girl" ]
            },
            "sissy collar": {
                "Name": "sissy collar", "ShortDesc": "a {COLOR} fur-lined leather collar emblazoned with the word 'SISSY' in rhinestones.",
                "LongDesc": "This thick collar is made of sturdy leather and lined with soft fur, making it somewhat tolerable to wear... if it wasn't for the word 'SISSY' writ large in shiny faux gems across it.",
                "Slot": "Neck", "Restrict": ["Neck"], "Color": "pink", "Price": 50, "Style": "RARE", "Type" : "ACCESSORY",
                "WearEffect": {"Femininity": [0, 10, 70]}, "Category" : [ "Sissy Lolita" ]
            },
            "striped bra": {
                "Name": "striped bra", "ShortDesc": "a {COLOR} and white striped bra",
                "LongDesc": "This cute little number is exceptionally girly, perfect for a little sissy baby.",
                "Slot": "Bra", "Restrict": ["Bra"], "Color": "pink", "Price": 80, "Style": "UNCOMMON", "Type" : "CLOTHING",
                "WearEffect": {"Femininity": [0, 10, 50]}, "Category" :  [ "Sissy Lolita" ]
            },
            "striped panties": {
                "Name": "striped panties", "ShortDesc": "a pair of {COLOR} and white striped panties",
                "LongDesc": "This cute little number is exceptionally girly, perfect for a little sissy baby.",
                "Slot": "Panty", "Restrict": ["Panty"], "Color": "pink", "Price": 80, "Style": "UNCOMMON", "Type" : "CLOTHING",
                "WearEffect": {"Femininity": [0, 10, 50]}, "Category" :  [ "Sissy Lolita" ]
            },
            "frilly bloomers": {
                "Name": "frilly bloomers", "ShortDesc": "a pair of frilly {COLOR} cotton bloomers",
                "LongDesc": "These bloomers are cut short and have a frilly bottom, perfect for a little sissy girl.",
                "Slot": "Panty", "Restrict": ["Panty"], "Color": "pink", "Price": 150, "Style": "RARE", "Type" : "CLOTHING",
                "WearEffect": {"Femininity": [0, 10, 70]}, "Category" :  [ "Sissy Lolita" ]
            },
            "striped stockings": {
                "Name": "striped stockings", "ShortDesc": "a pair of {COLOR} and white striped stockings",
                "LongDesc": "These cute striped stockings have adorable little pink bows at the top.",
                "Slot": "Stockings", "Restrict": ["Stockings"], "Color": "pink", "Price": 75, "Style": "UNCOMMON", "Type" : "CLOTHING",
                "WearEffect": {"Femininity": [0, 10, 50]}, "Category" :  [ "Sissy Lolita" ]
            },
            "frilly dress": {
                "Name": "frilly dress", "ShortDesc": "a cute frilly {COLOR} dress",
                "LongDesc": "This dress is all ruffles and lace. Perfect for attire for a dedicated sissy girl.",
                "Slot": "Dress", "Restrict": ["Shirt", "Pants", "Dress", "Costume"], "Color": "pink", "Price": 250, "Style": "UNCOMMON", "Type" : "ONE PIECE",
                "WearEffect": {"Femininity": [0, 10, 70]}, "Category" :  [ "Sissy Lolita" ]
            },
            "pink mary janes": {
                "Name": "pink mary janes", "ShortDesc": "a pair of low heeled {COLOR} mary janes",
                "LongDesc": "These girly shoes have bows on the ankles and a short heel making them easy to walk in.",
                "Slot": "Shoes", "Restrict": ["Shoes"], "Color": "pink", "Price": 125, "Style": "UNCOMMON", "Type" : "CLOTHING",
                "WearEffect": {"Femininity": [0, 5, 50]}, "Category" : [ "Sissy Lolita", "Daddy's Girl" ]
            },
            "pink platform mary janes": {
                "Name": "pink platform mary janes", "ShortDesc": "a pair of {COLOR} platform mary janes",
                "LongDesc": "These girly shoes have bows on the ankles and a chunky platform heel. Difficult to walk in but both sexy and girly.",
                "Slot": "Shoes", "Restrict": ["Shoes"], "Color": "pink", "Price": 200, "Style": "RARE", "Type" : "CLOTHING",
                "WearEffect": {"Femininity": [0, 10, 70]}, "Category" :  [ "Sissy Lolita", "Daddy's Girl" ]
            },
// Daddy's Girl style
            "pigtail wig": {
                "Name": "pigtail wig", "ShortDesc": "a {COLOR} wig with pigtails and accessories",
                "LongDesc": "This high quality wig is done up in pigtails fashioned with little heart accessories that have 'I @@color:pink;&#9825;@@ Daddy!' written on them.",
                "Slot": "Wig", "Restrict": ["Wig"], "Color": "blond", "Price": 150, "Style": "RARE", "Type" : "ACCESSORY",
                "HairLength": 60, "HairStyle": "cute pig tails", "HairBonus": 60, "Category" : [ "Daddy's Girl" ]
            },
            "pink knee socks": {
                "Name": "pink knee socks", "ShortDesc": "a pair of {COLOR} knee socks",
                "LongDesc": "These pink socks come up right to your knee and have little ties to hold them up.",
                "Slot": "Stockings", "Restrict": ["Stockings"], "Color": "pink", "Price": 75, "Style": "UNCOMMON", "Type" : "CLOTHING",
                "WearEffect": {"Femininity": [0, 10, 50]}, "Category" :  [ "Daddy's Girl", "Ordinary" ]
            },
            "white knee socks": {
                "Name": "pink knee socks", "ShortDesc": "a pair of {COLOR} knee socks",
                "LongDesc": "These white socks come up right to your knee and have little ties to hold them up.",
                "Slot": "Stockings", "Restrict": ["Stockings"], "Color": "white", "Price": 75, "Style": "UNCOMMON", "Type" : "CLOTHING",
                "WearEffect": {"Femininity": [0, 10, 50]}, "Category" :  [ "Daddy's Girl", "Ordinary" ]
            },
            "pink gingham dress": {
                "Name": "pink gingham dress", "ShortDesc": "a super short {COLOR} gingham dress",
                "LongDesc": "This dress has a girly gingham pattern with white lace collar trim. Normally it'd look quite demure, but it's so short it barely covers your arse and it has a very prominent cleavage window to show off your assets.",
                "Slot": "Dress", "Restrict": ["Shirt", "Pants", "Dress", "Costume"], "Color": "pink", "Price": 800, "Style": "LEGENDARY", "Type" : "ONE PIECE",
                "WearEffect": {"Femininity": [0, 10, 80]}, "Category" :  [ "Daddy's Girl" ]
            },
            "cute pink bra": {
                "Name": "cute pink bra", "ShortDesc": "a cute {COLOR} bra with tiny hearts on it",
                "LongDesc": "This cute bra has tiny white &#9825; on it and a delicate little bow in the middle.",
                "Slot": "Bra", "Restrict": ["Bra"], "Color": "pink", "Price": 80, "Style": "UNCOMMON", "Type" : "CLOTHING",
                "WearEffect": {"Femininity": [0, 10, 50]}, "Category" :  [ "Daddy's Girl" ]
            },
            "cute pink panties": {
                "Name": "cute pink panties", "ShortDesc": "a pair of cute {COLOR} pink panties",
                "LongDesc": "On the surface these cute pink panties look quite demure, but they have 'I @@color:pink;&#9825;@@ Daddy!' written across the backside.",
                "Slot": "Panty", "Restrict": ["Panty"], "Color": "pink", "Price": 200, "Style": "RARE", "Type" : "CLOTHING",
                "WearEffect": {"Femininity": [0, 10, 50]}, "Category" :  [ "Daddy's Girl" ]
            },
// Pirate Slut
            "pirate hat": {
                "Name": "pirate hat", "ShortDesc": "a cute little pirate hat",
                "LongDesc": "This cute little pirate hat is the perfect accessory for a sissy pirate slut.",
                "Slot": "Hat", "Restrict": ["Hat"], "Color": "black", "Price": 100, "Style": "RARE", "Type" : "ACCESSORY",
                "Category" : [ "Pirate Slut" ]
            },
// Other Styles
            "cheap wig": {
                "Name": "cheap wig", "ShortDesc": "a short {COLOR} wig",
                "LongDesc": "This cheap wig is made out of badly dyed horse hair.",
                "Slot": "Wig", "Restrict": ["Wig"], "Color": "black", "Price": 50, "Style": "COMMON", "Type" : "ACCESSORY",
                "HairLength": 30, "HairStyle": "a short bob", "HairBonus": 30
            },
            "wig": {
                "Name": "wig", "ShortDesc": "a long {COLOR} wig",
                "LongDesc": "This wig is made from human hair and of quite a fine quality.",
                "Slot": "Wig", "Restrict": ["Wig"], "Color": "blond", "Price": 150, "Style": "UNCOMMON", "Type" : "ACCESSORY",
                "HairLength": 60, "HairStyle": "loose curls", "HairBonus": 60
            },
            "exotic wig": {
                "Name": "exotic wig", "ShortDesc": "an exotic {COLOR} wig",
                "LongDesc": "This exotic wig is made of finely dyed human hair and strung with jewels.",
                "Slot": "Wig", "Restrict": ["Wig"], "Color": "purple", "Price": 300, "Style": "RARE", "Type" : "ACCESSORY",
                "HairLength": 80, "HairStyle": "twin tails", "HairBonus": 90
            },
            "bonnet": {
                "Name": "bonnet", "ShortDesc": "a frilly {COLOR} bonnet",
                "LongDesc": "This frilly little bonnet is a dainty accessory sure to give off a girlish demeanor.",
                "Slot": "Hat", "Restrict": ["Hat"], "Color": "pink", "Price": 100, "Style": "RARE", "Type" : "ACCESSORY"
            },
            "cat ears": {
                "Name": "cat ears", "ShortDesc": "a pair of fluffy {COLOR} cat ears",
                "LongDesc": "These large furry cat ears are attached by a headband to be worn.",
                "Slot": "Hat", "Restrict": ["Hat"], "Color": "black", "Price": 200, "Style": "RARE", "Type" : "ACCESSORY"
            },
            "choker": {
                "Name": "choker", "ShortDesc": "a {COLOR} silk choker",
                "LongDesc": "This thin choker is made of silk and designed to accentuate a delicate neck.",
                "Slot": "Neck", "Restrict": ["Neck"], "Color": "black", "Price": 50, "Style": "COMMON", "Type" : "ACCESSORY"
            },
            "collar": {
                "Name": "collar", "ShortDesc": "a leather slave collar",
                "LongDesc": "This thick leather collar is worn to remind everyone that the wearer is a slave.",
                "Slot": "Neck", "Restrict": ["Neck"], "Color": "black", "Price": 200, "Style": "COMMON", "Type" : "ACCESSORY", "Locked": 1,
                "WearEffect": {"WillPower": [0, -5, 50], "Perversion": [0, 5, 30]}
            },
            "nipple clamps": {
                "Name": "nipple clamps", "ShortDesc": "a pair of silver nipple clamps",
                "LongDesc": "These sterling silver nipple clamps are designed to inflict punishment... or perhaps arousal?",
                "Slot": "Nipples", "Restrict": ["Nipples"], "Color": "silver", "Price": 100, "Style": "COMMON", "Type" : "ACCESSORY",
                "WearEffect": {"WillPower": [0, -5, 80], "Perversion": [0, 5, 30]}
            },
            "nipple rings": {
                "Name": "nipple rings", "ShortDesc": "a pair of silver nipple rings joined by a chain",
                "LongDesc": "These rings are connected by a chain that is designed to torment and tug on the wearers nipples.",
                "Slot": "Nipples", "Restrict": ["Nipples"], "Color": "silver", "Price": 150, "Style": "COMMON", "Type" : "ACCESSORY",
                "WearEffect": {"WillPower": [0, -5, 80], "Perversion": [0, 5, 30]}
            },
            "chemise": {
                "Name": "chemise", "ShortDesc": "a plain {COLOR} cotton chemise",
                "LongDesc": "A brief slip designed to cover the breasts under clothes. Not very supportive at all.",
                "Slot": "Bra", "Restrict": ["Bra"], "Color": "white", "Price": 50, "Style": "COMMON", "Type" : "CLOTHING",
                "WearEffect": {"Femininity": [0, 5, 20]}
            },
            "cotton bra": {
                "Name": "cotton bra", "ShortDesc": "a {COLOR} cotton bra trimmed with lace",
                "LongDesc": "A regular sized bra designed to contain and support female breasts. It offers modest support and a small amount of sexual appeal.",
                "Slot": "Bra", "Restrict": ["Bra"], "Color": "white", "Price": 100, "Style": "COMMON", "Type" : "CLOTHING",
                "WearEffect": {"Femininity": [0, 5, 30]}
            },
            "silk bra": {
                "Name": "silk bra", "ShortDesc": "a sexy {COLOR} silk bra with lace trim",
                "LongDesc": "This expensive undergarment is designed to accentuate and display a woman's chest with lustful appeal.",
                "Slot": "Bra", "Restrict": ["Bra"], "Color": "black", "Price": 200, "Style": "COMMON", "Type" : "CLOTHING",
                "WearEffect": {"Femininity": [0, 5, 50]}
            },
            "fashion corset": {
                "Name": "fashion corset", "ShortDesc": "a tightly bound {COLOR} silk and lace corset",
                "LongDesc": "This corset is made from silk and lace, more fashionable than functional, but it still tightly binds your waist and lifts your breasts.",
                "Slot": "Corset", "Restrict": ["Corset"], "Color": "black", "Price": 200,"Style": "COMMON", "Type" : "ACCESSORY",
                "WearEffect": {"Femininity": [0, 5, 50], "Waist": [0, -10, 17]}
            },
            "training corset": {
                "Name": "training corset", "ShortDesc": "a whale boned {COLOR} training corset",
                "LongDesc": "This garment borders on a torture device. It's designed to slim and shape a woman's waist and push up her bust.",
                "Slot": "Corset", "Restrict": ["Corset"], "Color": "white", "Price": 200, "Style": "COMMON", "Type" : "ACCESSORY",
                "WearEffect": {"Femininity": [0, 5, 50], "Waist": [0, -20, 10]}
            },
            "bondage corset": {
                "Name": "bondage corset", "ShortDesc": "a steel boned {COLOR} leather bondage corset",
                "LongDesc": "This corset is made of strong leather and boned with steel. It has various straps and locks to ensure it must be worn at all times.",
                "Slot": "Corset", "Restrict": ["Corset"], "Color": "black", "Price": 400, "Style": "COMMON", "Type" : "ACCESSORY",
                "WearEffect": {"Femininity": [0, 5, 50], "Waist": [0, -25, 0]}
            },
            "cotton bloomers": {
                "Name": "cotton bloomers", "ShortDesc": "a pair of {COLOR} cotton bloomers",
                "LongDesc": "The most basic of undergarments. No frills and almost zero sex appeal.",
                "Slot": "Panty", "Restrict": ["Panty"], "Color": "white", "Price": 50, "Style": "COMMON", "Type" : "CLOTHING",
                "WearEffect": {"Femininity": [0, 5, 20]}
            },
            "sheer bloomers": {
                "Name": "sheer bloomers", "ShortDesc": "a pair of sheer {COLOR} silk and lace bloomers",
                "LongDesc": "Made from sheer silk, they're smooth against your skin and decidedly sexy.",
                "Slot": "Panty", "Restrict": ["Panty"], "Color": "black", "Price": 150, "Style": "COMMON", "Type" : "CLOTHING",
                "WearEffect": {"Femininity": [0, 5, 50]}
            },
            "cotton stockings": {
                "Name": "cotton stockings", "ShortDesc": "a pair of {COLOR} cotton stockings",
                "LongDesc": "Basic stockings, held up with string ties.",
                "Slot": "Stockings", "Restrict": ["Stockings"], "Color": "white", "Price": 50, "Style": "COMMON", "Type" : "CLOTHING",
                "WearEffect": {"Femininity": [0, 5, 20]}
            },
            "silk stockings": {
                "Name": "silk stockings", "ShortDesc": "a pair of {COLOR} silk stockings and garters",
                "LongDesc": "Luxurious and sexy silk stockings held up with garters.",
                "Slot": "Stockings", "Restrict": ["Stockings"], "Color": "black", "Price": 150, "Style": "COMMON", "Type" : "CLOTHING",
                "WearEffect": {"Femininity": [0, 5, 40]}
            },
            "fishnet stockings": {
                "Name": "fishnet stockings", "ShortDesc": "a pair of {COLOR} fishnet stockings",
                "LongDesc": "Sexy fishnet stockings topped with lace and held up by garter straps.",
                "Slot": "Stockings", "Restrict": ["Stockings"], "Color": "black", "Price": 250, "Style": "COMMON", "Type" : "CLOTHING",
                "WearEffect": {"Femininity": [0, 5, 60]}
            },
            "worn boots": {
                "Name": "worn boots", "ShortDesc": "a worn pair of {COLOR} boots",
                "LongDesc": "These boots are decidedly ugly. More functional than fashionable.",
                "Slot": "Shoes", "Restrict": ["Shoes"], "Color": "brown", "Price": 50, "Style": "COMMON", "Type" : "CLOTHING"
            },
            "knee boots": {
                "Name": "knee boots", "ShortDesc": "a pair of knee-high {COLOR} leather heeled boots",
                "LongDesc": "These fashionable leather boots go with almost any outfit.",
                "Slot": "Shoes", "Restrict": ["Shoes"], "Color": "black", "Price": 250, "Style": "COMMON", "Type" : "CLOTHING",
                "WearEffect": {"Femininity": [0, 8, 40]}
            },
            "short heels": {
                "Name": "short heels", "ShortDesc": "a pair of short {COLOR} heels",
                "LongDesc": "These dainty shoes have a small kitten heel. Not too hard to walk in.",
                "Slot": "Shoes", "Restrict": ["Shoes"], "Color": "black", "Price": 100, "Style": "COMMON", "Type" : "CLOTHING",
                "WearEffect": {"Femininity": [0, 5, 20]}
            },
            "medium heels": {
                "Name": "medium heels", "ShortDesc": "a pair of medium {COLOR} heels",
                "LongDesc": "These shoes have a medium height heel that causes you to roll your ass as you walk.",
                "Slot": "Shoes", "Restrict": ["Shoes"], "Color": "black", "Price": 150, "Style": "COMMON", "Type" : "CLOTHING",
                "WearEffect": {"Femininity": [0, 8, 40]}
            },
            "tall heels": {
                "Name": "tall heels", "ShortDesc": "a pair of very tall {COLOR} platform heels",
                "LongDesc": "The heels on these sexy shoes are so tall that you prance and waddle, shaking your ass, everywhere you walk.",
                "Slot": "Shoes", "Restrict": ["Shoes"], "Color": "black", "Price": 250, "Style": "COMMON", "Type" : "CLOTHING",
                "WearEffect": {"Femininity": [0, 5, 60]}
            },
            "cotton blouse": {
                "Name": "cotton blouse", "ShortDesc": "a {COLOR} cotton blouse",
                "LongDesc": "This simple cotton blouse is made from rough cotton.",
                "Slot": "Shirt", "Restrict": ["Shirt", "Dress", "Costume"], "Color": "white", "Price": 50, "Style": "COMMON", "Type" : "CLOTHING",
                "WearEffect": {"Femininity": [0, 5, 20]}
            },
            "silk blouse": {
                "Name": "silk blouse", "ShortDesc": "a low cut {COLOR} silk blouse",
                "LongDesc": "This elegant silk blouse is cut daringly low.",
                "Slot": "Shirt", "Restrict": ["Shirt", "Dress", "Costume"], "Color": "white", "Price": 150, "Style": "COMMON", "Type" : "CLOTHING",
                "WearEffect": {"Femininity": [0, 5, 40]}
            },
            "leather pants": {
                "Name": "leather pants", "ShortDesc": "a pair of {COLOR} leather pants",
                "LongDesc": "These leather pants are incredibly tight and designed to show off your ass.",
                "Slot": "Pants", "Restrict": ["Pants", "Dress", "Costume"], "Color": "black", "Price": 200, "Style": "COMMON", "Type" : "CLOTHING"
            },
            "leather shorts": {
                "Name": "leather shorts", "ShortDesc": "a pair of low rise {COLOR} leather shorts",
                "LongDesc": "These tight leather shorts ride up in all the right places.",
                "Slot": "Pants", "Restrict": ["Pants", "Dress", "Costume"], "Color": "black", "Price": 150, "Style": "COMMON", "Type" : "CLOTHING"
            },
            "cotton dress": {
                "Name": "cotton dress",
                "ShortDesc": "a {COLOR} cotton dress",
                "LongDesc": "This simple cotton dress is made from rough cotton.",
                "Slot": "Dress",
                "Restrict": ["Shirt", "Pants", "Dress", "Costume"],
                "Color": "blue",
                "Price": 50,
                "Style": "COMMON", "Type" : "ONE PIECE",
                "WearEffect": {"Femininity": [0, 5, 20]}
            },
            "sundress": {
                "Name": "sundress", "ShortDesc": "a cute {COLOR} floral sundress",
                "LongDesc": "This soft sundress has a cute floral pattern that is exceptionally girly.",
                "Slot": "Dress", "Restrict": ["Shirt", "Pants", "Dress", "Costume"], "Color": "pink", "Price": 100, "Style": "UNCOMMON", "Type" : "ONE PIECE",
                "WearEffect": {"Femininity": [0, 5, 50]}
            },
            "micro dress": {
                "Name": "sexy micro dress",
                "ShortDesc": "a figure hugging {COLOR} micro dress",
                "LongDesc": "This dress is made out of some exotic material that hugs every curve of your body. It's so humiliatingly short that your genitals are half open for everyone and the top has several strategic holes to expose your nipples.",
                "Slot": "Dress",
                "Restrict": ["Shirt", "Pants", "Dress", "Costume"],
                "Color": "red",
                "Price": 250,
                "Style": "UNCOMMON", "Type" : "ONE PIECE",
                "WearEffect": {"Femininity": [0, 15, 60], "Seduction" : [10,0,0]}
            },
            "sexy dress": {
                "Name": "sexy dress",
                "ShortDesc": "a sexy {COLOR} mini dress",
                "LongDesc": "This daringly short dress hugs your body and lets everyone know it's for sale.",
                "Slot": "Dress",
                "Restrict": ["Shirt", "Pants", "Dress", "Costume"],
                "Color": "black",
                "Price": 250,
                "Style": "UNCOMMON", "Type" : "ONE PIECE",
                "WearEffect": {"Femininity": [0, 15, 60],  "Seduction" : [10,0,0]}
            },
            "stripper costume": {
                "Name": "stripper costume",
                "ShortDesc": "a tacky looking {COLOR} stripper costume",
                "LongDesc": "This costume consists of a two piece outfit with accessories that is designed to mimic a navy officers uniform, if the navy was a service filled with "+
                "brazen whores. The skirt is flared and too low, showing off your bottom. The top is tight and mostly open, it has patches that can be pulled off to reveal tassels hanging "+
                "off your tits from pasties that are shaped like anchors. Instead of sleeves or a collar it has little accessories designed to look like them, including the epaulets of the navy "+
                "suit jacket.",
                "Slot": "Costume",
                "Restrict": ["Shirt", "Pants", "Dress", "Costume"],
                "Color": "white",
                "Price": 450,
                "Style": "UNCOMMON", "Type" : "ONE PIECE",
                "WearEffect": {"Femininity": [0, 15, 60], "Perversion": [0, 5, 50]},
                "SkillBonus": {"Dancing": [10, 20, 0], "Singing": [10, 10, 0]}
            },
            "burlesque costume": {
                "Name": "burlesque costume",
                "ShortDesc": "a fancy {COLOR} burlesque costume",
                "LongDesc": "This costume is typical of the many burlesque dancers that entertain customers in taverns throughout the land. It has a variety of accessories and flair designed to be torn off as you strip.",
                "Slot": "Costume",
                "Restrict": ["Shirt", "Pants", "Dress", "Costume"],
                "Color": "red",
                "Price": 450,
                "Style": "UNCOMMON", "Type" : "ONE PIECE",
                "WearEffect": {"Femininity": [0, 15, 60], "Perversion": [0, 5, 50]},
                "SkillBonus": {"Dancing": [10, 20, 0], "Singing": [10, 10, 0]}
            },
            "maid costume": {
                "Name": "maid costume",
                "ShortDesc": "a frilly {COLOR} maid uniform",
                "LongDesc": "This is a typical maid costume that has been altered to showcase your ass and chest.",
                "Slot": "Costume",
                "Restrict": ["Shirt", "Pants", "Dress", "Costume"],
                "Color": "black",
                "Price": 450,
                "Style": "UNCOMMON", "Type" : "ONE PIECE",
                "WearEffect": {"Femininity": [0, 15, 60], "Perversion": [0, 5, 50]},
                "SkillBonus": {"Cooking": [20, 20, 0], "Cleaning": [20, 20, 0]}
            },
            "small plug": {
                "Name": "small plug", "ShortDesc": "a metal anal plug with a {COLOR} faux gem",
                "LongDesc": "This tiny little plug is designed be worn in your ass. The fake gem is there for decoration.",
                "Slot": "Butt", "Restrict": ["Butt"], "Color": "pink", "Price": 100, "Style": "COMMON", "Type" : "ACCESSORY",
                "WearEffect": {"Perversion": [0, 10, 40]}
            },
            "large plug": {
                "Name": "large plug", "ShortDesc": "a large {COLOR} butt plug",
                "LongDesc": "This large butt plug can be worn in your ass to help loosen your sissy hole for use.",
                "Slot": "Butt", "Restrict": ["Butt"], "Color": "black", "Price": 200, "Style": "COMMON", "Type" : "ACCESSORY",
                "WearEffect": {"Perversion": [0, 10, 40], "AssFucking": [0, 20, 30]}
            },
            "cat tail": {
                "Name": "cat tail", "ShortDesc": "a long furry {COLOR} cat tail anal plug",
                "LongDesc": "This large anal plug has a long furry cat tail attached to it. Wearing it will loosen your asshole and probably attract animal lovers.",
                "Slot": "Butt", "Restrict": ["Butt"], "Color": "black", "Price": 300, "Style": "COMMON", "Type" : "ACCESSORY",
                "WearEffect": {"Perversion": [0, 10, 50], "AssFucking": [0, 20, 30]}
            },
            "chastity cage": {
                "Name": "chastity cage", "ShortDesc": "a metal and leather chastity device",
                "LongDesc": "This cruel device constricts and crushes your genitals. Wearing it is not only painful but probably bad for your health.",
                "Slot": "Penis", "Restrict": ["Penis"], "Color": "black", "Price": 300, "Style": "COMMON", "Type" : "ACCESSORY", "Locked": 1,
                "WearEffect": {
                    "Perversion": [0, 10, 30],
                    "Penis": [0, -15, 0],
                    "Balls": [0, -15, 0]
                }
            },
            "cock ribbon": {
                "Name": "cock ribbon", "ShortDesc": "a cute little {COLOR} ribbon",
                "LongDesc": "This dainty little ribbon is meant to be tied on a sissy clit for decoration.",
                "Slot": "Penis", "Restrict": ["Penis"], "Color": "pink", "Price": 300, "Style": "COMMON", "Type" : "ACCESSORY",
                "WearEffect": {"Femininity": [0, 10, 30]}
            }
        };

window.App.Data.Cosmetics = {
            "hair accessories": {
                "Name": "haircare accessories",
                "ShortDesc": "hair accessories [x5]",
                "LongDesc": "A collection of cheap brushes, combs, ribbons and other accessories for styling hair.",
                "Type": "hair tool",
                "Charges": 5,
                "SkillBonus": {"Styling": [5, 0, 0]},
                "Price": 2
            },
            "hair products": {
                "Name": "haircare supplies",
                "ShortDesc": "haircare supplies [x5]",
                "LongDesc": "Various substances for styling and maintaining hair.",
                "Type": "hair treatment",
                "Charges": 5,
                "SkillBonus": {"Styling": [10, 0, 0]},
                "Price": 3
            },
            "basic makeup": {
                "Name": "basic makeup",
                "ShortDesc": "basic makeup [x5]",
                "LongDesc": "A collection of cheap makeup. Basic pigments and foundation with lipstick.",
                "Type": "basic makeup",
                "Charges": 5,
                "SkillBonus": {"Styling": [10, 0, 0]},
                "Price": 4
            },
            "expensive makeup": {
                "Name": "expensive makeup",
                "ShortDesc": "expensive makeup [x5]",
                "LongDesc": "A collection of nice makeup. It contains attractive pigments, eyeshadow and lipstick.",
                "Type": "expensive makeup",
                "Charges": 5,
                "SkillBonus": {"Styling": [20, 0, 0]},
                "Price": 6
            }
        };

window.App.Data.QuestItems = {
        "isla harbor mansion key": {
            "Name": "isla harbor mansion key",
            "ShortDesc": "@@color:purple;isla harbor mansion key@@",
            "LongDesc": "You obtained this backdoor key by letting Jarvis the butler pillage YOUR backdoor. It was hard work and your poor abused asshole leaked cum for hours afterwards, but now you can sneak into the mansion after dark.",
            "Type": "QUEST"
        },
        "14 inch purple dildo": {
            "Name": "14 inch purple dildo",
            "ShortDesc": "@@color:purple;a 14 inch purple dildo@@",
            "LongDesc": "This giant dildo is surprisingly rubbery with realistic veins and an equally impressive set of fake balls attached to you. Somewhat surprisingly you found this in the closet of your supposedly virginal girlfriend.",
            "Type": "QUEST"
        },
        "porno portfolio": {
            "Name": "porno portfolio",
            "ShortDesc": "@@color:purple;a portfolio of pornographic drawings@@",
            "LongDesc": "This leather portfolio is bound with string and contains numerous drawings of naked women engaged in various acts of fornication using all sorts of implements. You wonder why this was at the bottom of your girlfriends closet?",
            "Type": "QUEST"
        }
};
/* twine-user-script #11: "JobData.js" */
window.App = window.App || { Data: { }, Entity: { } };

window.App.Data.JobData = {
    "COOK01": {
        "ID": "COOK01", "TITLE": "Helping out in the Galley", "GIVER": "Cook", "PAY" : 10,
        "RATING" : 2, // of 5
        "PHASES" : [ 0, 1, 2, 3 ],
        "DAYS"   : 1,
        "HIDDEN" : false,
        "COST" : [  { "TYPE" : "TIME", "VALUE" : 1 },
                    { "TYPE" : "STAT", "NAME" : "Energy", "VALUE" : 1 } ],
        "REQUIREMENTS" : [
            { "TYPE" : "SKILL", "NAME" : "Cooking", "VALUE" : 20, "CONDITION" : "gte" } ],
        "INTRO" :   "NPC_NAME says, \"PLAYER_NAME, you've become a decently good hand in the galley recently, so if you'd "+
                    "like to earn some extra coin, how 'bout giving me an the boys a 'hand'... or an arse even! "+
                    "Ye have no idea how boring it is to slop up gruel all day long - having a pBLOWJOBS like you "+
                    "around'd be a nice change o' pace...\"",
        "START" : "",
        "SCENES" : [
            {
                "ID" : "SCENE01",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                            { "TAG": "A", "TYPE" : "SKILL", "NAME" : "Cooking", "DIFFICULTY" : 30, "REWARD" : "MONEY", "R_NAME" : "MONEY","VALUE" : 10, "OPT" : 0 }],
                "POST" : [
                    { "TYPE" : "NPC_STAT", "NAME" : "Mood", "VALUE" : 5, "OPT" : 0 } ],
                "START" :   "The galley is small and cramped and it doesn't help matters that NPC_NAME himself is enormous. "+
                            "You do your best to mostly try to stay out of the way, but every now and then his hands "+
                            "seem to find you with a not so subtle shove or a grope of your pBUST chest or pASS ass.",
                "END" : "",
                "RESULTS" : [
                            {"A":  25, "TEXT": "The @@distraction is too much for you@@ and you end up burning some food. That'll come out of your pay, or your ass, later."},
                            {"A":  50, "TEXT": "Despite being distracted by the constant groping you @@manage to keep your food from burning@@."},
                            {"A": 500, "TEXT": "You @@expertly manage to keep your eyes on the dishes@@ you are preparing even as your tits and ass are being "+
                                                "mauled by NPC_NAME and his staff. It seems you're quite used to being sexually harassed."} ]
            },
            {
                "ID" : "SCENE02",
                "TRIGGERS" :[
                    { "TYPE" : "NPC_STAT", "NAME" : "Lust", "VALUE" : 80, "CONDITION" : "gte" }
                ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "B", "TYPE" : "SKILL", "NAME" : "Cooking", "DIFFICULTY" : 30, "REWARD" : "MONEY", "R_NAME" : "MONEY", "VALUE" : 10, "OPT" : 0 },
                    { "TAG" : "C", "TYPE" : "SKILL", "NAME" : "AssFucking", "DIFFICULTY" : 30, "REWARD" : "MONEY","R_NAME" : "MONEY","VALUE" : 10, "OPT" : 0 }],
                "POST" : [
                    { "TYPE" : "NPC_STAT", "NAME" : "Lust", "VALUE" : -20, "OPT" : 0 },
                    { "TYPE" : "NPC_STAT", "NAME" : "Mood", "VALUE" : 5, "OPT" : 0 }
                ],
                "START" :   "You're chopping some vegetables for NPC_NAME's famous 'mystery stew' when you feel a pair of large arms "+
                            "wrap around you. It's NPC_NAME and he whispers in your ear, \"Just relax and keep chopping those veggies slut.\" "+
                            "You take a deep breath and continue chopping while his burly hands start removing your lower clothes. Within minutes "+
                            "you feel something wet and slick being rubbed all over your asshole and shortly after that the sensation of NPC_NAME's "+
                            "cock being pushed up against your sphincter.",
                END : "NPC_NAME cleans off his cock on a nearby rag and wanders off, leaving you humiliated and with a slippery ass dripping cum.",
                "RESULTS" : [
                    {"B":  25, "TEXT":  "You try to steady yourself, but the feeling of the rough penetration is too much for your inexperienced ass and @@you "+
                                        "make a huge mess of the vegetables@@ as NPC_NAME pillages your butt hole."},
                    {"B":  50, "TEXT":  "It's difficult, but you @@somehow manage to not make too much of a mess@@ as NPC_NAME rams his tool up your slick asshole."},
                    {"B": 500, "TEXT":  "You steel yourself for a moment and force your asshole to gape open so as to accommodate NPC_NAME's tool. Doing so allows "+
                                        "him to easily achieve maximum penetration into your sissy ass and @@keeps you from ruining the food in front of you@@."},
                    {"C":  25, "TEXT":  "He pumps away at your pASS butt for what seems like ages, you try to encourage him, just to get the ordeal over, but it "+
                                        "@@doesn't seem to have much effect@@. Eventually he does manage to climax, and dumps a hot load of cum up your whore ass."},
                    {"C":  50, "TEXT":  "He ravages your whore ass, pushing his meaty cock so deep into you that you @@gasp in a mixture of pain and arousal@@. This goes on "+
                                        "for a long time until you feel his cock twitch and start squirting hot jizz up your pASS butt."},
                    {"C": 500, "TEXT":  "He plows your whore ass with extreme vigour and you do your best to respond and encourage him, @@grinding your own ass against "+
                                        "his cock and bucking your hips in time with him@@. It doesn't take long for NPC_NAME to loudly groan and climax, his meaty cock shooting an "+
                                        "enormous amount of cum up your backside. As he pulls out, NPC_NAME gives you a swat on the ass and says, \"Good job, whore.\""}]
            },
            {
                "ID" : "SCENE03",
                "TRIGGERS" :[
                    { "TYPE" : "RANDOM-100", "VALUE" : 33, "CONDITION" : "lte" } ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [ ],
                "POST" : [
                    { "TYPE" : "FOOD", "NAME" : "bread crust", "VALUE" : 3, "OPT" : "RANDOM" }],
                "START" :   "The work in the galley is winding down and there are less people about, you take the opportunity to pocket a few crusts of bread.",
                "END" : "",
                "RESULTS" : [ ]
            }
        ],
        "END" : "Finally, your shift in the galley is over. NPC_NAME comes up to you and says, \"JOB_RESULTS\" He then hands you JOB_PAY coins.",
        "JOB_RESULTS" : [
            { "A" :  25,  "TEXT" : "Your @@cooking was pretty horrible@@, don't complain about the pay." },
            { "A" :  50, "TEXT" : "Your @@cooking was passable@@, but then again these slobs here aren't used to fine chow anyway." },
            { "A" : 500, "TEXT" : "I'm impressed that your @@cooking was so good@@. Who knew you had that kind of talent as well?" },
            { "C" :  25, "TEXT" : "How can you be such @@a bad fuck@@? You'd think after all the dicks you've taken you'd be halfway decent at it by now." },
            { "C" :  50, "TEXT" : "Your ass @@was pretty good@@ - but I think you need more practice. Like tomorrow, and here." },
            { "C" : 500, "TEXT" : "But who cares about your cooking when you can @@work a cock with your ass like that@@. Come back later if you want some more fun." }
        ]

    },
    "COOK02": {
        "ID": "COOK02", "TITLE": "Cooking Lessons", "GIVER": "Cook", "PAY" : 0,
        "RATING" : 1, // of 5
        "PHASES" : [ 0, 1, 2, 3 ],
        "DAYS"   : 1,
        "HIDDEN" : false,
        "COST" : [
            { "TYPE" : "TIME",  "VALUE" : 1 },
            { "TYPE" : "STAT",  "NAME" : "Energy", "VALUE" : 1 },
            { "TYPE" : "MONEY", "VALUE" : 20 } ],
        "REQUIREMENTS" : [
            { "TYPE" : "SKILL", "NAME" : "Cooking", "VALUE" : 5,  "CONDITION" : "gte" } ],
        "INTRO" :
        "NPC_NAME says, \"We can always use help in the galley PLAYER_NAME. If your skill at cooking is too low then I could give you "+
        "a 'personal lesson' for a small fee...\"",
        "START" :
        "NPC_NAME leads you to the back of the galley and to a large table where he has laid out a collection of cooking tools and ingredients. "+
        "You're actually surprised that he's put so much thought into this considering the quality of the food it that the pirates on board the "+
        "ship eat.",
        "SCENES" : [
            {
                "ID" : "SCENE01",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "A", "TYPE" : "SKILL", "NAME" : "Cooking", "DIFFICULTY" : 30, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 100, "OPT" : 0 }
                ],
                "POST" : [
                    { "TYPE" : "SKILL_XP", "NAME" : "Cooking", "VALUE" :  10, "OPT" : 0 },
                    { "TYPE" : "SKILL_XP", "NAME" : "Cooking", "VALUE" : 100, "OPT" : "RANDOM" }
                ],
                "START" :
                "NPC_NAME starts by giving you some basic instruction on how to use various tools and implements in the galley. He then goes into a "+
                "practical demonstration of some simple dishes, their ingredients and their preparation. After watching him it's then your turn to "+
                "try and repeat the recipes.",
                "END" : "",
                "RESULTS" : [
                    {"A":  25, "TEXT":  "Unfortunately it seems that the lesson didn't really stick well with you and your @@dishes came out horrible@@. NPC_NAME isn't pleased with the result."},
                    {"A":  50, "TEXT":  "With a small amount of effort you manage to cook a @@dish that isn't half bad@@. NPC_NAME takes a few tastes and nods his head with slight approval."},
                    {"A": 500, "TEXT":  "You take your time and manage to @@skillfully recreate the dishes@@ that you were shown. NPC_NAME looks at them, takes a few tastes and then nods with approval."} ]
            },
            {
                "ID" : "SCENE02",
                "TRIGGERS" :[
                    { "TYPE" : "NPC_STAT", "NAME" : "Lust", "VALUE" : 50, "CONDITION" : "gte" }
                ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "B", "TYPE" : "SKILL", "NAME" : "BlowJobs", "DIFFICULTY" : 30, "REWARD" : "MONEY", "R_NAME" : "MONEY", "VALUE" : 10, "OPT" : 0 }
                ],
                "POST" : [
                    { "TYPE" : "NPC_STAT",  "NAME" : "Lust",        "VALUE" : -20,  "OPT" : 0 },
                    { "TYPE" : "NPC_STAT",  "NAME" : "Mood",        "VALUE" : 5,    "OPT" : 0 },
                    { "TYPE" : "STAT",      "NAME" : "Nutrition",   "VALUE" : 5,    "OPT" : 0 }
                ],
                "START" :
                "After the cooking lesson, NPC_NAME comes to you and says, \"Now that we've got that out of the way, how about you get on your knees "+
                "here and try to earn back a little bit of your tuition with that slutty mouth of yours?\" NPC_NAME doesn't even wait for you to respond before he "+
                "pushes you down by the shoulder and fishes his stiffening cock from his trousers. You wince internally a bit, but then resign yourself to having to suck "+
                "his sweaty cock. He pushes his turgid meat against your pLIPS lips and you begin to slowly lick the glans of his penis trying to arouse him.",
                END :
                    "NPC_NAME pulls up his trousers and gives you a rough pat on the head and then walks away.",
                "RESULTS" : [
                    {"B":  25, "TEXT":
                    "Without warning NPC_NAME shoves his dick full in your mouth. You try to accommodate his massive meat pole @@but you struggle to "+
                    "find the right movement and tempo@@. Not that it matters much because NPC_NAME simply grabs your head and then forcibly rams his dick down your throat until he cums.\n\n"+
                    "NPC_NAME says, \"That was horrible PLAYER_NAME. You should be paying me for that kind of shitty blow job. Go get some more practice god damn it, it's not like there "+
                    "isn't a ship full of dicks to suck here.\""},
                    {"B":  50, "TEXT":
                    "You take NPC_NAME's stiffening cock in your mouth and @@begin to suck on it in earnest@@. Within moments he is starting to moan and you increase " +
                    "the pleasure by bobbing your head up and down on his shaft, the tip of his dick tickling the back of your throat. After a few minutes of this treatment NPC_NAME grabs "+
                    "a hold of your head and rams his dick in as far as it can go, you know what this means and do your best to relax so that he can shoot his load straight into your gullet.\n\n" +
                    "NPC_NAME says, \"Not bad PLAYER_NAME, I'll give you back JOB_PAY coins.\""},
                    {"B": 500, "TEXT":
                    "@@You easily swallow his dick@@ and within moments you have it sufficiently lubricated and your throat relaxed enough to be able to take him down "+
                    "so deeply that he's quickly moaning and panting in pleasure. You toy with the tempo and your tongue movements until he's almost about to pass out from the stimulation and then "+
                    "he suddenly starts shooting his load directly into your mouth. There's so much of it that it's a real struggle to swallow it all down.\n\n"+
                    "NPC_NAME says, \"Not bad PLAYER_NAME, I'll give you back JOB_PAY coins.\""} ]
            },
            {
                "ID" : "SCENE03",
                "TRIGGERS" :[
                    { "TYPE" : "RANDOM-100", "VALUE" : 50, "CONDITION" : "lte" } ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [ ],
                "POST" : [
                    { "TYPE" : "FOOD", "NAME" : "bread crust", "VALUE" : 3, "OPT" : "RANDOM" }],
                "START" :
                "With the lesson in galley over, you notice an opportunity for you to steal some food. Normally you're not a thief, but these are not "+
                "normal times. When you're sure no one is looking you manage to swipe some bread crusts. At least it's better than the semen gruel they keep feeding you.",
                "END" : "",
                "RESULTS" : [ ]
            }
        ],
        "END" :
            "You feel like you made some JOB_RESULTS.",
        "JOB_RESULTS" : [
            { "A" :  25,  "TEXT" : "@@minimal progress@@ today" },
            { "A" :  50, "TEXT" : "@@moderate progress@@ today" },
            { "A" : 500, "TEXT" : "@@good progress@@ today" },
            { "B" :  25, "TEXT" : " even if you did have to @@suck a cock@@ to get the lesson" },
            { "B" :  50, "TEXT" : " even if you did have to @@suck a cock@@ to get the lesson" },
            { "B" : 500, "TEXT" : " even if you did have to @@suck a cock@@ to get the lesson" }
        ]

    },
    "COOK03": {
        "ID": "COOK03", "TITLE": "A 'Free Meal'", "GIVER": "Cook", "PAY" : 0,
        "RATING" : 1, // of 5
        "PHASES" : [ 0, 1, 2, 3 ],
        "DAYS"   : 1,
        "HIDDEN" : true,
        "COST" : [
            { "TYPE" : "TIME",  "VALUE" : 1 },
            { "TYPE" : "STAT",  "NAME" : "Energy", "VALUE" : 1 }],
        "REQUIREMENTS" : [
            { "TYPE" : "STAT",      "NAME" : "Nutrition",   "VALUE" : 70,   "CONDITION" : "lte" },
            { "TYPE" : "NPC_STAT",  "NAME" : "Lust",        "VALUE" : 60,   "CONDITION" : "gte" }
        ],
        "INTRO" :
            "NPC_NAME says, \"You're looking a little hungry PLAYER_NAME... and I don't just mean for cock. Tell you what, if you want to get a "+
            "'free meal' I might be willing to oblige if you have a little fun with me in return.\" He gestures his head in the direction of a "+
            "large 'high chair' across the room, the kind you might feed a child from, but obviously built for an adult. You have a bad feeling about this.",
        "START" :
            "NPC_NAME leads you over to the looming high chair and shoves you into it. Before you can even catch your breath, you find yourself "+
            "locked in behind the large wooden tray. Just as you are about to protest, NPC_NAME puts one of his massive fingers against your lips "+
            "and goes, \"Shh... just be quiet like a good little sissy baby.\"\n\n"+
            "He then manacles you to the chair and produces a large pink bonnet that he secures to your head as well as a frilly pink bib that he "+
            "places around your neck. He chuckles mirthfully to himself and then says, \"One minute sissy girl. Daddy has a treat for you.\" You  "+
            "hear some shuffling behind you as NPC_NAME rummages around in the kitchen. Within moments he returns with a large bowl of yellowish "+
            "goop and ominously, no spoon. He sets the bowl down on the counter next to him and pulls down his trousers, revealing a fat and massive cock.",
        "SCENES" : [
            {
                "ID" : "SCENE01",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "A", "TYPE" : "SKILL", "NAME" : "BlowJobs", "DIFFICULTY" : 30, "REWARD" : "NPC_STAT", "R_NAME" : "Mood", "VALUE" : 10, "OPT" : 0 }
                ],
                "POST" : [
                    { "TYPE" : "STAT_XP",   "NAME" : "Nutrition",   "VALUE" : 100,  "OPT" : 0 },
                    { "TYPE" : "STAT",      "NAME" : "Nutrition",   "VALUE" :  20,  "OPT" : 0 },
                    { "TYPE" : "BODY_XP",   "NAME" : "Lips",        "VALUE" :  50,  "OPT" : 0 },
                    { "TYPE" : "BODY_XP",   "NAME" : "Lips",        "VALUE" : 100,  "OPT" : "RANDOM" },
                    { "TYPE" : "STAT_XP",   "NAME" : "Hormones",    "VALUE" : 100,  "OPT" : "RANDOM" },
                    { "TYPE" : "STAT_XP",   "NAME" : "WillPower",   "VALUE" : -20,  "OPT" : 0 },
                    { "TYPE" : "NPC_STAT",  "NAME" : "Mood",        "VALUE" :   5,  "OPT" : 0 },
                    { "TYPE" : "NPC_STAT",  "NAME" : "Lust",        "VALUE" : -20,  "OPT" : 0 }
                ],
                "START" :
                    "With one hand he scoops up some of the mysterious goop and slathers a large heaping on his turgid member. He approaches you eagerly, "+
                    "his massive cock waving in front of your face.\n\n NPC_NAME says, \"Now be a good sissy and open wide...\"\n\n"+
                    "You quickly turn your head away, but it's to no avail as NPC_NAME easily palms your entire skull with one of his massive meat hooks and "+
                    "turns you to face his cock. Without much ceremony he pushes his meat past your pLIPS lips.\n\n"+
                    "Inwardly you sigh. This entire act is humiliating and degrading, but you're the one that wanted a free meal. Faking a smile you lean forward "+
                    "and start licking the goop from NPC_NAME's dick, taking care to run your tongue and pLIPS lips over his glans while consuming as much of the 'food' as you can.\n\n"+
                    "NPC_NAME continues feeding you this way by putting more and more of the mystery gruel on his cock and forcing it past your lips. Somewhere "+
                    "after the fourth or fifth serving you start to feel your head get light and your lips start to tingle. Without even noticing it you have been "+
                    "absently slurping and licking the gruel off his massive member and licking your lips in between servings. Eventually NPC_NAME gets tired of "+
                    "the game and begins to fuck your face in earnest. You think that this is supposed to hurt, but for some reason your entire face and brain feel numb. "+
                    "Maybe there was something in the gruel?\n\n"+
                    "NPC_NAME grabs your head and forces it down on his pole. The strength of this man is not to be underestimated as he easily buries "+
                    "your pLIPS lips down to the root of his shaft. You feel his already massive member swell in size and then start to spasm as he shoots an enormous "+
                    "amount of cum past your tonsils and down your throat.",
                "END" :
                    "After all is said and done and after NPC_NAME has unlocked you from the chair, you let out a small burp flavored with sperm and say to yourself, \"I guess there's no such thing as a 'free meal'\"",
                "RESULTS" : [
                    {"A": 25,    "TEXT": "NPC_NAME says, \"That was fun, but you're a @@lousy cock sucker@@. Oh well at least you'll have time to learn.\""},
                    {"A": 50,   "TEXT": "NPC_NAME says, \"Not bad PLAYER_NAME. Not bad at all. You keep @@sucking my dick like that@@ and I might keep you as my personal little girl.\""},
                    {"A": 500,  "TEXT": "NPC_NAME says, \"Damn you're a pretty @@good cock sucker@@ ain't ya? Come back later if you want to 'fill your belly' again slut.\""}
                ]
            }
        ],
        "END" : "",
        "JOB_RESULTS" : [ ]
    },
    "QUAR01": {
        "ID": "QUAR01", "TITLE": "Helping down in the hold", "GIVER": "Quartermaster", "PAY" : 10,
        "RATING" : 1, // of 5
        "PHASES" : [ 0, 1 ],
        "DAYS"   : 1,
        "HIDDEN" : false,
        "COST" : [
            { "TYPE" : "TIME",  "VALUE" : 2 },
            { "TYPE" : "STAT",  "NAME" : "Energy", "VALUE" : 2 }],
        "REQUIREMENTS" : [
        ],
        "INTRO" :
        "NPC_NAME says, \"If you're looking for a way to earn some extra coin, I usually need help cleaning up and taking stock down here in the hold "+
        "every morning. It's backbreaking work and pays like shit, but maybe it's better than sucking dick all day?\"",
        "START" : "",
        "SCENES" : [
            {
                "ID" : "SCENE01",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "A", "TYPE" : "SKILL", "NAME" : "Cleaning", "DIFFICULTY" : 50, "REWARD" : "MONEY", "R_NAME" : "MONEY", "VALUE" : 10, "OPT" : 0 }
                ],
                "POST" : [
                    { "TYPE" : "STAT_XP",   "NAME" : "Fitness",     "VALUE" :  50,  "OPT" : 0 },
                    { "TYPE" : "NPC_STAT",  "NAME" : "Mood",        "VALUE" :  10,  "OPT" : 0 }
                ],
                "START" :
                    "The cargo hold is vast, dark and dirty. It's a huge amount of tiring work, but thankfully you're so far out of the way "+
                    "that most of the crew leaves you alone to get on with it. That's not to say that this lack of distraction makes this an "+
                    "easy good, not at all. In fact, you find the work rather difficult and exhausting. The boxes are heavy and dust is " +
                    "covering everything. Occasionally you are surprised by the presence of a small rodent or spider - stow aways on the ship, much like you.\n\n",
                "END" : "",
                "RESULTS" : [
                    {"A": 25,   "TEXT":
                        "The work is back breaking and grueling, but you manage to work for a couple of hours and get the majority of the task done. "+
                        "While keeping any semblance of order down here in the hold is probably impossible, for today at least @@you've done your part@@."},
                    {"A": 50,   "TEXT":
                        "The work is back breaking and grueling, but you manage to work for a couple of hours and get the majority of the task done. "+
                        "At the end of the shift, while not perfect, the area is @@much improved@@."},
                    {"A": 500,  "TEXT":
                        "The work is back breaking and grueling, but you manage to work for a couple of hours and get the majority of the task done. "+
                        "Taking a break to wipe the sweat from your eyes, you look upon your handy work with a @@sense of satisfaction@@."}
                ]
            },
            {
                "ID" : "SCENE02",
                "TRIGGERS" :[
                    { "TYPE" : "RANDOM-100", "VALUE" : 33, "CONDITION" : "lte" } ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [ ],
                "POST" : [
                    { "TYPE" : "DRUGS", "NAME" : "medicinal herbs", "VALUE" : 1, "OPT" : 0 }],
                "START" :
                    "While cleaning, out of the corner of your eye you spot a small pouch of herbs. These must belong to NPC_NAME, " +
                    "or he must have lost them. With a quick glance to make sure no one is looking, you snatch them up.",
                "END" : "",
                "RESULTS" : [ ]
            }
        ],
        "END" : "NPC_NAME comes up to you and says, \"JOB_RESULTS\" He then hands you JOB_PAY coins.",
        "JOB_RESULTS" : [
            { "A" :  25,  "TEXT" : "Well, I guess that's @@better than nothing@@." },
            { "A" :  50, "TEXT" : "Hmm... @@not too bad@@. You certainly know your way around a broom." },
            { "A" : 500, "TEXT" : "That's a @@pretty good job@@ PLAYER_NAME. Come back again sometime for more work." }
        ]
    },
    "QUAR02": {
        "ID": "QUAR02", "TITLE": "Human Experimentation", "GIVER": "Quartermaster", "PAY" : 20,
        "RATING" : 3, // of 5
        "PHASES" : [ 0, 1, 2 ],
        "DAYS"   : 3,
        "HIDDEN" : false,
        "COST" : [
            { "TYPE" : "TIME",  "VALUE" : 2 },
            { "TYPE" : "STAT",  "NAME" : "Energy", "VALUE" : 3 }],
        "REQUIREMENTS" : [
        ],
        "INTRO" :
            "NPC_NAME says, \"You know, I've got this new special 'substance' that I've been working on. The effects are currently unknown. "+
            "How about it? Are you willing to be my human guinea pig? It shouldn't be dangerous... or at least fatal... hopefully. I can "+
            "pay you a bit of coin for your time and who knows... I might discover something useful?\"",
        "START" :
            "NPC_NAME takes you to a dark corner of the cargo hold, it's a small area set off to the side with ramshackle "+
            "partitions made of scavenged wood and cloth. He motions for you to take a seat on a long table, which you do "+
            "and then he proceeds to tinker with some alchemical equipment.\n\n"+
            "NPC_NAME says, \"Now... I can't honestly say what will happen PLAYER_NAME, but it shouldn't be fatal.\"\n\n"+
            "He coughs for a moment and mutters under his breath, \"Probably...\"\n\n"+
            "Before you have time to reconsider if this is a wise idea or not, NPC_NAME approaches you with a vial filled to "+
            "the brim with a strange bubbling liquid. He holds it up to your pLIPS lips and says, \"Come now, PLAYER_NAME, just the tip here...\"\n\n"+
            "It's not the first time you've heard that on this ship.\n\n"+
            "Hesitantly you swallow the liquid. It burns your throat as it goes down. Minutes pass by and you don't seem to notice any "+
            "immediate effects. Then, suddenly, your vision goes blurry. You try to inform NPC_NAME of this, but your words come out "+
            "sodden and slurry. The room is spinning and everything becomes incredibly colourful and loud.",
        "SCENES" : [
            {
                "ID" : "SCENE01",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "A", "TYPE" : "SKILL", "NAME" : "AssFucking", "DIFFICULTY" : 30, "REWARD" : "MONEY", "R_NAME" : "MONEY", "VALUE" : 10, "OPT" : 0 }
                ],
                "POST" : [
                    { "TYPE" : "STAT_XP",   "NAME" : "Nutrition",   "VALUE" : -50,  "OPT" : 0 },
                    { "TYPE" : "STAT",      "NAME" : "Toxicity",    "VALUE" :  20,  "OPT" : 0 },
                    { "TYPE" : "STAT",      "NAME" : "Toxicity",    "VALUE" : 100,  "OPT" : "RANDOM" },
                    { "TYPE" : "STAT_XP",   "NAME" : "Hormones",    "VALUE" : 100,  "OPT" : "RANDOM" },
                    { "TYPE" : "STAT_XP",   "NAME" : "Hormones",    "VALUE" : 100,  "OPT" : 0 },
                    { "TYPE" : "STAT_XP",   "NAME" : "WillPower",   "VALUE" : -50,  "OPT" : "RANDOM" },
                    { "TYPE" : "BODY_XP",   "NAME" : "Ass",         "VALUE" :  50,  "OPT" : 0 },
                    { "TYPE" : "BODY_XP",   "NAME" : "Ass",         "VALUE" :  100, "OPT" : "RANDOM" },
                    { "TYPE" : "NPC_STAT",  "NAME" : "Mood",        "VALUE" :  10,  "OPT" : 0 },
                    { "TYPE" : "NPC_STAT",  "NAME" : "Lust",        "VALUE" : -10,  "OPT" : 0 },
                    { "TYPE" : "COUNTER",   "NAME" : "CARGO_XP",    "VALUE" :   1,  "OPT" : 1 }
                ],
                "START" :
                    "NPC_NAME says, \"Ah, I see it's taken effect. Now to wait and see what happens...\"\n\n"+
                    "He looks at you for a moment and then seems to have an idea. He quickly comes over to you and rolls you over on "+
                    "your stomach, your legs danging over the table and revealing your pASS ass. The last thing you hear before you lose "+
                    "consciousness is the phrase, \"Well, at least this gives me something to do while I wait.\""+
                    "...\n....\n.....\n......\n.......\n........\n",
                "END" :
                    "\n\nYou start collecting your thing (how did you clothes end up on the floor?) and you notice NPC_NAME is sitting at "+
                    "a desk going over some papers. He turns around to face you...",
                "RESULTS" : [
                    {"A":  50,   "TEXT": "You wake up hours later, still groggy and with a suspiciously slippery and @@sore ass@@."},
                    {"A": 500,   "TEXT": "You wake up hours later, still groggy and with what you suspect is a @@thoroughly fucked ass@@"}
                ]
            },
            {
                "ID" : "SCENE02",
                "TRIGGERS" :[
                    { "TYPE" : "COUNTER",   "NAME" : "CARGO_XP",        "VALUE" :   10, "CONDITION" : "gte",    "OPT" : "RANDOM" },
                    { "TYPE" : "FLAG",      "NAME" : "CARGO_DISCOVER1", "OPT" : "NOT_SET" }
                ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                ],
                "POST" : [
                    { "TYPE" : "MONEY",     "NAME" : "MONEY",           "VALUE" :  50,          "OPT" : 0           },
                    { "TYPE" : "MONEY",     "NAME" : "MONEY",           "VALUE" :  50,          "OPT" : "RANDOM"    },
                    { "TYPE" : "FLAG",      "NAME" : "CARGO_DISCOVER1", "VALUE" :   1,          "OPT" : "SET"       },
                    { "TYPE" : "FLAG",      "NAME" : "CARGO_XP",        "VALUE" :   0,          "OPT" : "SET"       },
                    { "TYPE" : "NPC_STAT",  "NAME" : "Mood",            "VALUE" :  10,          "OPT" : 0           },
                    { "TYPE" : "STORE",     "NAME" : "CARGO",           "VALUE" :  "khafkir",   "OPT" : "UNLOCK"    }
                ],
                "START" :
                "NPC_NAME says, \"Ah, PLAYER_NAME, you're up! Well, I have good news - it seems that the test results are in and "+
                "I've been able to re-create an old brew from these notes the Captain found. Thanks for your help... here have some extra coin "+
                "and if you're interested, a new drink should be available in my shop... it's a liquor called \"Khafkir\" and it supposedly "+
                "has some quite strong healing properties.",
                "END" : "",
                "RESULTS" : []
            },
            {
                "ID" : "SCENE03",
                "TRIGGERS" :[
                    { "TYPE" : "COUNTER",   "NAME" : "CARGO_XP",        "VALUE" :   10, "CONDITION" : "gte",    "OPT" : "RANDOM" },
                    { "TYPE" : "FLAG",      "NAME" : "CARGO_DISCOVER1", "OPT" : "SET" },
                    { "TYPE" : "FLAG",      "NAME" : "CARGO_DISCOVER2", "OPT" : "NOT_SET" }
                ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                ],
                "POST" : [
                    { "TYPE" : "MONEY",     "NAME" : "MONEY",           "VALUE" :  50,              "OPT" : 0           },
                    { "TYPE" : "MONEY",     "NAME" : "MONEY",           "VALUE" :  50,              "OPT" : "RANDOM"    },
                    { "TYPE" : "FLAG",      "NAME" : "CARGO_DISCOVER2", "VALUE" :   1,              "OPT" : "SET"       },
                    { "TYPE" : "FLAG",      "NAME" : "CARGO_XP",        "VALUE" :   0,              "OPT" : "SET"       },
                    { "TYPE" : "NPC_STAT",  "NAME" : "Mood",            "VALUE" :  10,              "OPT" : 0           },
                    { "TYPE" : "STORE",     "NAME" : "CARGO",           "VALUE" :  "siren elixir",  "OPT" : "UNLOCK"    }
                ],
                "START" :
                "NPC_NAME says, \"Ah, PLAYER_NAME, you're up! Well, I have good news - it seems that the test results are in and "+
                "I've been able to re-create an old brew from these notes the Captain found. Thanks for your help... here have some extra coin "+
                "and if you're interested, a new potion should be available in my shop... it's an elixir called \"Siren's Tears\" and it supposedly "+
                "has the power to instill tranquility in a person. Amazing!",
                "END" : "",
                "RESULTS" : []
            }
        ],
        "END" :
            "NPC_NAME tosses a small bag of JOB_PAY coins at you and then waves you on his way, continuing to furiously study at his notes.",
        "JOB_RESULTS" : [ ]
    },
    "MATE01": {
        "ID": "MATE01", "TITLE": "Personal Whore", "GIVER": "FirstMate", "PAY" : 20,
        "RATING" : 4, // of 5
        "PHASES" : [ 1, 2, 3 ],
        "DAYS"   : 1,
        "HIDDEN" : false,
        "COST" : [
            { "TYPE" : "TIME",  "VALUE" : 1 },
            { "TYPE" : "STAT",  "NAME" : "Energy", "VALUE" : 2 }],
        "REQUIREMENTS" : [
            { "TYPE" : "BODY",      "NAME" : "Bust",        "VALUE" :  5,   "CONDITION" : "gte" },
            { "TYPE" : "NPC_STAT",  "NAME" : "Lust",        "VALUE" : 60,   "CONDITION" : "gte" }
        ],
        "INTRO" :
            "NPC_NAME leers at your pBUST tits and says, Well, it looks like you're packing quite a bit up top these days. How about you be my personal whore for the "+
            "pPHASE and I make it worth your while? A bit of coin for a bit of fun... with your funbags.",
        "SCENES" : [
            {
                "ID" : "SCENE01",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "A", "TYPE" : "STAT", "NAME" : "Perversion", "DIFFICULTY" : 80, "REWARD" : "STAT_XP", "R_NAME" : "Perversion", "VALUE" : 50, "OPT" : "RANDOM" }
                ],
                "POST" : [
                    { "TYPE" : "STAT_XP", "NAME" : "WillPower",     "VALUE" : -20,  "OPT" : 0 },
                    { "TYPE" : "STAT_XP", "NAME" : "Perversion",    "VALUE" :  50,  "OPT" : "TAG_A"}
                ],
                "START" :
                    "You agree to serve NPC_NAME and obediently follow him to his quarters. Once there he shoves you through the "+
                    "door and onto the floor. As you try to get up, you feel one of his big boots on your ass, holding you down.\n\n"+
                    "\"Just stay like that for now slut,\" he growls.",
                "END" : "",
                "RESULTS" : [
                    {"A": 50,   "TEXT": "The feral sound of his voice causes a @@color:red;shiver of fear@@ to crawl down your spine as you fear what " +
                                        "the massive black man has in store for you."   },
                    {"A": 500,  "TEXT": "The feral sound of his voice @@color:DeepPink;sends a thrill up your spine@@ as you start to anticipate what " +
                                        "the massive black man is going to do to you."  }
                ]
            },
            {
                "ID" : "SCENE02",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "B", "TYPE" : "SKILL", "NAME" : "Seduction", "DIFFICULTY" : 60, "REWARD" : "MONEY", "R_NAME" : "MONEY", "VALUE" : 20, "OPT" : 0 }
                ],
                "POST" : [
                    { "TYPE" : "NPC_STAT", "NAME" : "Mood",    "VALUE" :  3,  "OPT" : "TAG_B" },
                    { "TYPE" : "NPC_STAT", "NAME" : "Lust",    "VALUE" : -5,  "OPT" : "TAG_B" }
                ],
                "START" :
                "Within moments he returns with small sack and from it he produces a costume that he throws at you.\n\n"+
                "\"Get changed,\"he simply states.\n\n"+
                "You unfold the costume to realize that it'ss a small bikini, dyed with a pattern to match a popular form of milk "+
                "giving aurach - included with the costume are a matching collar, headband and anal plug with a thick bristly tail "+
                "attached. It seems that NPC_NAME does indeed have a strong tit fetish if he wants you to pretend to be a cow. The "+
                "costume is not well made and the tail is slightly painful to jab up your rectum without any lubricant other than "+
                "your spit, but you somehow manage the task, transforming into a vision of a perverted cow slave.\n\n"+
                "NPC_NAME admires the fetish outfit on you and gives you a tug on the collar, causing the cowbell to jingle. One of "+
                "his big paws reaches out to grope your pBUST tits, causing them to wobble slightly. He then looks you dead in the "+
                "eyes and commands you to prostrate yourself before him and to arouse him.",
                "END" : "",
                "RESULTS" : [
                    {"B": 50,   "TEXT": "You drop to your knees and feebly grope your pBUST boobs, trying to shake them and fondle them to be arousing. You "+
                                        "mutter some lame pick up lines, but @@it doesn't seem to have much effect@@."   },
                    {"B": 500,  "TEXT": "You drop to your knees and slowly start to massage and shake your pBUST tits. @@You fondle and shake them while cooing@@ "+
                                        "at NPC_NAME that you're a \"naughty little cow that needs to be milked by a big black stud.\""  } ]
            },
            {
                "ID" : "SCENE03",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "C", "TYPE" : "SKILL", "NAME" : "BlowJobs", "DIFFICULTY" : 60, "REWARD" : "MONEY", "R_NAME" : "MONEY", "VALUE" : 20, "OPT" : 0 }
                ],
                "POST" : [
                    { "TYPE" : "NPC_STAT", "NAME" : "Mood",    "VALUE" :  3,  "OPT" : "TAG_C" },
                    { "TYPE" : "NPC_STAT", "NAME" : "Lust",    "VALUE" : -5,  "OPT" : "TAG_C" }
                ],
                "START" :
                    "Eventually NPC_NAME can't take it any more and he produces a large vial of oil from his bag which he proceeds to pour "+
                    "all over your tits. You start to massage the oil into your flesh and within minutes your entire chest is a shiny and "+
                    "slick mess. NPC_NAME drops his pants and produces an incredibly huge erect black cock that he waves menacingly at you.\n\n"+
                    "\"Suck it,\" he commands.\n\n",
                "END" :
                "NPC_NAME proceeds to fuck your face, causing you to gag as his dick slides in and out of your throat. You choke back "+
                "tears and focus on your breathing as the horrible oral abuse goes on for what seems like ages. Eventually he picks up "+
                "the pace and forces your head down his shaft. You feel his already massive prick swell in size as he starts to ejaculate "+
                "burst after burst of semen down your abused throat.",
                "RESULTS" : [
                    {"C": 50,   "TEXT": "You hesitate for a moment, trying to figure out how you'll get NPC_NAME's massive tool into your mouth, but eventually "+
                                        "he just grabs it and shoves it towards your pLIPS lips. There is a moment of fear as you try to adjust your breathing "+
                                        "and unhinge your jaw to @@take the huge dick@@."   },
                    {"C": 500,  "TEXT": "@@You expertly wrap@@ your pLIPS lips around NPC_NAME's enormous cock, working your tongue up and down his glands and "+
                                        "making sure that your pBUST tits are rubbing against his balls and legs."  } ]
            },
            {
                "ID" : "SCENE04",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "D", "TYPE" : "SKILL", "NAME" : "TitFucking", "DIFFICULTY" : 60, "REWARD" : "MONEY", "R_NAME" : "MONEY", "VALUE" : 20, "OPT" : 0 }
                ],
                "POST" : [
                    { "TYPE" : "NPC_STAT",  "NAME" : "Mood",    "VALUE" :  3,   "OPT" : "TAG_D" },
                    { "TYPE" : "NPC_STAT",  "NAME" : "Lust",    "VALUE" : -5,   "OPT" : "TAG_D" },
                    { "TYPE" : "BODY_XP",   "NAME" : "Bust",    "VALUE" : 50,   "OPT" : 0 },
                    { "TYPE" : "BODY_XP",   "NAME" : "Bust",    "VALUE" : 100,  "OPT" : "RANDOM" }
                ],
                "START" :
                    "NPC_NAME finishes cumming and pushes you down on the ground, his dick flying out of your mouth with an audible \"pop\" "+
                    "and sending a stream of drool and semen arching towards the air. He straddles you and produces two small "+
                    "syringes filled with a glowing pink liquid.\n\n"+
                    "\"Now comes the fun part,\" he says as he jabs each of your tits in turn with the mysterious drug. The pain "+
                    "from the injection is momentary, but as NPC_NAME begins to rub your breasts you start to feel a burning sensation "+
                    "and tightness. Your breathing increases and you realize that you're getting incredibly aroused. Just as you are "+
                    "pondering this, without warning, you feel a wetness... your eyes open wide as you realize that almost implausibly, "+
                    "you have watery streams of milk shooting from your nipples!\n\n"+
                    "NPC_NAME grins and slides his huge pick between your already lubricated tits and begins to fuck them furiously. "+
                    "His fingers are tweaking and pulling at your nipples and every time he thrusts a dribble of milk squirts. As he "+
                    "increases the tempo you feel the sensations actually flowing from your engorged nips and shooting into your brain.",
                "END" : "",
                "RESULTS" : [
                    {"D": 50,   "TEXT": "You try to help NPC_NAME cum by holding your breasts together for him and encouraging him with dirty talk, "+
                                        "but you're so damn distracted by the unusual experience that @@it doesn't have much effect@@. Still, he "+
                                        "proceeds to thoroughly fuck your lactating hooters with a frenzied pace."   },
                    {"D": 500,  "TEXT": "You take your hands and squeeze the sides of your tits onto NPC_NAME's dick, trying your best to jack him "+
                                        "off as he @@frantically fucks your now lactating tits@@. You look at him and say, \"Yeah! Fuck my big cow udders! "+
                                        "I'm just a dumb fucking milk cow! A fucking pair of tits with legs! Fuck my tits stupid!\" The verbal encouragement drives him wild."  } ]
            },
            {
                "ID" : "SCENE05",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "E", "TYPE" : "SKILL", "NAME" : "AssFucking", "DIFFICULTY" : 60, "REWARD" : "MONEY", "R_NAME" : "MONEY", "VALUE" : 10, "OPT" : 0 }
                ],
                "POST" : [
                    { "TYPE" : "NPC_STAT", "NAME" : "Mood",         "VALUE" :  3,       "OPT" : "TAG_E" },
                    { "TYPE" : "NPC_STAT", "NAME" : "Lust",         "VALUE" : -5,       "OPT" : "TAG_E" },
                    { "TYPE" : "STAT_XP",  "NAME" : "Perversion",   "VALUE" : 50,       "OPT" : "TAG_E" }
                ],
                "START" :
                    "Without much warning NPC_NAME squeezes your pBUST tits one last time and cums furiously, coating your face "+
                    "and hair with his seed and causing your jugs to release an enormous stream of milk. The sensation is too "+
                    "much for you and your pPENIS sissy clit starts shooting your own cum in unison.\n\n"+
                    "You roll over on your side, your breathing ragged and your vision blurred, clearly exhausted from your recent orgasm. "+
                    "You feel a tugging sensation from your anus and realize that NPC_NAME is removing the anal plug from your asshole. "+
                    "However any thoughts of relief you might have had are immediately banished as you feel the head of NPC_NAME's bulbous "+
                    "cock pushing up against your abused fuckhole.",
                "END" : "",
                "RESULTS" : [
                    {"E": 50,   "TEXT": "You don't have any time to prepare as NPC_NAME rams his huge dick past your tight sphincter. "+
                                        "Thankfully he's at least conscious of the fact that the size of his tool makes it @@impossible for him "+
                                        "to get it all inside@@ at one go and he slowly works it up your pASS ass."  },
                    {"E": 500,  "TEXT": "You do your best and bear down on your sphincter, opening it wide for NPC_NAME's dick to slide into "+
                                        "your pASS ass. Maybe the oil from the earlier tit fuck helped, but whatever the case, you feel an incredible "+
                                        "sensation of fullness as NPC_NAME @@manages to bottom out in your sissy butt@@."  } ]
            }
        ],
        "END" :
            "A minute later he's finally got you face down, tits leaking milk and with the biggest black dick you've ever "+
            "seen shoved up your ass. You gasp as he begins to saw that giant dick of his in and out of your butt. The "+
            "sensation you had earlier, when he was fucking your tits returns and you find yourself incredibly aroused, "+
            "your pPENIS sissy clit becoming painfully erect.\n\n"+
            "NPC_NAME starts breathing harder as he picks up the pace in your ass, each thrust sending a shiver up your spine "+
            "and through your pPENIS dick. Then, with one last massive push he jams his cock so deep into your ass you're "+
            "positive that you felt it in the back of your throat. The sensation - a mixture of drug induced arousal and "+
            "humiliation is so intense that you have a second orgasm and pass out.\n"+
            "...\n"+
            "......\n"+
            ".........\n"+
            "You wake up later, mostly naked, covered in semen and oil and with cum matted on your face, in your hair and leaking "+
            "out of your abused asshole. On the floor next to you, you find JOB_PAY coins.\n\n"+
            "NPC_NAME is nowhere to be seen.",
        "JOB_RESULTS" : [ ]
    },
    "MATE02": {
        "ID": "MATE02", "TITLE": "Navigation Lessons", "GIVER": "FirstMate", "PAY" : 0,
        "RATING" : 3, // of 5
        "PHASES" : [ 1 ],
        "DAYS"   : 1,
        "HIDDEN" : false,
        "COST" : [
            { "TYPE" : "TIME",  "VALUE" : 2 },
            { "TYPE" : "STAT",  "NAME" : "Energy", "VALUE" : 1 },
            { "TYPE" : "MONEY", "VALUE" : 50 } ],
        "REQUIREMENTS" : [
            { "TYPE" : "QUEST",     "NAME" : "Q002",    "VALUE" : "COMPLETED",  "CONDITION" : "eq" },
            { "TYPE" : "NPC_STAT",  "NAME" : "Lust",    "VALUE" : 60,           "CONDITION" : "gte" }
        ],
        "INTRO" :
        "You often see NPC_NAME scouring maps and using strange tools that seem to be related to navigation. Maybe if you were a little 'friendly' to him, he'd show you what he knows?",
        "START" :
        "NPC_NAME says, \"@@color:cyan;So you want to learn about navigation huh? I normally wouldn't bother but if you're willing to pay with coins and your arse, then who am I to say no?@@\"\n\n"+
        "The leering grin he gives you makes you feel rather uncomfortable about the entire exchange and you're fairly sure that you're not getting a good deal and you're even MORE by the outline of "+
        "the bulge in NPC_NAME's trousers that your asshole is going to regret this later, but for some reason you go along with it. Definitely it's because of your thirst for knowledge and not because "+
        "you want his massive black member up your backside...",
        "SCENES" : [
            {
                "ID" : "SCENE01",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "A", "TYPE" : "SKILL", "NAME" : "Navigating", "DIFFICULTY" : 25, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 100, "OPT" : 0 }
                ],
                "POST" : [
                    { "TYPE" : "SKILL_XP", "NAME" : "Navigating", "VALUE" :  25, "OPT" : "TAG_A" }
                ],
                "START" :
                "NPC_NAME leads you to sit next to him at a table and starts the lesson by giving you some basic instruction on how to read various charts and maps that he "+
                "has stored in his cabin. He's surprisingly serious and thoughtful with his instruction ",
                "END" : "",
                "RESULTS" : [
                    {"A":  25, "TEXT":  "and you do your best to take it in, but @@color:red;unfortunately it's a bit too complex@@ for you to understand."},
                    {"A":  50, "TEXT":  "and you do your best to take it in, but some @@color:yellow;key points still elude@@ you. Maybe more instruction is required?"},
                    {"A": 500, "TEXT":  "and you find yourself @@color:green;completely comprehending the lesson@@. In short order you move on to the next topic."} ]
            },
            {
                "ID" : "SCENE02",
                "TRIGGERS" :[
                    { "TYPE" : "NPC_STAT", "NAME" : "Lust", "VALUE" : 90, "CONDITION" : "gte" }
                ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "B", "TYPE" : "SKILL", "NAME" : "BlowJobs", "DIFFICULTY" : 50, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 100, "OPT" : 0 }
                ],
                "POST" : [
                    { "TYPE" : "NPC_STAT",  "NAME" : "Lust",        "VALUE" : -10,      "OPT" : "TAG_B" },
                    { "TYPE" : "NPC_STAT",  "NAME" : "Mood",        "VALUE" : 10,       "OPT" : "TAG_B" }
                ],
                "START" :
                "After the map reading lesson NPC_NAME stands up from the table pulls down his trousers and unleashes his massive black cock. It dangles almost menacingly in front of your "+
                "face. You look up at him and just as you begin to ask him what's going on, he takes the opportunity to slip the fat head of his dick into your pLIPS lips. Considering this "+
                "to be the answer to your question, you begin to do your best to work on this part of your 'payment'",
                END :
                    "NPC_NAME wipes off his dick with an errant towel and then throws it at you. Even though it's covered with your drool and some remnants of his cum, you do your best to try "+
                "and clean up as he prepares for the next part of the lesson.",
                "RESULTS" : [
                    {"B":  25, "TEXT":
                    "You try to accommodate his massive meat pole @@but you struggle to find the right movement and tempo@@. Not that it matters much because NPC_NAME simply grabs your head "+
                    "and then forcibly rams his dick down your throat until he cums.\n\n" },
                    {"B":  50, "TEXT":
                    "You take NPC_NAME's stiffening cock in your mouth and @@begin to suck on it in earnest@@. Within moments he is starting to moan and you increase " +
                    "the pleasure by bobbing your head up and down on his shaft, the tip of his dick tickling the back of your throat. After a few minutes of this treatment NPC_NAME grabs "+
                    "a hold of your head and rams his dick in as far as it can go, you know what this means and do your best to relax so that he can shoot his load straight into your gullet.\n\n" },
                    {"B": 500, "TEXT":
                    "@@You easily swallow his dick@@ and within moments you have it sufficiently lubricated and your throat relaxed enough to be able to take him down "+
                    "so deeply that he's quickly moaning and panting in pleasure. You toy with the tempo and your tongue movements until he's almost about to pass out from the stimulation and then "+
                    "he suddenly starts shooting his load directly into your mouth. There's so much of it that it's a real struggle to swallow it all down.\n\n" }
                ]
            },
            {
                "ID" : "SCENE03",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "C", "TYPE" : "SKILL", "NAME" : "Navigating", "DIFFICULTY" : 50, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 100, "OPT" : 0 }
                ],
                "POST" : [
                    { "TYPE" : "SKILL_XP", "NAME" : "Navigating", "VALUE" :  50, "OPT" : "TAG_C" }
                ],
                "START" :
                "NPC_NAME returns to the table with a large weighted rope and an hourglass like timer. He explains that these tools are used to determine how fast the ship "+
                "is travelling at and how to use this to determine where on the map it will be. After the explanation he then takes you out of his cabin and to the deck so "+
                "that you can practice this skill. ",
                "END" : "",
                "RESULTS" : [
                    {"C":  25, "TEXT":  "You do your best, but @@color:red;despite his instruction@@ it doesn't seem that you've quite grasped the concept yet."},
                    {"C":  50, "TEXT":  "You do your best and while you are able to @@color:yellow;make some progress@@ you're note quite confident in your skill doing this yet."},
                    {"C": 500, "TEXT":  "You take your time counting the knots in the rope as you swing it over the side of the ship and measuring both the time as well as the "+
                    "number of knots slipped. Eventually you @@color:green;come up with a figure and plot a trajectory@@ that seems to satisfy NPC_NAME. "} ]
            },
            {
                "ID" : "SCENE04",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "D", "TYPE" : "SKILL", "NAME" : "AssFucking", "DIFFICULTY" : 50, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 100, "OPT" : 0 }
                ],
                "POST" : [
                    { "TYPE" : "NPC_STAT",  "NAME" : "Lust",        "VALUE" : -10,      "OPT" : "TAG_D" },
                    { "TYPE" : "NPC_STAT",  "NAME" : "Mood",        "VALUE" : 10,       "OPT" : "TAG_D" }
                ],
                "START" :
                "NPC_NAME leads you back to the cabin and motions for you to approach the table. He roughly bends you over it, making sure your hands are flat on it's cold wooden surface. "+
                "It doesn't take much imagination for you to guess what is about to happen next, so you do your best to try and 'loosen' up your ass-pussy for the pounding it's about to "+
                "to receive. You feel NPC_NAME's rough hands on you as he removes your bottom clothes. You even start to make a move to help him, only to have him slap your hands away and "+
                "roughly shove you down again even more flat on the table. You're resting in this awkward position when you feel something cold and slimy start to spread between your ass cheeks.\n\n"+
                "Somewhat relieved that at least he is going to lubricate before shoving his monster cock inside you, you are surprised when you feel a thick meaty finger slip in to your "+
                "sissy hole. You gasp... (or is that a moan) as he works his thick finger in and out of you. Eventually this becomes two fingers and then finally three and accompanied by "+
                "the embarrassing sounds of your now well lubricated ass opening and closing.\n\n"+
                "\"@@color:cyan;Here it comes bitch.@@\" he says, and while you appreciate the warning it doesn't do much to lesson the shock of what you swear is over a foot of black cock "+
                "suddenly entering your well lubricated rectum. ",
                END :
                "NPC_NAME starts breathing harder as he picks up the pace in your ass, each thrust sending a shiver up your spine "+
                "and through your pPENIS dick. Then, with one last massive push he jams his cock so deep into your ass you're "+
                "positive that you felt it in the back of your throat. The sensation - a mixture of arousal and "+
                "humiliation is so intense that you have a tiny orgasm and your pPENIS sissy clit leaks a pathetic spurt of cum.",
                "RESULTS" : [
                    {"D":  25, "TEXT":
                    "You try hard to accommodate NPC_NAME's massive dick, @@color:red;but even with the lube@@ it's still a struggle. You mostly just lay there, trying not to cry as he fucks your sissy slut ass." },
                    {"D":  50, "TEXT":
                    "You make a valiant effort to open your sphincter as wide as it can go as NPC_NAME shoves his massive meat up your backside. Unfortunately there is only @@color:yellow;so far you can stretch@@ "+
                    "when faced with so many angry inches of dick. You gasp and struggle slightly as he continues to work his way up your insides until eventually you feel like you're going to pass out "+
                    "as he lodges himself deep inside you."},
                    {"D": 500, "TEXT":
                    "You push out as hard as you can to @@color:green;fully open your asshole@@ to the big black First Mate. He grunts approvingly as he easily slides his monstrous member up your "+
                    "slutty sissy ass. Within seconds he has completely filled you, bottoming out someplace so deep that it almost makes you faint. Thankfully he starts off slow, giving you time to "+
                    "relax and get into the motion and ultimately you are able to match his motion and start thrusting your ass back towards him, reaching all the way to the root of his cock." }
                ]
            }
        ],
        "END" :
            "It takes some time for you to recover your wits after being so thoroughly fucked but thankfully NPC_NAME must be in a good mood since he mostly leaves you alone as you gather up your "+
        "discarded clothes and leave his cabin. It was an eventful afternoon and even though the sun has gone down you feel that JOB_RESULTS.",
        "JOB_RESULTS" : [
            { "A" :  25,  "TEXT" : "@@minimal progress@@ at map reading" },
            { "A" :  50, "TEXT" : "@@moderate progress@@ at map reading" },
            { "A" :  75, "TEXT" : "@@good progress@@ at map reading" },
            { "A" : 505, "TEXT" : "@@excellent progress@@ at map reading" },
            { "C" :  25, "TEXT" : " and @@minimal progress@@ at navigation" },
            { "C" :  50, "TEXT" : " and @@moderate progress@@ at navigation" },
            { "C" :  75, "TEXT" : " and @@good progress@@ at navigation" },
            { "C" : 505, "TEXT" : " and @@excellent progress@@ at navigation" }
        ]

    },
    "MATE03": {
        "ID": "MATE03", "TITLE": "Sailing Lessons", "GIVER": "FirstMate", "PAY" : 0,
        "RATING" : 3, // of 5
        "PHASES" : [ 1 ],
        "DAYS"   : 1,
        "HIDDEN" : false,
        "COST" : [
            { "TYPE" : "TIME",  "VALUE" : 2 },
            { "TYPE" : "STAT",  "NAME" : "Energy", "VALUE" : 1 },
            { "TYPE" : "MONEY", "VALUE" : 50 } ],
        "REQUIREMENTS" : [
            { "TYPE" : "QUEST",     "NAME" : "Q003",    "VALUE" : "COMPLETED",  "CONDITION" : "eq" },
            { "TYPE" : "NPC_STAT",  "NAME" : "Lust",    "VALUE" : 60,           "CONDITION" : "gte" }
        ],
        "INTRO" : "You often see NPC_NAME directing the pirates on deck and giving orders related to sailing. Maybe if you were a little 'friendly' to him, he'd show you what he knows?",
        "START" :
        "NPC_NAME says, \"@@color:cyan;So you want to learn about sailing huh? I normally wouldn't bother but if you're willing to pay with coins and your arse, then who am I to say no?@@\"\n\n"+
        "The leering grin he gives you makes you feel rather uncomfortable about the entire exchange and you're fairly sure that you're not getting a good deal and you're even MORE by the outline of "+
        "the bulge in NPC_NAME's trousers that your asshole is going to regret this later, but for some reason you go along with it. Definitely it's because of your thirst for knowledge and not because "+
        "you want his massive black member up your backside...",
        "SCENES" : [
            {
                "ID" : "SCENE01",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "A", "TYPE" : "SKILL", "NAME" : "Sailing", "DIFFICULTY" : 25, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 100, "OPT" : 0 }
                ],
                "POST" : [
                    { "TYPE" : "SKILL_XP", "NAME" : "Sailing", "VALUE" :  25, "OPT" : "TAG_A" }
                ],
                "START" :
                "NPC_NAME leads you on a tour around the deck, taking time to point out the various stations on the ship and the activities that they are responsible for. He's surprisingly thoughtful in his explanations and answers questions seriously.",
                "END" : "",
                "RESULTS" : [
                    {"A":  25, "TEXT":  "You do your best to take it in, but @@color:red;unfortunately it's a bit too complex@@ for you to understand."},
                    {"A":  50, "TEXT":  "You do your best to take it in, but some @@color:yellow;key points still elude@@ you. Maybe more instruction is required?"},
                    {"A": 500, "TEXT":  "You find yourself @@color:green;completely comprehending the lesson@@. In short order you move on to the next topic."} ]
            },
            {
                "ID" : "SCENE02",
                "TRIGGERS" :[
                    { "TYPE" : "NPC_STAT", "NAME" : "Lust", "VALUE" : 90, "CONDITION" : "gte" }
                ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "B", "TYPE" : "SKILL", "NAME" : "BlowJobs", "DIFFICULTY" : 50, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 100, "OPT" : 0 }
                ],
                "POST" : [
                    { "TYPE" : "NPC_STAT",  "NAME" : "Lust",        "VALUE" : -10,      "OPT" : "TAG_B" },
                    { "TYPE" : "NPC_STAT",  "NAME" : "Mood",        "VALUE" : 10,       "OPT" : "TAG_B" }
                ],
                "START" :
                "After the lesson NPC_NAME takes you aside and pulls down his trousers, unleashing his massive black cock. It dangles almost menacingly in front of your "+
                "face. You look up at him and just as you begin to ask him what's going on, he takes the opportunity to slip the fat head of his dick into your pLIPS lips. Considering this "+
                "to be the answer to your question, you begin to do your best to work on this part of your 'payment'",
                END :
                "NPC_NAME wipes off his dick with an errant towel and then throws it at you. Even though it's covered with your drool and some remnants of his cum, you do your best to try "+
                "and clean up as he prepares for the next part of the lesson.",
                "RESULTS" : [
                    {"B":  25, "TEXT":
                    "You try to accommodate his massive meat pole @@but you struggle to find the right movement and tempo@@. Not that it matters much because NPC_NAME simply grabs your head "+
                    "and then forcibly rams his dick down your throat until he cums.\n\n" },
                    {"B":  50, "TEXT":
                    "You take NPC_NAME's stiffening cock in your mouth and @@begin to suck on it in earnest@@. Within moments he is starting to moan and you increase " +
                    "the pleasure by bobbing your head up and down on his shaft, the tip of his dick tickling the back of your throat. After a few minutes of this treatment NPC_NAME grabs "+
                    "a hold of your head and rams his dick in as far as it can go, you know what this means and do your best to relax so that he can shoot his load straight into your gullet.\n\n" },
                    {"B": 500, "TEXT":
                    "@@You easily swallow his dick@@ and within moments you have it sufficiently lubricated and your throat relaxed enough to be able to take him down "+
                    "so deeply that he's quickly moaning and panting in pleasure. You toy with the tempo and your tongue movements until he's almost about to pass out from the stimulation and then "+
                    "he suddenly starts shooting his load directly into your mouth. There's so much of it that it's a real struggle to swallow it all down.\n\n" }
                ]
            },
            {
                "ID" : "SCENE03",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "C", "TYPE" : "SKILL", "NAME" : "Sailing", "DIFFICULTY" : 50, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 100, "OPT" : 0 }
                ],
                "POST" : [
                    { "TYPE" : "SKILL_XP", "NAME" : "Sailing", "VALUE" :  50, "OPT" : "TAG_C" }
                ],
                "START" :
                "NPC_NAME pulls you to your feet and takes you to the ships helm. He launches into a long explanation of how to steer and sail the ship, even letting you try your hand "+
                    "at steering a few times.",
                "END" : "",
                "RESULTS" : [
                    {"C":  25, "TEXT":  "You do your best, but @@color:red;despite his instruction@@ it doesn't seem that you've quite grasped the concept yet."},
                    {"C":  50, "TEXT":  "You do your best and while you are able to @@color:yellow;make some progress@@ you're note quite confident in your skill doing this yet."},
                    {"C": 500, "TEXT":  "Maybe you're a natural, or NPC_NAME is just a good instructor, but it seems that the lesson @@color:green;comes easily to you@@."} ]
            },
            {
                "ID" : "SCENE04",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "D", "TYPE" : "SKILL", "NAME" : "AssFucking", "DIFFICULTY" : 50, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 100, "OPT" : 0 }
                ],
                "POST" : [
                    { "TYPE" : "NPC_STAT",  "NAME" : "Lust",        "VALUE" : -10,      "OPT" : "TAG_D" },
                    { "TYPE" : "NPC_STAT",  "NAME" : "Mood",        "VALUE" : 10,       "OPT" : "TAG_D" }
                ],
                "START" :
                "After the lesson is over, NPC_NAME leads you back to the cabin and motions for you to approach the table. He roughly bends you over it, making sure your hands are flat on it's cold wooden surface. "+
                "It doesn't take much imagination for you to guess what is about to happen next, so you do your best to try and 'loosen' up your ass-pussy for the pounding it's about to "+
                "to receive. You feel NPC_NAME's rough hands on you as he removes your bottom clothes. You even start to make a move to help him, only to have him slap your hands away and "+
                "roughly shove you down again even more flat on the table. You're resting in this awkward position when you feel something cold and slimy start to spread between your ass cheeks.\n\n"+
                "Somewhat relieved that at least he is going to lubricate before shoving his monster cock inside you, you are surprised when you feel a thick meaty finger slip in to your "+
                "sissy hole. You gasp... (or is that a moan) as he works his thick finger in and out of you. Eventually this becomes two fingers and then finally three and accompanied by "+
                "the embarrassing sounds of your now well lubricated ass opening and closing.\n\n"+
                "\"@@color:cyan;Here it comes bitch.@@\" he says, and while you appreciate the warning it doesn't do much to lesson the shock of what you swear is over a foot of black cock "+
                "suddenly entering your well lubricated rectum. ",
                END :
                "NPC_NAME starts breathing harder as he picks up the pace in your ass, each thrust sending a shiver up your spine "+
                "and through your pPENIS dick. Then, with one last massive push he jams his cock so deep into your ass you're "+
                "positive that you felt it in the back of your throat. The sensation - a mixture of arousal and "+
                "humiliation is so intense that you have a tiny orgasm and your pPENIS sissy clit leaks a pathetic spurt of cum.",
                "RESULTS" : [
                    {"D":  25, "TEXT":
                        "You try hard to accommodate NPC_NAME's massive dick, @@color:red;but even with the lube@@ it's still a struggle. You mostly just lay there, trying not to cry as he fucks your sissy slut ass." },
                    {"D":  50, "TEXT":
                    "You make a valiant effort to open your sphincter as wide as it can go as NPC_NAME shoves his massive meat up your backside. Unfortunately there is only @@color:yellow;so far you can stretch@@ "+
                    "when faced with so many angry inches of dick. You gasp and struggle slightly as he continues to work his way up your insides until eventually you feel like you're going to pass out "+
                    "as he lodges himself deep inside you."},
                    {"D": 500, "TEXT":
                    "You push out as hard as you can to @@color:green;fully open your asshole@@ to the big black First Mate. He grunts approvingly as he easily slides his monstrous member up your "+
                    "slutty sissy ass. Within seconds he has completely filled you, bottoming out someplace so deep that it almost makes you faint. Thankfully he starts off slow, giving you time to "+
                    "relax and get into the motion and ultimately you are able to match his motion and start thrusting your ass back towards him, reaching all the way to the root of his cock." }
                ]
            }
        ],
        "END" :
        "It takes some time for you to recover your wits after being so thoroughly fucked but thankfully NPC_NAME must be in a good mood since he mostly leaves you alone as you gather up your "+
        "discarded clothes and leave his cabin. It was an eventful afternoon and even though the sun has gone down you feel that JOB_RESULTS.",
        "JOB_RESULTS" : [
            { "A" :  25,  "TEXT" : "@@minimal progress@@ at jobbing" },
            { "A" :  50, "TEXT" : "@@moderate progress@@ at jobbing" },
            { "A" :  75, "TEXT" : "@@good progress@@ at jobbing" },
            { "A" : 500, "TEXT" : "@@excellent progress@@ at jobbing" },
            { "C" :  25, "TEXT" : " and @@minimal progress@@ at sailing" },
            { "C" :  50, "TEXT" : " and @@moderate progress@@ at sailing" },
            { "C" :  75, "TEXT" : " and @@good progress@@ at sailing" },
            { "C" : 500, "TEXT" : " and @@excellent progress@@ at sailing" }
        ]

    },
    "MATE04": {
        "ID": "MATE04", "TITLE": "Swashbuckling Lessons", "GIVER": "FirstMate", "PAY" : 0,
        "RATING" : 4, // of 5
        "PHASES" : [ 1 ],
        "DAYS"   : 1,
        "HIDDEN" : false,
        "COST" : [
            { "TYPE" : "TIME",  "VALUE" : 2 },
            { "TYPE" : "STAT",  "NAME" : "Energy", "VALUE" : 1 },
            { "TYPE" : "MONEY", "VALUE" : 50 } ],
        "REQUIREMENTS" : [
            { "TYPE" : "QUEST",     "NAME" : "Q004",    "VALUE" : "COMPLETED",  "CONDITION" : "eq" },
            { "TYPE" : "NPC_STAT",  "NAME" : "Lust",    "VALUE" : 60,           "CONDITION" : "gte" }
        ],
        "INTRO" : "You often see the pirates on deck engaging in various mock duels. NPC_NAME appears to be the reigning champion, maybe if you were a little 'friendly' to him, he'd show you what he knows?",
        "START" :
        "NPC_NAME says, \"@@color:cyan;So you want to learn about sword fighting? I normally wouldn't bother but if you're willing to pay with coins and your arse, then who am I to say no?@@\"\n\n"+
        "The leering grin he gives you makes you feel rather uncomfortable about the entire exchange and you're fairly sure that you're not getting a good deal and you're even MORE by the outline of "+
        "the bulge in NPC_NAME's trousers that your asshole is going to regret this later, but for some reason you go along with it. Definitely it's because of your thirst for knowledge and not because "+
        "you want his massive black member up your backside...",
        "SCENES" : [
            {
                "ID" : "SCENE01",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "A", "TYPE" : "SKILL", "NAME" : "Swashbuckling", "DIFFICULTY" : 25, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 100, "OPT" : 0 }
                ],
                "POST" : [
                    { "TYPE" : "SKILL_XP", "NAME" : "Swashbuckling", "VALUE" :  25, "OPT" : "TAG_A" }
                ],
                "START" :
                    "NPC_NAME leads you to the main deck and tosses you a rusty old cutlass, an act that draws the attention of several pirates standing nearby. He leans in and begins to explain the "+
                "basics of sword fighting - footwork, balance, the correct way to thrust and parry. The instruction is mostly verbal with you aping his motions as he calls them off. After a time he "+
                "starts to drill you in earnest ",
                "END" : "",
                "RESULTS" : [
                    {"A":  25, "TEXT":  "and while you do your best to follow along, your @@color:red;ineptitude is plain to see@@."},
                    {"A":  50, "TEXT":  "and while you do your best to follow along, you @@color:yellow;struggle to keep up with his commands@@."},
                    {"A": 500, "TEXT":  "and you do your best to keep up, eventually managing to @@color:green;flawlessly execute the routine@@."} ]
            },
            {
                "ID" : "SCENE02",
                "TRIGGERS" :[
                    { "TYPE" : "NPC_STAT", "NAME" : "Lust", "VALUE" : 90, "CONDITION" : "gte" }
                ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "B", "TYPE" : "SKILL", "NAME" : "BlowJobs", "DIFFICULTY" : 50, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 100, "OPT" : 0 }
                ],
                "POST" : [
                    { "TYPE" : "NPC_STAT",  "NAME" : "Lust",        "VALUE" : -10,      "OPT" : "TAG_B" },
                    { "TYPE" : "NPC_STAT",  "NAME" : "Mood",        "VALUE" : 10,       "OPT" : "TAG_B" }
                ],
                "START" :
                "After the lesson NPC_NAME pulls you aside and pushes you to your knees. The pirates who were watching before are now snickering, some of them begin to hoot and toss "+
                "lewd words your way. It's pretty obvious what's going to happen next and sure enough within moments you're face to face with NPC_NAME's enormous black cock. Inwardly you "+
                "sigh - truthfully this isn't any different from what you normally do for coin on the ship, but the way he is asserting his dominance over you is utterly humiliating. Without any "+
                "ceremony you decide to get the chore over and begin to suck the tip of NPC_NAME's cock.",
                END :
                "NPC_NAME wipes off his dick with an errant towel and then throws it at you. Even though it's covered with your drool and some remnants of his cum, you do your best to try "+
                "and clean up as he prepares for the next part of the lesson.",
                "RESULTS" : [
                    {"B":  25, "TEXT":
                    "You try to accommodate his massive meat pole @@but you struggle to find the right movement and tempo@@. Not that it matters much because NPC_NAME simply grabs your head "+
                    "and then forcibly rams his dick down your throat until he cums.\n\n" },
                    {"B":  50, "TEXT":
                    "You take NPC_NAME's stiffening cock in your mouth and @@begin to suck on it in earnest@@. Within moments he is starting to moan and you increase " +
                    "the pleasure by bobbing your head up and down on his shaft, the tip of his dick tickling the back of your throat. After a few minutes of this treatment NPC_NAME grabs "+
                    "a hold of your head and rams his dick in as far as it can go, you know what this means and do your best to relax so that he can shoot his load straight into your gullet.\n\n" },
                    {"B": 500, "TEXT":
                    "@@You easily swallow his dick@@ and within moments you have it sufficiently lubricated and your throat relaxed enough to be able to take him down "+
                    "so deeply that he's quickly moaning and panting in pleasure. You toy with the tempo and your tongue movements until he's almost about to pass out from the stimulation and then "+
                    "he suddenly starts shooting his load directly into your mouth. There's so much of it that it's a real struggle to swallow it all down.\n\n" }
                ]
            },
            {
                "ID" : "SCENE03",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "C", "TYPE" : "SKILL", "NAME" : "Swashbuckling", "DIFFICULTY" : 100, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 100, "OPT" : 0 }
                ],
                "POST" : [
                    { "TYPE" : "SKILL_XP", "NAME" : "Swashbuckling", "VALUE" :  50, "OPT" : "TAG_C" },
                    { "TYPE" : "STAT_XP", "NAME" : "Fitness", "VALUE" : 50, "OPT" : 0 }
                ],
                "START" :
                "As you're busy inspecting your clothing for errant cum stains, NPC_NAME abruptly pulls you to your feet. \"@@color:cyan;No time for that whore... now you'll be facing my other sword. Get ready to receive!@@\""+
                    "It's clear he's quite serious about this and you do your best to get into a proper fighting stance. You raise your feeble cutlass and prepare to meet his assault.\n\n",
                "END" : "",
                "RESULTS" : [
                    {"C":  25, "TEXT":  "NPC_NAME's attacks come @@color:red;too fast and too hard for you to deal with@@. You struggle to maintain even a pitiful defence, let alone strike back and ultimately he has you bent over on the deck and is swatting your pASS behind playfully with his sword."},
                    {"C":  50, "TEXT":  "NPC_NAME is an expert duelist and @@color:yellow;you are clearly outmatched@@. At first you manage to put up some sort of defense, but within minutes the tide of the duel is clearly in his favor. Not long after that your defense entirely collapses and you find yourself laying prone on the deck with everyone laughing at you."},
                    {"C": 500, "TEXT":  "Right from the start, NPC_NAME tries to go in for the kill but you nimbly dance backwards and meet his thrust with a parry. The two of you go back and forth in a " +
                    "@@color:green;flurry of blows that manages to draw the attention of the remaining pirates on deck@@. Soon everyone is captivated by the display of swordsmanship before them and are actively cheering. Eventually you tire, but thankfully before NPC_NAME can press this advantage he calls the lesson over. You suspect that he was going easy on you."} ]
            },
            {
                "ID" : "SCENE04",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "D", "TYPE" : "SKILL", "NAME" : "AssFucking", "DIFFICULTY" : 50, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 100, "OPT" : 0 }
                ],
                "POST" : [
                    { "TYPE" : "NPC_STAT",  "NAME" : "Lust",        "VALUE" : -10,      "OPT" : "TAG_D" },
                    { "TYPE" : "NPC_STAT",  "NAME" : "Mood",        "VALUE" : 10,       "OPT" : "TAG_D" }
                ],
                "START" :
                "After the lesson is over, NPC_NAME leads you back to the cabin and motions for you to approach the table. He roughly bends you over it, making sure your hands are flat on it's cold wooden surface. "+
                "It doesn't take much imagination for you to guess what is about to happen next, so you do your best to try and 'loosen' up your ass-pussy for the pounding it's about to "+
                "to receive. You feel NPC_NAME's rough hands on you as he removes your bottom clothes. You even start to make a move to help him, only to have him slap your hands away and "+
                "roughly shove you down again even more flat on the table. You're resting in this awkward position when you feel something cold and slimy start to spread between your ass cheeks.\n\n"+
                "Somewhat relieved that at least he is going to lubricate before shoving his monster cock inside you, you are surprised when you feel a thick meaty finger slip in to your "+
                "sissy hole. You gasp... (or is that a moan) as he works his thick finger in and out of you. Eventually this becomes two fingers and then finally three and accompanied by "+
                "the embarrassing sounds of your now well lubricated ass opening and closing.\n\n"+
                "\"@@color:cyan;Here it comes bitch.@@\" he says, and while you appreciate the warning it doesn't do much to lesson the shock of what you swear is over a foot of black cock "+
                "suddenly entering your well lubricated rectum. ",
                END :
                "NPC_NAME starts breathing harder as he picks up the pace in your ass, each thrust sending a shiver up your spine "+
                "and through your pPENIS dick. Then, with one last massive push he jams his cock so deep into your ass you're "+
                "positive that you felt it in the back of your throat. The sensation - a mixture of arousal and "+
                "humiliation is so intense that you have a tiny orgasm and your pPENIS sissy clit leaks a pathetic spurt of cum.",
                "RESULTS" : [
                    {"D":  25, "TEXT":
                        "You try hard to accommodate NPC_NAME's massive dick, @@color:red;but even with the lube@@ it's still a struggle. You mostly just lay there, trying not to cry as he fucks your sissy slut ass." },
                    {"D":  50, "TEXT":
                    "You make a valiant effort to open your sphincter as wide as it can go as NPC_NAME shoves his massive meat up your backside. Unfortunately there is only @@color:yellow;so far you can stretch@@ "+
                    "when faced with so many angry inches of dick. You gasp and struggle slightly as he continues to work his way up your insides until eventually you feel like you're going to pass out "+
                    "as he lodges himself deep inside you."},
                    {"D": 500, "TEXT":
                    "You push out as hard as you can to @@color:green;fully open your asshole@@ to the big black First Mate. He grunts approvingly as he easily slides his monstrous member up your "+
                    "slutty sissy ass. Within seconds he has completely filled you, bottoming out someplace so deep that it almost makes you faint. Thankfully he starts off slow, giving you time to "+
                    "relax and get into the motion and ultimately you are able to match his motion and start thrusting your ass back towards him, reaching all the way to the root of his cock." }
                ]
            }
        ],
        "END" :
        "It takes some time for you to recover your wits after being so thoroughly fucked but thankfully NPC_NAME must be in a good mood since he mostly leaves you alone as you gather up your "+
        "discarded clothes and leave his cabin. It was an eventful afternoon and even though the sun has gone down you feel that JOB_RESULTS.",
        "JOB_RESULTS" : [
            { "A" :  25,  "TEXT" : "@@minimal progress@@ at technique" },
            { "A" :  50, "TEXT" : "@@moderate progress@@ at technique" },
            { "A" :  75, "TEXT" : "@@good progress@@ at technique" },
            { "A" : 500, "TEXT" : "@@excellent progress@@ at technique" },
            { "C" :  25, "TEXT" : " and @@minimal progress@@ at dueling" },
            { "C" :  50, "TEXT" : " and @@moderate progress@@ at dueling" },
            { "C" :  75, "TEXT" : " and @@good progress@@ at dueling" },
            { "C" : 500, "TEXT" : " and @@excellent progress@@ at dueling" }
        ]

    },
    "CAPT01": {
        "ID": "CAPT01", "TITLE": "Sissy Training", "GIVER": "Captain", "PAY" : 40,
        "RATING" : 4, // of 5
        "PHASES" : [ 1, 2 ],
        "DAYS"   : 2,
        "HIDDEN" : false,
        "COST" : [
            { "TYPE" : "TIME",  "VALUE" : 2 },
            { "TYPE" : "STAT",  "NAME" : "Energy", "VALUE" : 2 }],
        "REQUIREMENTS" : [
            { "TYPE" : "QUEST",     "NAME" : "Q005",        "VALUE" : "COMPLETED",  "CONDITION" : "eq"  },
            { "TYPE" : "NPC_STAT",  "NAME" : "Lust",        "VALUE" : 70,           "CONDITION" : "gte" },
            { "TYPE" : "STAT",      "NAME" : "Perversion",  "VALUE" : 30,           "CONDITION" : "gte"  }
        ],
        "INTRO" :
        "NPC_NAME says, \"Not bad PLAYER_NAME, not bad at all. I was dubious at first, but it seems like you're 'developing' quite nicely. "+
        "With those pBUST tits and pASS ass you certainly have the right assets for the job of the ship's whore. Tell you what, I might be "+
        "persuaded to part with some coin and some 'special training' that is guaranteed to increase your income. You game slut?\"",
        "START" :
        "NPC_NAME roughly pushes you through the door into his private chambers with such force that you nearly trip. You "+
        "recover your sense and turn around only to see that he has locked the heavy iron door behind him. The \"click\" of "+
        "the lock itself rings out loudly and ominously in your ears.\n\n"+
        "NPC_NAME says, \"Now that's a good whore. Get on your knees.\"",
        "SCENES" : [
            {
                "ID" : "SCENE01a",
                "TRIGGERS" :[
                    { "TYPE" : "FLAG",      "NAME" : "CAPTAIN_TRAINING", "OPT" : "NOT_SET" }
                ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [ ],
                "POST" : [ ],
                "START" :
                    "Nothing out of the regular here, it seems a good blow job is what most of these pirate "+
                    "scum want. Just as you're about to comply however, $n reaches out and backhands you across the face!\n\n"+
                    "\"Stupid slut!\" he bellows at you. \"When I give you a command, you immediately answer 'Yes master!'. Do you understand?\"\n\n"+
                    "@@color:DeepPink;\"Yes master!\"@@ you respond as you lower yourself to your knees before NPC_NAME. "+
                    "It's humiliating, but it's better than getting belted across the side of the face again.",
                "END" : "",
                "RESULTS" : [ ]
            },
            {
                "ID" : "SCENE01b",
                "TRIGGERS" :[
                    { "TYPE" : "FLAG",      "NAME" : "CAPTAIN_TRAINING", "OPT" : "SET" }
                ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [ ],
                "POST" : [ ],
                "START" :
                    "@@color:DeepPink;\"Yes master!\"@@ you respond as you lower yourself to your knees before NPC_NAME. "+
                    "You've learned from experience that he expects you to act like a completely subservient bimbo slut "+
                    "otherwise he'll quickly get abusive. For a good tip and a few less bruises, then you'll gladly act the part.",
                "END" : "",
                "RESULTS" : [ ]
            },
            {
                "ID": "SCENE02a",
                "TRIGGERS": [
                    {"TYPE": "FLAG", "NAME": "CAPTAIN_TRAINING", "OPT": "NOT_SET"}
                ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS": [],
                "POST": [],
                "START":
                    "You are about to reach for NPC_NAME's trousers so that you can fish out his cock and start your service, but he bats your " +
                    "hands away. A look of confusion flutters across your face and he rolls his eyes and explains, \"Keep your hands behind " +
                    "your back and use your mouth like a good little whore.\n\n" +
                    "You put your hands behind your back as the Captain wants. He could probably use shackles, or even command you with his ring " +
                    ", but for some reason he prefers that you do this of your own accord. You clumsily move your head forward and with your " +
                    "teeth start yanking down his trousers. It takes some effort, but eventually you free his cock, a massive 11 inch member that " +
                    "is already erect and waving dauntingly in front of your face.",
                "END": "",
                "RESULTS": []
            },
            {
                "ID": "SCENE02b",
                "TRIGGERS": [
                    {"TYPE": "FLAG", "NAME": "CAPTAIN_TRAINING", "OPT": "SET"}
                ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS": [],
                "POST": [],
                "START":
                    "You put your hands behind your back as you know is NPC_NAME's preference. He could probably use shackles, or even command you with his ring, " +
                    "but for some reason he prefers that you do this of your own accord. It's probably more humiliating this way. You clumsily move your head forward and with your " +
                    "teeth start yanking down his trousers. It takes some effort, but eventually you free his cock, a massive 11 inch member that " +
                    "is already erect and waving menacingly in front of your face.",
                "END": "",
                "RESULTS": []
            },
            {
                "ID": "SCENE03",
                "TRIGGERS": [ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS": [
                    { "TAG" : "A", "TYPE" : "SKILL", "NAME" : "BlowJobs", "DIFFICULTY" : 80, "REWARD" : "MONEY", "R_NAME" : "MONEY", "VALUE" : 20, "OPT" : 0 }
                ],
                "POST": [
                    { "TYPE" : "NPC_STAT", "NAME" : "Mood",    "VALUE" :  3,  "OPT" : "TAG_A" },
                    { "TYPE" : "NPC_STAT", "NAME" : "Lust",    "VALUE" : -5,  "OPT" : "TAG_A" }
                ],
                "START":
                    "You wrap your pLIPS lips around the head of NPC_NAME's cock and begin to suck. He doesn't move at all, evidently "+
                    "he expects you to completely service him. It takes some effort but you slowly work your mouth down to the root of "+
                    "his thick dick. Your jaw hurts and you have trouble breathing through your nose as you struggle to get his massive "+
                    "member in your mouth.\n\n"+
                    "Eventually NPC_NAME grabs the back of your head and pushes his cock, inch by inch down your throat. You gag and "+
                    "struggle even harder to breath, tears flowing from your eyes. After what seems like ages your pLIPS lips are "+
                    "buried in his pubic hair and his massive member is halfway down your gullet. From there he starts mercilessly "+
                    "pounding away at your face, his dick using your mouth and throat as a cock sleeve.\n\n",
                "END":
                    "\n\nAfter withdrawing his cock from your throat, NPC_NAME produces a long leash, like the kind used for a dog or other pet and attaches "+
                    "it to your collar. You try to move, to get up from your knees, but you find yourself unable to do anything except crawl. "+
                    "You look up at NPC_NAME expectantly and he nods as to confirm your fears - he's using his magic ring on your slave collar to compel "+
                    "you to \"forget\" how to walk.",
                "RESULTS": [
                    {"A":  50,   "TEXT":"You try your best to accommodate NPC_NAME's tool, but @@it doesn't seem to matter too much@@. After a few minutes "+
                                        "of the steady face fucking, you feel his already huge member engorge to what feels like almost double it's normal "+
                                        "size and then the familiar twitching sensation as stream after stream of hot white jizz is deposited directly into your stomach."},
                    {"A": 500,   "TEXT":"Slowly you start to work your head up and down, the tightness of your full throat fucking causing NPC_NAME to "+
                                        "@@moan in pleasure@@. You quickly pick up the tempo and after what seems like an eternity you feel his already "+
                                        "huge member engorge to what feels like almost double it's normal size and start to shake as stream after stream of "+
                                        "hot white jizz is deposited directly into your stomach."}
                ]
            },
            {
                "ID": "SCENE04a",
                "TRIGGERS": [
                    {"TYPE": "FLAG", "NAME": "CAPTAIN_TRAINING", "OPT": "NOT_SET"}
                ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS": [],
                "POST": [],
                "START":
                    "NPC_NAME slowly strips you and produces a new garment and accessories that cause your blood to run cold. First there "+
                    "is a small, but vicious looking garment - an @@color:orange;extreme bondage corset@@ that is made out of metal and steel with "+
                    "various attachments for keeping it's wearer subjugated. Next to that are a @@color:orange;pair of nipple clamps@@, horrible looking devices that "+
                    "leave little to the imagination as to what they are for.\n\n"+
                    "Finally, the last item is the one that scares you the most. It's a large black @@color:orange;anal dildo@@. It's obviously designed to be "+
                    "inserted into your ass and then locked into place with a strap on the corset. This is not going to end well for your poor behind.",
                "END": "",
                "RESULTS": []
            },
            {
                "ID": "SCENE04b",
                "TRIGGERS": [
                    {"TYPE": "FLAG", "NAME": "CAPTAIN_TRAINING", "OPT": "SET"}
                ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS": [],
                "POST": [],
                "START":
                    "NPC_NAME slowly strips you and produces the familiar 'training' equipment that he used on you last time. You stare timidly at the "+
                    "@@color:orange;extreme bondage corset and anal dildo@@, the memory still fresh in your mind of the previous experience. You slowly swallow "+
                    "in fear...",
                "END": "",
                "RESULTS": []
            },
            {
                "ID": "SCENE05",
                "TRIGGERS": [ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS": [
                    { "TAG" : "B", "TYPE" : "SKILL", "NAME" : "AssFucking", "DIFFICULTY" : 80, "REWARD" : "MONEY", "R_NAME" : "MONEY", "VALUE" : 20, "OPT" : 0 }
                ],
                "POST": [
                    { "TYPE" : "NPC_STAT", "NAME" : "Mood",    "VALUE" :  3,  "OPT" : "TAG_B" },
                    { "TYPE" : "NPC_STAT", "NAME" : "Lust",    "VALUE" : -5,  "OPT" : "TAG_B" }
                ],
                "START":
                "NPC_NAME changes your clothes. The corset is so tight around your pWAIST waist that it keeps you from taking "+
                "anything but the most shallow of breaths. It pushes up your pBUST tits and flatters your pHIPS hips, causing "+
                "your pASS ass to look more pronounced.\n\n"+
                "After you've been situated such, he locks you into the device, your arms firmly at your side. Next comes the "+
                "@@color:orange;nipple clamps@@ - he spends some time toying with your nipples to get them fully errect and you "+
                "have to admit that it feels quite pleasurable, at least until he attaches the cruel clamps to you. It's all "+
                "you can manage to keep from crying.\n\n"+
                "Finally, he produces the @@color:orange;large anal plug@@. He puts it in front of your face so that you can "+
                "spit on it to try and provide some small amount of lubrication before it finds purchase in your soon to be "+
                "abused ass. Once done, he bends you over - a painful prospect in the corset and proceeds to push the end of "+
                "the bulbous dildo against your rectum.\n\n",
                "END":
                    "\n\nOnce fully attired NPC_NAME spends the rest of the pPHASE tormenting you with a variety of implements and raping "+
                    "your mouth. He constantly degrades you, forcing you to lick his feet, his anus and his cum off the floor while you call yourself names.\n\n"+
                    "@@color:DeepPink;\"I'm a stupid dumb bimbo whore!\"@@ you say with false pride in your happy voice. "+
                    "NPC_NAME laughs and slaps you on the ass, obviously pleased at your act of self degradation.\n\n"+
                    "\"That's right, and now you're going to prove it,\" NPC_NAME says as he removes the dildo from your ass.\n\n"+
                    "He grabs you by the collar and leads you over to a specially prepared rocking horse. It has a long furry and "+
                    "plush main and a (slightly) smaller dildo protruding from the seat.",
                "RESULTS": [
                    {"B":  50,   "TEXT":"You try your hardest to gape your asshole, but it's to no avail. The dildo is just @@too massive to easily "+
                                        "fit up your butt@@ and it takes NPC_NAME quite a bit of effort to slowly work it up into your bowels. You grunt "+
                                        "in pain and tears begin streaming from your eyes. NPC_NAME doesn't relent and methodically keeps forcing "+
                                        "the monstrous tool up your rectum. By the time he manages to get it firmly lodged in your posterior and locked "+
                                        "into place you are sobbing and convulsing as much the cruel corset you are wearing allows you to."},
                    {"B": 500,   "TEXT":"You strain and with great effort manage to gape your asshole sufficiently enough so that the @@monstrously "+
                                        "huge dildo easily enters your backside@@. NPC_NAME is surprised by how fluidly he is able to drive the evil "+
                                        "looking phallus into you. Obviously it annoys him a little, so right as the dildo is about to bottom out he "+
                                        "gives it a wicked slam, driving it deep into your bowels. The shock and pain cause you to involuntarily let out "+
                                        "a scream and despite yourself your eyes start to tear up. While painful, the display seems to have satisfied "+
                                        "the sadistic Captain and he locks the dildo in place with a grin."}
                ]
            },
            {
                "ID": "SCENE06a",
                "TRIGGERS": [
                    {"TYPE": "FLAG", "NAME": "CAPTAIN_TRAINING", "OPT": "NOT_SET"}
                ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS": [],
                "POST": [],
                "START":
                "\"Well slut, get to it\" he states. You look confused for a moment until you feel the harsh boot of NPC_NAME's foot upon your arse, "+
                "sending you sprawling towards the little horsie. It's obvious what he wants you to do, but how much more can the man humiliate you? "+
                "Slowly you pick yourself up off the floor, a task made more difficult by the constricting corset you are wearing and straddle the "+
                "perverted toy. You give one last look at NPC_NAME and he simply nods. You hold your breath and steel your guts while you impale yourself on the phallus.",
                "END": "",
                "RESULTS": []
            },
            {
                "ID": "SCENE06b",
                "TRIGGERS": [
                    {"TYPE": "FLAG", "NAME": "CAPTAIN_TRAINING", "OPT": "SET"}
                ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS": [],
                "POST": [],
                "START":
                "\"Well slut, get to it\" he states."+
                "Knowing just what NPC_NAME wants to see, you daintily prance over to the perverted rocking horse and straddle it, only taking a "+
                "moment to catch your breath in the constricting corset until you impale your abused ass on the upright phallus.",
                "END": "",
                "RESULTS": []
            },
            {
                "ID": "SCENE07",
                "TRIGGERS": [ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS": [
                    { "TAG" : "C", "TYPE" : "SKILL", "NAME" : "BlowJobs", "DIFFICULTY" : 80, "REWARD" : "MONEY", "R_NAME" : "MONEY", "VALUE" : 20, "OPT" : 0 }
                ],
                "POST": [
                    { "TYPE" : "NPC_STAT", "NAME" : "Mood",    "VALUE" :  3,  "OPT" : "TAG_C" },
                    { "TYPE" : "NPC_STAT", "NAME" : "Lust",    "VALUE" : -5,  "OPT" : "TAG_C" }
                ],
                "START":
                "Once in place, NPC_NAME puts his dick in front of your face and with your hands at your side you proceed to "+
                "give him a blow job while riding the rocking dildo with your sissy asshole. The mane of the rocking horse is "+
                "made out of some type of material that brushes sensually against your pPENIS sissy clit and combined with the "+
                "stimulation in your ass starts to arouse you. It doesn't take long until your pPENIS dick is hard and you "+
                "are straining you rub it more furiously as you bounce up and down, your butt being self-raped while you suck off NPC_NAME.\n\n",
                "END":
                "\n\nAfter you've recovered your senses NPC_NAME leads you again by the collar to the floor and forces you to eat all "+
                "of the semen with your tongue and not using your hands. You lazily gobble up the mixed pool of jizz while he continues "+
                "to humiliate and insult you. By the time you are done, without even realizing it you're crying and sobbing to yourself.\n"+
                "Thankfully the 'special training' time is almost over and NPC_NAME lets you get changed and cleaned up.",
                "RESULTS": [
                    {"C": 500,   "TEXT":"Eventually @@your cock sucking has the desired effect@@ on NPC_NAME and he grabs your head and starts to blow load "+
                    "and load of hot semen in your mouth. There's so much of it that you can't even swallow it all and it starts to "+
                    "pool out of your lips and nose. At this exact same moment, the combination of the anal stimulation, your pPENIS "+
                    "dick rubbing on the horse and the humiliation of the situation brings about your own orgasm and you find yourself "+
                    "shooting your own sissy cum while ironically drinking another mans hot jizz."}
                ]
            },
            {
                "ID": "SCENE08a",
                "TRIGGERS": [
                    {"TYPE" : "FLAG", "NAME": "CAPTAIN_CLAMPS", "OPT": "SET"},
                    {"TYPE" : "FLAG", "NAME": "CAPTAIN_DILDO",  "OPT": "SET"},
                    {"TYPE" : "FLAG", "NAME": "CAPTAIN_CORSET", "OPT": "NOT_SET"},
                    {"TYPE" : "TAG",  "NAME": "A", "VALUE":  100, "CONDITION" : "gte" },
                    {"TYPE" : "TAG",  "NAME": "B", "VALUE":  100, "CONDITION" : "gte" },
                    {"TYPE" : "TAG",  "NAME": "C", "VALUE":  100, "CONDITION" : "gte" }
                ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS": [],
                "POST": [
                    {"TYPE" : "FLAG",       "NAME" : "CAPTAIN_CORSET",  "VALUE" : 1, "OPT" : "SET"},
                    {"TYPE" : "CLOTHES",    "NAME" : "bondage corset",  "VALUE" : 1, "OPT" : "WEAR" }

                ],
                "START":
                "NPC_NAME says, \"You've really come a long way PLAYER_NAME. When I first brought you aboard I had no idea you'd turn into "+
                "such a fine slut. I'm pleasantly surprised. You can keep that @@color:orange;extreme bondage corset@@, I think it was made for you anyway.\"",
                "END": "",
                "RESULTS": []
            },
            {
                "ID": "SCENE08b",
                "TRIGGERS": [
                    {"TYPE" : "FLAG", "NAME": "CAPTAIN_CLAMPS", "OPT": "SET"},
                    {"TYPE" : "FLAG", "NAME": "CAPTAIN_DILDO",  "OPT": "NOT_SET"},
                    {"TYPE" : "FLAG", "NAME": "CAPTAIN_CORSET", "OPT": "NOT_SET"},
                    {"TYPE" : "TAG",  "NAME": "A", "VALUE":  100, "CONDITION" : "gte" },
                    {"TYPE" : "TAG",  "NAME": "B", "VALUE":  100, "CONDITION" : "gte" },
                    {"TYPE" : "TAG",  "NAME": "C", "VALUE":  100, "CONDITION" : "gte" }
                ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS": [],
                "POST": [
                    {"TYPE" : "FLAG",       "NAME" : "CAPTAIN_DILDO",  "VALUE" : 1, "OPT" : "SET"},
                    {"TYPE" : "CLOTHES",    "NAME" : "large plug",    "VALUE" : 1, "OPT" : "WEAR" }

                ],
                "START":
                "NPC_NAME says, \"Not a half bad job PLAYER_NAME, keep it up and you'll be a fine bimbo whore some day.\"\n\n"+
                "He tosses the @@color:orange;anal dildo@@ to you and says, \"Keep that as a tip. You'll put them to good use I'm sure.\"",
                "END": "",
                "RESULTS": []
            },
            {
                "ID": "SCENE08c",
                "TRIGGERS": [
                    {"TYPE" : "FLAG", "NAME": "CAPTAIN_CLAMPS", "OPT": "NOT_SET"},
                    {"TYPE" : "FLAG", "NAME": "CAPTAIN_DILDO",  "OPT": "NOT_SET"},
                    {"TYPE" : "FLAG", "NAME": "CAPTAIN_CORSET", "OPT": "NOT_SET"},
                    {"TYPE" : "TAG",  "NAME": "A", "VALUE":  10, "CONDITION" : "gte" },
                    {"TYPE" : "TAG",  "NAME": "B", "VALUE":  10, "CONDITION" : "gte" },
                    {"TYPE" : "TAG",  "NAME": "C", "VALUE":  10, "CONDITION" : "gte" }
                ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS": [],
                "POST": [
                    {"TYPE" : "FLAG",       "NAME" : "CAPTAIN_CLAMPS",  "VALUE" : 1, "OPT" : "SET"},
                    {"TYPE" : "CLOTHES",    "NAME" : "nipple clamps",   "VALUE" : 1, "OPT" : "WEAR" }

                ],
                "START":
                "NPC_NAME says, \"Not a half bad job PLAYER_NAME, keep it up and you'll be a fine bimbo whore some day.\"\n\n"+
                "He tosses the @@color:orange;nipple clamps@@ to you and says, \"Keep that as a tip. You'll put them to good use I'm sure.\"",
                "END": "",
                "RESULTS": []
            },
            {
                "ID": "SCENE09",
                "TRIGGERS": [],
                "TRIGGERS_ANY" : [ ],
                "CHECKS": [],
                "POST": [
                    { "TYPE" : "FLAG",       "NAME" : "CAPTAIN_TRAINING",   "VALUE" :   1, "OPT" : "SET"},
                    { "TYPE" : "STAT_XP",    "NAME" : "WillPower",          "VALUE" : -50, "OPT" : "RANDOM" },
                    { "TYPE" : "STAT_XP",    "NAME" : "Perversion",         "VALUE" : 100, "OPT" : "RANDOM" }
                ],
                "START": "",
                "END": "",
                "RESULTS": []
            }

        ],
        "END" : "NPC_NAME hands you a small pouch filled with JOB_PAY coins and says, \"Don't just lay there, your job is over so see yourself out whore.\"\n\n"+
        "You'd almost be offended if it wasn't for the fact that what he said was essentially true. You pick up your poor and battered body and head for the door.",
        "JOB_RESULTS" : [ ]
    },
    "STRP01": {
        "ID": "STRP01", "TITLE": "Practice Stripping", "GIVER": "GALLEY", "PAY" : 0,
        "RATING" : 2, // of 5
        "PHASES" : [ 0 ],
        "DAYS"   : 1,
        "HIDDEN" : true,
        "COST" : [  { "TYPE" : "TIME", "VALUE" : 1 },
                    { "TYPE" : "STAT", "NAME" : "Energy", "VALUE" : 1 } ],
        "REQUIREMENTS" : [
                    { "TYPE" : "QUEST",     "NAME" : "STRIPPING",        "VALUE" : "ACTIVE",  "CONDITION" : "eq"  }
        ],
        "INTRO" :   "Not used",
        "START" : "The stage in the galley looks like it's been recently repaired. You wonder if it wasn't done expressly so that you could use it. Did one of the Pirates, "+
        "or even the Captain, foretell that you'd sink this far into depravity? You take a moment to think about what you need to do. It's not like you've never seen a dancing "+
        "girl before, or even a lewd dancing girl or two on occasion, but the concept of being the woman up on stage jiggling her ass and tits for a horde of men is "+
        "something you never imagined. Still, you need the money... and truthfully it's an easier way to earn coin than most other options you have right now.",
        "SCENES" : [
            {
                "ID" : "SCENE01",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG": "A", "TYPE" : "SKILL", "NAME" : "Seduction", "DIFFICULTY" : 30, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 0, "OPT" : 0 }],
                "POST" : [ ],
                "START" :   "You start off you \"act\" by trying to make a big entrance. You saunter sexily across the stage, twisting and shaking your body at "+
                "an imaginary crowd. Winking and smiling while groping your tits or slapping your ass.",
                "END" : "",
                "RESULTS" : [
                    {"A":  25, "TEXT": "The overall result @@seems more comical@@ than anything else. You doubt that you'd get anything but laughter from the crowd.."},
                    {"A":  50, "TEXT": "You're not entirely confident, but you think you @@did a good enough job@@ showcasing your assets and being flirty. More practice may be needed."},
                    {"A": 500, "TEXT": "You are surprised by @@how easily it comes to you@@. Perhaps all the time you've spent \"acting\" as a girl on this ship has managed to change your personality to such a degree that this is natural to you now?"}
                ]
            },
            {
                "ID" : "SCENE02",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG": "B", "TYPE" : "SKILL", "NAME" : "Dancing", "DIFFICULTY" : 30, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 0, "OPT" : 0 }],
                "POST" : [
                    { "TYPE" : "STAT_XP", "NAME" : "Fitness",    "VALUE" :  25,  "OPT" : "TAG_B" }
                ],
                "START" :   "Next up, you start off trying to do some sexy dance moves. There's no music, so you need to pretend and move along to an imaginary beat. "+
                "You swish your hips and shake your ass, twisting and pivoting for the \"crowd\" and making sure to occasionally hike up your skirt or dip your pBUST tits out of your top.",
                "END" : "",
                "RESULTS" : [
                    {"B":  25, "TEXT": "The effect is muted heavily by the fact that you appear to have @@two left feet@@. Your dancing needs improvement."},
                    {"B":  50, "TEXT": "You feel that you've @@mostly got a handle on it@@ but your moves could do with some refinement.."},
                    {"B": 500, "TEXT": "The entire experience is @@surprisingly easy@@, your body moving naturally and fluidly like that of a seasoned stripper. Maybe you have some natural talent in this area?"}
                ]
            },
            {
                "ID" : "SCENE03",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG": "C", "TYPE" : "SKILL", "NAME" : "Dancing", "DIFFICULTY" : 50, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 0, "OPT" : 0 },
                    { "TAG": "C1", "TYPE" : "SKILL", "NAME" : "Seduction", "DIFFICULTY" : 50, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 0, "OPT" : 0 }],
                "POST" : [
                    { "TYPE" : "STAT_XP", "NAME" : "Fitness",    "VALUE" :  25,  "OPT" : "TAG_C" }
                ],
                "START" :   "You decide to kick it up a notch and start to disrobe while doing your dance moves. You first start trying to be \"flirty\" by peeking your "+
                "pBUST bosom out of your top or exposing your pASS ass by flipping your skirt and then move into the full act of removing your clothes one by one while still "+
                "trying to put on a sexy dance number.",
                "END" : "",
                "RESULTS" : [
                    {"C":  25, "TEXT": "The dancing of course, ends up @@being terrible@@ due to your inexperience and the extra challenge of trying to get naked at the same time."},
                    {"C":  50, "TEXT": "You somehow @@manage to keep a beat@@ while taking off your garments, one by one."},
                    {"C": 500, "TEXT": "You @@shake your stuff sexily@@ while you strip your clothes."},
                    {"C1":  25, "TEXT": "But you find it @@difficult@@ to actually remove your garments. Who knew getting naked would be so hard?"},
                    {"C1":  50, "TEXT": "You @@manage to disrobe@@ yourself during this act without too much hassle. Maybe it wasn't as sexy as it could be however?"},
                    {"C1": 500, "TEXT": "You @@sexily remove your clothing@@, making a huge show of each piece as it comes off your body and onto the floor."}
                ]
            },
            {
                "ID" : "SCENE04",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG": "D", "TYPE" : "SKILL", "NAME" : "Seduction", "DIFFICULTY" : 50, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 0, "OPT" : 0 }],
                "POST" : [ ],
                "START" :   "Now that you're mostly naked, you continue to try and jiggle and gyrate your assets at the imaginary crowd. You cover your breasts with your hands "+
                "and arms, while turning your back to show off your pASS derriere, wiggling and shimmying your body to the beat of the imaginary tune in your head.",
                "END" : "",
                "RESULTS" : [
                    {"D":  25, "TEXT": "This is @@surprisingly much harder than you thought@@ and you feel inexperienced and foolish."},
                    {"D":  50, "TEXT": "You think you managed to @@pull it off well enough@@, but you could improve some in a couple of areas."},
                    {"D": 500, "TEXT": "You @@seem to be a natural@@ at these types of seductive movements. If it wasn't for the obvious proof between your legs, no one would suspect you weren't born a woman."}
                ]
            },
            {
                "ID" : "SCENE05",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG": "E", "TYPE" : "SKILL", "NAME" : "Dancing", "DIFFICULTY" : 50, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 0, "OPT" : 0 }],
                "POST" : [
                    { "TYPE" : "STAT_XP", "NAME" : "Fitness",    "VALUE" :  25,  "OPT" : "TAG_E" }
                ],
                "START" :   "Finally, you decide to end your \"show\" with a big dance number. You start picking up the pace and stop hiding your pBUST tits. You have a pair "+
                "of long red tassels attached to your nipples and you try to make them spin in circles as you undulate your body to the beat in your head.",
                "END" : "",
                "RESULTS" : [
                    {"E":  25, "TEXT": "You try to pick up the tempo, but just as you're about to put on a finishing move, you @@slip and fall on your arse@@. Not a great way to end a performance."},
                    {"E":  50, "TEXT": "The tassels and your tits are flying everywhere as you @@strut your stuff@@ on the stage. It's not perfect, but passable enough for pirate scum. You finish off by doing the splits and landing on the stage, somewhat awkwardly."},
                    {"E": 500, "TEXT": "You really get into the act and start experimenting, doing @@more and more complex moves@@ as you finish with spinning your tassels in opposite directions while landing forward on the stage doing the splits. You think you pulled it off well enough."}
                ]
            }
        ],
        "END" : "You pick yourself up off the stage and start gathering your discarded clothing. You're surprised at how much of a workout that is and you wonder how much "+
        "more you're going to have to practice until you get good enough for the \"real thing\".",
        "JOB_RESULTS" : [
        ]

    },
    "STRP02": {
        "ID": "STRP02", "TITLE": "Perform Strip Show", "GIVER": "GALLEY", "PAY" : 30,
        "RATING" : 2, // of 5
        "PHASES" : [ 2 ],
        "DAYS"   : 1,
        "HIDDEN" : true,
        "COST" : [
                    { "TYPE" : "TIME", "VALUE" : 1 },
                    { "TYPE" : "STAT", "NAME" : "Energy", "VALUE" : 2 } ],
        "REQUIREMENTS" : [
                    { "TYPE" : "QUEST",     "NAME" : "STRIPPING",        "VALUE" : "COMPLETED",  "CONDITION" : "eq"  }
        ],
        "INTRO" :   "Not used",
        "START" : "There's a surprisingly large crowd gathered in the galley to watch you perform this evening. The pirates are generally a rowdy bunch "+
        "but even more so when they've been hitting the grog and expecting a show. You give a nod to the pirate who's manning the piano and he starts to "+
        "play a bawdy fanfare that signifies you're about to \"enter the stage\". A roar goes up from the crowd!",
        "SCENES" : [
            {
                "ID" : "SCENE01",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG": "A", "TYPE" : "SKILL", "NAME" : "Dancing",     "DIFFICULTY" : 70,  "REWARD" : "MONEY", "R_NAME" : "MONEY", "VALUE" : 10, "OPT" : "RANDOM" },
                    { "TAG": "B", "TYPE" : "SKILL", "NAME" : "Seduction",   "DIFFICULTY" : 70,  "REWARD" : "MONEY", "R_NAME" : "MONEY", "VALUE" : 10, "OPT" : "RANDOM" }
                ],
                "POST" : [
                    { "TYPE" : "STAT_XP",        "NAME" : "Fitness",    "VALUE" :  10,  "OPT" : "TAG_A" },
                    { "TYPE" : "PIRATE_STATS",   "NAME" : "Mood",       "VALUE" :   5,  "OPT" : "TAG_A" },
                    { "TYPE" : "PIRATE_STATS",   "NAME" : "Lust",       "VALUE" :   5,  "OPT" : "TAG_B" }
                ],
                "START" :   "You enter onto the stage holding up large feather fans in front of your body. You put extra emphasis in your walk, shaking your pASS ass and pBUST tits "+
                "in time with the music. You do your best to try and make a spectacle of yourself and flaunting your body and sexuality.",
                "END" : "",
                "RESULTS" : [
                    {"A":  25, "TEXT": "Your moves are @@less than impressive@@, bordering on incompetent. You just hope the crowd didn't notice."},
                    {"A":  50, "TEXT": "You feel like you @@managed to enter sexily enough@@ onto the stage, your assets giving you a clear edge."},
                    {"A": 500, "TEXT": "You @@easily handle entering the stage@@ and the wiggling up your hips and tits gets everyone's attention."},
                    {"B":  25, "TEXT": "The crowd's reaction is @@not very impressive@@ however. You'll have to work harder."},
                    {"B":  50, "TEXT": "The crowd seems to @@really get into it@@ which is a good sign for your tips."},
                    {"B": 500, "TEXT": "The crowd is @@clapping and cheering@@ as you strut your stuff. Hopefully you can keep this energy level up."}
                ]
            },
            {
                "ID" : "SCENE02",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG": "C", "TYPE" : "SKILL", "NAME" : "Dancing",     "DIFFICULTY" : 70,  "REWARD" : "MONEY", "R_NAME" : "MONEY", "VALUE" : 10, "OPT" : "RANDOM" },
                    { "TAG": "D", "TYPE" : "SKILL", "NAME" : "Seduction",   "DIFFICULTY" : 70,  "REWARD" : "MONEY", "R_NAME" : "MONEY", "VALUE" : 10, "OPT" : "RANDOM" }
                ],
                "POST" : [
                    { "TYPE" : "STAT_XP",        "NAME" : "Fitness",    "VALUE" :  10,  "OPT" : "TAG_C" },
                    { "TYPE" : "PIRATE_STATS",   "NAME" : "Mood",       "VALUE" :   5,  "OPT" : "TAG_C" },
                    { "TYPE" : "PIRATE_STATS",   "NAME" : "Lust",       "VALUE" :   5,  "OPT" : "TAG_D" }
                ],
                "START" :   "The music starts to pick up and you do your best to gyrate your body in time with it. You toy with the crowd, starting to remove "+
                "your clothing bit by bit while giving them glimpses of your pBUST tits from behind the fans. Each piece of your costume that you remove gets held "+
                "up over a fan and dangled for a bit before being discarded, each time eliciting a hoot from the crowd. Eventually you're entirely naked except for "+
                "the tassels on your tits and a small thong hiding your pPENIS sissy dick from the audience.",
                "END" : "",
                "RESULTS" : [
                    {"C":  25, "TEXT": "Except for a @@few mistakes@@ you manage to keep your footing to the music."},
                    {"C":  50, "TEXT": "Your dancing is @@relatively well done@@ and gets a good response from the crowd."},
                    {"C": 500, "TEXT": "Your @@sexy moves@@ get a roar of approval from the crowd."},
                    {"D":  25, "TEXT": "However, you do see a @@few disinterested faces out there@@. Maybe you're not trying hard enough?"},
                    {"D":  50, "TEXT": "Everyone seems to be @@really into your act@@ at this stage."},
                    {"D": 500, "TEXT": "The @@crowd roars with approval@@ at your display."}
                ]
            },
            {
                "ID" : "SCENE03",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG": "E", "TYPE" : "SKILL", "NAME" : "Dancing",     "DIFFICULTY" : 70,  "REWARD" : "MONEY", "R_NAME" : "MONEY", "VALUE" : 20, "OPT" : "RANDOM" },
                    { "TAG": "F", "TYPE" : "SKILL", "NAME" : "Seduction",   "DIFFICULTY" : 70,  "REWARD" : "MONEY", "R_NAME" : "MONEY", "VALUE" : 20, "OPT" : "RANDOM" }
                ],
                "POST" : [
                    { "TYPE" : "STAT_XP",        "NAME" : "Fitness",    "VALUE" :  10,  "OPT" : "TAG_E" },
                    { "TYPE" : "PIRATE_STATS",   "NAME" : "Mood",       "VALUE" :   5,  "OPT" : "TAG_E" },
                    { "TYPE" : "PIRATE_STATS",   "NAME" : "Lust",       "VALUE" :   5,  "OPT" : "TAG_F" },
                    { "TYPE" : "STAT_XP",        "NAME" : "Femininity", "VALUE" :  50,  "OPT" : "TAG_E" }
                ],
                "START" :   "Now that you have their attention, it's time for the big finisher. This is the part of the act that will get them out of their "+
                "seats and their coins out of their pockets. You continue to flirt and toy with the audience, peeking your pBUST tits out from behind the fans "+
                "and giggling and laughing while you blow kisses to the men. You turn around and slowly start to shimmy the fans down your body... "+
                "eventually exposing your bare pASS rear end. This gets a cheer and you discard the fans to either side and then turn around as fast as "+
                "you can, revealing your pBUST hooters in all their glory. You start shaking your jugs back and forth, causing the tassels attached to the pasties "+
                "on your tits to swing around in large circles and your tit-flesh to wobble and jiggle.",
                "END" : "You finish off your act with a flurry of movement, shaking, jiggling and gyrating. Finally - arms stretched outwards, breasts fully exposed, "+
                "you tilt your head back at the ceiling and let everyone take in the lewdness of your body.",
                "RESULTS" : [
                    {"E":  25, "TEXT": "You @@almost lose your footing@@ a couple of times, but barely manage to recover."},
                    {"E":  50, "TEXT": "You @@strut your stuff@@ for the crowd, putting on a display of seductive gyrating."},
                    {"E": 500, "TEXT": "Your @@movements are fluid and sexy@@, entrancing everyone who watches."},
                    {"F":  25, "TEXT": "Still... you notice that @@not everyone has their concentration on you@@, or your tits."},
                    {"F":  50, "TEXT": "The crowd is @@cat calling you intently@@ and several men start propositioning."},
                    {"F": 500, "TEXT": "The crowd goes wild - men are staring at you with @@lust filled eyes@@ bordering on madness."}
                ]
            }

        ],
        "END" : "JOB_RESULTS Some of the men start throwing coins at the stage. Still naked, you bend over to pick them up and count JOB_PAY in total. You give the crowd a wink and blow them a kiss and then "+
        "remove yourself to get dressed.",
        "JOB_RESULTS" : [
            { "E" :  25, "TEXT" : "The crowd @@didn't seem too impressed@@ with your dancing ability, which isn't saying much, but " },
            { "E" :  50, "TEXT" : "The crowd @@seemed to enjoy@@ your dancing, but " },
            { "E" : 500, "TEXT" : "The crowd @@was really into your dance performance@@, but " },
            { "F" :  25, "TEXT" : "your @@sex appeal was overall lacking@@. You need to do better if you want to earn more money." },
            { "F" :  50, "TEXT" : "your @@sex appeal was on point@@. At least they can appreciate a good body." },
            { "F" : 500, "TEXT" : "your @@sex appeal was through the roof@@. You can see several of the pirate sporting large boners even from here." }
        ]

    },
    "JARV01": {
        "ID": "JARV01", "TITLE": "A slutty seduction", "GIVER": "Jarvis", "PAY" : 0,
        "RATING" : 5, // of 5
        "PHASES" : [ 3 ],
        "DAYS"   : 1,
        "HIDDEN" : true,
        "COST" : [  { "TYPE" : "TIME", "VALUE" : 1 },
                    { "TYPE" : "STAT", "NAME" : "Energy", "VALUE" : 3 },
                    { "TYPE" : "ITEM", "NAME" : "fortified wine", "VALUE" : 1 }
                 ],
        "REQUIREMENTS" : [
            { "TYPE" : "QUEST",     "NAME" : "THEBACKDOOR",         "VALUE" : "ACTIVE",     "CONDITION" : "eq"  },
            { "TYPE" : "ITEM",      "NAME" : "fortified wine",      "VALUE" : 1,            "CONDITION" : "gte" }
        ],
        "INTRO" :   "NPC_NAME wouldn't normally stoop so low as to fuck a common whore behind a tavern, but perhaps if you gave him a little 'mental lubrication' first he might become a little more compliant?",
        "START" : "You slowly saunter up to NPC_NAME's table making sure to stick out your bust and give your arse an extra wiggle. You've clearly got his attention but he briskly turns his head to side. Undeterred "+
        "you sit down at a free chair next to him and slide across a bottle of @@color:purple;fortified wine@@.\n\n"+
        "\"@@color:DeepPink;Care you have a drink with me handsome?@@\" you ask while fluttering your eyelashes at him. NPC_NAME seems to consider for a moment and smiles and uncorks the bottle of wine. With some light flirting and banter it doesn't "+
        "take long for him to get drunk off the potent alcohol. Sensing your opportunity, you grab him by the hand and whisper in his ear to come with you outside so that you can show him a \"@@color:DeepPink;real good time@@\".",
        "SCENES" : [
            {
                "ID" : "SCENE01",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG": "A", "TYPE" : "SKILL", "NAME" : "Seduction", "DIFFICULTY" : 50, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 0, "OPT" : 0 }],
                "POST" : [ ],
                "START" :   "Once outside you find a quiet alley to begin your work. Thankfully it's late enough at night that there aren't any passer-bys and NPC_NAME seems to mostly be either too drunk, or too horny "+
                "to care about being found out. You rub your pBUST tits against him and start to stroke his groin through his trousers.\n\n"+
                "\"@@color:DeepPink;Oh, what a thick cock you have hiding in there,@@\" you whisper against his ear, \"@@color:DeepPink;I want to have a taste of it just sooooo bad...@@\"",
                "RESULTS" : [
                    {"A":  25, "TEXT": "NPC_NAME seems to sober up momentarily and he gives you a weary look. Was that a @@little bit too much@@ perhaps?"},
                    {"A":  50, "TEXT": "You're not entirely confident, but you think you @@did a good enough job@@ getting NPC_NAME ready to go."},
                    {"A": 500, "TEXT": "You are surprised by @@how easily it is@@ to turn this old goat on. You feel his cock practically surge in your hand and hear his breath hitch in his throat."}
                ],
                "END" : "Without warning he grabs one of your turgid nipples and gives it a firm twist, causing you to gasp out loud. A wicked grin comes across his face and he roughly pushes you down to your knees. It's obvious what he wants."
            },
            {
                "ID" : "SCENE02",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG": "B", "TYPE" : "SKILL", "NAME" : "BlowJobs", "DIFFICULTY" : 80, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 0, "OPT" : 0 }],
                "POST" : [ ],
                "START" :   "You fumble momentarily with the front of NPC_NAME's trousers and he slightly moans when you finally release his turgid member from their confines. It's a short, but thick and meaty cock, ripe with the smell of "+
                "a man who has worked a full day. You place your pLIPS lips on the tip of his member and take an experimental lick, it's salty and not altogether unpleasant. Encouraged, you engulf his member in your mouth and begin to suck like you've done so many times before. "+
                "NPC_NAME doesn't wait for you to pick up the pace and one of his hands winds itself into your hair, pushing your mouth further down his cock. You do your best to keep up a steady rhythm while trying not to choke, but it doesn't keep the tears from coming out of your eyes.",
                "END" : "",
                "RESULTS" : [
                    {"B":  25, "TEXT": "Finally, after @@what seems like ages@@ you feel his body tense up and he slams his hips into your face. Within moments a torrent of hot cum invades your throat, it's all you can do to swallow it without choking."},
                    {"B":  50, "TEXT": "You increase your pace on his cock, blinking away the tears and forcing his thick member down your poor abused throat. The extra effort @@seems to pay off@@ and within minutes NPC_NAME is pouring a hot helping of cum down your sissy gullet."},
                    {"B": 500, "TEXT": "You @@expertly suck and deep throat@@ NPC_NAME's cock, your lips and tongue moving up and down his shaft like a musician playing a fiddle. With sudden urgency you plunge his stiff rod to the back of your mouth and choke on it's thickness. Within moments he's cumming and you back off to let it pool in your mouth. Once he's spent, he looks down at you and you smile, opening your mouth and showing him his cum before you greedily swallow it down. "}
                ]
            },
            {
                "ID" : "SCENE03",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG": "C", "TYPE" : "SKILL", "NAME" : "AssFucking", "DIFFICULTY" : 80, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 0, "OPT" : 0 }],
                "POST" : [ ],
                "START" :   "Jarvis seems spent, but still coherent and you can't have that. You rise from your knees and start fondling his dick with one hand while you free your pASS arse from the confines of your clothing.\n\n"+
                "\"@@color:DeepPink;You're not going to leave a girl hanging are you?@@\" you ask. He looks momentarily taken aback but is soon lost again to the tender administrations of your hands.\n\n"+
                "You slowly turn around and start rubbing your exposed backside against his now stiffening member. You hear a grunt and are rewarded with the feeling of a turgid cock poking against your arse. He's almost there."+
                "\"@@color:Cyan;What is it you want, you little slut?@@\" NPC_NAME says in a low tone, his eyes greedily clinging to your arse.\n\n"+
                "\"@@color:DeepPink;You know what I need...@@\" you say in a low throaty voice, \"@@color:DeepPink;That big hard cock up my backside... please, please fuck me!@@\"\n\n"+
                "NPC_NAME doesn't require much encouragement after that, your slutty display and the motions of your whore ass against his dick having aroused him for the second time. You deftly shift your ass and position his cock at the "+
                "entrance of your sphincter. Since his dick is already well lubricated from your blow job, it goes in rather easily and with a sudden gasp you shove yourself down on his pole. The thickness is so much that you swear you can "+
                "actually feel your bowels push apart. NPC_NAME, obviously turned on by your lewd act, grabs you by your pHIPS hips and starts to furiously pump away at your pASS ass.",
                "END" : "",
                "RESULTS" : [
                    {"C":  25, "TEXT": "Despite the furious pounding your backside is receiving, you are @@unable to either loosen up enough or shift into a good enough position@@ to allow NPC_NAME to really bottom out in your colon. After what seems like ages, you think that maybe NPC_NAME has cum, but you're not entirely sure. In either case, he removes himself from your ass-pussy and puts away his cock."},
                    {"C":  50, "TEXT": "You @@furiously buck your hips@@ against NPC_NAME's burgeoning boner, impaling yourself so deep that you feel your guts twist and flop with each thrust. Quickly you get into a good rhythm and with scant encouragement you feel a torrent of boiling jizz fill your bowels."},
                    {"C": 500, "TEXT": "\"@@color:DeepPink;Yeah! Fuck me daddy!@@\" you scream while impaling your sissy ass on NPC_NAME's thick shaft. The verbal encouragement really excites him and he begins to really plow your ass deeply. Maybe it's the hours of practice you've already had, but it doesn't take long for your sissy hole to respond and you feel your own orgasm explode, a thin trail of sissy cum leaking out of your limp clit. NPC_NAME doesn't seem to notice the dripping girl jizz, but he definitely feels the spasms of your orgasmic rectum and it quickly brings him over the edge. With a guttural groan he impales his hot cock fully inside you, spewing a torrent of jizz so deep that you swear you can taste it in your mouth. The pure lust and perversion of the act causes you to cum again and you barely notice that NPC_NAME falls back, seemingly dazed."}
                ]
            },
            {
                "ID" : "SCENE04a",
                "TRIGGERS" :[
                    {"TYPE" : "TAG",  "NAME": "A", "VALUE":   50, "CONDITION" : "gte" },
                    {"TYPE" : "TAG",  "NAME": "B", "VALUE":   50, "CONDITION" : "gte" },
                    {"TYPE" : "TAG",  "NAME": "C", "VALUE":  100, "CONDITION" : "gte" }
                ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [ ],
                "POST" : [
                    { "TYPE" : "QUEST_FLAG", "NAME": "THEBACKDOOR", "OPT": "SET", "VALUE" : "COMPLETED"},
                    { "TYPE" : "QUEST_ITEM", "NAME" : "isla harbor mansion key", "VALUE" : 1 }
                ],
                "START" :   "",
                "END" : "Once you come out of your own orgasmic fog, you notice that NPC_NAME appears to have fainted dead against the alley wall. Without hesitation you rummage through his pockets until you find a specific key that GF_NAME used to use to let you into the mansion after hours. Ironically enough, you let Jarvis up your backdoor so that you could use his later.",
                "RESULTS" : [ ]
            },
            {
                "ID" : "SCENE04b",
                "TRIGGERS" : [ ],
                "TRIGGERS_ANY" :[
                    {"TYPE" : "TAG",  "NAME": "A", "VALUE":   50, "CONDITION" : "lt" },
                    {"TYPE" : "TAG",  "NAME": "B", "VALUE":   50, "CONDITION" : "lt" },
                    {"TYPE" : "TAG",  "NAME": "C", "VALUE":  100, "CONDITION" : "lt" }
                ],
                "CHECKS" : [ ],
                "POST" : [
                ],
                "START" :   "",
                "END" : "Turning around you notice that NPC_NAME appears to be leaning heavily against the wall. You make your way up to him and start rubbing your hands on him, but what you're actually doing is searching for his keys. Unfortunately he slaps your hands away and says, \"@@color:Cyan;Dammit slut, I'm spent, there'll be no more of that!@@\" and walks away while fixing up his trousers. Alas, it seems that your efforts tonight went to waste. Where did you go wrong?",
                "RESULTS" : [ ]
            }

        ],
        "END" : "You take a moment to straighten out your clothes, fix your hair and wipe away some of the cum before checking to make sure no one has seen you. You quickly depart the alley and make your way back to the tavern.",
        "JOB_RESULTS" : [
        ]

    },
    "GOV01": {
        "ID": "GOV01", "TITLE": "Daddy's Little Girl", "GIVER": "LordRowe", "PAY" : 200,
        "RATING" : 5, // of 5
        "PHASES" : [ 1, 2, 3 ],
        "DAYS"   : 1,
        "HIDDEN" : false,
        "COST" : [
            { "TYPE" : "TIME",  "VALUE" : 1 },
            { "TYPE" : "STAT",  "NAME" : "Energy", "VALUE" : 1 }],
        "REQUIREMENTS" : [
            { "TYPE" : "NPC_STAT",      "NAME" : "Lust",            "VALUE" : 70,           "CONDITION" : "gte" },
            {"TYPE": "STYLE_CATEGORY",  "NAME": "Daddy's Girl",     "VALUE": 100,           "CONDITION" : "gte" },
            {"TYPE": "HAIR_STYLE",      "NAME": "cute pig tails",   "VALUE": true,          "CONDITION" : "eq" },
            {"TYPE": "HAIR_COLOR",      "NAME": "blond",            "VALUE": true,          "CONDITION" : "eq" },
            {"TYPE": "QUEST",           "NAME": "DADDYSGIRL",       "VALUE": "COMPLETED",   "CONDITION" : "eq" }
        ],
        "INTRO" :
        "NPC_NAME smiles at you and says, \"@@color:cyan;Well, if it isn't Daddy's little girl. Come here princess and sit on Daddy's lap, he has a nice surprise for you in his pants.@@\"",
        "SCENES" : [
            {
                "ID" : "SCENE01",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "A", "TYPE" : "SKILL", "NAME" : "Seduction", "DIFFICULTY" : 60, "REWARD" : "MONEY", "R_NAME" : "MONEY", "VALUE" : 50, "OPT" : 0 }
                ],
                "POST" : [
                     { "TYPE" : "SKILL_XP", "NAME" : "Seduction",    "VALUE" :  50,  "OPT" : "TAG_A"}
                ],
                "START" :
                "You flounce across the floor in NPC_NAME's direction taking care to put your pASS ass and pBUST tits to their maximum use with the exaggerated movement. Once there, you abruptly  "+
                "turn around and lift up your skirt, giving NPC_NAME a look at your derriere and the words, 'I @@color:pink;&#9825;@@ Daddy!' emblazoned on your panties. \"@@color:DeepPink;Like what "+
                "you see Daddy?@@\" you say with a giggle, earning you a playful swat on the rump. ",
                "RESULTS" : [
                    {"A": 50,   "TEXT": "You're @@color:red;not sure@@ if your display was effective or not, but NPC_NAME at least seems interested. " },
                    {"A": 500,  "TEXT": "A quick peek at NPC_NAME's lap confirms that his cock is already tenting his trousers. It seems your little display was @@color:green;very effective@@. "  }
                ],
                "END" : ""
            },
            {
                "ID" : "SCENE02",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "B", "TYPE" : "SKILL", "NAME" : "HandJobs", "DIFFICULTY" : 60, "REWARD" : "MONEY", "R_NAME" : "MONEY", "VALUE" : 50, "OPT" : 0 }
                ],
                "POST" : [
                    { "TYPE" : "SKILL_XP", "NAME" : "HandJobs",    "VALUE" :  50,  "OPT" : "TAG_B"}
                ],
                "START" :
                "NPC_NAME pulls you into his lap and starts roughly groping you. You let out a well acted girlish giggle and say, \"@@color:DeepPink;Sheesh Daddy! You're all handsy today!@@\" and then you "+
                "proceed to make quite a show of rubbing your ass in circles on his crotch. It doesn't take long before you hear NPC_NAME's breath start to become more strained and you gasp, \"@@color:DeepPink;Ooh Daddy! "+
                "Something hard is poking me in the bottom!@@\"\n\n"+
                "NPC_NAME says, \"@@color:cyan;That's my... uh....@@\" he moans softly and continues, \"@@color:cyan;My... trouser snake!@@\"\n\n"+
                "You give out another fake gasp. \"@@color:DeepPink;Wow! What's that Daddy? Can I see?@@\" Without waiting for a response you get down on your knees and start stroking NPC_NAME's cock through his pants. "+
                "\"@@color:DeepPink;Gee Daddy, Mr. Snake is getting so big and hard now, I'm going to let him out, okaaaaay?@@\"\n\n"+
                "NPC_NAME merely nods as you unhitch his trousers, his thick meat pole springing up and flinging a droplet of pre-cum at your forehead. You give out a fake gasp of surprise and cover your mouth with your free hand, "+
                "earning you a short laugh for your performance. ",
                "RESULTS" : [
                    {"B": 50,   "TEXT": "Without being asked to, you quickly start to work your fingers up and down NPC_NAME's shaft. It's hot and hard to the touch and you find yourself @@color:red;somewhat distracted@@ "+
                    "by it's girth. You barely notice that NPC_NAME is starting to get more agitated than aroused."},
                    {"B": 500,  "TEXT": "Without being asked to, you quickly start to work your fingers up and down NPC_NAME's shaft. You take your time and gently massage the underside of his cock, making sure to stop "+
                    "every so often to give it a long and drool laden lick to aid in lubrication. Your ministrations @@color:green;quickly have the desired effect@@ and soon NPC_NAME is panting and moaning in arousal."}
                ],
                "END" : "\"@@color:DeepPink;Daddy, Mr. Snake looks so red and angry, what do you think I should do?@@\" you ask sweetly. NPC_NAME does his best to collect his thoughts under your erotic onslaught and responds, \"@@color:cyan;He's mad because "+
                    "he is so filled with venom Princess. Why don't you do Daddy a favor and see if you can suck it all out?@@\""
            },
            {
                "ID" : "SCENE03",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "C", "TYPE" : "SKILL", "NAME" : "BlowJobs", "DIFFICULTY" : 60, "REWARD" : "MONEY", "R_NAME" : "MONEY", "VALUE" : 50, "OPT" : 0 }
                ],
                "POST" : [
                    { "TYPE" : "SKILL_XP",       "NAME" : "BlowJobs",   "VALUE" :  50,  "OPT" : "TAG_C"},
                    { "TYPE" : "NPC_STAT",   "NAME" : "Mood",       "VALUE" :  20,  "OPT" : "TAG_C" },
                    { "TYPE" : "NPC_STAT",   "NAME" : "Lust",       "VALUE" :  20,  "OPT" : "TAG_C" }
                ],
                "START" :
                "At NPC_NAME's prompting, you engulf his member with your mouth, making sure to play it up with a extremely girlish squeal. You take your time at first, making sure to cover his member "+
                " with your saliva and slowly stretching your mouth to accommodate his meaty cock. It's a struggle to get it fully past your lips without scraping it with your teeth, but eventually you manage "+
                "to establish a good rhythm. You feel NPC_NAME wrap his hand in your hair, pushing your head deep into his crotch while he starts moaning...\"GF_NAME@@color:cyan;... oh @@GF_NAME\"\n\n"+
                "Is this for real? Is the perverted old man fantasizing about his own daughter? As disturbing as this information is, you don't have much time to ponder it as you feel NPC_NAME's cock swell in your mouth, "+
                "poking against the back of your throat. ",
                "RESULTS" : [
                    {"C": 50,   "TEXT": "You do your best to suppress your gag reflex and accept his member, @@color:red;but it's difficult@@ and soon your eyes are filled with tears and you are struggling to get breath."},
                    {"C": 500,  "TEXT": "You @@color:green;expertly suppress your gag reflex@@ and easily accept his member deep into your throat. Soon your head is pistoning up and down on his shaft and the room is filled with "+
                    "the lewd sounds of his panting and your face being fucked."}
                ],
                "END" : "Long minutes pass, but eventually NPC_NAME firmly grasps the sides of your head and thrusts deeply into your throat. In your oxygen deprived state it barely registers that this cock is "+
                    "twitching and spewing what feels like a literal bucket of semen straight into your gut. You struggle to breathe through your nose while waiting for your customer to finally be spent and are relieved "+
                    "when you finally feel the raging hardness in your mouth start to soften. As soon as NPC_NAME's iron grip goes slack, you remove your mouth from his dick with a gasp and an audible 'pop'. "
            }
      ],
        "END" : "NPC_NAME is reclining in his chair, his face sweaty and flushed. You straighten up your clothing and use a small handkerchief to wipe the drool and errant cum from your clothing and face.\n\n"+
        "\"@@color:DeepPink;So Daddy, how about some allowance for widdle ol me?@@\" you say in your best little girl voice. NPC_NAME doesn't respond but he moves to his desk and takes out a bag of coins, counting "+
        "out JOB_PAY and placing them in your hands.\n\n"+
        "\"@@color:cyan;Come back some time dear,@@\" he says after catching his breath. You nod eagerly and tell him you always have time to play with 'Daddy' before taking your leave.",
        "JOB_RESULTS" : [ ]
    },
    "ISLA_WAITRESS": {
        "ID": "ISLA_WAITRESS", "TITLE": "Wench For Hire", "GIVER": "IslaTavernKeeper", "PAY" : 40,
        "RATING" : 3, // of 5
        "PHASES" : [ 1 ],
        "DAYS"   : 1,
        "HIDDEN" : false,
        "COST" : [  { "TYPE" : "TIME", "VALUE" : 3 },
                    { "TYPE" : "STAT", "NAME" : "Energy", "VALUE" : 2 } ],
        "REQUIREMENTS" : [
                    { "TYPE" : "STYLE", "NAME" : "STYLE", "VALUE" : 50, "CONDITION" : "gte" }
        ],
        "START" :   "NPC_NAME eyes you up and down, muttering to himself and then nods slowly in your direction.\n\n"+
                    "\"@@color:cyan;The job's easy enough lass, so don't worry if you don't have much experience at wenching. So long as you don't "+
                    "screw up too badly, you'll get paid@@\", he says.\n\n"+
                    "That's a relief. For once it seems you can get paid some coin without having to suck a dick... or five.\n\n"+
                    "\"@@color:cyan;Just a word of warning...@@\" he adds, \"@@color:cyan;The boys can get pretty 'hands on' if you know what I mean, "+
                    "especially after they've had a few. It shouldn't go too far... not like last time anyway.@@\"\n\n"+
                    "Aaaaaand... there it is.",
        "INTRO" : "NPC_NAME says, \"@@color:cyan;I'm always looking for help on the floor. If you can sling beers and don't mind a hand or two on your arse, we're hiring.@@\"",
        "SCENES" : [
            {
                "ID" : "SCENE01",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "A", "TYPE" : "SKILL", "NAME" : "Serving", "DIFFICULTY" : 30, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 100, "OPT" : 0 } ],
                "POST" : [
                    { "TYPE" : "NPC_STAT", "NAME" : "Mood", "VALUE" : 5, "OPT" : "TAG_A" },
                    { "TYPE" : "MONEY", "NAME" : "", "VALUE" : 20, "OPT" : "TAG_A" }
                ],
                "START" :
                    "You start your shift. The Tavern is mostly quiet this time of day and the customers are relatively orderly. "
                ,
                "END" :
                    "Eventually the rush ends and you get a few moments to catch your breath and prepare for the next bustle of customers.",
                "RESULTS" : [
                    {"A":  33, "TEXT": "However, despite this, you find it @@difficult@@ to manage all of your orders and keep them happy."},
                    {"A":  66, "TEXT": "You start off slowly and make a few miss-steps, but eventually @@you get the hang of it@@ and fall into a natural rhythm of slinging ale and grub."},
                    {"A": 500, "TEXT": "All in all, it's @@not very difficult@@ to keep everyone happy - plied with drinks and food."} ]
            },
            {
                "ID" : "SCENE02",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "B", "TYPE" : "SKILL", "NAME" : "Serving", "DIFFICULTY" : 30, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 100, "OPT" : 0 } ],
                "POST" : [
                    { "TYPE" : "NPC_STAT", "NAME" : "Mood", "VALUE" : 5, "OPT" : "TAG_B" },
                    { "TYPE" : "MONEY", "NAME" : "", "VALUE" : 20, "OPT" : "TAG_B" }
                ],
                "START" :
                    "The sky outside starts to darken and before long new customers start to arrive and you steel yourself for the dinner rush. "
                ,
                "END" :
                    "",
                "RESULTS" : [
                    {"B":  33, "TEXT": "However, despite this, you find it @@difficult@@ to manage all of your orders and keep them happy."},
                    {"B":  66, "TEXT": "You start off slowly and make a few miss-steps, but eventually @@you get the hang of it@@ and fall into a natural rhythm of slinging ale and grub."},
                    {"B": 500, "TEXT": "All in all, it's @@not very difficult@@ to keep everyone happy - plied with drinks and food."} ]
            },
            {
                "ID" : "SCENE02a",
                "TRIGGERS" :[
                    { "TYPE" : "STAT_BODY", "NAME" : "Ass", "VALUE" : 40, "CONDITION" : "gte", "OPT" : 0 }
                ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "B1", "TYPE" : "SKILL", "NAME" : "Seduction", "DIFFICULTY" : 30, "REWARD" : "MONEY", "R_NAME" : "MONEY", "VALUE" : 50, "OPT" : 0 } ],
                "POST" : [ ],
                "START" :
                    "Your pASS arse attracts a lot of attention of the customers. Several times during your shift you find yourself being groped or otherwise fondled by smelly labourers or fishermen."
                ,
                "END" :
                    "",
                "RESULTS" : [
                    {"B1":  33, "TEXT": "You do your best to ignore the constant molestation and smile through it, but @@your tips suffer for it@@."},
                    {"B1":  66, "TEXT": "You do your best at flirting and smiling while being molested and @@mostly it seems to work@@, getting you some extra coin in tips."},
                    {"B1": 500, "TEXT": "You use the opportunity to flirt and grin at the obviously sex starved customers, who are more than happy to @@tip you generously@@"} ]
            },
            {
                "ID" : "SCENE03",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "C", "TYPE" : "SKILL", "NAME" : "Serving", "DIFFICULTY" : 30, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 100, "OPT" : 0 } ],
                "POST" : [
                    { "TYPE" : "NPC_STAT", "NAME" : "Mood", "VALUE" : 5, "OPT" : "TAG_C" },
                    { "TYPE" : "MONEY", "NAME" : "", "VALUE" : 20, "OPT" : "TAG_C" }
                ],
                "START" :
                    "Eventually the dinner rush comes to an end, leaving behind only the customers who are interested in some late night drinking and entertainment. You take a "+
                    "short break and then with renewed determination head back into the growing crowd."
                ,
                "END" :
                    "",
                "RESULTS" : [
                    {"C":  33, "TEXT": "However, despite this, you find it @@difficult@@ to manage all of your orders and keep them happy."},
                    {"C":  66, "TEXT": "You start off slowly and make a few miss-steps, but eventually @@you get the hang of it@@ and fall into a natural rhythm of slinging ale and grub."},
                    {"C": 500, "TEXT": "All in all, it's @@not very difficult@@ to keep everyone happy - plied with drinks and food."} ]
            },
            {
                "ID" : "SCENE03a",
                "TRIGGERS" :[
                    { "TYPE" : "STAT_SKILL", "NAME" : "Dancing", "VALUE" : 30, "CONDITION" : "gte", "OPT" : 0 }
                ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "C1", "TYPE" : "SKILL", "NAME" : "Dancing", "DIFFICULTY" : 60, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 100, "OPT" : 0 } ],
                "POST" : [
                    {"TYPE" : "MONEY", "NAME" : "", "VALUE" : 60, "OPT" : "TAG_C1" }
                ],
                "START" :
                    "During your shift one of the locals begins to entertain the crowd by playing on his fiddle. The tune is quite catchy and you find yourself tapping your feet "+
                        "in time with the music. Some of the patrons catch on and with a little encouragement start to dance with you. Soon they are encouraging you as you twirl and "+
                        "twist away on the floor and the incessant clapping starts to get to your head. Caught up in the moment you quickly climb on top of the bar and start dancing for "+
                        "the crowd."
                ,
                "END" :
                    "",
                "RESULTS" : [
                    {"C1":  33, "TEXT": "Your dancing is @@competent, if not inspired@@ and while the crowd seems to enjoy it, they don't really loosen their purse strings for you either."},
                    {"C1":  66, "TEXT": "You mix in a few sexy moves with your dancing, exposing your pBUST tits in brief flashes and winking saucily at the crowd and you are @@rewarded with a good amount of tips@@ for your effort."},
                    {"C1": 500, "TEXT": "Using everything you know, you prance and strut your stuff across the bar. You tease and flirt with the crowd, exposing brief glimpses of your pBUST tits and pASS ass to them and riling them up into a sexual frenzy. By the end of your routine they are @@practically showering you with coins@@."} ]
            }
        ],
        "END" : "Finally, your shift in the tavern is over. NPC_NAME comes up to you and hands you your pay for the night, JOB_PAY coins.",
        "JOB_RESULTS" : [ ]
    },
    "ISLA_MASCOT": {
        "ID": "ISLA_MASCOT", "TITLE": "Store Mascot", "GIVER": "IslaShopKeeper", "PAY" : 40,
        "RATING" : 3, // of 5
        "PHASES" : [ 1, 2, 3 ],
        "DAYS"   : 1,
        "HIDDEN" : false,
        "COST" : [  { "TYPE" : "TIME", "VALUE" : 1 },
            { "TYPE" : "STAT", "NAME" : "Energy", "VALUE" : 1 } ],
        "REQUIREMENTS" : [
            { "TYPE" : "STYLE", "NAME" : "STYLE", "VALUE" : 50, "CONDITION" : "gte" },
            { "TYPE" : "STAT", "NAME" : "Femininity", "VALUE" : 10, "CONDITION" : "gte"}
        ],
        "START" :   "NPC_NAME eyes you up and down, muttering to herself and then nods slowly in your direction.\n\n"+
        "\"@@color:cyan;I'll be honest dear, this job doesn't pay much, but it doesn't require much from you either. All you need to do is wear one of the"+
        "outfits from my shop and beckon customers inside. You can start immediately and I'll pay you at the end of your shift.@@\"\n\n"+
        "This sounds okay to you. Sure, it's probably not a lot of money, but it should be easy work. But what about that costume...\n\n"+
        "Almost on cue NPC_NAME reaches behind her counter and pulls out a frilly pink dress along with a pair of the highest platform shoes you've ever "+
        "seen before. What kind of clothes does this shop sell anyway? Before you can ask, she shoves the garments into your hands and directs you to a back room to change.\n\n"+
        "Moment's later you are standing in front of shop looking like a cross between a little girl and a prostitute. You sigh to yourself and begin to call out to random people passing by.",
        "INTRO" : "NPC_NAME says, \"@@color:cyan;I'm looking for help driving customers into the shop. The pay's not great, but it's easy work.@@\"",
        "SCENES" : [
            {
                "ID" : "SCENE01",
                "TRIGGERS" :[ ],
                "TRIGGERS_ANY" : [ ],
                "CHECKS" : [
                    { "TAG" : "A", "TYPE" : "SKILL", "NAME" : "Seduction", "DIFFICULTY" : 50, "REWARD" : "NONE", "R_NAME" : "NONE", "VALUE" : 100, "OPT" : 0 } ],
                "POST" : [
                    { "TYPE" : "NPC_STAT", "NAME" : "Mood", "VALUE" : 5, "OPT" : "TAG_A" },
                    { "TYPE" : "MONEY", "NAME" : "", "VALUE" : 20, "OPT" : "TAG_A" },
                    { "TYPE" : "STAT_XP", "NAME" : "Femininity", "VALUE" : 50, "OPT" : "TAG_A" }
                ],
                "START" :
                    "Several potential customers, both men and women, walk by. You call out to them extolling the virtues of the wares inside the shop. At least you think "+
                    "you are considering you're not exactly sure what this shop sells, or if it's any good. Still, lying isn't difficult and you do your best."
                ,
                "END" :
                    "Eventually your shift ends and you saunter back inside.",
                "RESULTS" : [
                    {"A":  33, "TEXT": "Despite your efforts and outgoing antics @@not very many@@ customers enter the store. Hopefully it'll be enough."},
                    {"A":  66, "TEXT": "You seem to have a @@modest success@@ at cajoling people to check out the store. It's surprisingly more tiring than you thought to be so outgoing."},
                    {"A": 500, "TEXT": "You put on your best face and try to exert your 'girlish charm'. It seems to @@have the desired effect@@ and you draw a respectable amount of customers to the shop."} ]
            }
        ],
        "END" : "NPC_NAME comes up to you and hands you your pay for the shift, JOB_PAY coins. JOB_RESULTS",
        "JOB_RESULTS" : [
            {"A":  33, "TEXT": "It seems that she was a @@little disappointed@@ in the turn out, but hey at least you still got paid."},
            {"A":  66, "TEXT": "It appears you did @@reasonably well@@ and the pay reflects that."},
            {"A": 500, "TEXT": "You definitely did a @@good job@@ and the pay reflects that."}
        ]
    }

};
/* twine-user-script #12: "QuestData.js" */
window.App = window.App || { Data: { }, Entity: { } };

window.App.Data.Quests  = {
            "Q001": {
                "ID": "Q001", "Title": "Price of Freedom - Part 1",
                "GIVER": "Captain",
                "PRE": [
                    // Flags that are required to trigger quest.
                ],
                "POST": [
                    {"NAME": "Q001b", "VALUE": "ACTIVE"}
                ],
                "CHECKS": [
                    // Conditions that must be satisfied to complete the quest.
                ],
                "REWARD": [
                    // Rewards given when quest is completed.
                ],
                "PREREQ": "Said when you don't have the pre-req for the quest.",
                "INTRO": "Some intro text goes here",
                "MIDDLE": "This is what gets displayed when you are doing the quest.",
                "FINISH": "NPC_NAME says, \"Well now slut, I see you're not walking funny after all that ass raping - you must be a natural for this kind of work.\" " +
                "He laughs menacingly at his own bad joke and continues, \"I mentioned to you that there was a way off this ship... well other than the gang plank and that's " +
                "simple. All you need to do is @@color:cyan;earn enough filthy coin@@ for me to replace your faggot ass with a good and proper whore. About @@color:cyan;50 grand@@ should cover it. " +
                "Until then... familiarize yourself with the ship and the crew. I'm sure they'll be familiarizing themselves with your slutty holes sooner or later.\"",
                "JOURNAL_ENTRY": "You have been kidnapped and forced to become the on board prostitute to a ship full of scurvy sea dogs. " +
                "The Captain of the ship had mentioned to you that it might be possible to purchase your freedom. You should go and speak to him.",
                "JOURNAL_COMPLETE": "NPC_NAME has offered to let you buy your freedom for the sum of 50,000 coins. It's an enormous amount of money to earn, particularly for " +
                "an inexperienced sissy-whore, but other than looking out for some way to escape, you don't think there is any other way to get away from this life."
            },
            "Q001b": {
                "ID": "Q001b", "Title": "Price of Freedom - Part 2",
                "GIVER": "Captain",
                "PRE": [
                    "Q001"
                ],
                "POST": [
                    {"NAME": "GAME_WON", "VALUE": 1}
                ],
                "CHECKS": [
                    {"TYPE": "MONEY", "NAME": "MONEY", "VALUE": 50000}
                ],
                "REWARD": [],
                "PREREQ": "Said when you don't have the pre-req for the quest.",
                "INTRO": "Some intro text goes here",
                "MIDDLE": "NPC_NAME says, \"Ah, if it isn't little PLAYER_NAME, everyone's favorite sissy slut.\n" +
                    "He looks your body up and down, you think you detect a faint boner beginning to grow in his trousers.\n" +
                    "NPC_NAME continues, \"Managed to earn that coin yet, have we? If not then what are you waiting for? An idle whore earns nothing but a stiff kick to the arse as they say.\"",
                "FINISH": "NPC_NAME looks at you, his eyes filled with amazement. He says, \"I honestly didn't think you'd manage to do it and I have to say that I'm " +
                    "almost sad you did. You were a fine whore PLAYER_NAME, for a sissy anyways. Well, a deal's a deal. I'll take those coins and get that collar off your neck.\"\n" +
                    "NPC_NAME thinks for a moment and then continues, \"Of course, you're welcome to stay on and keep working the deck for as long as you want. Some of the lads have grown " +
                    "quite fond of you, or at least your holes.\"\n\n" +
                    "You do your best to maintain a poker face, acting like your actually considering the offer as you hand over the coin. Of course, you have no intention of staying one " +
                    "second longer than necessary. NPC_NAME waves his signet ring over your neck and the collar drops off with a loud thud. It's been a torturous experience, but now " +
                    "you are finally free.",
                "JOURNAL_ENTRY": "NPC_NAME has promised your freedom for the queenly sum of 50,000 coins. It's a seemingly insurmountable amount of money for you to gather, "+
                    "particularly as a slave to the pirates on the Salty Mermaid. However, it seems to be your only way of getting free... unless another opportunity presents itself.",
                "JOURNAL_COMPLETE": "You managed to scrounge up the coins required to buy your freedom. Now that it has come to this... what will you do?"
            },
            "BOARDINGPASS": {
                "ID": "BOARDINGPASS", "Title": "Boarding Pass",
                "GIVER": "Captain",
                "PRE": [
                    "PRE_BOARDINGPASS"
                ],
                "POST": [
                ],
                "CHECKS": [
                    {"TYPE": "NPC_MOOD", "NAME": "Crew", "VALUE": 90},
					{"TYPE": "NPC_MOOD", "NAME": "FirstMate", "VALUE": 90},
					{"TYPE": "NPC_MOOD", "NAME": "Cook", "VALUE": 90},
					{"TYPE": "NPC_MOOD", "NAME": "Quartermaster", "VALUE": 90}
                ],
                "REWARD": [
                    // Rewards given when quest is completed.
                ],
                "INTRO": "NPC_NAME says, \"Ah, what can I do for you slut? Wait... you want to leave the ship?\"\n\n"+
				"NPC_NAME busts out into peals of laughter. After an uncomfortably long minute, he gathers his composure.\n\n"+
				"NPC_NAME says, \"You know that the @@color:orange;geas on that slave collar@@ won't let you get more than a mile or two away from me so long as I wear "+
				"the control ring, right? Look, I'm not opposed to giving you some shore leave, but that comes after your duties are finished. "+
				"Make sure everyone, and I mean ''everyone'' on board has gotten their fill of your holes first. Then come back to me and I'll grant you leave.\"\n\n"+
				"You weren't sure what you were expecting, but as NPC_NAME dismisses you from his quarters, you feel a depressing tiredness settle over your body. "+
				"Just the sheer volume of dicks you'll have to service to meet his demands would daunt an experienced whore, let alone a reluctant sissy like yourself.",
                "MIDDLE": "NPC_NAME says, \"So, how is it PLAYER_NAME? What are you doing wasting your time around here when there are still cocks to be sucked on deck.\"",
                "FINISH": "NPC_NAME says, \"You've done a hell of a job PLAYER_NAME. A hell of a job. I'm actually surprised you can still walk after all the cocks "+
				"you've taken up your ass these last weeks.\"\n\n"+
				"NPC_NAME chuckles to himself and continues.\n\n"+
				"NPC_NAME says, \"Anyway, your leave is granted. Remember - if you get more than a couple of miles away from me however that collar around your neck "+
				"will rip your stupid bimbo head right off. Boy, that'd be a sight to see... just don't be sucking a dick when it happens... HA!\"",
				"JOURNAL_ENTRY" : "You've been told by NPC_NAME that if you want to be able to take leave liberty when the @@color:cyan;Salty Mermaid@@ is "+
				"at port then you'll first have to make sure that every man aboard the ship is @@color:DeepPink;cheered@@ by your sexual services.",
				"JOURNAL_COMPLETE" : "After what seemed like countless days filled with crazed fucking, you managed to completely sexually satisfy "+
				"every man on board the ship. Doing so, NPC_NAME deigned to grant you a special pass that will allow you to leave the ship. However if "+
				"you get too far away from the Captain, the magical geas on your collar will surely end your life. Be careful."
            },
            "Q002": {
                "ID": "Q002", "Title": "Tools of the Trade - Part 1",
                "GIVER": "FirstMate",
                "PRE": [
                    // Flags that are required to trigger quest.
                ],
                "POST": [
                    // Flags that are set when quest is completed.
                ],
                "CHECKS": [
                    {"TYPE": "NPC_MOOD", "NAME": "Crew", "VALUE": 41}
                ],
                "REWARD": [
                    {"REWARD_TYPE": "ITEM", "TYPE": "COSMETICS", "NAME": "hair accessories", "AMOUNT": 40},
                    {"REWARD_TYPE": "ITEM", "TYPE": "COSMETICS", "NAME": "hair products", "AMOUNT": 40},
                    {"REWARD_TYPE": "ITEM", "TYPE": "COSMETICS", "NAME": "basic makeup", "AMOUNT": 60},
                    {"REWARD_TYPE": "ITEM_CHOICE", "TYPE": "CLOTHES", "NAME": "bonnet", "AMOUNT": 1},
                    {"REWARD_TYPE": "ITEM_CHOICE", "TYPE": "CLOTHES", "NAME": "cotton bra", "AMOUNT": 1},
                    {"REWARD_TYPE": "ITEM_CHOICE", "TYPE": "CLOTHES", "NAME": "short heels", "AMOUNT": 1}
                ],
                "PREREQ": "Said when you don't have the pre-req for the quest.",
                "INTRO": "NPC_NAME says, \"The crew on the Salty Mermaid are a ravenously horny lot, but even they have standards and frankly, you don't really meet them. " +
                "If you ever want to earn enough money to buy your freedom, then you'll need to focus on improving your appearance. It's pretty simple really, " +
                "the higher your @@color:DeepPink;Beauty@@ and @@color:cyan;Style@@ are, the more money you will earn. Even a sissy like you can at least wear sexy clothes " +
                "and put on make-up to be more attractive. If you go and improve the @@color:lime;Mood@@ of the crew, I'll give you some items that can help you earn money. \"",
                "MIDDLE": "NPC_NAME says, \"Hey PLAYER_NAME... what are you doing wasting your time here when you should be on deck making the crew happy? Come back to me when you've " +
                "improved their @@color:lime;Mood@@ and then we'll talk.\"",
                "FINISH": "NPC_NAME says, \"I've heard that you've been out on deck whoring up a storm. Good, that's what you're supposed to do. You'll find that the crew is more " +
                "generous with their coin if you both look good and perform well, so here, have these, they'll help.\"",
                "JOURNAL_ENTRY": "You've been tasked by NPC_NAME to go forth and improve the @@color:lime;Mood@@ of the crew... obviously by letting them fuck you. " +
                "If you manage to complete this task, then NPC_NAME has promised to give you some items that will enhance your @@color:DeepPink;Beauty@@ and @@color:cyan;Style@@, " +
                "making it easier for you to earn more coin.",
                "JOURNAL_COMPLETE": "It was difficult, but after hours spent humiliating and degrading yourself as the personal fuck-toy for the crew of the Salty Mermaid, " +
                "you managed to make them happy enough for NPC_NAME give you his reward. It was an ominous first step into your life as a sissy prostitute."
            },
            "Q003": {
                "ID": "Q003", "Title": "Tools of the Trade - Part 2",
                "GIVER": "FirstMate",
                "PRE": [
                    "Q002"
                ],
                "POST": [
                    // Flags that are set when quest is completed.
                ],
                "CHECKS": [
                    {"TYPE": "NPC_MOOD", "NAME": "Cook", "VALUE": 81}
                ],
                "REWARD": [
                    {"REWARD_TYPE": "ITEM", "TYPE": "FOOD", "NAME": "milkdew melon", "AMOUNT": 3},
                    {"REWARD_TYPE": "ITEM", "TYPE": "FOOD", "NAME": "butter gourd", "AMOUNT": 3},
                    {"REWARD_TYPE": "ITEM_CHOICE", "TYPE": "CLOTHES", "NAME": "silk bra", "AMOUNT": 1},
                    {"REWARD_TYPE": "ITEM_CHOICE", "TYPE": "CLOTHES", "NAME": "frilly bloomers", "AMOUNT": 1}
                ],
                "PREREQ": "Said when you don't have the pre-req for the quest.",
                "INTRO": "NPC_NAME says, \"Not bad slut, you did pretty good keeping the crew entertained but if you want to survive on this ship then you'll need to " +
                "also get the favor of the officers. Take @@color:cyan;Cookie@@ for instance. That fat tub of lard controls the galley on this tub and if you get on his " +
                "bad side, then you'll be eating gruel and cum for the rest of your life. Go and get on his @@color:cyan;good side@@ and then come back.",
                "MIDDLE": "NPC_NAME says, \"Hey PLAYER_NAME... what are you doing wasting your time here when you should be getting on @@color:cyan;Cookie's@@ good side? Come back to me when you've " +
                "improved his @@color:magenta;Mood@@ and then we'll talk.\"",
                "FINISH": "NPC_NAME says, \"I've heard that @@color:cyan;Cookie's@@ taken a liking to you. That's good. You've probably noticed that the more people like you, the more " +
                "services they are willing to offer. That holds true for everyone really, if you think about it. Anyway, now that he's willing to occasionally feed you " +
                "better grub and not just his filthy cock, you'll have a better chance of lasting on this ship. Just be careful, some food has... certain side effects. " +
                "Why don't you experiment with these and see?\"",
                "JOURNAL_ENTRY": "You've been tasked by NPC_NAME get on @@color:cyan;Cookie's@@ good side. You'll need to make sure he's @@color:magenta;really cheerful@@.",
                "JOURNAL_COMPLETE": "It was difficult, but after days spent granting \"favors\" for Cookie in the galley, he's become quite fond of you. In the end it " +
                "paid off because not only did NPC_NAME give you a small reward, but now @@color:cyan;Cookie@@ will occasionally sell you higher quality food."
            },
            "Q004": {
                "ID": "Q004", "Title": "Tools of the Trade - Part 3",
                "GIVER": "FirstMate",
                "PRE": [
                    "Q003"
                ],
                "POST": [
                    // Flags that are set when quest is completed.
                ],
                "CHECKS": [
                    {"TYPE": "NPC_MOOD", "NAME": "Quartermaster", "VALUE": 81}
                ],
                "REWARD": [
                    {"REWARD_TYPE": "ITEM", "TYPE": "DRUGS", "NAME": "face cream", "AMOUNT": 3},
                    {"REWARD_TYPE": "ITEM", "TYPE": "DRUGS", "NAME": "fairy dust", "AMOUNT": 3},
                    {"REWARD_TYPE": "ITEM_CHOICE", "TYPE": "CLOTHES", "NAME": "silk stockings", "AMOUNT": 1},
                    {"REWARD_TYPE": "ITEM_CHOICE", "TYPE": "CLOTHES", "NAME": "frilly dress", "AMOUNT": 1}
                ],
                "PREREQ": "Said when you don't have the pre-req for the quest.",
                "INTRO": "NPC_NAME says, \"By now you should know the score. I won't waste any time explaining it to you, go and get @@color:cyan;Julius@@ on your side. He's a strange one " +
                "to be sure. More interested in his experiments than anything else... although, I wouldn't trust your asshole around him if you're passed out. You know what I mean.",
                "MIDDLE": "NPC_NAME says, \"Hey PLAYER_NAME}... what are you doing wasting your time here when you should be getting on @@color:magenta;Julius's@@ good side? Come back to me when you've " +
                "improved his @@color:magenta;Mood@@ and then we'll talk.\"",
                "FINISH": "NPC_NAME says, \"I've heard that @@color:cyan;Julius's@@ taken a liking to you. Just like @@color:cyan;Cookie@@, getting on his good side will make it so " +
                "that he offers you more drugs for sale and at cheaper prices as well. You'll need those drugs if you want to be able to optimize your earning potential. " +
                "Here, have these samples and you'll see what I mean. Just be careful, using too many drugs will increase your @@color:yellow;Toxicity@@, basically they're poison. " +
                "Just as you'd expect, if you're poisoned, not only will you not heal effectively, but you'll eventually take damage over time.",
                "JOURNAL_ENTRY": "You've been tasked by NPC_NAME get on @@color:cyan;Julius's@@ good side. You'll need to make sure he's @@color:magenta;really cheerful@@.",
                "JOURNAL_COMPLETE": "It was difficult, but after days spent granting \"favors\" for Julius in the cargo hold, he's become quite fond of you. In the end it " +
                "paid off because not only did NPC_NAME give you a small reward, but now @@color:cyan;Julius@@ will occasionally sell you higher quality drugs."
            },
            "Q005": {
                "ID": "Q005", "Title": "Build a Better Bimbo - Part 1",
                "GIVER": "Captain",
                "PRE": [],
                "POST": [
                    // Flags that are set when quest is completed.
                ],
                "CHECKS": [
                    {"TYPE": "STAT_BODY", "NAME": "Bust", "VALUE": 11},
                    {"TYPE": "STAT_BODY", "NAME": "Lips", "VALUE": 32},
                    {"TYPE": "STAT_BODY", "NAME": "Ass", "VALUE": 11}
                ],
                "REWARD": [
                    {"REWARD_TYPE": "ITEM", "TYPE": "CLOTHES", "NAME": "fashion corset", "AMOUNT": 1},
                    {"REWARD_TYPE": "ITEM", "TYPE": "CLOTHES", "NAME": "pirate hat", "AMOUNT": 1}
                ],
                "INTRO": "NPC_NAME says, \"You're going to have a lot of trouble earning the coin you need looking like that.\"\n\n" +
                "He looks you up and down, it's obvious he isn't pleased by what he sees.\n\n" +
                "NPC_NAME clears his throat and continues, \"It's like this PLAYER_NAME, a whore's earning potential is a combination of both her " +
                "skills and looks. You can get the skills by practice, but the looks... well that's a whole other story.\"\n\n" +
                "You're not quite sure you like the direction this conversation is heading in, but it's hard to deny the logic of it. Even you wouldn't " +
                "fuck yourself (as a girl) looking how you do.\n\n" +
                "\"Anyway,\" says NPC_NAME, \"There are some ways to get around this. We're a pirate ship, so we smuggle a lot of goods and some of those goods " +
                "have some pretty serious effects on the human body - why don't you see if @@color:cyan;Julius@@ or @@color:cyan;Cookie@@ have anything they can sell " +
                "you that might help. If you come back to me with some @@color:yellow;ample breasts@@, @@color:yellow;feminine lips@@ and at least a @@color:yellow;small ass@@ " +
                "then even I might fuck you... and I have to tell ya, I pay a lot better than the crew.\"\n\n" +
                "You consider NPC_NAME's offer. You're not sure if you want to alter your body that much, but earning the money for your freedom takes priority...",
                "MIDDLE": "NPC_NAME takes one look at you and says, \"Hmm, what is it? Not quite there yet are we? Come back to me when you at least " +
                "resemble something close to a proper slut.\"",
                "FINISH": "NPC_NAME says, \"Oooer, lookie here. Our little PLAYER_NAME is turning into a right and proper bimbo slut. With a body like that you'll " +
                "find yourself earning far more coin than usual. Men will pay a lot more to fuck a huge pair of tits, or a large jiggling ass and of course, a pair of " +
                "massive cock sucking lips is a great advertisement for your dick sucking skills.\"\n\n" +
                "You know that he's just stating the obvious, but from where you stand you've witnessed it first hand. As your \"womanly assets\" have grown, so has your financial assets. " +
                "It's shameful, but you have to admit that taking NPC_NAME's advice has paid off... literally.\n\n" +
                "NPC_NAME looks at you and smiles, \"Here slut, have a little something to help you on your way, and if you ever want to earn some good coin " +
                "stop by my cabin for some 'play time'.\"",
                "JOURNAL_ENTRY": "You've been told to increase your physical assets so that you have some @@color:yellow;shapely breasts@@, " +
                "@@color:yellow;puckered lips@@ and at least a @@color:yellow;rounded ass@@. Doing so will increase your favor with the Captain.",
                "JOURNAL_COMPLETE": "You've discovered that the food and drugs you consume can alter your body in the most amazing ways. " +
                "Through trial and error you managed to increase the size of your breasts, lips and ass to proportions where your customers are willing to pay " +
                "far more for your services than before. In addition to this, the Captain will now be available as a potential customer."
            },
            "Q006": {
                "ID": "Q006", "Title": "Build a Better Bimbo - Part 2",
                "GIVER": "Captain",
                "PRE": [
                    "Q005"
                ],
                "POST": [
                    // Flags that are set when quest is completed.
                ],
                "CHECKS": [
                    {"TYPE": "STAT_BODY", "NAME": "Face", "VALUE": 39},
                    {"TYPE": "STAT_BODY", "NAME": "-Waist", "VALUE": 40},
                    {"TYPE": "STAT_BODY", "NAME": "Hair", "VALUE": 20}
                ],
                "REWARD": [
                    {"REWARD_TYPE": "ITEM", "TYPE": "DRUGS", "NAME": "healing potion", "AMOUNT": 3},
                    {"REWARD_TYPE": "ITEM_CHOICE", "TYPE": "DRUGS", "NAME": "face cream", "AMOUNT": 10},
                    {"REWARD_TYPE": "ITEM_CHOICE", "TYPE": "DRUGS", "NAME": "hair tonic", "AMOUNT": 10}
                ],
                "INTRO": "NPC_NAME says, \"Well, if it isn't the crews favorite sissy. You're definitely looking a better these days, but I think you " +
                "could do better. No, you will do better.\"\n\n" +
                "NPC_NAME gets an evil glare in his eye as he looks you up and down. He slowly reaches out a hand, cupping one of your breasts and giving it a firm squeeze.\n\n" +
                "NPC_NAME says, \"Not bad, not bad at all. But that face... that waist and that hair. It just simply doesn't do. Go and get some more work done slut, that's " +
                "an order from the Captain. Return when you're looking a bit more presentable and I'll give ye a fine little present.\"\n\n" +
                "NPC_NAME has made good on his offers so far and his advice, as much as you hate it, has helped you earn a fair amount of coin. What should you do?",
                "MIDDLE": "NPC_NAME takes one look at you and says, \"Hmm, what is it? Not quite there yet are we? Come back to me when you at least " +
                "resemble something close to a proper slut.\"",
                "FINISH": "NPC_NAME says, \"Not bad, not bad. That face won't win you any prizes... well, at least not yet, but we can discuss that later. Still, you've come a " +
                "long way from when you started aboard this ship, and I dare say you have quite a bit further to go until you can buy your freedom. But never mind that, take these " +
                "items. They'll help you perform your duties and increase your earning potential.\"",
                "JOURNAL_ENTRY": "The Captain has told you to improve your physical appearance some more - namely your @@color:yellow;face@@, @@color:magenta;waist@@ and @@color:green;hair@@. " +
                "If you satisfy his inspection, he's promised to give you some more items that could help you earn more coin.",
                "JOURNAL_COMPLETE": "It wasn't easy, but you managed to satisfy the Captain's requirements for improving your physical appearance. You have to say, that you do agree with him in " +
                "one regard - looking as you do now, the amount of money you earn from whoring out your holes has improved dramatically from when you started... back when you still had some " +
                "vague sense of manhood. You just hope that after you're free that you can find a way to reverse all the transformations you've gone through."
            },
            "Q007": {
                "ID": "Q007", "Title": "Build a Better Bimbo - Part 3",
                "GIVER": "Captain",
                "PRE": [
                    "Q006"
                ],
                "POST": [
                    // Flags that are set when quest is completed.
                ],
                "CHECKS": [
                    {"TYPE": "STAT_BODY", "NAME": "Bust", "VALUE": 39},
                    {"TYPE": "STAT_BODY", "NAME": "Ass", "VALUE": 39},
                    {"TYPE": "STAT_BODY", "NAME": "-Waist", "VALUE": 30},
                    {"TYPE": "STAT_BODY", "NAME": "Face", "VALUE": 59},
                    {"TYPE": "STAT_BODY", "NAME": "Lips", "VALUE": 54}
                ],
                "REWARD": [
                    {"REWARD_TYPE": "ITEM", "TYPE": "CLOTHES", "NAME": "knee boots", "AMOUNT": 1},
                    {"REWARD_TYPE": "ITEM", "TYPE": "CLOTHES", "NAME": "silk blouse", "AMOUNT": 1},
                    {"REWARD_TYPE": "ITEM", "TYPE": "CLOTHES", "NAME": "leather shorts", "AMOUNT": 1},
                    {"REWARD_TYPE": "ITEM", "TYPE": "FOOD", "NAME": "milkdew melon", "AMOUNT": 4},
                    {"REWARD_TYPE": "ITEM", "TYPE": "FOOD", "NAME": "butter gourd", "AMOUNT": 4},
                    {"REWARD_TYPE": "ITEM", "TYPE": "FOOD", "NAME": "honey mead", "AMOUNT": 4},
                    {"REWARD_TYPE": "ITEM_CHOICE", "TYPE": "DRUGS", "NAME": "succubus philtre", "AMOUNT": 1},
                    {"REWARD_TYPE": "ITEM_CHOICE", "TYPE": "DRUGS", "NAME": "nereid philtre", "AMOUNT": 1}

                ],
                "INTRO": "NPC_NAME says, \"Right, PLAYER_NAME, I was wondering when you'd come to see me...\"\n\n" +
                "NPC_NAME deftly puts an arm around your shoulder and leads you to his desk. He takes a seat and pulls you down into his lap.\n\n" +
                "NPC_NAME says, \"So my little sissy girl, did you come for play time or are you finally ready to take the next step?\"\n\n" +
                "\"The next step?\" @@color:DeepPink;you say@@, curious as to what the Captain has planned...\n\n" +
                "NPC_NAME chortles and cups your breasts with his hands as he grinds his crotch into your ass on his lap. The ring on his finger glows and despite yourself, you " +
                "feel a flush of arousal course through your body. You let out a small gasp and a moan as his nimble fingers start pulling on your stiff nipples.\n\n" +
                "\"It's easy, well for an easy slut like you...\" he says, \"Let's just consider it an expansion of existing assets... Grow your tits into @@color:cyan;truly huge@@ fuck pillows, " +
                "@@color:cyan;inflate that ass@@ until it's irresistibly fuckable and lastly, get some @@color:magenta;cock sucking lips@@ on a @@color:magenta;pretty face@@.\"\n\n" +
                "His words swim around in your head and as he continues to fondle and arouse you, the idea of becoming even more of a perfect fuck doll starts to enrapture your brain.\n\n" +
                "NPC_NAME gropes you, causing you to gasp and then he adds, \"Do this for me my little fuckslut and I'll give you a very nice reward.",
                "MIDDLE": "NPC_NAME commands that you stand in front of him and kneel. Once you are on your knees he begins his inspection, thoroughly prodding and groping your slutty body.\n\n" +
                "NPC_NAME says, \"You're not quite ready slut, but you're coming along nicely. Keep at it and make me proud.\"",
                "FINISH": "You enter NPC_NAME's quarter and assume a position of submission at his feet. You know this is what he prefers and it's come to be almost what you prefer as well. He " +
                "walks over to inspect you, his hand freeing your massive tits from your clothes and his fingers pulling painfully on your nipples. You find it both humiliating as well as erotic. " +
                "NPC_NAME commands you to bend over his desk and he unclothes your bottom, giving it a sound slap to watch it jiggle. He chuckles to himself, seemingly amused and does it again. The " +
                "impromptu spanking turns you on and you involuntarily feel your sissy fuckhole start to gape - an action that doesn't go unnoticed by the Captain.\n\n" +
                "NPC_NAME says, \"Getting turned on by this much? My, you really are turning into a proper bimbo slut, aren't you? Don't worry, I'll give you what you need.\"\n\n" +
                "He then proceeds to fish his massive cock out of pants and press the stiffening member against your slutty asshole. It doesn't take long before he's worked his tool up into " +
                "your rectum and is pounding away at you furiously. The feeling of his engorged member rampaging inside you turns your already horny body into overdrive and within minutes you are " +
                "gasping and panting in a mixture of pleasure and pain. \"You love this cock don't you?\" NPC_NAME asks you as he slaps your ass. When you're late in responding, he slaps it harder causing " +
                "you to yelp out a hasty, \"@@color:DeepPink;YES SIR!@@\" to which he responds, \"What is it you love slut?\" This time you don't delay and scream out, \"@@color:DeepPink;YOUR COCK UP MY BUTT SIR! I LOVE IT! I LOVE COCK!@@\" " +
                "This seems to satisfy NPC_NAME as he picks up the pace, plowing your butt hole with abandon. He grabs your hair, pulling your head backwards and driving his thick dick deep inside you. " +
                "The sensation is intense, the pain and the humiliation adding a dark undertone that sends you over the edge, your own sissy clit leaking cum onto the floor as NPC_NAME deposits load after " +
                "load of hot jizz up your ravaged ass.\n\n" +
                "Once you've collected yourself, you find the Captain throwing something at you.\n\n" +
                "\"Here, take this,\" he says. \"You'll find it useful and as a top tier slut, you should always be advertising your wares.\"",
                "JOURNAL_ENTRY": "The Captain has told you to improve your physical appearance some more - namely your @@color:magenta;face@@, @@color:cyan;ass@@, @@color:cyan;tits@@ and @@color:magenta;lips@@. " +
                "If you satisfy his inspection, he's promised to give you a reward... you hope it's one you'll like.",
                "JOURNAL_COMPLETE": "You managed to complete the Captain's quest and in the process have been turned into almost the perfect fuck doll. From when you started, a slightly boyish " +
                "looking young man, you've ended up as a slutty bimbo with huge tits, a jiggling ass and a pair of lips that could suck off a horse. Very few \"natural\" women could compete with " +
                "you when it comes to looks and technique, it'd be fitting to say that you're a Queen of a Whore."
            },
            "STRIPPING": {
                "ID": "STRIPPING", "Title": "The Casting Couch",
                "GIVER": "Cook",
                "PRE": [
                    "Q005"
                ],
                "POST": [
                    // Flags that are set when quest is completed.
                ],
                "CHECKS": [
                    {"TYPE": "STAT_SKILL", "NAME": "Dancing", "VALUE": 20},
                    {"TYPE": "STAT_CORE", "NAME": "Fitness", "VALUE": 30},
                    {"TYPE": "STAT_CORE", "NAME": "Femininity", "VALUE": 30},
                    {"TYPE": "STAT_SKILL", "NAME" : "Seduction", "VALUE" : 30}
                ],
                "REWARD": [
                    {"REWARD_TYPE": "ITEM", "TYPE": "CLOTHES", "NAME": "stripper costume", "AMOUNT": 1},
                    {"REWARD_TYPE": "ITEM", "TYPE": "COSMETICS", "NAME": "hair accessories", "AMOUNT": 20},
                    {"REWARD_TYPE": "ITEM", "TYPE": "COSMETICS", "NAME": "hair products", "AMOUNT": 20},
                    {"REWARD_TYPE": "ITEM", "TYPE": "COSMETICS", "NAME": "expensive makeup", "AMOUNT": 30}
                ],
                "INTRO": "NPC_NAME says, \"Nice to see you're putting some meat on those bones PLAYER_NAME.\" He eyes you up and down, his gaze lingering on your tits and ass. "+
                "\"And I gotta say, it's all going to the right places too.\"\n\n"+
                "You know what NPC_NAME is talking about - the rare food and drugs on board the @@color:cyan;Salty Mermaid@@ have started to make dramatic alterations to your body, "+
                "right down to a hormonal level. You'd almost wouldn't believe such dramatic changes were possible, but the pBUST tits you are dragging around beg otherwise. If only you could "+
                "find some more wholesome source of nourishment... but maybe it's too late? NPC_NAME interrupts these thoughts and continues speaking.\n\n"+
                "\"If you feel like earning some extra coin, then you might consider putting on a show.\" He motions across the Galley dining room to a small raised dias against the aft wall. "+
                "NPC_NAME says, \"We used to have a proper slut on crew and she'd put on the best stripping and burlesque shows for the boys in the evening. It'd really drive them wild and make "+
                "horny as hell. You might think about it.\"\n\n"+
                "As humiliating as it sounds, being a dancing girl is probably a step up from a whore. Still, chances are with the way you are looking these days there isn't really that "+
                "much of a difference. Still, you wonder if the tips would be good...\n\n"+
                "NPC_NAME says, \"You can use the stage to practice in the mornings and when you think you've got a decent routine come back and see me. I'll give you an 'audition' and if you pass "+
                "then I'll let you perform during the evenings for some extra coin. You may also want to think about getting in better shape - although your dance practice might help with that you "+
                "could also benefit from doing some more physical labor. Maybe something down in the cargo hold?\"",
                "MIDDLE": "NPC_NAME says, \"Don't take it the wrong way sweet tits, but I don't think you have the right 'stuff' yet in order to make it on stage. Keep working on it and come back.\"",
                "FINISH": "You approach NPC_NAME and request that he give you your 'audition' for the role of the only sissy-stripper on board the @@color:cyan;Salty Mermaid@@. NPC_NAME and half of the "+
                "kitchen staff take up seats around the Galley as you get on the stage. One of the cooks, an older man with a strange hat begins to play a raunchy tune on an even older piano that has been "+
                "recently rolled into place. You start off your gyrations a little awkwardly, trying to get in tune with the music. Each time it comes up to an exclamation, you make sure to stick out either "+
                "your pBUST tits or pASS ass with a shake and a jiggle to put extra emphasis on them. As the song progresses you start taking off more and more clothes, trying to do it in a flirty and teasing "+
                "way, smiling and winking at the audience. By now the men are clapping their hands and hooting as you are gyrating your pBUST tits at them, each nipple has a small tassel firmly attached to it "+
                "and you are swinging them counter clockwise in an alternating motion. By now everyone is fully into the show and although you're still quite the novice you feel that you have a good grasp of "+
                "how this should work. You finish off by bending over, your pBUST tits dangling towards the floor and simulating getting butt fucked in tempo to the beat of the music. As you grope and fondle "+
                "yourself and let out a series of moans, the audience is getting increasingly agitated. It's no mistake that they all want to fuck you right now.\n\n"+
                "You finish the show with a wink and a blown kiss to the crowd and they all applaud as you fetch your discarded clothing. NPC_NAME comes up to you and says, \"Well done PLAYER_NAME. "+
                "I had my doubts when I first saw you, but you're going to be a fine slut for this crew. Here take these, they'll help you perform better on stage... oh and by the way, you now "+
                "can come here and put on shows during the evenings every day. Just be careful, you might drive the men so wild that they'll fuck your asshole inside out!\"",
                "JOURNAL_ENTRY": "NPC_NAME has told you that you can @@color:orange;use the stage in the Galley to practice your dancing in the mornings@@. If you improve your abilities enough "+
                "then you will be able to put on shows in the evening for tips.",
                "JOURNAL_COMPLETE": "Your 'audition' for the cooking crew was a wild success. You bumped and wiggled yourself into their hearts, or at least you made their dicks hard for you. From now "+
                    "on you can perform on the stage during the evenings for extra coin and to raise the lust of the crew."
            },
        "THEBACKDOOR": {
            "ID": "THEBACKDOOR", "Title": "The Backdoor",
            "GIVER": "Jarvis",
            "PRE": [
                // Flags that are required to trigger quest.
            ],
            "POST": [
                // Flags that are set when quest is completed.
            ],
            "CHECKS": [
                {"TYPE": "FLAG", "NAME": "FuckedJarvisSilly", "VALUE": true}
            ],
            "REWARD": [
            ],
            "PREREQ": "Said when you don't have the pre-req for the quest.",
            "INTRO": "You approach NPC_NAME and give him what you hope is a graceful curtsy.\n\n\"@@color:DeepPink;Excuse me sir@@\", you speak, \"@@color:DeepPink;Is there anyway I could come and visit his Lordship? It's a matter of urgent importance.@@\"\n\n"+
            "NPC_NAME takes one look at you and raises his eyebrow. \"@@color:Cyan;Sorry miss, but his Lordship is not currently taking visitors@@\". He pauses for a moment and then adds, \"@@color:Cyan;Or accepting services, of a particular kind...@@\"\n\n"+
            "It's pretty obvious that the stuffy old bastard means that the Governor isn't looking for a whore. You're not sure if you should be insulted or not, particularly considering how you've been spending your "+
            "time recently. In any case, you'll have to come up with some sort of plan in order to gain access to the Governor.",
            "MIDDLE": "NPC_NAME says, \"@@color:Cyan;Sorry@@ PLAYER_NAME... @@color:Cyan;but the Governor is still not taking visitors. Please come back in a few days.@@\"",
            "FINISH": "Should never show up.",
            "JOURNAL_ENTRY": "There must be some way to gain access to the Governor or at least entrance to the Mansion after hours. You'll have to keep your eyes open for an opportunity.",
            "JOURNAL_COMPLETE": "Using a combination of alcohol and your whorish skills, you were able to completely exhaust Jarvis and loot him of his house key. You can now come and go into the mansion after dark via the back door."
        },
    "DADDYSGIRL": {
        "ID": "DADDYSGIRL", "Title": "Daddy's Little Girl",
        "GIVER": "LordRowe",
        "PRE": [
            // Flags that are required to trigger quest.
        ],
        "POST": [
            // Flags that are set when quest is completed.
        ],
        "CHECKS": [
            {"TYPE": "STYLE_CATEGORY", "NAME": "Daddy's Girl", "VALUE": 100 },
            {"TYPE": "HAIR_STYLE", "NAME": "cute pig tails", "VALUE": true },
            {"TYPE": "HAIR_COLOR", "NAME": "blond", "VALUE": true }
        ],
        "REWARD": [
        ],
        "PREREQ": "Said when you don't have the pre-req for the quest.",
        "INTRO": "You walk up to NPC_NAME and give him a deep curtsy, taking special care to thrust out your pBUST cleavage to draw his eye. He looks up at you apprehensively and for a moment you can catch the tiredness in his eyes. Clearly he has been losing sleep over the disappearance of his daughter.\n\n" +
        "You introduce yourself and step forward. @@color:DeepPink;\"Excuse me my Lord, but I've come to ask for a boon@@,\" you state as NPC_NAME eyes you up and down. It's clear from the look on his face that he has already surmised much about your current station in life.\n\n" +
        "\"@@color:Cyan;And what would a 'lady' such as yourself need from me? Can't you see that I am lost in my grief for my precious missing daughter? Begone harlot!@@\" he exclaims, his hands motioning for the door.\n\n"+
        "That could have gone better. Perhaps there might be some other way to get his attention, such as preying on his obsession with GF_NAME...",

        "MIDDLE": "NPC_NAME says, \"@@color:Cyan;I thought I told you to leave. Be gone and leave me to my grief!@@\"",
        "FINISH": "NPC_NAME looks up from his desk and takes you in. For a moment he seems puzzled and it's obvious that your superficial resemblance to GF_NAME was playing on his mind.\n\n" +
            "\"@@color:Cyan;Excuse me my dear, but why are you here? Did you get lost?@@\" he asks. Without hesitating you flounce your way over and sit on his lap, \"@@color:DeepPink;Oooph!@@\" you let out in an high voice, followed quickly by a girlish giggle.\n\n"+
            "\"@@color:DeepPink;Sowwy... It wooks wike I wost my Daddy and I can't find him anywhere. Hey mistah, would you be my new Daddy?@@\" you say, while making a show of wiggling your butt on NPC_NAME's lap. It doesn't take long before you feel something hard pushing back.\n\n" +
            "\"@@color:Cyan;What a shame little one... I'm sure we can come to some sort of... agreement.@@\" he replies, his hands gently encircling your waist. You giggle again lightly and return his embrace.\n\n" +
            "It appears your attire, a perfect mix between perversity and coquettishness has captured his attention. Now what do you do?",
        "JOURNAL_ENTRY": "NPC_NAME seems caught up in his grief for his missing daughter. Perhaps if you were to alter your appearance in a way that might draw out his 'fatherly' instincts, he might become more compliant?",
        "JOURNAL_COMPLETE": "It seems that @@color:Cyan;Lord Rowe's@@ obsession with GF_NAME had a rather 'abnormal' aspect to it. Once you changed your appearance, he was more than happy to listen to you... so long as you sit on his lap like a good little girl. In addition, you can gain access to his study at any hour of the day."
    }
    };
/* twine-user-script #13: "StoreData.js" */
window.App = window.App || { Data: { }, Entity: { } };

window.App.Data.Stores =  {
    "CARGO" : {
        "ID" : "CARGO",     "NAME" : "Julius's Secret Stash", "OPEN" : [2, 3], "RESTOCK" : 7,
        "INVENTORY" : [
            { "CATEGORY":   "COMMON",   "TYPE": "DRUGS",    "QTY":    4,    "MAX":    4,  "PRICE":    50, "MOOD":  0,   "LOCK": 0,  "TAG" : "pixie dust"            },
            { "CATEGORY":   "COMMON",   "TYPE": "DRUGS",    "QTY":    4,    "MAX":    4,  "PRICE":    50, "MOOD": 20,   "LOCK": 0,  "TAG" : "medicinal herbs"       },
            { "CATEGORY":   "COMMON",   "TYPE": "DRUGS",    "QTY":    4,    "MAX":    4,  "PRICE":    25, "MOOD": 40,   "LOCK": 0,  "TAG" : "fairy dust"            },
            { "CATEGORY":   "COMMON",   "TYPE": "DRUGS",    "QTY":    2,    "MAX":    2,  "PRICE":   150, "MOOD": 80,   "LOCK": 0,  "TAG" : "face cream"            },
            { "CATEGORY":   "COMMON",   "TYPE": "DRUGS",    "QTY":    2,    "MAX":    2,  "PRICE":   100, "MOOD": 20,   "LOCK": 1,  "TAG" : "khafkir"               },
            { "CATEGORY":   "COMMON",   "TYPE": "DRUGS",    "QTY":    1,    "MAX":    1,  "PRICE":   500, "MOOD": 60,   "LOCK": 1,  "TAG" : "siren elixir"          },
            { "CATEGORY":   "RARE",     "TYPE": "DRUGS",    "QTY":    2,    "MAX":    2,  "PRICE":    50, "MOOD": 60,   "LOCK": 0,  "TAG" : "hair tonic"            },
            { "CATEGORY":   "RARE",     "TYPE": "FOOD",     "QTY":    2,    "MAX":    2,  "PRICE":   100, "MOOD": 60,   "LOCK": 0,  "TAG" : "starfruit"             },
            { "CATEGORY":   "RARE",     "TYPE": "DRUGS",    "QTY":    1,    "MAX":    1,  "PRICE":  2500, "MOOD": 80,   "LOCK": 0,  "TAG" : "nereid philtre"        },
            { "CATEGORY":   "RARE",     "TYPE": "DRUGS",    "QTY":    1,    "MAX":    1,  "PRICE":  2500, "MOOD": 80,   "LOCK": 0,  "TAG" : "succubus philtre"      }
        ]
    },
    "GALLEY" : {
        "ID" : "GALLEY",    "NAME" : "Salty Mermaid Galley",  "OPEN" : [0, 1, 2, 3], "RESTOCK" : 7,
        "INVENTORY" : [
            { "CATEGORY":   "COMMON",   "TYPE": "FOOD",    "QTY":   12,     "MAX":   12,  "PRICE":    10, "MOOD":  0,   "LOCK": 0,  "TAG" : "slave gruel"            },
            { "CATEGORY":   "COMMON",   "TYPE": "FOOD",    "QTY":    8,     "MAX":    8,  "PRICE":     8, "MOOD":  0,   "LOCK": 0,  "TAG" : "grog"                   },
            { "CATEGORY":   "COMMON",   "TYPE": "FOOD",    "QTY":    4,     "MAX":    4,  "PRICE":    25, "MOOD": 20,   "LOCK": 0,  "TAG" : "mystery stew"           },
            { "CATEGORY":   "COMMON",   "TYPE": "FOOD",    "QTY":    2,     "MAX":    2,  "PRICE":   100, "MOOD": 40,   "LOCK": 0,  "TAG" : "starfruit"              },
            { "CATEGORY":   "COMMON",   "TYPE": "FOOD",    "QTY":    2,     "MAX":    2,  "PRICE":   175, "MOOD": 65,   "LOCK": 0,  "TAG" : "pink peach"             },
            { "CATEGORY":   "RARE",     "TYPE": "FOOD",    "QTY":    1,     "MAX":    1,  "PRICE":   100, "MOOD": 60,   "LOCK": 0,  "TAG" : "milkdew melon"          },
            { "CATEGORY":   "RARE",     "TYPE": "FOOD",    "QTY":    1,     "MAX":    1,  "PRICE":   100, "MOOD": 80,   "LOCK": 0,  "TAG" : "honey mead"             },
            { "CATEGORY":   "RARE",     "TYPE": "FOOD",    "QTY":    1,     "MAX":    1,  "PRICE":   140, "MOOD": 80,   "LOCK": 0,  "TAG" : "butter gourd"           }
        ]
    },
    "ISLATAVERN" : {
        "ID" : "ISLATAVERN",    "NAME" : "Isla Harbor Tavern",  "OPEN" : [1, 2, 3, 4], "RESTOCK" : 7,
        "INVENTORY" : [
            { "CATEGORY":   "COMMON",   "TYPE": "FOOD",    "QTY":   12,     "MAX":   12,  "PRICE":    16, "MOOD":  0,   "LOCK": 0,  "TAG" : "beer"                   },
            { "CATEGORY":   "COMMON",   "TYPE": "FOOD",    "QTY":   12,     "MAX":   12,  "PRICE":    20, "MOOD":  0,   "LOCK": 0,  "TAG" : "cheap wine"             },
            { "CATEGORY":   "COMMON",   "TYPE": "FOOD",    "QTY":    4,     "MAX":    4,  "PRICE":    50, "MOOD":  0,   "LOCK": 0,  "TAG" : "bread and cheese"       },
            { "CATEGORY":   "COMMON",   "TYPE": "FOOD",    "QTY":    4,     "MAX":    4,  "PRICE":    50, "MOOD":  0,   "LOCK": 0,  "TAG" : "roast fish"             },
            { "CATEGORY":   "COMMON",   "TYPE": "FOOD",    "QTY":   12,     "MAX":   12,  "PRICE":    60, "MOOD":  0,   "LOCK": 0,  "TAG" : "rum"                    }
        ]
    },
    "ISLASTORE" : {
        "ID" : "ISLASTORE",    "NAME" : "Isla Harbor General Store",  "OPEN" : [0, 1, 2, 3], "RESTOCK" : 7,
        "INVENTORY" : [
            { "CATEGORY":   "COMMON",   "TYPE": "COSMETICS",    "QTY":    5,     "MAX":    5,  "PRICE":    20, "MOOD":  0,   "LOCK": 0,  "TAG" : "basic makeup"             },
            { "CATEGORY":   "COMMON",   "TYPE": "COSMETICS",    "QTY":    5,     "MAX":    5,  "PRICE":    20, "MOOD":  0,   "LOCK": 0,  "TAG" : "hair products"            },
            { "CATEGORY":   "COMMON",   "TYPE": "FOOD",         "QTY":    5,     "MAX":    5,  "PRICE":  1000, "MOOD":  0,   "LOCK": 0,  "TAG" : "fortified wine"           },
            { "CATEGORY":   "COMMON",   "TYPE": "CLOTHES",      "QTY":    1,     "MAX":    1,  "PRICE":   300, "MOOD":  0,   "LOCK": 0,  "TAG" : "wig"                      },
            { "CATEGORY":   "COMMON",   "TYPE": "CLOTHES",      "QTY":    1,     "MAX":    1,  "PRICE":   200, "MOOD":  0,   "LOCK": 0,  "TAG" : "sundress"                 },
            { "CATEGORY":   "COMMON",   "TYPE": "CLOTHES",      "QTY":    1,     "MAX":    1,  "PRICE":   160, "MOOD":  0,   "LOCK": 0,  "TAG" : "striped bra"              },
            { "CATEGORY":   "COMMON",   "TYPE": "CLOTHES",      "QTY":    1,     "MAX":    1,  "PRICE":   160, "MOOD":  0,   "LOCK": 0,  "TAG" : "striped panties"          },
            { "CATEGORY":   "COMMON",   "TYPE": "CLOTHES",      "QTY":    1,     "MAX":    1,  "PRICE":   150, "MOOD":  0,   "LOCK": 0,  "TAG" : "striped stockings"        },
            { "CATEGORY":   "RARE",     "TYPE": "CLOTHES",      "QTY":    1,     "MAX":    1,  "PRICE":   300, "MOOD":  0,   "LOCK": 0,  "TAG" : "frilly bloomers"          },
            { "CATEGORY":   "RARE",     "TYPE": "CLOTHES",      "QTY":    1,     "MAX":    1,  "PRICE":   500, "MOOD":  0,   "LOCK": 0,  "TAG" : "frilly dress"             },
            { "CATEGORY":   "RARE",     "TYPE": "CLOTHES",      "QTY":    1,     "MAX":    1,  "PRICE":   250, "MOOD":  0,   "LOCK": 0,  "TAG" : "pink mary janes"          },
            { "CATEGORY":   "RARE",     "TYPE": "CLOTHES",      "QTY":    1,     "MAX":    1,  "PRICE":   400, "MOOD":  0,   "LOCK": 0,  "TAG" : "pink platform mary janes" },
            { "CATEGORY":   "RARE",     "TYPE": "CLOTHES",      "QTY":    1,     "MAX":    1,  "PRICE":   120, "MOOD":  0,   "LOCK": 0,  "TAG" : "pink head bow"            }
        ]
    }
};
/* twine-user-script #14: "Story JavaScript" */
//Sugarcube config
Config.history.controls = false;</script><tw-passagedata pid="1" name="Cabin" tags="" position="100,100">&lt;&lt;script&gt;&gt;$(&quot;#story-caption&quot;).show();&lt;&lt;/script&gt;&gt;\
Your &quot;Cabin&quot; is really a converted jail cell used for holding prisoners, or in your case, slaves. It&#39;s been fitted with some old and decrepit furnishings, just enough amenities for you to begin your life as a whore. 

There is a large wooden wardrobe here that contains spare clothes and a vanity and mirror combination for taking care of your personal appearance.

@@color:cyan;Interact@@: [[Wardrobe]] | [[Vanity]] | [[Mirror]]
@@color:yellow;Action@@: &lt;&lt;if $Player.Phase &lt; 3&gt;&gt;&lt;&lt;if $Player.CoreStats[&quot;Energy&quot;] == $Player.GetMaxStat(&quot;STAT&quot;,&quot;Energy&quot;);&gt;&gt;@@color:grey;[Rest]@@&lt;&lt;else&gt;&gt;[[Rest]]&lt;&lt;/if&gt;&gt;&lt;&lt;else&gt;&gt;[[Sleep]]&lt;&lt;/if&gt;&gt;
@@color:lime;Travel@@: [[Deck]]

[[Stat Test]]</tw-passagedata><tw-passagedata pid="2" name="Captain" tags="" position="225,100">The captains quarters are spacious, at least by the standards of this ship. There is a large glass window against the aft side of the room and plush velvet drapes hanging from the walls. The furniture itself is old, but well maintained and the Captain is known for his expensive tastes.

&lt;&lt;NPC &quot;Captain&quot;&gt;&gt;

@@color:lime;Travel@@: [[Deck]]</tw-passagedata><tw-passagedata pid="3" name="Cargo" tags="" position="350,100">The cargo hold of the Salty Mermaid is a dank and musty area shrounded in darkness. Rows and rows of crates and barrels line the floors with an odd assortment of plundered &quot;goods&quot; spilling from them. Most of it looks like garbage, but you never know what you&#39;ll find if you look long enough.

&lt;&lt;NPC &quot;Quartermaster&quot;&gt;&gt;

@@color:lime;Travel@@: [[Deck]]</tw-passagedata><tw-passagedata pid="4" name="Deck" tags="" position="475,100">This is the main deck of the Salty Mermaid. This area is usually busy during most times of the day and evening as men either go about their jobs or take the occasional break to gamble or relax. From here you can travel to other areas of the ship, or prostitute yourself for some coin.

@@color:yellow;Action@@: &lt;&lt;if $Player.GetStat(&quot;STAT&quot;,&quot;Energy&quot;) &lt; 1 or $Player.Phase == 4 or window.App.QuestEngine.GetQuestFlag($Player, &quot;Q001&quot;) != &quot;COMPLETED&quot;&gt;&gt;@@color:grey;[Whore]@@&lt;&lt;else&gt;&gt;&lt;&lt;customMenuLink &quot;Whore&quot; &quot;Crew&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $Player.Phase == 4&gt;&gt;\
@@color:lime;Travel@@: [[Cabin]] | @@color:grey;[Ships Helm]@@ | @@color:grey;[Galley]@@ | @@color:grey;[Cargo Hold]@@ | @@color:grey;[Captain&#39;s Quarters]@@
&lt;&lt;else&gt;&gt;\
@@color:lime;Travel@@: [[Cabin]] | [[Ships Helm|FirstMate]] |  [[Galley]] | [[Cargo Hold|Cargo]] | [[Captain&#39;s Quarters|Captain]]
&lt;&lt;shipPortLink&gt;&gt;\
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="5" name="FirstMate" tags="" position="600,100">The helm of the Salty Mermaid is manned around the clock by a navigator and usually overseen by the First Mate. From here you have a commanding view of the decks and the scenery at sea. The crisp breeze and scent of the ocean assault your senses.

&lt;&lt;NPC &quot;FirstMate&quot;&gt;&gt;

@@color:lime;Travel@@: [[Deck]]</tw-passagedata><tw-passagedata pid="6" name="Galley" tags="" position="725,100">The galley is a small, but vital area on the ship. From here the cook and his helpers stock and prepare all the meals for the crew, working perpetually around the clock. While most of the crew takes their meals on the deck, there are rows of benches and tables scattered around as well as a small raised dias that looks something like a stage.

&lt;&lt;NPC &quot;Cook&quot;&gt;&gt;
&lt;&lt;jobLinks &quot;GALLEY&quot; 1&gt;&gt;
@@color:lime;Travel@@: [[Deck]]</tw-passagedata><tw-passagedata pid="7" name="Mirror" tags="" position="850,100">This is a well used full length mirror. Unlike most mirrors it&#39;s actually made out of silvered glass intead of metal. It&#39;s surprisingly expensive.

@@color:cyan;Interact:@@ [[Exit|Cabin]] | [[Vanity]] | [[Wardrobe]]

&lt;&lt;printPlayerDescription&gt;&gt;</tw-passagedata><tw-passagedata pid="8" name="Vanity" tags="" position="975,100">This is an old but massive vanity table complete with a small oval mirror. Obviously it was placed here by the Captain with the intent that you use it to make yourself &quot;pretty&quot; for the crew. If you had the right tools, you could style your hair and put on make-up here.

@@color:cyan;Interact@@: [[Exit|Cabin]] | [[Wardrobe]] | [[Mirror]]

&lt;span id=&quot;VanityUI&quot;&gt;&lt;&lt;printStyleDescription&gt;&gt;&lt;/span&gt;&lt;&lt;vanityMenu&gt;&gt;</tw-passagedata><tw-passagedata pid="9" name="Wardrobe" tags="" position="1100,100">You are standing infront of a large wooden wardrobe. It&#39;s obviously old and it&#39;s time at sea has caused it to rot away in places. This is where you can store and change your clothes.

@@color:cyan;Interact:@@ [[Exit|Cabin]] | [[Vanity]] | [[Mirror]]
&lt;span id=&quot;WardrobeUI&quot;&gt;&lt;&lt;WearingTable&gt;&gt;&lt;/span&gt;</tw-passagedata><tw-passagedata pid="10" name="GFVanity" tags="" position="1225,100">A tasteful vanity, suitable for a highborn lady. You could style your makeup and hair here if you choose.

@@color:cyan;Interact@@: [[Exit|GirlfriendRoom]] | [[Wardrobe|GFWardrobe]] | [[Mirror|GFMirror]]

&lt;span id=&quot;VanityUI&quot;&gt;&lt;&lt;printStyleDescription&gt;&gt;&lt;/span&gt;&lt;&lt;vanityMenu&gt;&gt;</tw-passagedata><tw-passagedata pid="11" name="GFMirror" tags="" position="1350,100">This elegant and clearly expensive full length mirror sits behind a large screen in the corner of the room. You take a moment to inspect yourself.

@@color:cyan;Interact:@@ [[Exit|GirlfriendRoom]] | [[Vanity|GFVanity]] | [[Wardrobe|GFWardrobe]]

&lt;&lt;printPlayerDescription&gt;&gt;</tw-passagedata><tw-passagedata pid="12" name="GFWardrobe" tags="" position="1475,100">&lt;&lt;set _QE = window.App.QuestEngine&gt;&gt;You are standing infront of a beautiful mahogany wardrobe. It&#39;s deep wood color is accentuated with what appears to be burnished brass and inlaid ivory. It&#39;s probably worth more than you are.
&lt;&lt;if _QE.QuestCompleted($Player, &quot;GFWARDROBE&quot;) == false&gt;&gt;
Opening the door, you find some items ...

a super short pink gingham dress
a pair of white knee socks
@@color:purple;a 14 inch purple dildo@@
@@color:purple;a portfolio of pornographic drawings@@
@@color:gold;1000 gold coins@@
&lt;&lt;run $Player.AddItem(&quot;CLOTHES&quot;, &quot;pink gingham dress&quot;, 1);&gt;&gt;\
&lt;&lt;run $Player.AddItem(&quot;CLOTHES&quot;, &quot;white knee socks&quot;, 1); &gt;&gt;\
&lt;&lt;run $Player.AddItem(&quot;QUEST&quot;, &quot;14 inch purple dildo&quot;, 1); &gt;&gt;\
&lt;&lt;run $Player.AddItem(&quot;QUEST&quot;, &quot;porno portfolio&quot;, 1); &gt;&gt;\
&lt;&lt;run $Player.AdjustMoney(1000);&gt;&gt;\
&lt;&lt;run _QE.SetQuestFlag($Player, &quot;GFWARDROBE&quot;, &quot;COMPLETED&quot;);&gt;&gt;
&lt;&lt;/if&gt;&gt;
@@color:cyan;Interact:@@ [[Exit|GirlfriendRoom]] | [[Vanity|GFVanity]] | [[Mirror|GFMirror]]
&lt;span id=&quot;WardrobeUI&quot;&gt;&lt;&lt;WearingTable&gt;&gt;&lt;/span&gt;</tw-passagedata><tw-passagedata pid="13" name="GirlfriendRoom" tags="" position="1600,100">&lt;&lt;set _GFN = $Player.GirlfriendName&gt;&gt;\
It looks like @@color:pink;&lt;&lt;=_GFN&gt;&gt;&#39;s@@ room hasn&#39;t been disturb since the night of your ill-fated departure. In fact, the room is practically immaculate as if not a single spec of dust has landed since. @@color:pink;&lt;&lt;=_GFN&gt;&gt;@@ always seemed to have particularly girly tastes and her room reflects this. Everything is colored a light rose and draped in voluminus fabrics.

@@color:cyan;Interact@@: [[Wardrobe|GFWardrobe]] | [[Vanity|GFVanity]] | [[Mirror|GFMirror]]
@@color:lime;Travel@@: [[Foyer|IslaMansion]]</tw-passagedata><tw-passagedata pid="14" name="GovernorStudy" tags="" position="1725,100">The Governor&#39;s study is just exactly how you imagined it would be - simple, but comfortable, much like the man himself. A large picture window hangs in the wall granting a view down upon the harbor and sitting in front of it is a solid oak desk that his Lordship the Governor uses for official purposes. 

&lt;&lt;NPC &quot;LordRowe&quot;&gt;&gt;

@@color:lime;Travel@@: [[Foyer|IslaMansion]]</tw-passagedata><tw-passagedata pid="15" name="IslaHarbor" tags="" position="1850,100">You are standing on the docks of Isla Harbor, your home town. There is a motley collection of sailors ambling around loading and unloading ships while occasionally visiting a local tavern. Off in the distance, up the hill, you can see the familiar sight of the town square.

@@color:lime;Travel@@: [[Back to The Mermaid|Deck]] | [[Town Square|IslaTown]] | [[Tavern|IslaTavern]]</tw-passagedata><tw-passagedata pid="16" name="IslaMansion" tags="" position="1975,100">&lt;&lt;set _GFN = $Player.GirlfriendName + &quot;&#39;s Room&quot;;&gt;&gt;\
&lt;&lt;set _GFL = $Player.GirlfriendName + &quot;&#39;s Room&quot;&gt;&gt;\
The Governors Mansion is the largest and most elegant building on Isla Harbor. You&#39;ve only been in a few times, mostly when $Player.GirlfriendName would sneak you past the house staff, but it&#39;s largely how you remember it - with high vaulted cielings, dark wood panelling and lush carpets covering the tiled floors. The Governor himself isn&#39;t much for such opulance, but as $Player.GirlfriendName explained to you, there&#39;s a certain level of extravagance that&#39;s expected with such a position in society.

&lt;&lt;if $Player.Phase &lt; 3&gt;&gt;&lt;&lt;NPC &quot;Jarvis&quot;&gt;&gt;

@@color:lime;Travel@@: [[Town Center|IslaTown]] | \
&lt;&lt;click _GFL&gt;&gt;\
&lt;&lt;replace &quot;#Notification&quot;&gt;&gt;\
As you attempt to gain entry into @@color:HotPink;&lt;&lt;print _GFL &gt;&gt;@@ the steward steps forward and blocks your way.

@@color:cyan;Jarvis@@ says, &quot;Excuse me, but I can&#39;t allow you to enter any further than this. The young miss isn&#39;t about but I dare say she wouldn&#39;t like you rifling through her things.&quot;

//Perhaps if there was some way to distract him...//
&lt;&lt;/replace&gt;&gt;\
&lt;&lt;/click&gt;&gt;\
 | \
&lt;&lt;if window.App.QuestEngine.GetQuestFlag($Player, &quot;DADDYSGIRL&quot;) == false&gt;&gt;\
&lt;&lt;click &quot;Study&quot;&gt;&gt;\
&lt;&lt;replace &quot;#Notification&quot;&gt;&gt;\
You move forward toward&#39;s the @@color:gold;Governor&#39;s Study@@, but the steward steps forward and blocks your way.

@@color:cyan;Jarvis@@ says, &quot;Sorry miss, but the Governor isn&#39;t taking any visitors now. He&#39;s quite distraught over the disappearance of his daughter.&quot;

//How can you convince him to let you through without exposing your embarassing identity?//
&lt;&lt;/replace&gt;&gt;\
&lt;&lt;/click&gt;&gt;\
&lt;&lt;else&gt;&gt;\
[[Study|GovernorStudy]]
&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;@@color:lime;Travel@@: [[Town Center|IslaTown]] | [[_GFN|GirlfriendRoom]] | [[Study|GovernorStudy]]
&lt;&lt;/if&gt;&gt;

&lt;span id=&quot;Notification&quot;&gt;&lt;/span&gt;</tw-passagedata><tw-passagedata pid="17" name="IslaStore" tags="" position="2100,100">This general store has seen better times, but despite it&#39;s obviously ancient age it is kept fastidously clean by it&#39;s proprieter. Rows of shelves and wooden bins line the walls and while the selection of goods isn&#39;t the widest, it&#39;s still the best stocked shop in Isla Harbor.

&lt;&lt;NPC &quot;IslaShopKeeper&quot;&gt;&gt;

@@color:lime;Travel@@: [[Town Square|IslaTown]]</tw-passagedata><tw-passagedata pid="18" name="IslaTavern" tags="" position="2225,100">Entering this tavern brings back bad memories of that fateful night when you first ran into Captain Reginald and his pirate crew. The place hasn&#39;t changed much since then, it&#39;s still dingy, dirty and thoroughly disreputable. 
&lt;&lt;if $Player.Phase &lt; 2&gt;&gt;\
The tavern is mostly quiet now, but business tends to pick up in the evening.&lt;&lt;else&gt;&gt;\
&lt;&lt;if $Player.Phase == 4&gt;&gt;\
It&#39;s late night so there aren&#39;t many patrons around.&lt;&lt;else&gt;&gt;\
The tavern is bustling and lively with many patrons clamoring for drink and food.&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;NPC &quot;IslaTavernKeeper&quot;&gt;&gt;
&lt;&lt;if $Player.Phase == 3&gt;&gt;&lt;&lt;NPC &quot;Jarvis&quot;&gt;&gt;&lt;&lt;/if&gt;&gt;
@@color:lime;Travel@@: [[The Docks|IslaHarbor]]</tw-passagedata><tw-passagedata pid="19" name="IslaTown" tags="" position="2350,100">The town center of Isla Harbor is exactly how you remembered it. People are strolling back and forth between their jobs and various businesses and luckily not paying too much attention to you. Not that you think anyone would recognize you in your current state, but at least it spares you from some embarassment. Further up on the hill you can see the Governors Mansion and behind you are the Docks.

&lt;&lt;if $Player.Phase &lt; 3&gt;&gt;\
@@color:lime;Travel@@: [[The Docks|IslaHarbor]] | [[General Store|IslaStore]] | [[Governors Mansion|IslaMansion]]
&lt;&lt;else&gt;&gt;\
&lt;&lt;if window.App.QuestEngine.GetQuestFlag($Player, &quot;THEBACKDOOR&quot;) == &quot;COMPLETED&quot;&gt;&gt;\
@@color:lime;Travel@@: [[The Docks|IslaHarbor]] | @@color:grey;[General Store]@@ | [[Governors Mansion|IslaMansion]]
&lt;&lt;else&gt;&gt;\
@@color:lime;Travel@@: [[The Docks|IslaHarbor]] | @@color:grey;[General Store]@@ | @@color:grey;[Governors Mansion]@@
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="20" name="Bazzar" tags="" position="2475,100">@@color:lime;Travel@@: [[Portside District|Portside]]</tw-passagedata><tw-passagedata pid="21" name="GI_CheapBrothel" tags="" position="2600,100">@@color:lime;Travel@@: [[Portside District|Portside]]</tw-passagedata><tw-passagedata pid="22" name="GI_Clothiers" tags="" position="2725,100">@@color:lime;Travel@@: [[High Hill District|HighHill]]</tw-passagedata><tw-passagedata pid="23" name="GI_DanceHall" tags="" position="2850,100">@@color:lime;Travel@@: [[High Hill District|HighHill]]</tw-passagedata><tw-passagedata pid="24" name="GI_GeneralGoods" tags="" position="2975,100">@@color:lime;Travel@@: [[Portside District|Portside]]</tw-passagedata><tw-passagedata pid="25" name="GI_GovernorsMansion" tags="" position="3100,100">@@color:lime;Travel@@: [[High Hill District|HighHill]]</tw-passagedata><tw-passagedata pid="26" name="GI_GuardStation" tags="" position="3225,100">@@color:lime;Travel@@: [[Portside District|Portside]] | [[Jail House|GI_Jail]] | [[High Hill District|HighHill]]</tw-passagedata><tw-passagedata pid="27" name="GI_Jail" tags="" position="3350,100">@@color:lime;Travel@@: [[Guard Station|GI_GuardStation]]</tw-passagedata><tw-passagedata pid="28" name="GI_Salon" tags="" position="3475,100">@@color:lime;Travel@@: [[High Hill District|HighHill]]</tw-passagedata><tw-passagedata pid="29" name="GoldenIsle" tags="" position="3600,100">@@color:lime;Travel@@: [[Back to The Mermaid|Deck]] | [[Smuggler&#39;s Den|SmugglersDen]] | [[Portside District|Portside]]</tw-passagedata><tw-passagedata pid="30" name="HighHill" tags="" position="3725,100">@@color:lime;Travel@@: [[Guard Station|GI_GuardStation]] | [[Madame Yvonne&#39;s Salon|GI_Salon]] | [[Bella&#39;s Boudoir|GI_Clothiers]] | [[Minxy&#39;s Dance Hall|GI_DanceHall]] | [[The Governor&#39;s Mansion|GI_GovernorsMansion]]</tw-passagedata><tw-passagedata pid="31" name="Portside" tags="" position="3850,100">@@color:lime;Travel@@: [[Docks|GoldenIsle]] | [[General Goods Store|GI_GeneralGoods]] | [[The Saucy Slattern|GI_CheapBrothel]] | [[The Bazzar|Bazzar]] | [[Guard Station|GI_GuardStation]]</tw-passagedata><tw-passagedata pid="32" name="SmugglersDen" tags="" position="3975,100">@@color:lime;Travel@@: [[Docks|GoldenIsle]]</tw-passagedata><tw-passagedata pid="33" name="Abamond" tags="" position="4100,100">@@color:lime;Travel@@: [[Back to The Mermaid|Deck]] | [[Far Beach|FarBeach]] | [[Into the Jungle|Jungle]]</tw-passagedata><tw-passagedata pid="34" name="FarBeach" tags="" position="4225,100">@@color:lime;Travel@@: [[Lonely Pier|Abamond]] | [[Into the Cave|OceanCave]]</tw-passagedata><tw-passagedata pid="35" name="HiddenCove" tags="" position="4350,100">@@color:lime;Travel@@: [[Into the Jungle|Jungle]]</tw-passagedata><tw-passagedata pid="36" name="Jungle" tags="" position="4475,100">@@color:lime;Travel@@: [[Lonely Pier|Abamond]] | [[Hidden Cove|HiddenCove]] | [[Into the Ruins|Ruins]]</tw-passagedata><tw-passagedata pid="37" name="OceanCave" tags="" position="4600,100">@@color:lime;Travel@@: [[Far Beach|FarBeach]]</tw-passagedata><tw-passagedata pid="38" name="Ruins" tags="" position="4725,100">@@color:lime;Travel@@: [[Into the Jungle|Jungle]] | [[Treasure Room|TreasureRoom]]</tw-passagedata><tw-passagedata pid="39" name="TreasureRoom" tags="" position="4850,100">@@color:lime;Travel@@: [[Into the Jungle|Jungle]]</tw-passagedata><tw-passagedata pid="40" name="Casino" tags="" position="4975,100">@@color:lime;Travel@@: [[Entertainment District|EntertainmentDistrict]]</tw-passagedata><tw-passagedata pid="41" name="CourtesansGuild" tags="" position="5100,100">@@color:lime;Travel@@: [[The Wealthy District|WealthyDistrict]]</tw-passagedata><tw-passagedata pid="42" name="EntertainmentDistrict" tags="" position="5225,100">@@color:lime;Travel@@: [[Great Market|GreatMarket]] | [[The Grand Casino|Casino]] | [[Jezzebelles|PR_DanceHall]] | [[Green Gryphon|PR_FancyTavern]] | [[Sindee Rella&#39;s Sexorium and Slut Show|XXXShow]] |
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[Port Royale Gifts|GiftShop]]</tw-passagedata><tw-passagedata pid="43" name="FortuneTeller" tags="" position="5350,100">@@color:lime;Travel@@: [[Great Market|GreatMarket]]</tw-passagedata><tw-passagedata pid="44" name="GiftShop" tags="" position="5475,100">@@color:lime;Travel@@: [[Entertainment District|EntertainmentDistrict]]</tw-passagedata><tw-passagedata pid="45" name="GreatMarket" tags="" position="5600,100">@@color:lime;Travel@@: [[The Docks|PortRoyale]] | [[Madame Blanche&#39;s|FortuneTeller]] | [[Grey Peacock|PR_Tavern]] | [[Lusty Lass|PR_CheapBrothel]] | [[The Entertainment District|EntertainmentDistrict]] | [[Guard House|PR_GuardHouse]]</tw-passagedata><tw-passagedata pid="46" name="PR_CheapBrothel" tags="" position="5725,100">@@color:lime;Travel@@: [[Great Market|GreatMarket]]</tw-passagedata><tw-passagedata pid="47" name="PR_Clothier" tags="" position="5850,100">@@color:lime;Travel@@: [[The Wealthy District|WealthyDistrict]]</tw-passagedata><tw-passagedata pid="48" name="PR_DanceHall" tags="" position="5975,100">@@color:lime;Travel@@: [[Entertainment District|EntertainmentDistrict]]</tw-passagedata><tw-passagedata pid="49" name="PR_FancyTavern" tags="" position="6100,100">@@color:lime;Travel@@: [[Entertainment District|EntertainmentDistrict]]</tw-passagedata><tw-passagedata pid="50" name="PR_GovernorsMansion" tags="" position="6225,100">@@color:lime;Travel@@: [[The Wealthy District|WealthyDistrict]]</tw-passagedata><tw-passagedata pid="51" name="PR_GuardHouse" tags="" position="6350,100">@@color:lime;Travel@@: [[Great Market|GreatMarket]] | [[Jail House|PR_Jail]] | [[The Wealthy District|WealthyDistrict]]</tw-passagedata><tw-passagedata pid="52" name="PR_Jail" tags="" position="6475,100">@@color:lime;Travel@@: [[Guard House|PR_GuardHouse]]</tw-passagedata><tw-passagedata pid="53" name="PR_RareGoods" tags="" position="6600,100">@@color:lime;Travel@@: [[The Wealthy District|WealthyDistrict]]</tw-passagedata><tw-passagedata pid="54" name="PR_Tavern" tags="" position="6725,100">@@color:lime;Travel@@: [[Great Market|GreatMarket]]</tw-passagedata><tw-passagedata pid="55" name="PortRoyale" tags="" position="6850,100">@@color:lime;Travel@@: [[Back to The Mermaid|Deck]] | [[Shipwright|ShipWright]] | [[Great Market|GreatMarket]]</tw-passagedata><tw-passagedata pid="56" name="ShipWright" tags="" position="6975,100">@@color:lime;Travel@@: [[The Docks|PortRoyale]]</tw-passagedata><tw-passagedata pid="57" name="WealthyDistrict" tags="" position="7100,100">@@color:lime;Travel@@: [[Guard House|PR_GuardHouse]] | [[Lady Selene&#39;s School for Courtesans|CourtesansGuild]] | [[Veronica&#39;s Secret|PR_Clothier]] | [[David Jone&#39;s Locker|PR_RareGoods]] | 
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;[[The Governor&#39;s Mansion|PR_GovernorsMansion]]</tw-passagedata><tw-passagedata pid="58" name="XXXShow" tags="" position="7225,100">@@color:lime;Travel@@: [[Entertainment District|EntertainmentDistrict]]</tw-passagedata><tw-passagedata pid="59" name="PassageTest" tags="" position="7350,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;click &quot;PIRATE_PRACTICE&quot; &quot;Combat&quot;&gt;&gt;
&lt;&lt;set $MenuAction = &quot;PIRATE_PRACTICE&quot;;&gt;&gt;
&lt;&lt;if not tags().contains(&quot;custom-menu&quot;)&gt;&gt;
&lt;&lt;set $GameBookmark = passage(); &gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/click&gt;&gt;&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="60" name="Stat Test" tags="" position="7475,100">&lt;table&gt;
&lt;tr&gt;
	&lt;td&gt;Stat&lt;/td&gt;&lt;td&gt;Score&lt;/td&gt;&lt;td&gt;XP&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
	&lt;td&gt;Body&lt;/td&gt;&lt;td&gt;Score&lt;/td&gt;&lt;td&gt;XP&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
	&lt;td&gt;Skill&lt;/td&gt;&lt;td&gt;Score&lt;/td&gt;&lt;td&gt;XP&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td&gt;Health&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.CoreStats[&quot;Health&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.CoreStatsXP[&quot;Health&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
	&lt;td&gt;Face&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.BodyStats[&quot;Face&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;Face&quot;&gt;&lt;&lt;print $Player.BodyXP[&quot;Face&quot;]&gt;&gt;&lt;/span&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;click &quot;+&quot;&gt;&gt;&lt;&lt;replace &quot;#Face&quot;&gt;&gt;&lt;&lt;print $Player.BodyXP[&quot;Face&quot;]+= 50;&gt;&gt;&lt;&lt;/replace&gt;&gt;&lt;&lt;/click&gt;&gt;
	    &lt;&lt;click &quot;-&quot;&gt;&gt;&lt;&lt;replace &quot;#Face&quot;&gt;&gt;&lt;&lt;print $Player.BodyXP[&quot;Face&quot;]-= 50;&gt;&gt;&lt;&lt;/replace&gt;&gt;&lt;&lt;/click&gt;&gt;
	&lt;/td&gt;
	&lt;td&gt;HandJobs&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.Skills[&quot;HandJobs&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;HandJobs&quot;&gt;&lt;&lt;print $Player.SkillsXP[&quot;HandJobs&quot;]&gt;&gt;&lt;/span&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;click &quot;+&quot;&gt;&gt;&lt;&lt;replace &quot;#HandJobs&quot;&gt;&gt;&lt;&lt;print $Player.SkillsXP[&quot;HandJobs&quot;]+= 50;&gt;&gt;&lt;&lt;/replace&gt;&gt;&lt;&lt;/click&gt;&gt;
	    &lt;&lt;click &quot;-&quot;&gt;&gt;&lt;&lt;replace &quot;#HandJobs&quot;&gt;&gt;&lt;&lt;print $Player.SkillsXP[&quot;HandJobs&quot;]-= 50;&gt;&gt;&lt;&lt;/replace&gt;&gt;&lt;&lt;/click&gt;&gt;
	&lt;/td&gt;	
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td&gt;Nutrition&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.CoreStats[&quot;Nutrition&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.CoreStatsXP[&quot;Nutrition&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
	&lt;td&gt;Lips&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.BodyStats[&quot;Lips&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.BodyXP[&quot;Lips&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
	&lt;td&gt;TitFucking&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.Skills[&quot;TitFucking&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.SkillsXP[&quot;TitFucking&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td&gt;WillPower&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.CoreStats[&quot;WillPower&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.CoreStatsXP[&quot;WillPower&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
	&lt;td&gt;Bust&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.BodyStats[&quot;Bust&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;Bust&quot;&gt;&lt;&lt;print $Player.BodyXP[&quot;Bust&quot;]&gt;&gt;&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;click &quot;+&quot;&gt;&gt;&lt;&lt;replace &quot;#Bust&quot;&gt;&gt;&lt;&lt;print $Player.BodyXP[&quot;Bust&quot;]+= 50;&gt;&gt;&lt;&lt;/replace&gt;&gt;&lt;&lt;/click&gt;&gt;
	    &lt;&lt;click &quot;-&quot;&gt;&gt;&lt;&lt;replace &quot;#Bust&quot;&gt;&gt;&lt;&lt;print $Player.BodyXP[&quot;Bust&quot;]-= 50;&gt;&gt;&lt;&lt;/replace&gt;&gt;&lt;&lt;/click&gt;&gt;&lt;/td&gt;
	&lt;td&gt;BlowJobs&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.Skills[&quot;BlowJobs&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.SkillsXP[&quot;BlowJobs&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td&gt;Perversion&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.CoreStats[&quot;Perversion&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.CoreStatsXP[&quot;Perversion&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
	&lt;td&gt;Ass&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.BodyStats[&quot;Ass&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.BodyXP[&quot;Ass&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
	&lt;td&gt;AssFucking&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.Skills[&quot;AssFucking&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.SkillsXP[&quot;AssFucking&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td&gt;Femininity&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.CoreStats[&quot;Femininity&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.CoreStatsXP[&quot;Femininity&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
	&lt;td&gt;Waist&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.BodyStats[&quot;Waist&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.BodyXP[&quot;Waist&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
	&lt;td&gt;Dancing&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.Skills[&quot;Dancing&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.SkillsXP[&quot;Dancing&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td&gt;Fitness&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.CoreStats[&quot;Fitness&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.CoreStatsXP[&quot;Fitness&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
	&lt;td&gt;Hips&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.BodyStats[&quot;Hips&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.BodyXP[&quot;Hips&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
	&lt;td&gt;Singing&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.Skills[&quot;Singing&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.SkillsXP[&quot;Singing&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td&gt;Toxicity&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.CoreStats[&quot;Toxicity&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.CoreStatsXP[&quot;Toxicity&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
	&lt;td&gt;Penis&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.BodyStats[&quot;Penis&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.BodyXP[&quot;Penis&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
	&lt;td&gt;Seduction&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.Skills[&quot;Seduction&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.SkillsXP[&quot;Seduction&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td&gt;Hormones&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.CoreStats[&quot;Hormones&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;Hormones&quot;&gt;&lt;&lt;print $Player.CoreStatsXP[&quot;Hormones&quot;]&gt;&gt;&lt;/span&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;click &quot;+&quot;&gt;&gt;&lt;&lt;replace &quot;#Hormones&quot;&gt;&gt;&lt;&lt;print $Player.CoreStatsXP[&quot;Hormones&quot;]+= 50;&gt;&gt;&lt;&lt;/replace&gt;&gt;&lt;&lt;/click&gt;&gt;
	    &lt;&lt;click &quot;-&quot;&gt;&gt;&lt;&lt;replace &quot;#Hormones&quot;&gt;&gt;&lt;&lt;print $Player.CoreStatsXP[&quot;Hormones&quot;]-= 50;&gt;&gt;&lt;&lt;/replace&gt;&gt;&lt;&lt;/click&gt;&gt;
	&lt;/td&gt;	
	&lt;td&gt;Hair&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.BodyStats[&quot;Hair&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.BodyXP[&quot;Hair&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
	&lt;td&gt;Cleaning&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.Skills[&quot;Cleaning&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.SkillsXP[&quot;Cleaning&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td colspan=&quot;4&quot;&gt; &lt;/td&gt;
	&lt;td&gt;Height&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.BodyStats[&quot;Height&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.BodyXP[&quot;Height&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
	&lt;td&gt;Cooking&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.Skills[&quot;Cooking&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.SkillsXP[&quot;Cooking&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td colspan=&quot;4&quot;&gt; &lt;/td&gt;
	&lt;td&gt;Balls&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.BodyStats[&quot;Balls&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.BodyXP[&quot;Balls&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
	&lt;td&gt;Swashbuckling&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.Skills[&quot;Swashbuckling&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.SkillsXP[&quot;Swashbuckling&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td colspan=&quot;4&quot;&gt; &lt;/td&gt;
	&lt;td colspan=&quot;4&quot;&gt; &lt;/td&gt;
	&lt;td&gt;Sailing&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.Skills[&quot;Sailing&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.SkillsXP[&quot;Sailing&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td colspan=&quot;4&quot;&gt; &lt;/td&gt;
	&lt;td colspan=&quot;4&quot;&gt; &lt;/td&gt;
	&lt;td&gt;Navigating&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.Skills[&quot;Navigating&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.SkillsXP[&quot;Navigating&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td colspan=&quot;4&quot;&gt; &lt;/td&gt;
	&lt;td colspan=&quot;4&quot;&gt; &lt;/td&gt;
	&lt;td&gt;Styling&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.Skills[&quot;Styling&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt;&lt;&lt;print $Player.SkillsXP[&quot;Styling&quot;]&gt;&gt;&lt;/td&gt;&lt;td&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
[[Hormones to 100|Stat Test][$Player.CoreStats[&quot;Hormones&quot;] to 100]]
[[Next Day|Stat Test][$Player.NextDay();]]
[[Cabin]] [[IslaHarbor]] [[GoldenIsle]] [[Abamond]] [[PortRoyale]] [[PassageTest]]</tw-passagedata><tw-passagedata pid="61" name="InventoryWidgets" tags="widget" position="7600,100">&lt;&lt;widget &quot;InspectItem&quot;&gt;&gt;&lt;&lt;set _Item = $Player.GetItemById($args[0]); &gt;&gt;\
&lt;table class=&quot;.MyTable&quot; style=&quot;width:750px;&quot;&gt;
&lt;tbody&gt;
	&lt;tr&gt;&lt;td colspan=&quot;2&quot;&gt;&lt;h3&gt;@@color:yellow;Inspecting - @@&lt;&lt;= _Item.Description()&gt;&gt;&lt;/h3&gt;&lt;/td&gt;
		&lt;td colspan=&quot;2&quot; style=&quot;text-align:right&quot;&gt;@@.wardrobeButton;&lt;&lt;button &quot;Back&quot;&gt;&gt;&lt;&lt;replace &quot;#InventoryUI&quot;&gt;&gt;&lt;&lt;InventoryTable $args[1]&gt;&gt;&lt;&lt;/replace&gt;&gt;&lt;&lt;/button&gt;&gt;@@&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr style=&quot;border-bottom:1px solid white;&quot;&gt;
		&lt;td style=&quot;width:80px;&quot;&gt; &lt;/td&gt;
		&lt;td style=&quot;width:400px;&quot;&gt; &lt;/td&gt;
		&lt;td style=&quot;width:120px;&quot;&gt; &lt;/td&gt;
		&lt;td style=&quot;width:120px;&quot;&gt; &lt;/td&gt;
	&lt;/tr&gt;	
	&lt;tr&gt;
		&lt;td&gt; &lt;/td&gt;
		&lt;td colspan=&quot;2&quot;&gt;
		&lt;&lt;print _Item.Examine($Player);&gt;&gt;&lt;/td&gt;
		&lt;td&gt; &lt;/td&gt;
	&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;UseItem&quot;&gt;&gt;&lt;&lt;set _Item = $Player.GetItemById($args[0]); &gt;&gt;\
&lt;table class=&quot;.MyTable&quot; style=&quot;width:750px;&quot;&gt;
&lt;tbody&gt;
	&lt;tr&gt;&lt;td colspan=&quot;2&quot;&gt;&lt;h3&gt;@@color:yellow;Using - @@&lt;&lt;= _Item.Description()&gt;&gt;&lt;/h3&gt;&lt;/td&gt;
		&lt;td colspan=&quot;2&quot; style=&quot;text-align:right&quot;&gt;@@.wardrobeButton;&lt;&lt;button &quot;Back&quot;&gt;&gt;&lt;&lt;replace &quot;#InventoryUI&quot;&gt;&gt;&lt;&lt;InventoryTable $args[1]&gt;&gt;&lt;&lt;/replace&gt;&gt;&lt;&lt;/button&gt;&gt;@@&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr style=&quot;border-bottom:1px solid white;&quot;&gt;
		&lt;td style=&quot;width:80px;&quot;&gt; &lt;/td&gt;
		&lt;td style=&quot;width:400px;&quot;&gt; &lt;/td&gt;
		&lt;td style=&quot;width:120px;&quot;&gt; &lt;/td&gt;
		&lt;td style=&quot;width:120px;&quot;&gt; &lt;/td&gt;
	&lt;/tr&gt;	
	&lt;tr&gt;
		&lt;td&gt; &lt;/td&gt;
		&lt;td colspan=&quot;2&quot;&gt;
			&lt;&lt;print _Item.Message($Player);&gt;&gt;\
			&lt;&lt;run $Player.UseItem($args[0]);&gt;&gt;&lt;/td&gt;
		&lt;td&gt; &lt;/td&gt;
	&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;&lt;replace &quot;#PlayerScore&quot;&gt;&gt;&lt;&lt;score&gt;&gt;&lt;&lt;/replace&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;ExamineItemButton&quot;&gt;&gt;&lt;&lt;nobr&gt;&gt;
@@.wardrobeButton;&lt;&lt;button &quot;Examine&quot;&gt;&gt;
&lt;&lt;replace &quot;#InventoryUI&quot;&gt;&gt;&lt;&lt;InspectItem $args[0] $args[1]&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;/button&gt;&gt;@@
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;UseItemButton&quot;&gt;&gt;&lt;&lt;nobr&gt;&gt;
@@.wardrobeButton;&lt;&lt;button &quot;Use&quot;&gt;&gt;
&lt;&lt;replace &quot;#InventoryUI&quot;&gt;&gt;&lt;&lt;UseItem $args[0] $args[1]&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;/button&gt;&gt;@@
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;InventoryTable&quot;&gt;&gt;&lt;&lt;nobr&gt;&gt;
&lt;table class=&quot;.MyTable&quot; style=&quot;width:750px;&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;&lt;if $args[0] == &quot;food&quot;&gt;&gt;
&lt;&lt;set _Items = $Player.GetItemByTypes([&quot;food&quot;]);&gt;&gt;
	&lt;td colspan=2&gt;&lt;h3&gt;@@color:yellow;Inventory - Food and Drink@@&lt;/h3&gt;&lt;/td&gt;
	&lt;td colspan=2 style=&quot;text-align:right&quot;&gt;@@color:grey;Food@@ |
	&lt;&lt;click &quot;Potions&quot;&gt;&gt;
		&lt;&lt;replace &quot;#InventoryUI&quot;&gt;&gt;&lt;&lt;InventoryTable &quot;potion&quot;&gt;&gt;&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/click&gt;&gt; | &lt;&lt;click &quot;Quest&quot;&gt;&gt;
		&lt;&lt;replace &quot;#InventoryUI&quot;&gt;&gt;&lt;&lt;InventoryTable &quot;quest&quot;&gt;&gt;&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/click&gt;&gt;&lt;/td&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;if $args[0] == &quot;potion&quot;&gt;&gt;
&lt;&lt;set _Items = $Player.GetItemByTypes([&quot;potion&quot;]);&gt;&gt;
	&lt;td colspan=2&gt;&lt;h3&gt;@@color:yellow;Inventory - Potions and Drugs@@&lt;/h3&gt;&lt;/td&gt;
	&lt;td colspan=2 style=&quot;text-align:right&quot;&gt;&lt;&lt;click &quot;Food&quot;&gt;&gt;
		&lt;&lt;replace &quot;#InventoryUI&quot;&gt;&gt;&lt;&lt;InventoryTable &quot;food&quot;&gt;&gt;&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/click&gt;&gt; | @@color:grey;Potions@@ | &lt;&lt;click &quot;Quest&quot;&gt;&gt;
		&lt;&lt;replace &quot;#InventoryUI&quot;&gt;&gt;&lt;&lt;InventoryTable &quot;quest&quot;&gt;&gt;&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/click&gt;&gt;&lt;/td&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;if $args[0] == &quot;quest&quot;&gt;&gt;
&lt;&lt;set _Items = $Player.GetItemByTypes([&quot;QUEST&quot;]);&gt;&gt;
	&lt;td colspan=2&gt;&lt;h3&gt;@@color:yellow;Inventory - Quest Items@@&lt;/h3&gt;&lt;/td&gt;
	&lt;td colspan=2 style=&quot;text-align:right&quot;&gt;&lt;&lt;click &quot;Food&quot;&gt;&gt;
		&lt;&lt;replace &quot;#InventoryUI&quot;&gt;&gt;&lt;&lt;InventoryTable &quot;food&quot;&gt;&gt;&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/click&gt;&gt; | &lt;&lt;click &quot;Potions&quot;&gt;&gt;
		&lt;&lt;replace &quot;#InventoryUI&quot;&gt;&gt;&lt;&lt;InventoryTable &quot;potion&quot;&gt;&gt;&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/click&gt;&gt; | @@color:grey;Quest@@&lt;/td&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;/tr&gt;
&lt;tr style=&quot;border-bottom:1px solid white;&quot;&gt;
    &lt;td style=&quot;width:80px;&quot;&gt;Count&lt;/td&gt;
	&lt;td style=&quot;width:400px;&quot;&gt;Item&lt;/td&gt;
	&lt;td style=&quot;width:120px;&quot;&gt; &lt;/td&gt;
	&lt;td style=&quot;width:120px;&quot;&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;&lt;if ($args[0] == &quot;food&quot;) or ($args[0] == &quot;potion&quot;) &gt;&gt;
&lt;&lt;for _i = 0; _i lt _Items.length; _i++&gt;&gt;
&lt;tr&gt;
&lt;td&gt;&lt;&lt;= _Items[_i].Charges() &gt;&gt;&lt;/td&gt;
&lt;td&gt;&lt;&lt;= _Items[_i].Description() &gt;&gt;&lt;/td&gt;
&lt;td style=&quot;text-align:right&quot;&gt;&lt;&lt;= &quot;&lt;&lt;ExamineItemButton \&quot;&quot; + _Items[_i].Id() + &quot;\&quot; \&quot;&quot; + $args[0] + &quot;\&quot; &gt;&gt;&quot; &gt;&gt;&lt;/td&gt;
&lt;td style=&quot;text-align:right&quot;&gt;&lt;&lt;= &quot;&lt;&lt;UseItemButton \&quot;&quot; + _Items[_i].Id() + &quot;\&quot; \&quot;&quot; + $args[0] + &quot;\&quot; &gt;&gt;&quot; &gt;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;for _i = 0; _i lt _Items.length; _i++&gt;&gt;
&lt;tr&gt;
&lt;td&gt;&lt;&lt;= _Items[_i].Charges() &gt;&gt;&lt;/td&gt;
&lt;td&gt;&lt;&lt;= _Items[_i].Description() &gt;&gt;&lt;/td&gt;
&lt;td style=&quot;text-align:right&quot;&gt;&lt;&lt;= &quot;&lt;&lt;ExamineItemButton \&quot;&quot; + _Items[_i].Id() + &quot;\&quot; \&quot;&quot; + $args[0] + &quot;\&quot; &gt;&gt;&quot; &gt;&gt;&lt;/td&gt;
&lt;td style=&quot;text-align:right&quot;&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="62" name="JobLink" tags="widget" position="7725,100">&lt;&lt;widget &quot;jobLink&quot;&gt;&gt;&lt;&lt;nobr&gt;&gt;
&lt;&lt;set _JobTitle = $args[0].Title(true); &gt;&gt;
&lt;&lt;click _JobTitle &quot;SelfJobs&quot;&gt;&gt;
&lt;&lt;set $MenuAction = $args[0]&gt;&gt;
&lt;&lt;if not tags().contains(&quot;custom-menu&quot;)&gt;&gt;&lt;&lt;set $GameBookmark = passage(); &gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/click&gt;&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;jobLinks&quot;&gt;&gt;&lt;&lt;nobr&gt;&gt;
&lt;&lt;set _JE = window.App.JobEngine;&gt;&gt;
&lt;&lt;set _JL = _JE.GetAvailableLocationJobs($Player, $args[0]);&gt;&gt;
&lt;&lt;run console.log(_JL); &gt;&gt;
&lt;&lt;if $args[1] == 1 &amp;&amp; _JL.length &gt;= 1&gt;&gt;@@color:yellow;Action@@: &lt;&lt;/if&gt;&gt;
&lt;&lt;for _i = 0; _i &lt; _JL.length; _i++&gt;&gt;
&lt;&lt;if _JL[_i].Ready($Player) == true&gt;&gt;
&lt;&lt;if _i &gt; 0&gt;&gt;| &lt;&lt;/if&gt;&gt;
&lt;&lt;jobLink _JL[_i]&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;if _i &gt; 0&gt;&gt;| &lt;&lt;/if&gt;&gt;
&lt;&lt;print &#39;@@color:grey;&#39;+_JL[_i].Title(true)+&#39;@@&#39;;&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="63" name="NPC" tags="widget" position="7850,100">&lt;&lt;widget NPC&gt;&gt;\
&lt;&lt;set _QE = window.App.QuestEngine;&gt;&gt;\
&lt;&lt;set _NPC = $Player.NPCS[$args[0]];&gt;&gt;\
&lt;&lt;set _JE = window.App.JobEngine;&gt;&gt;\
&lt;&lt;set _SE = window.App.StoreEngine;&gt;&gt;\
&lt;&lt;= window.App.PR.TokenizeString($Player, _NPC, _NPC.ShortDesc())&gt;&gt;
@@color:DeepPink;NPC Menu@@: &lt;&lt;customMenuLink &quot;Examine&quot; _NPC&gt;&gt;\
 &lt;&lt;if _JE.HasJobs($Player, $args[0]);&gt;&gt;\
 | &lt;&lt;customMenuLink &quot;Jobs&quot; $args[0]&gt;&gt;\
 &lt;&lt;if _JE.JobsAvailable($Player, $args[0])&gt;&gt;\
  @@color:yellow; (!)@@&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
 &lt;&lt;if _QE.GetQuests(&quot;any&quot;, $Player, $args[0]).length != 0&gt;&gt;\
 | &lt;&lt;customMenuLink &quot;Quests&quot; $args[0]&gt;&gt;\
 &lt;&lt;if _QE.GetQuests(&quot;available&quot;, $Player, $args[0]).length !=0&gt;&gt;\
 @@color:yellow; (!)@@&lt;&lt;/if&gt;&gt;\
 &lt;&lt;if _QE.GetQuests(&quot;cancomplete&quot;, $Player, $args[0]).length !=0&gt;&gt;\
 @@color:DeepPink; (!)@@&lt;&lt;/if&gt;&gt;\
 &lt;&lt;/if&gt;&gt;\
&lt;&lt;if _SE.HasStore(_NPC);&gt;&gt;\
&lt;&lt;if _SE.IsOpen($Player, _NPC) == true&gt;&gt;\
 | &lt;&lt;customMenuLink &quot;Shop&quot; _NPC&gt;&gt;\
 &lt;&lt;else&gt;&gt;\
 | @@color:grey;[Shop]@@&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;\
 &lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="64" name="SexEndPhase" tags="widget" position="7975,100">&lt;&lt;widget &quot;sexEndButtons&quot;&gt;&gt;\
&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $Player.GetStat(&quot;STAT&quot;, &quot;Health&quot;) &lt; 1&gt;&gt;
@@.cmdButton;&lt;&lt;button &quot;Game Over&quot; &quot;GameOver&quot;&gt;&gt;&lt;&lt;/button&gt;&gt;@@
&lt;&lt;else&gt;&gt;
@@.cmdButton;&lt;&lt;button &quot;Exit&quot; $GameBookmark&gt;&gt;
&lt;&lt;run $Player.NextPhase();&gt;&gt;
&lt;&lt;set $WhoreTurn = 0&gt;&gt;
&lt;&lt;/button&gt;&gt;@@

&lt;&lt;if ($CL.length &gt; 0) and ($Player.GetStat(&quot;STAT&quot;, &quot;Energy&quot;) &gt;= 1)&gt;&gt;
@@.cmdButton;&lt;&lt;button &quot;Continue Whoring&quot;&gt;&gt;
&lt;&lt;set $WhoreTurn = 0&gt;&gt;
&lt;&lt;set $Customer = $CL.shift()&gt;&gt;
&lt;&lt;if  ( $Customer.SexAct == &quot;TitFucking&quot; ) &amp;&amp;              
	  ( $Player.GetStatPercent(&quot;BODY&quot;, &quot;Bust&quot;) &lt; 6 ) &gt;&gt;
&lt;&lt;set $Customer.SexAct = &quot;HandJobs&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;replace &quot;#SexProgress&quot;&gt;&gt; &lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#WhoreCommands&quot;&gt;&gt;&lt;&lt;negotiateButtons&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#CommandTxt&quot;&gt;&gt;@@color:yellow;Continue Whoring - Negotiate Sex Act@@&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#WhoreDialog&quot;&gt;&gt;
Deciding that there&#39;s still coin to be earned, you do your best to clean yourself up so that you&#39;re minimally presentable for the next customer.&lt;br/&gt;&lt;br/&gt;

&lt;&lt;print &quot;@@color:cyan;&quot; + $Customer.Name + &quot;@@ says: &quot;+ $Customer.DoChat($Player, &quot;CustomerIntro&quot;);&gt;&gt;&lt;br/&gt;&lt;br/&gt;
&lt;&lt;/replace&gt;&gt;
&lt;&lt;/button&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;sexEndDialog&quot;&gt;&gt;\
&lt;&lt;nobr&gt;&gt;

&lt;&lt;set _Cmd = window.App.Data.Lists.SexCommands[$Customer.SexAct][4]&gt;&gt;
&lt;&lt;print $Customer.Fuck($Player, _Cmd); &gt;&gt;&lt;br/&gt;&lt;br/&gt;
&lt;&lt;set _Pay = $Customer.PayOut($Player); &gt;&gt;
&lt;&lt;run $Player.AdjustMoney(_Pay); &gt;&gt;
&lt;&lt;run _NPC.AdjustStat(&quot;Mood&quot;, ( $Customer.GetServiceRating() / 10));&gt;&gt;
&lt;&lt;run _NPC.AdjustStat(&quot;Lust&quot;, -($Customer.GetArousal()/10));&gt;&gt;
&lt;&lt;run $Player.AdjustStat(&quot;Energy&quot;,-1); &gt;&gt;
&lt;&lt;replace &quot;#PlayerScore&quot;&gt;&gt;&lt;&lt;score&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#SexProgress&quot;&gt;&gt;&lt;&lt;sexProgress&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#MoodScore&quot;&gt;&gt;&lt;&lt;print _NPC.pMood(); &gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#LustScore&quot;&gt;&gt;&lt;&lt;print _NPC.pLust(); &gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;if $Player.GetStat(&quot;STAT&quot;, &quot;Health&quot;) &lt; 1&gt;&gt;
You subcumb to the beating and die...
&lt;&lt;else&gt;&gt;
&lt;&lt;print $Customer.Name + &quot; walks away, leaving you &quot; + _Pay + &quot; coins.&quot;&gt;&gt;&lt;br/&gt;&lt;br/&gt;

&lt;&lt;if ($CL.length &gt; 0)&gt;&gt;There are still more customers waiting.
&lt;&lt;else&gt;&gt;
That seems to be the end of the work for now... best get some rest and try again later.
&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;sexEndHeader&quot;&gt;&gt;\
&lt;&lt;nobr&gt;&gt;
@@color:yellow;Whoring Complete!@@
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="65" name="WardrobeWidgets" tags="widget" position="8100,100">&lt;&lt;widget &quot;InspectClothing&quot;&gt;&gt;&lt;&lt;set _Item = $Player.GetEquipmentInSlot($args[0]); &gt;&gt;\
&lt;&lt;nobr&gt;&gt;
&lt;table class=&quot;.MyTable&quot;&gt;
&lt;tbody&gt;
	&lt;tr&gt;&lt;td colspan=&quot;3&quot;&gt;
			&lt;h3&gt;@@color:yellow;Inspecting Item@@&lt;/h3&gt;
		&lt;/td&gt;
		&lt;td&gt;@@.wardrobeButton;&lt;&lt;button &quot;Back&quot;&gt;&gt;
			&lt;&lt;replace &quot;#WardrobeUI&quot;&gt;&gt;&lt;&lt;WearingTable&gt;&gt;&lt;&lt;/replace&gt;&gt;
			&lt;&lt;/button&gt;&gt;@@
		&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr style=&quot;border-bottom:1px solid white;&quot;&gt;
		&lt;td style=&quot;width:80px;&quot;&gt; &lt;/td&gt;
		&lt;td style=&quot;width:360px;&quot;&gt; &lt;/td&gt;
		&lt;td style=&quot;width:80px;&quot;&gt; &lt;/td&gt;
		&lt;td style=&quot;width:80px;&quot;&gt; &lt;/td&gt;
	&lt;/tr&gt;	
&lt;/tbody&gt;&lt;/table&gt;&lt;&lt;/nobr&gt;&gt;\
You spy with your little eye...

&lt;&lt;print _Item.Description() &gt;&gt;
&lt;&lt;print _Item.Examine();&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;WearingExa&quot;&gt;&gt;&lt;&lt;nobr&gt;&gt;
&lt;&lt;set _Item = $Player.GetEquipmentInSlot($args[0]); &gt;&gt;
&lt;&lt;if _Item == 0&gt;&gt;@@.disabledWardrobeButton;&lt;&lt;button &quot;Examine&quot;&gt;&gt;&lt;&lt;/button&gt;&gt;@@
&lt;&lt;else&gt;&gt;
@@.wardrobeButton;&lt;&lt;button &quot;Examine&quot;&gt;&gt;
&lt;&lt;replace &quot;#WardrobeUI&quot;&gt;&gt;&lt;&lt;InspectClothing $args[0]&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;/button&gt;&gt;@@
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;InspectWardrobe&quot;&gt;&gt;&lt;&lt;nobr&gt;&gt;
&lt;&lt;set _Item = $Player.WardrobeItem($args[0]); &gt;&gt;
&lt;&lt;set _Slot = $args[1];&gt;&gt;
&lt;table class=&quot;.MyTable&quot;&gt;
&lt;tbody&gt;
	&lt;tr&gt;&lt;td colspan=&quot;3&quot;&gt;
			&lt;h3&gt;@@color:yellow;Inspecting Item@@&lt;/h3&gt;
		&lt;/td&gt;
		&lt;td&gt;@@.wardrobeButton;&lt;&lt;button &quot;Back&quot;&gt;&gt;
			&lt;&lt;replace &quot;#WardrobeUI&quot;&gt;&gt;&lt;&lt;WardrobeTable _Slot&gt;&gt;&lt;&lt;/replace&gt;&gt;
			&lt;&lt;/button&gt;&gt;@@
		&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr style=&quot;border-bottom:1px solid white;&quot;&gt;
		&lt;td style=&quot;width:80px;&quot;&gt; &lt;/td&gt;
		&lt;td style=&quot;width:360px;&quot;&gt; &lt;/td&gt;
		&lt;td style=&quot;width:80px;&quot;&gt; &lt;/td&gt;
		&lt;td style=&quot;width:80px;&quot;&gt; &lt;/td&gt;
	&lt;/tr&gt;	
&lt;/tbody&gt;&lt;/table&gt;&lt;&lt;/nobr&gt;&gt;\
You spy with your little eye...

&lt;&lt;print _Item.Description() &gt;&gt;
&lt;&lt;print _Item.Examine();&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;WardrobeExamine&quot;&gt;&gt;&lt;&lt;nobr&gt;&gt;
	@@.wardrobeButton;&lt;&lt;button &quot;Examine&quot;&gt;&gt;
	&lt;&lt;replace &quot;#WardrobeUI&quot;&gt;&gt;&lt;&lt;InspectWardrobe $args[0] $args[1]&gt;&gt;&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/button&gt;&gt;@@
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;WardrobeWear&quot;&gt;&gt;&lt;&lt;nobr&gt;&gt;
&lt;&lt;set _Worn = $Player.GetEquipmentInSlot($args[1])&gt;&gt;
&lt;&lt;if _Worn != 0&gt;&gt;
	&lt;&lt;if _Worn.IsLocked() == 1&gt;&gt;
		@@.disabledWardrobeButton;&lt;&lt;button &quot;LOCKED&quot;&gt;&gt;&lt;&lt;/button&gt;&gt;@@
	&lt;&lt;else&gt;&gt;
		@@.wardrobeButton;&lt;&lt;button &quot;Wear&quot;&gt;&gt;
		&lt;&lt;run $Player.Wear($Player.WardrobeItem($args[0])) &gt;&gt;&lt;&lt;replace &quot;#WardrobeUI&quot;&gt;&gt;&lt;&lt;WearingTable&gt;&gt;&lt;&lt;/replace&gt;&gt;
		&lt;&lt;/button&gt;&gt;@@		
	&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
		@@.wardrobeButton;&lt;&lt;button &quot;Wear&quot;&gt;&gt;
		&lt;&lt;run $Player.Wear($Player.WardrobeItem($args[0])) &gt;&gt;&lt;&lt;replace &quot;#WardrobeUI&quot;&gt;&gt;&lt;&lt;WearingTable&gt;&gt;&lt;&lt;/replace&gt;&gt;
		&lt;&lt;/button&gt;&gt;@@		
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;WardrobeTable&quot;&gt;&gt;&lt;&lt;nobr&gt;&gt;
&lt;&lt;set _Items = $Player.WardrobeItemsBySlot($args[0])&gt;&gt;
&lt;table class=&quot;.MyTable&quot;&gt;
&lt;tbody&gt;
	&lt;tr&gt;&lt;td colspan=&quot;3&quot;&gt;
			&lt;h3&gt;@@color:yellow;Wardrobe Items - &lt;&lt;= $args[0] &gt;&gt;@@&lt;/h3&gt;
		&lt;/td&gt;
		&lt;td&gt;@@.wardrobeButton;&lt;&lt;button &quot;Back&quot;&gt;&gt;
			&lt;&lt;replace &quot;#WardrobeUI&quot;&gt;&gt;&lt;&lt;WearingTable&gt;&gt;&lt;&lt;/replace&gt;&gt;
			&lt;&lt;/button&gt;&gt;@@
		&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr style=&quot;border-bottom:1px solid white;&quot;&gt;
		&lt;td style=&quot;width:80px;&quot;&gt; &lt;/td&gt;
		&lt;td style=&quot;width:360px;&quot;&gt;Item&lt;/td&gt;
		&lt;td style=&quot;width:80px;&quot;&gt; &lt;/td&gt;
		&lt;td style=&quot;width:80px;&quot;&gt; &lt;/td&gt;
	&lt;/tr&gt;
&lt;&lt;for _i = 0; _i lt _Items.length; _i++&gt;&gt;
&lt;tr&gt;
&lt;td&gt; &lt;/td&gt;
&lt;td&gt;&lt;&lt;= _Items[_i].Description() &gt;&gt;&lt;/td&gt;
&lt;td&gt;&lt;&lt;= &quot;&lt;&lt;WardrobeExamine \&quot;&quot; + _Items[_i].Id() + &quot;\&quot; \&quot;&quot; + $args[0] + &quot;\&quot; &gt;&gt;&quot; &gt;&gt;&lt;/td&gt;
&lt;td&gt;&lt;&lt;= &quot;&lt;&lt;WardrobeWear \&quot;&quot; + _Items[_i].Id() + &quot;\&quot; \&quot;&quot; + $args[0] + &quot;\&quot; &gt;&gt;&quot; &gt;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;&lt;/for&gt;&gt;	
&lt;/tbody&gt;
&lt;/table&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;WearingChange&quot;&gt;&gt;&lt;&lt;nobr&gt;&gt;
&lt;&lt;set _Item = $Player.GetEquipmentInSlot($args[0]); &gt;&gt;
&lt;&lt;if _Item != 0&gt;&gt;
	&lt;&lt;if _Item.IsLocked() == 1&gt;&gt;
		@@.disabledWardrobeButton;&lt;&lt;button &quot;LOCKED&quot;&gt;&gt;&lt;&lt;/button&gt;&gt;@@
	&lt;&lt;else&gt;&gt;
		&lt;&lt;if $Player.WardrobeItemsBySlot($args[0]).length &gt; 0&gt;&gt;
			@@.wardrobeButton;&lt;&lt;button &quot;Change&quot;&gt;&gt;&lt;&lt;replace &quot;#WardrobeUI&quot;&gt;&gt;&lt;&lt;WardrobeTable $args[0]&gt;&gt;&lt;&lt;/replace&gt;&gt;&lt;&lt;/button&gt;&gt;@@		
		&lt;&lt;else&gt;&gt;
			@@.disabledWardrobeButton;&lt;&lt;button &quot;Change&quot;&gt;&gt;&lt;&lt;/button&gt;&gt;@@
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;if $Player.WardrobeItemsBySlot($args[0]).length &gt; 0&gt;&gt;
		@@.wardrobeButton;&lt;&lt;button &quot;Change&quot;&gt;&gt;&lt;&lt;replace &quot;#WardrobeUI&quot;&gt;&gt;&lt;&lt;WardrobeTable $args[0]&gt;&gt;&lt;&lt;/replace&gt;&gt;&lt;&lt;/button&gt;&gt;@@		
	&lt;&lt;else&gt;&gt;
		@@.disabledWardrobeButton;&lt;&lt;button &quot;Change&quot;&gt;&gt;&lt;&lt;/button&gt;&gt;@@
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;WearingRemove&quot;&gt;&gt;&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $Player.GetEquipmentInSlot($args[0]) != 0&gt;&gt;
	&lt;&lt;if $Player.GetEquipmentInSlot($args[0]).IsLocked() == 1&gt;&gt;
		@@.disabledWardrobeButton;&lt;&lt;button &quot;LOCKED&quot;&gt;&gt;&lt;&lt;/button&gt;&gt;@@
	&lt;&lt;else&gt;&gt;
		@@.wardrobeButton;&lt;&lt;button &quot;Remove&quot;&gt;&gt;
		&lt;&lt;run $Player.Remove($Player.GetEquipmentInSlot($args[0]))&gt;&gt;
		&lt;&lt;replace &quot;#WardrobeUI&quot;&gt;&gt;&lt;&lt;WearingTable&gt;&gt;&lt;&lt;/replace&gt;&gt;&lt;&lt;/button&gt;&gt;@@		
	&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
		@@.disabledWardrobeButton;&lt;&lt;button &quot;Remove&quot;&gt;&gt;&lt;&lt;/button&gt;&gt;@@
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;wlink&quot;&gt;&gt;&lt;&lt;nobr&gt;&gt;
&lt;&lt;click $args[0]&gt;&gt;&lt;&lt;replace &quot;#WardrobeUI&quot;&gt;&gt;&lt;&lt;WardrobeTable $args[0]&gt;&gt;&lt;&lt;/replace&gt;&gt;&lt;&lt;/click&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;StyleDisplay&quot;&gt;&gt;&lt;&lt;nobr&gt;&gt;
&lt;&lt;set _PR = window.App.PR;&gt;&gt;
&lt;table class=&quot;.MyTable&quot;&gt;
&lt;tbody&gt;
	&lt;tr&gt;&lt;td colspan=&quot;3&quot;&gt;
			&lt;h3&gt;@@color:yellow;Inspecting Current Outfit@@&lt;/h3&gt;
		&lt;/td&gt;
		&lt;td&gt;@@.wardrobeButton;&lt;&lt;button &quot;Back&quot;&gt;&gt;
			&lt;&lt;replace &quot;#WardrobeUI&quot;&gt;&gt;&lt;&lt;WearingTable&gt;&gt;&lt;&lt;/replace&gt;&gt;
			&lt;&lt;/button&gt;&gt;@@
		&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr style=&quot;border-bottom:1px solid white;&quot;&gt;
		&lt;td style=&quot;width:80px;&quot;&gt; &lt;/td&gt;
		&lt;td style=&quot;width:360px;&quot;&gt; &lt;/td&gt;
		&lt;td style=&quot;width:80px;&quot;&gt; &lt;/td&gt;
		&lt;td style=&quot;width:80px;&quot;&gt; &lt;/td&gt;
	&lt;/tr&gt;	
&lt;/tbody&gt;&lt;/table&gt;&lt;&lt;/nobr&gt;&gt;
The style and fashion of your clothing is &lt;&lt;= window.App.PR.pClothing($Player) &gt;&gt;

&lt;table class=&quot;#score-table&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;&lt;td colspan=&quot;6&quot; style=&quot;border-bottom: 1px solid&quot;&gt;@@color:yellow;Current Fashion Breakdown@@&lt;/td&gt;&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td&gt;Ordinary:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;= _PR.pStyleMeter(&quot;Ordinary&quot;, $Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
		&lt;td&gt;Pirate Slut:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;= _PR.pStyleMeter(&quot;Pirate Slut&quot;, $Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
		&lt;td&gt;Bimbo:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;= _PR.pStyleMeter(&quot;Bimbo&quot;, $Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td&gt;Sissy Lolita:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;= _PR.pStyleMeter(&quot;Sissy Lolita&quot;, $Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
		&lt;td&gt;Gothic Lolita:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;= _PR.pStyleMeter(&quot;Gothic Lolita&quot;, $Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
		&lt;td&gt;BDSM:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;= _PR.pStyleMeter(&quot;BDSM&quot;, $Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td&gt;Daddy&#39;s Girl:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;= _PR.pStyleMeter(&quot;Daddy&#39;s Girl&quot;, $Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
		&lt;td&gt;Naughty Nun:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;= _PR.pStyleMeter(&quot;Naughty Nun&quot;, $Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
		&lt;td&gt;Pet Girl:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;= _PR.pStyleMeter(&quot;Pet Girl&quot;, $Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td&gt;High Class Whore:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;= _PR.pStyleMeter(&quot;High Class Whore&quot;, $Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
		&lt;td&gt;Slutty Lady:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;= _PR.pStyleMeter(&quot;Slutty Lady&quot;, $Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
		&lt;td&gt;Sexy Dancer:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;= _PR.pStyleMeter(&quot;Sexy Dancer&quot;, $Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
	&lt;/tr&gt;	
&lt;/tbody&gt;
&lt;/table&gt;

&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;WearingTable&quot;&gt;&gt;&lt;&lt;nobr&gt;&gt;
&lt;table class=&quot;.MyTable&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;
	&lt;td colspan=2&gt;&lt;h3&gt;@@color:yellow;Worn Items@@&lt;/h3&gt;&lt;/td&gt;
	&lt;td colspan=3&gt;&lt;&lt;click &quot;Get naked&quot;&gt;&gt;
		&lt;&lt;run $Player.Strip();&gt;&gt;
		&lt;&lt;replace &quot;#WardrobeUI&quot;&gt;&gt;&lt;&lt;WearingTable&gt;&gt;&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/click&gt;&gt; | &lt;&lt;click &quot;Inspect Outfit&quot;&gt;&gt;
		&lt;&lt;replace &quot;#WardrobeUI&quot;&gt;&gt;&lt;&lt;StyleDisplay&gt;&gt;&lt;&lt;/replace&gt;&gt;
	&lt;&lt;/click&gt;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr style=&quot;border-bottom:1px solid white;&quot;&gt;
    &lt;td style=&quot;width:80px;&quot;&gt;Slot&lt;/td&gt;
	&lt;td style=&quot;width:360px;&quot;&gt;Item&lt;/td&gt;
	&lt;td style=&quot;width:80px;&quot;&gt; &lt;/td&gt;
	&lt;td style=&quot;width:80px;&quot;&gt; &lt;/td&gt;
	&lt;td style=&quot;width:80px;&quot;&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
    &lt;td&gt;&lt;&lt;wlink &quot;Wig&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;= $Player.PrintEquipment(&quot;Wig&quot;) &gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingExa &quot;Wig&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingChange &quot;Wig&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingRemove &quot;Wig&quot;&gt;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
    &lt;td&gt;&lt;&lt;wlink &quot;Hat&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;= $Player.PrintEquipment(&quot;Hat&quot;) &gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingExa &quot;Hat&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingChange &quot;Hat&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingRemove &quot;Hat&quot;&gt;&gt;&lt;/td&gt;	
&lt;/tr&gt;
&lt;tr&gt;
    &lt;td&gt;&lt;&lt;wlink &quot;Neck&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;= $Player.PrintEquipment(&quot;Neck&quot;) &gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingExa &quot;Neck&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingChange &quot;Neck&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingRemove &quot;Neck&quot;&gt;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
    &lt;td&gt;&lt;&lt;wlink &quot;Nipples&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;= $Player.PrintEquipment(&quot;Nipples&quot;) &gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingExa &quot;Nipples&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingChange &quot;Nipples&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingRemove &quot;Nipples&quot;&gt;&gt;&lt;/td&gt;	
&lt;/tr&gt;
&lt;tr&gt;
    &lt;td&gt;&lt;&lt;wlink &quot;Bra&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;= $Player.PrintEquipment(&quot;Bra&quot;) &gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingExa &quot;Bra&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingChange &quot;Bra&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingRemove &quot;Bra&quot;&gt;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
    &lt;td&gt;&lt;&lt;wlink &quot;Corset&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;= $Player.PrintEquipment(&quot;Corset&quot;) &gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingExa &quot;Corset&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingChange &quot;Corset&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingRemove &quot;Corset&quot;&gt;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
    &lt;td&gt;&lt;&lt;wlink &quot;Panty&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;= $Player.PrintEquipment(&quot;Panty&quot;) &gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingExa &quot;Panty&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingChange &quot;Panty&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingRemove &quot;Panty&quot;&gt;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
    &lt;td&gt;&lt;&lt;wlink &quot;Stockings&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;= $Player.PrintEquipment(&quot;Stockings&quot;) &gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingExa &quot;Stockings&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingChange &quot;Stockings&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingRemove &quot;Stockings&quot;&gt;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
    &lt;td&gt;&lt;&lt;wlink &quot;Shirt&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;= $Player.PrintEquipment(&quot;Shirt&quot;) &gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingExa &quot;Shirt&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingChange &quot;Shirt&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingRemove &quot;Shirt&quot;&gt;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
    &lt;td&gt;&lt;&lt;wlink &quot;Pants&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;= $Player.PrintEquipment(&quot;Pants&quot;) &gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingExa &quot;Pants&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingChange &quot;Pants&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingRemove &quot;Pants&quot;&gt;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
    &lt;td&gt;&lt;&lt;wlink &quot;Dress&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;= $Player.PrintEquipment(&quot;Dress&quot;) &gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingExa &quot;Dress&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingChange &quot;Dress&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingRemove &quot;Dress&quot;&gt;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
    &lt;td&gt;&lt;&lt;wlink &quot;Costume&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;= $Player.PrintEquipment(&quot;Costume&quot;) &gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingExa &quot;Costume&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingChange &quot;Costume&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingRemove &quot;Costume&quot;&gt;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
    &lt;td&gt;&lt;&lt;wlink &quot;Shoes&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;= $Player.PrintEquipment(&quot;Shoes&quot;) &gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingExa &quot;Shoes&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingChange &quot;Shoes&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingRemove &quot;Shoes&quot;&gt;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
    &lt;td&gt;&lt;&lt;wlink &quot;Butt&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;= $Player.PrintEquipment(&quot;Butt&quot;) &gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingExa &quot;Butt&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingChange &quot;Butt&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingRemove &quot;Butt&quot;&gt;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
    &lt;td&gt;&lt;&lt;wlink &quot;Penis&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;= $Player.PrintEquipment(&quot;Penis&quot;) &gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingExa &quot;Penis&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingChange &quot;Penis&quot;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;WearingRemove &quot;Penis&quot;&gt;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="66" name="AttractionPhase" tags="widget" position="8225,100">&lt;&lt;widget &quot;attractButtons&quot;&gt;&gt;\
&lt;&lt;nobr&gt;&gt;
@@.cmdButton;&lt;&lt;button &quot;Femininity&quot;&gt;&gt;
&lt;&lt;set $CL = $Player.SolicitCustomer(1, _NPC.Lust(), _NPC.Mood(), _NPC.Wealth());&gt;&gt;
&lt;&lt;replace &quot;#WhoreDialog&quot;&gt;&gt;&lt;&lt;negotiateDialog 1&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#WhoreCommands&quot;&gt;&gt;&lt;&lt;negotiateButtons&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#CommandTxt&quot;&gt;&gt;&lt;&lt;negotiateHeading&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;/button&gt;&gt;@@
&lt;&lt;if $Player.GetStatPercent(&quot;STAT&quot;, &quot;Perversion&quot;) &lt; 40&gt;&gt;
@@.cmdDisabledButton;&lt;&lt;button &quot;Perversion&quot;&gt;&gt;&lt;&lt;/button&gt;&gt;@@
&lt;&lt;else&gt;&gt;
@@.cmdButton;&lt;&lt;button &quot;Perversion&quot;&gt;&gt;
&lt;&lt;set $CL = $Player.SolicitCustomer(2, _NPC.Lust(), _NPC.Mood(), _NPC.Wealth());&gt;&gt;
&lt;&lt;replace &quot;#WhoreDialog&quot;&gt;&gt;&lt;&lt;negotiateDialog 2&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#WhoreCommands&quot;&gt;&gt;&lt;&lt;negotiateButtons&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#CommandTxt&quot;&gt;&gt;&lt;&lt;negotiateHeading&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;/button&gt;&gt;@@
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $Player.Fetish() &lt; 40&gt;&gt;
@@.cmdDisabledButton;&lt;&lt;button &quot;Fetish&quot;&gt;&gt;&lt;&lt;/button&gt;&gt;@@
&lt;&lt;else&gt;&gt;
@@.cmdButton;&lt;&lt;button &quot;Fetish&quot;&gt;&gt;
&lt;&lt;set $CL = $Player.SolicitCustomer(3, _NPC.Lust(), _NPC.Mood(), _NPC.Wealth());&gt;&gt;
&lt;&lt;replace &quot;#WhoreDialog&quot;&gt;&gt;&lt;&lt;negotiateDialog 3&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#WhoreCommands&quot;&gt;&gt;&lt;&lt;negotiateButtons&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#CommandTxt&quot;&gt;&gt;&lt;&lt;negotiateHeading&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;/button&gt;&gt;@@
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;
&lt;&lt;widget &quot;attractDialog&quot;&gt;&gt;\
First you&#39;ll need to @@color:DeepPink;attract some customers@@. Select your preferred technique from the @@color:cyan;COMMAND@@ menu. Some options may be @@color:grey;[disabled]@@ if you lack a required statistic.

Your available options are: Attract customers using your &lt;&lt;print _PR.ColorizeString($Player.GetStatPercent(&quot;STAT&quot;,&quot;Femininity&quot;), &quot;femininity&quot;);&gt;&gt; or step it up and actively solicit with &lt;&lt;print _PR.ColorizeString($Player.GetStatPercent(&quot;STAT&quot;,&quot;Perversion&quot;), &quot;perverse catcalls&quot;);&gt;&gt; and offers of raunchy sex acts. Finally you can put on a &lt;&lt;print _PR.ColorizeString($Player.Fetish(), &quot;live sex show&quot;);&gt;&gt; hoping that your lewd body will bring the men in droves.&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="67" name="combatWidgets" tags="widget" position="8350,100">&lt;&lt;widget &quot;enemyStatus&quot;&gt;&gt;&lt;&lt;nobr&gt;&gt;
&lt;table&gt;
&lt;tbody&gt;
&lt;tr&gt;
    &lt;td colspan=&quot;2&quot;&gt;@@color:yellow;&lt;&lt;print $args[0].Name()&gt;&gt;@@&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
    &lt;td&gt;Health&lt;/td&gt;
	&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print $args[0].HealthMeter(); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
    &lt;td&gt;Energy&lt;/td&gt;
	&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print $args[0].EnergyMeter(); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;enemyStatus2&quot;&gt;&gt;&lt;&lt;print JSON.stringify($args[0]);&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;combatPanel&quot;&gt;&gt;&lt;&lt;nobr&gt;&gt;
&lt;&lt;set _CE = window.App.CombatEngine; &gt;&gt;
&lt;&lt;run _CE.LoadEncounter($args[0]);&gt;&gt;
&lt;&lt;set _EN = _CE.GetEnemies(); &gt;&gt;
&lt;table&gt;
&lt;tbody&gt;
&lt;tr style=&quot;border-bottom:solid 1px white;&quot;&gt;
	&lt;td colspan=&quot;4&quot;&gt;@@color:cyan;Combat Encounter!@@&lt;/td&gt;
&lt;/tr&gt;
&lt;tr style=&quot;border-bottom:solid 1px white;&quot;&gt;
&lt;&lt;for _i = 0; _i &lt; 4; _i++&gt;&gt;
&lt;&lt;if _i &lt; _EN.length&gt;&gt;
	&lt;td style=&quot;width:200px;&quot;&gt;&lt;&lt;enemyStatus _EN[_i]&gt;&gt;&lt;/td&gt;
&lt;&lt;else&gt;&gt;
	&lt;td style=&quot;width:200px;&quot;&gt; &lt;/td&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="68" name="customMenuLink" tags="widget" position="8475,100">&lt;&lt;widget &quot;customMenuLink&quot;&gt;&gt;\
&lt;&lt;click $args[0] $args[0]&gt;&gt;
&lt;&lt;if def $args[1]&gt;&gt;&lt;&lt;set $MenuAction = $args[1]&gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;if not tags().contains(&quot;custom-menu&quot;)&gt;&gt;&lt;&lt;set $GameBookmark = passage(); &gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/click&gt;&gt;\
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="69" name="negotiateButton" tags="widget" position="8600,100">&lt;&lt;widget negotiateButton&gt;&gt;&lt;&lt;nobr&gt;&gt;
&lt;&lt;set _SexName = _PR.pSkillName($args[0]);&gt;&gt;
&lt;&lt;if $Customer.HasRefused($args[0])&gt;&gt;
@@.cmdDisabledButton;&lt;&lt;button _SexName&gt;&gt;&lt;&lt;/button&gt;&gt;@@
&lt;&lt;else&gt;&gt;
&lt;&lt;if $args[0] eq &quot;TitFucking&quot; and $Player.GetStatPercent(&quot;BODY&quot;, &quot;Bust&quot;) &lt; 6&gt;&gt;
@@.cmdDisabledButton;&lt;&lt;button _SexName&gt;&gt;&lt;&lt;/button&gt;&gt;@@
&lt;&lt;else&gt;&gt;
&lt;&lt;if $args[0] eq $Customer.SexAct&gt;&gt;
@@.cmdButton;&lt;&lt;button _SexName&gt;&gt;
&lt;&lt;set $WhoreTurn = 1&gt;&gt;
&lt;&lt;replace &quot;#WhoreDialog&quot;&gt;&gt;
You decided to agree with @@color:cyan;&lt;&lt;print $Customer.Name;&gt;&gt;&#39;s@@ request. The two of you walk off to a more secluded area to get down to business...&lt;br/&gt;&lt;br/&gt;

You are now prostituting yourself. Make sure to raise the customers @@color:lime;Satisfaction@@ level to full to get the most pay out. Satisfaction increases faster when the customer is fully @@color:DeepPink;Aroused@@.
&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#WhoreCommands&quot;&gt;&gt;&lt;&lt;sexButtons&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#CommandTxt&quot;&gt;&gt;&lt;&lt;sexHeading &quot;normal&quot;&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#SexProgress&quot;&gt;&gt;&lt;&lt;sexProgress&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;/button&gt;&gt;@@
&lt;&lt;else&gt;&gt;
@@.cmdButton;&lt;&lt;button _SexName&gt;&gt;

&lt;&lt;set _Response = $Customer.Negotiate($args[0], $Player); &gt;&gt;

&lt;&lt;if _Response eq -1&gt;&gt;
&lt;&lt;set $WhoreTurn = 1&gt;&gt;
&lt;&lt;set _RAPE = 1;&gt;&gt;
&lt;&lt;set $Customer.RapeMode= true;&gt;&gt;
&lt;&lt;replace &quot;#WhoreCommands&quot;&gt;&gt;&lt;&lt;sexButtons&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#WhoreDialog&quot;&gt;&gt;
You approach @@color:cyan;$Customer.Name@@ and try to proposition that you perform a different sex act for money.&lt;br/&gt;&lt;br/&gt;
@@color:DeepPink;You say, &quot;&lt;&lt;print $Customer.DoChat($Player,  &quot;Negotiate&quot;, $args[0]); &gt;&gt;@@&quot;&lt;br/&gt;&lt;br/&gt;
@@color:cyan;$Customer.Name@@ gets angry and says, &quot;&lt;&lt;print $Customer.DoChat($Player, &quot;Angry&quot;);&gt;&gt;&quot;&lt;br/&gt;&lt;br/&gt;
@@color:cyan;$Customer.Name@@ grabs you violently and starts beating you. @@color:red;It hurts!@@ You&#39;ll have to do what he says or else!&lt;br/&gt;&lt;br/&gt;
You are being @@color:red;raped@@. This is dangerous, if you perform poorly, you may be beaten or even killed.
&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#CommandTxt&quot;&gt;&gt;&lt;&lt;sexHeading &quot;rape&quot;&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#SexProgress&quot;&gt;&gt;&lt;&lt;sexProgress&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if _Response eq 0&gt;&gt;
&lt;&lt;replace &quot;#WhoreDialog&quot;&gt;&gt;
You approach @@color:cyan;$Customer.Name@@ and try to proposition that you perform a different sex act for money.&lt;br/&gt;&lt;br/&gt;
@@color:DeepPink;You say, &quot;&lt;&lt;print $Customer.DoChat($Player,  &quot;Negotiate&quot;, $args[0]); &gt;&gt;&quot;@@&lt;br/&gt;&lt;br/&gt;
@@color:cyan;$Customer.Name@@ seems to think about it for a moment and then says, &quot;&lt;&lt;print $Customer.DoChat($Player, &quot;Disagree&quot;); &gt;&gt;&quot;
&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#WhoreCommands&quot;&gt;&gt;&lt;&lt;negotiateButtons&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if _Response eq 1&gt;&gt;
&lt;&lt;set $WhoreTurn = 1&gt;&gt;
&lt;&lt;replace &quot;#WhoreDialog&quot;&gt;&gt;
You approach @@color:cyan;$Customer.Name@@ and try to proposition that you perform a different sex act for money.&lt;br/&gt;&lt;br/&gt;
@@color:DeepPink;You say, &quot;&lt;&lt;print $Customer.DoChat($Player,  &quot;Negotiate&quot;, $args[0]); &gt;&gt;&quot;@@&lt;br/&gt;&lt;br/&gt;
@@color:cyan;$Customer.Name@@ seems to think about it for a moment and then says, &quot;&lt;&lt;print $Customer.DoChat($Player, &quot;Agree&quot;, $args[0]);&gt;&gt;&quot;
&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#WhoreCommands&quot;&gt;&gt;&lt;&lt;sexButtons&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#CommandTxt&quot;&gt;&gt;&lt;&lt;sexHeading &quot;normal&quot;&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $Customer.HasRefused(&quot;HandJobs&quot;) and $Customer.HasRefused(&quot;TitFucking&quot;) and $Customer.HasRefused(&quot;BlowJobs&quot;) and $Customer.HasRefused(&quot;AssFucking&quot;)&gt;&gt;
&lt;&lt;append &quot;#WhoreDialog&quot;&gt;&gt;
You wince as $Customer.Name refuses your offer. You may be a prostitute by circumstance, but you just can&#39;t bring yourself to be &lt;&lt;print window.App.PR.ColorizeString($Player.CoreStats[&quot;Perversion&quot;], &quot;perverted&quot;); &gt;&gt; enough to agree to his demands, so you&#39;ll have to turn him away.&lt;br/&gt;&lt;br/&gt;
&lt;&lt;if ($CL.length &gt; 0)&gt;&gt; At least there are still some more customers waiting in line, if you choose to see them.
&lt;&lt;/if&gt;&gt;
&lt;&lt;/append&gt;&gt;
&lt;&lt;replace &quot;#WhoreCommands&quot;&gt;&gt;&lt;&lt;sexEndButtons&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/button&gt;&gt;@@
&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="70" name="NegotiationPhase" tags="widget" position="8725,100">&lt;&lt;widget &quot;negotiateButtons&quot;&gt;&gt;\
&lt;&lt;nobr&gt;&gt;

&lt;&lt;if $Player.GetStatPercent(&quot;STAT&quot;, &quot;Perversion&quot;) &lt; 20 or $Player.GetStatPercent(&quot;BODY&quot;, &quot;Bust&quot;) &lt; 8&gt;&gt;
&lt;&lt;run $Customer.Refused.push(&quot;TitFucking&quot;);&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $Player.GetStatPercent(&quot;STAT&quot;, &quot;Perversion&quot;) &lt; 30&gt;&gt;
&lt;&lt;run $Customer.Refused.push(&quot;BlowJobs&quot;);&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;if $Player.GetStatPercent(&quot;STAT&quot;, &quot;Perversion&quot;) &lt; 50&gt;&gt;
&lt;&lt;run $Customer.Refused.push(&quot;AssFucking&quot;);&gt;&gt;&lt;&lt;/if&gt;&gt;

&lt;&lt;negotiateButton &quot;HandJobs&quot;&gt;&gt;
&lt;&lt;negotiateButton &quot;TitFucking&quot;&gt;&gt;
&lt;&lt;negotiateButton &quot;BlowJobs&quot;&gt;&gt;
&lt;&lt;negotiateButton &quot;AssFucking&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;negotiateDialog&quot;&gt;&gt;\
&lt;&lt;nobr&gt;&gt;

&lt;&lt;if $args[0] eq 1&gt;&gt;
You decide to passively attract customers by relying on your &lt;&lt;print _PR.ColorizeString($Player.GetStatPercent(&quot;STAT&quot;, &quot;Femininity&quot;),&quot;feminine charms&quot;) &gt;&gt;. You primp and preen and look mildly disinterested as you saunter back and forth among the @@color:cyan;&lt;&lt;print _NPC.Title();&gt;&gt;@@ occasionally stopping to do a slightly suggestive pose or otherwise look feminine and helpless.&lt;br/&gt;&lt;br/&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $args[0] eq 2&gt;&gt;
You decide to go with &lt;&lt;print _PR.ColorizeString($Player.GetStatPercent(&quot;STAT&quot;, &quot;Perversion&quot;),&quot;lewd gestures and propositions&quot;) &gt;&gt; as a way to attract customers. You start by advertising your willingness to do anything for a few coins, making sure to grab and fondle your body as you declare to the entire world what a @@color:DeepPink;&quot;horny sissy slut&quot;@@ you are and how eager you are for a good hard cock.&lt;br/&gt;&lt;br/&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $args[0] eq 3&gt;&gt;
You decide to put on a show of your &lt;&lt;print _PR.ColorizeString($Player.Fetish(),&quot;lewd body&quot;) &gt;&gt; in hopes of attracting a pervert to pay for a quick fuck. You start off by alterting your outfit, hitching it up in some places and loosing it in others so as to show off your &lt;&lt;print _PR.pBust($Player, 1);&gt;&gt; tits and &lt;&lt;print _PR.pAss($Player, 1);&gt;&gt; ass. As you stroll among the customers you put extra effort into wiggling and shaking your assets and more than one man catches you suggestively sucking on your own finger with your &lt;&lt;print _PR.pLips($Player,1);&gt;&gt; lips.&lt;br/&gt;&lt;br/&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $CL.length eq 0&gt;&gt;
Some time passes, but despite your efforts you were unable to attract any potential customers. Perhaps either the business is dead here or you might need to work on your appearance in order to get more work.
&lt;&lt;else&gt;&gt;
&lt;&lt;set $Customer = $CL.shift(); &gt;&gt;

&lt;&lt;if  ( $Customer.SexAct == &quot;TitFucking&quot; ) &amp;&amp;              
	  ( $Player.GetStatPercent(&quot;BODY&quot;, &quot;Bust&quot;) &lt; 8 ) &gt;&gt;
&lt;&lt;set $Customer.SexAct = &quot;HandJobs&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

You keep up the act for decent amount of time and eventually it starts to have the desired effect as a customer approaches you!&lt;br/&gt;&lt;br/&gt;
&lt;&lt;print &quot;@@color:cyan;&quot; + $Customer.Name + &quot;@@ says: &quot;+ $Customer.DoChat($Player, &quot;CustomerIntro&quot;);&gt;&gt;&lt;br/&gt;&lt;br/&gt;

@@color:cyan;$Customer.Name@@ wants a &lt;&lt;print _PR.pSkillName($Customer.SexAct); &gt;&gt;. What do you offer?
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;negotiateHeading&quot;&gt;&gt;\
&lt;&lt;if $CL.length eq 0&gt;&gt;\
@@color:yellow;Customer Attraction@@ @@color:red;FAILED@@\
&lt;&lt;else&gt;&gt;\
@@color:yellow;Customer Attraction@@ @@color:lime;SUCCESS@@ \
@@color:yellow;Negotiate Sex Act@@&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="71" name="printJobResult" tags="widget" position="8850,100">&lt;&lt;widget &quot;printJobResult&quot;&gt;&gt;&lt;&lt;nobr&gt;&gt;
&lt;&lt;set _Start = $args[0].PrintStart($Player, _NPC);&gt;&gt;
&lt;&lt;set _Scenes = $args[0].PlayScenes($Player, _NPC); &gt;&gt;
&lt;&lt;set _End = $args[0].PrintEnd($Player, _NPC);&gt;&gt;
&lt;&lt;if _Start != &quot;&quot;&gt;&gt;&lt;&lt;print _Start&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;for _i = 0; _i &lt; _Scenes.length; _i++&gt;&gt;
&lt;br/&gt;&lt;&lt;print _Scenes[_i].Print();&gt;&gt;&lt;&lt;/for&gt;&gt;
&lt;&lt;if _End != &quot;&quot;&gt;&gt;&lt;br/&gt;&lt;&lt;print $args[0].PrintEnd($Player, _NPC); &gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;jobButton&quot;&gt;&gt;&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $args[0].Available($Player, _NPC)&gt;&gt;
&lt;&lt;button &quot;Accept&quot;&gt;&gt;&lt;&lt;replace &quot;#JobUI&quot;&gt;&gt;&lt;&lt;printJobResult $args[0]&gt;&gt;&lt;&lt;/replace&gt;&gt;&lt;&lt;replace &quot;#PlayerScore&quot;&gt;&gt;&lt;&lt;score&gt;&gt;&lt;&lt;/replace&gt;&gt;&lt;&lt;/button&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;if $args[0].OnCoolDown($Player) == true&gt;&gt;
&lt;&lt;button &quot;COOLDOWN&quot;&gt;&gt;&lt;&lt;/button&gt;&gt;&lt;&lt;else&gt;&gt;
&lt;&lt;button &quot;LOCKED&quot;&gt;&gt;&lt;&lt;/button&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;print $args[0].ReqString($Player);&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="72" name="printPlayerDescription" tags="widget" position="8975,100">&lt;&lt;widget &quot;printPlayerDescription&quot;&gt;&gt;\
You stare into the mirror...

You are &lt;&lt;print window.App.PR.pHeight($Player);&gt;&gt; and &lt;&lt;print window.App.PR.pFitness($Player);&gt;&gt; You have a &lt;&lt;print window.App.PR.pFace($Player);&gt;&gt; &lt;&lt;print window.App.PR.pHair($Player);&gt;&gt; &lt;&lt;print window.App.PR.pEyes($Player);&gt;&gt; You have &lt;&lt;print window.App.PR.pLips($Player);&gt;&gt; &lt;&lt;print window.App.PR.pBust($Player);&gt;&gt; &lt;&lt;print window.App.PR.pAss($Player);&gt;&gt; &lt;&lt;print window.App.PR.pHips($Player);&gt;&gt; &lt;&lt;print window.App.PR.pWaist($Player);&gt;&gt; and &lt;&lt;print window.App.PR.pFigure($Player);&gt;&gt;. You have &lt;&lt;print window.App.PR.pPenis($Player);&gt;&gt; and &lt;&lt;print window.App.PR.pBalls($Player);&gt;&gt; between your legs.
You consider your natural beauty to be &lt;&lt;print window.App.PR.pBeauty($Player);&gt;&gt;.
The fetish appeal of your body is &lt;&lt;print window.App.PR.pFetish($Player);&gt;&gt;.
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="73" name="printStyleDescription" tags="widget" position="9100,100">&lt;&lt;widget &quot;printStyleDescription&quot;&gt;&gt;\
&lt;&lt;nobr&gt;&gt;
&lt;span id=&quot;StyleDesc&quot;&gt;&lt;&lt;print window.App.PR.pHair($Player);&gt;&gt; &lt;&lt;print window.App.PR.pMakeup($Player);&gt;&gt;. &lt;&lt;print &quot;The style and fashion of your clothing is &quot; +  window.App.PR.pClothing($Player)&gt;&gt;. &lt;&lt;print &quot;Your hygiene and styling is &quot; + window.App.PR.pStyle($Player); &gt;&gt;.&lt;/span&gt;&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="74" name="questDialog" tags="widget" position="9225,100">&lt;&lt;widget &quot;questDialog&quot;&gt;&gt;\
&lt;&lt;set _ID = $args[0][&quot;ID&quot;]&gt;&gt;\
&lt;&lt;set _QE = window.App.QuestEngine;&gt;&gt;\
&lt;&lt;set $ChoiceItem = 0&gt;&gt;\
&lt;&lt;set _NPC = $Player.NPCS[$MenuAction]&gt;&gt;\
&lt;&lt;if _QE.GetQuestFlag($Player, _ID) == 0&gt;&gt;\
&lt;&lt;print window.App.PR.pQuestDialog(_ID, &quot;INTRO&quot;, $Player, _NPC); &gt;&gt;

@@.cmdButton;&lt;&lt;button &quot;Accept&quot;&gt;&gt;\
&lt;&lt;run _QE.SetQuestFlag($Player, _ID, &quot;ACTIVE&quot;)&gt;&gt;\
&lt;&lt;replace &quot;#QuestUI&quot;&gt;&gt;&lt;&lt;questList&gt;&gt;&lt;&lt;/replace&gt;&gt;&lt;&lt;/button&gt;&gt;@@   @@.cmdButton;&lt;&lt;button &quot;Decline&quot;&gt;&gt;&lt;&lt;replace &quot;#QuestUI&quot;&gt;&gt;&lt;&lt;questList&gt;&gt;&lt;&lt;/replace&gt;&gt;&lt;&lt;/button&gt;&gt;@@
&lt;&lt;else&gt;&gt;\
&lt;&lt;if _QE.CanCompleteQuest($Player, _ID) == 0&gt;&gt;\
&lt;&lt;print window.App.PR.pQuestDialog(_ID, &quot;MIDDLE&quot;, $Player, _NPC); &gt;&gt;

&lt;&lt;print window.App.PR.pQuestRequirements(_ID, $Player);&gt;&gt;

@@.cmdButton;&lt;&lt;button &quot;Okay, fine&quot;&gt;&gt;&lt;&lt;replace &quot;#QuestUI&quot;&gt;&gt;&lt;&lt;questList&gt;&gt;&lt;&lt;/replace&gt;&gt;&lt;&lt;/button&gt;&gt;@@
&lt;&lt;else&gt;&gt;\
&lt;&lt;print window.App.PR.pQuestDialog(_ID, &quot;FINISH&quot;, $Player, _NPC); &gt;&gt;

&lt;&lt;if $args[0][&quot;REWARD&quot;].length != 0&gt;&gt;
@@color:DeepPink;Quest Rewards@@:
&lt;&lt;set _Rewards = window.App.PR.pQuestRewards(_ID) &gt;&gt;\
&lt;&lt;set $ChoiceItem to 0&gt;&gt;\
&lt;&lt;for _i = 0; _i &lt; _Rewards.length; _i++&gt;&gt;\
&lt;&lt;print _Rewards[_i] &gt;&gt;&lt;br/&gt;&lt;&lt;/for&gt;&gt;
&lt;&lt;set _Choices = _QE.GetQuestRewards(_ID, &quot;ITEM_CHOICE&quot;);&gt;&gt;\
&lt;&lt;if _Choices.length &gt; 0&gt;&gt;\
@@color:Cyan;Pick One@@:
&lt;&lt;for _i = 0; _i &lt; _Choices.length;_i++&gt;&gt;\
&lt;&lt;if _i == 0&gt;&gt;\
* &lt;&lt;print &#39;&lt;&lt;radiobutton &quot;$ChoiceItem&quot;  &quot;&#39;+_Choices[_i][&quot;NAME&quot;] +&#39;&quot; checked&gt;&gt; &#39; + window.App.PR.pItemDesc(_Choices[_i][&quot;TYPE&quot;], _Choices[_i][&quot;NAME&quot;], _Choices[_i][&quot;AMOUNT&quot;]) &gt;&gt;&lt;&lt;else&gt;&gt;\
* &lt;&lt;print &#39;&lt;&lt;radiobutton &quot;$ChoiceItem&quot;  &quot;&#39;+_Choices[_i][&quot;NAME&quot;] +&#39;&quot;&gt;&gt; &#39; + window.App.PR.pItemDesc(_Choices[_i][&quot;TYPE&quot;], _Choices[_i][&quot;NAME&quot;], _Choices[_i][&quot;AMOUNT&quot;]) &gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;/for&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;
@@.cmdButton;&lt;&lt;button &quot;Complete Quest&quot; $GameBookmark&gt;&gt;\
&lt;&lt;run _QE.CompleteQuest($Player, _ID, $ChoiceItem); &gt;&gt;\
&lt;&lt;if _QE.GetQuestFlag($Player, &quot;GAME_WON&quot;) == 1&gt;&gt;\
&lt;&lt;goto &quot;GameWon&quot;&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/button&gt;&gt;@@
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="75" name="questEntry" tags="widget" position="9350,100">&lt;&lt;widget &quot;questEntry&quot;&gt;&gt;\
&lt;&lt;set _QE = window.App.QuestEngine; &gt;&gt;\
&lt;&lt;print &#39;&lt;&lt;click &quot;&#39;+$args[0][&quot;Title&quot;]+&#39;&quot;&gt;&gt;&lt;&lt;replace &quot;#QuestUI&quot;&gt;&gt;&lt;&lt;questDialog $args[0]&gt;&gt;&lt;&lt;/replace&gt;&gt;&lt;&lt;/click&gt;&gt;&#39;;&gt;&gt;\
&lt;&lt;if _QE.GetQuestFlag($Player, $args[0][&quot;ID&quot;]) == &quot;ACTIVE&quot;&gt;&gt;\
&lt;&lt;print &quot;  @@color:lime;(IN PROGRESS)@@&quot;; &gt;&gt;&lt;&lt;/if&gt;&gt;\
&lt;&lt;if _QE.CanCompleteQuest($Player, $args[0][&quot;ID&quot;]) == 1&gt;&gt;\
&lt;&lt;print &quot;  @@color:DeepPink;(READY TO TURN IN!)@@&quot;;&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="76" name="questList" tags="widget" position="9475,100">&lt;&lt;widget &quot;questList&quot;&gt;&gt;\
&lt;&lt;set _QE = window.App.QuestEngine;&gt;&gt;\
&lt;&lt;set _QL = _QE.GetQuests(&quot;any&quot;, $Player, $MenuAction);&gt;&gt;\
&lt;&lt;set _NPC = $Player.NPCS[$MenuAction];&gt;&gt;\
&lt;&lt;set $n = _NPC.pName(); &gt;&gt;\
You approach $n and ask about any &#39;special tasks&#39; that need to be done.

&lt;&lt;for _i = 0; _i &lt; _QL.length; _i++&gt;&gt;\
&lt;&lt;if _QE.QuestAvailable($Player, _QL[_i][&quot;ID&quot;]) or
_QE.QuestActive($Player, _QL[_i][&quot;ID&quot;])&gt;&gt;\
&lt;&lt;questEntry _QL[_i]&gt;&gt;\
&lt;&lt;else&gt;&gt;\
&lt;&lt;if _QE.QuestCompleted($Player, _QL[_i][&quot;ID&quot;])&gt;&gt;\
@@color:grey;&lt;&lt;print _QL[_i][&quot;Title&quot;]&gt;&gt;@@ @@color:yellow;(COMPLETED)@@
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/for&gt;&gt;
@@color:cyan;Interact@@: &lt;&lt;click &quot;Exit&quot; $GameBookmark&gt;&gt;&lt;&lt;/click&gt;&gt;
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="77" name="sexButton" tags="widget" position="9600,100">&lt;&lt;widget &quot;sexButton&quot;&gt;&gt;&lt;&lt;nobr&gt;&gt;
&lt;&lt;set _Cmd = window.App.Data.Lists.SexCommands[$Customer.SexAct][$args[0]]&gt;&gt;
&lt;&lt;if $WhoreTurn &gt;= 5&gt;&gt;
&lt;&lt;if ($Player.Skills[$Customer.SexAct] &lt; _Cmd[&quot;Basic&quot;])&gt;&gt;
@@.cmdDisabledButton;&lt;&lt;button `&quot;LOCKED&quot;`&gt;&gt;&lt;&lt;/button&gt;&gt;@@
&lt;&lt;else&gt;&gt;
@@.cmdDisabledButton;&lt;&lt;button `_Cmd[&quot;Name&quot;]`&gt;&gt;&lt;&lt;/button&gt;&gt;@@
&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;if ($Player.Skills[$Customer.SexAct] &lt; _Cmd[&quot;Basic&quot;])&gt;&gt;
@@.cmdDisabledButton;&lt;&lt;button `&quot;LOCKED&quot;`&gt;&gt;&lt;&lt;/button&gt;&gt;@@
&lt;&lt;else&gt;&gt;
@@.cmdButton;&lt;&lt;button `_Cmd[&quot;Name&quot;]`&gt;&gt;

&lt;&lt;set _Cmd = window.App.Data.Lists.SexCommands[$Customer.SexAct][$args[0]]&gt;&gt;
&lt;&lt;set $WhoreTurn += 1;&gt;&gt;
&lt;&lt;set _Response = $Customer.Fuck($Player, _Cmd); &gt;&gt;

&lt;&lt;replace &quot;#WhoreCommands&quot;&gt;&gt;&lt;&lt;sexButtons&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#WhoreDialog&quot;&gt;&gt;&lt;&lt;sexDialog&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#SexProgress&quot;&gt;&gt;&lt;&lt;sexProgress&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#PlayerScore&quot;&gt;&gt;&lt;&lt;score&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;/button&gt;&gt;@@
&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="78" name="SexPhase" tags="widget" position="9725,100">&lt;&lt;widget &quot;sexButtons&quot;&gt;&gt;\
&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $Player.GetStat(&quot;STAT&quot;, &quot;Health&quot;) &lt; 1&gt;&gt;
@@.cmdButton;&lt;&lt;button &quot;Game Over&quot; &quot;GameOver&quot;&gt;&gt;&lt;&lt;/button&gt;&gt;@@
&lt;&lt;else&gt;&gt;
&lt;&lt;sexButton 0&gt;&gt;
&lt;&lt;sexButton 1&gt;&gt;
&lt;&lt;sexButton 2&gt;&gt;
&lt;&lt;sexButton 3&gt;&gt;
&lt;&lt;if ($WhoreTurn != 5) and 
($Customer.Arousal &lt; 70)&gt;&gt;
@@.cmdDisabledButton;&lt;&lt;button &quot;Finish&quot;&gt;&gt;&lt;&lt;/button&gt;&gt;&lt;&lt;else&gt;&gt;
@@.cmdButton;&lt;&lt;button &quot;Finish&quot;&gt;&gt;

&lt;&lt;append &quot;#WhoreDialog&quot;&gt;&gt;&lt;&lt;sexEndDialog&gt;&gt;&lt;&lt;/append&gt;&gt;
&lt;&lt;replace &quot;#WhoreCommands&quot;&gt;&gt;&lt;&lt;sexEndButtons&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#CommandTxt&quot;&gt;&gt;&lt;&lt;sexEndHeader&gt;&gt;&lt;&lt;/replace&gt;&gt;

&lt;&lt;/button&gt;&gt;@@
&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;sexDialog&quot;&gt;&gt;\
&lt;&lt;nobr&gt;&gt;
&lt;&lt;print _Response;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;sexHeading&quot;&gt;&gt;\
&lt;&lt;nobr&gt;&gt;
&lt;&lt;if _RAPE == 1&gt;&gt;
@@color:yellow;Customer Negotiation@@ @@color:red;FAILED@@ - @@color:yellow;Currently being@@ @@color:red;RAPED@@ by @@color:cyan;$Customer.Name@@
&lt;&lt;else&gt;&gt;
@@color:yellow;Customer Negotiation@@ @@color:lime;SUCCESS@@ - @@color:yellow;Currently Fucking@@ @@color:cyan;$Customer.Name@@ @@color:yellow;&lt;&lt;print &quot;(&quot; + _PR.pSkillName($Customer.SexAct) +&quot;)&quot;;&gt;&gt;@@
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;sexProgress&quot;&gt;&gt;&lt;&lt;nobr&gt;&gt;
&lt;table style=&quot;font-size:smaller;font-weight:bold;&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;
    &lt;td style=&quot;color:yellow;&quot;&gt;Sex Progress&lt;/td&gt;
	&lt;td style=&quot;text-align:center;&quot;&gt;Round [&lt;&lt;print $WhoreTurn;&gt;&gt;/5]&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;color:lime;&quot;&gt;Satisfaction&lt;/td&gt;
&lt;td style=&quot;font:fixed-font;&quot;&gt;
&lt;&lt;print _PR.pMeter($Customer.GetServiceRating(), 100);&gt;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;color:DeepPink;&quot;&gt;Arousal&lt;/td&gt;
&lt;td style=&quot;font:fixed-font;&quot;&gt;
&lt;&lt;print _PR.pMeter($Customer.GetArousal(), 100);&gt;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="79" name="shipPortLink" tags="widget" position="9850,100">&lt;&lt;widget shipPortLink&gt;&gt;\
&lt;&lt;set _Port = $Player.GetShipLocation(); &gt;&gt;\
&lt;&lt;set _Quest = window.App.QuestEngine; &gt;&gt;\
&lt;&lt;if _Port != 0&gt;&gt;\
&lt;&lt;set _Passage = _Port[&quot;PASSAGE&quot;] &gt;&gt;\
&lt;&lt;if _Quest.GetQuestFlag($Player, &quot;BOARDINGPASS&quot;) == &quot;ACTIVE&quot;&gt;&gt;\
@@color:lime;Disembark@@: @@color:grey;&lt;&lt;print _Port[&quot;NAME&quot;] &gt;&gt;@@ @@color:red;(LOCKED)@@
&lt;&lt;else&gt;&gt;\
@@color:lime;Disembark:@@ &lt;&lt;click `_Port[&quot;NAME&quot;]`&gt;&gt;\
&lt;&lt;if _Quest.GetQuestFlag($Player, &quot;BOARDINGPASS&quot;) != &quot;COMPLETED&quot;&gt;&gt;\
&lt;&lt;replace &quot;#BoardingPass&quot;&gt;&gt;\
As you approach the gangplank to leave the @@color:cyan;Salty Mermaid@@, two burly armed Pirates bar your way. Even with the magical geas on you, it appears it won&#39;t be possible for you to leave the ship without permission.&lt;&lt;/replace&gt;&gt;
&lt;&lt;run _Quest.SetQuestFlag($Player, &quot;PRE_BOARDINGPASS&quot;, &quot;COMPLETED&quot;);&gt;&gt;\
&lt;&lt;else&gt;&gt;\
&lt;&lt;goto _Passage&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/click&gt;&gt;
&lt;&lt;/if&gt;&gt;\
&lt;span id=&quot;BoardingPass&quot;&gt;&lt;/span&gt;
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="80" name="storeButton" tags="widget" position="9975,100">&lt;&lt;widget &quot;storeButton&quot;&gt;&gt;\
&lt;&lt;if ($args[0][&quot;TYPE&quot;] == &quot;CLOTHES&quot;) and ($Player.OwnsWardrobeItem($args[0]) == true)&gt;&gt;@@.disabledStoreButton;&lt;&lt;button &quot;OWNED&quot;&gt;&gt;&lt;&lt;/button&gt;&gt;@@\
&lt;&lt;else&gt;&gt;\
&lt;&lt;if ($args[0][&quot;QTY&quot;] &lt; 1) or
(_ST.PlayerCanAfford($args[0]) != 1)&gt;&gt;\
@@.disabledStoreButton;&lt;&lt;button &quot;BUY&quot;&gt;&gt;&lt;&lt;/button&gt;&gt;@@\
&lt;&lt;else&gt;&gt;\
&lt;&lt;if $Player.MaxItemCapacity($args[0])&gt;&gt;@@.disabledStoreButton;&lt;&lt;button &quot;FULL&quot;&gt;&gt;&lt;&lt;/button&gt;&gt;@@\
&lt;&lt;else&gt;&gt;\
@@.storeButton;&lt;&lt;button &quot;BUY&quot; &quot;Shop&quot;&gt;&gt;\
&lt;&lt;run _ST.BuyItem($args[0]);&gt;&gt;\
&lt;&lt;/button&gt;&gt;@@\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="81" name="storeInventory" tags="widget" position="10100,100">&lt;&lt;widget storeInventory&gt;&gt;\
&lt;&lt;set _NPC = $MenuAction&gt;&gt;\
&lt;&lt;set _SE = window.App.StoreEngine;&gt;&gt;\
&lt;&lt;set _ST = _SE.OpenStore($Player, _NPC);&gt;&gt;\
&lt;&lt;set _CI = _ST.GetCommonInventory();&gt;&gt;\
&lt;&lt;set _RI = _ST.GetRareInventory(); &gt;&gt;\
&lt;&lt;nobr&gt;&gt;
&lt;table class=&quot;.MyTable&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;&lt;td colspan=&quot;4&quot; style=&quot;font-size:larger;text-align:center;&quot;&gt;@@color:cyan;&lt;&lt;print _ST.GetName();&gt;&gt;@@&lt;/td&gt;
&lt;/tr&gt;
&lt;tr style=&quot;border-bottom:solid 1px white;&quot;&gt;
&lt;td style=&quot;width: 310px;&quot;&gt;@@color:yellow;General Items@@&lt;/td&gt;
&lt;td style=&quot;width: 80px;font-size:smaller;text-align:center;&quot;&gt;Quantity&lt;/td&gt;
&lt;td style=&quot;width: 60px;font-size:smaller;text-align:right;&quot;&gt;Price&lt;/td&gt;
&lt;td style=&quot;width: 125px;&quot;&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;&lt;if _CI.length == 0&gt;&gt;
&lt;tr&gt;
&lt;td colspan=&quot;4&quot;&gt;  @@color:orange;Nothing for sale!@@&lt;/td&gt;
&lt;/tr&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;for _i = 0; _i lt _CI.length; _i++&gt;&gt;
&lt;tr&gt;
&lt;td&gt;  &lt;&lt;print _ST.PrintItem(_CI[_i]);&gt;&gt;&lt;/td&gt;
&lt;td style=&quot;text-align:center;&quot;&gt;&lt;&lt;print _CI[_i][&quot;QTY&quot;]&gt;&gt;&lt;/td&gt;
&lt;td style=&quot;text-align:right;&quot;&gt;&lt;&lt;print _ST.GetPrice(_CI[_i]);&gt;&gt;&lt;/td&gt;
&lt;td style=&quot;text-align:center;&quot;&gt;&lt;&lt;storeButton _CI[_i]&gt;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;tr style=&quot;border-bottom:solid 1px white;&quot;&gt;
&lt;td style=&quot;width: 310px;&quot;&gt;@@color:lime;Rare Items@@&lt;/td&gt;
&lt;td style=&quot;width: 80px;&quot;&gt; &lt;/td&gt;
&lt;td style=&quot;width: 60px;&quot;&gt; &lt;/td&gt;
&lt;td style=&quot;width: 125px;&quot;&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;&lt;if _RI.length == 0&gt;&gt;
&lt;tr&gt;
&lt;td colspan=&quot;4&quot;&gt;  @@color:orange;Nothing for sale!@@&lt;/td&gt;
&lt;/tr&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;for _i = 0; _i lt _RI.length; _i++&gt;&gt;
&lt;tr&gt;
&lt;td&gt;  &lt;&lt;print _ST.PrintItem(_RI[_i]);&gt;&gt;&lt;/td&gt;
&lt;td style=&quot;text-align:center;&quot;&gt;&lt;&lt;print _RI[_i][&quot;QTY&quot;]&gt;&gt;&lt;/td&gt;
&lt;td style=&quot;text-align:right;&quot;&gt;&lt;&lt;print _ST.GetPrice( _RI[_i]);&gt;&gt;&lt;/td&gt;
&lt;td style=&quot;text-align:center;&quot;&gt;&lt;&lt;storeButton _RI[_i]&gt;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="82" name="vanityMenu" tags="widget" position="10225,100">&lt;&lt;widget &quot;vanityMenu&quot;&gt;&gt;\
&lt;&lt;set _Hair = window.App.Data.Lists[&quot;HairStyles&quot;];&gt;&gt;\
&lt;&lt;set _H1 = $Player.GetItemCharges(&quot;hair tool&quot;);&gt;&gt;\
&lt;&lt;set _H2 = $Player.GetItemCharges(&quot;hair treatment&quot;);&gt;&gt;
&lt;&lt;set _HL = $Player.GetStat(&quot;BODY&quot;, &quot;Hair&quot;); &gt;&gt;\
&lt;&lt;set _M1 = $Player.GetItemCharges(&quot;basic makeup&quot;);&gt;&gt;\
&lt;&lt;set _M2 = $Player.GetItemCharges(&quot;expensive makeup&quot;);&gt;&gt;
&lt;&lt;set _Makeup = window.App.Data.Lists[&quot;MakeupStyles&quot;];&gt;&gt;\
&lt;&lt;set _Wig = $Player.Equipment[&quot;Wig&quot;];&gt;&gt;\
&lt;&lt;set _Wigs = $Player.WardrobeItemsBySlot(&quot;Wig&quot;);&gt;&gt;\
&lt;&lt;set _TRIM = $Player.GetStat(&quot;BODY&quot;, &quot;Hair&quot;) - 5;&gt;&gt;\
&lt;&lt;set _PR = window.App.PR;&gt;&gt;\
&lt;&lt;nobr&gt;&gt;
&lt;table class=&quot;MyTable&quot;&gt;
    &lt;tbody&gt;
    &lt;tr&gt;
        &lt;td style=&quot;vertical-align:top;&quot;&gt;
        &lt;table class=&quot;MyTable&quot; style=&quot;border:1px solid black;&quot;&gt;
            &lt;tbody&gt;
            &lt;tr style=&quot;border-bottom:1px solid white;&quot;&gt;
			    &lt;td style=&quot;width:30px;&quot;&gt; &lt;/td&gt;
                &lt;td&gt;Hair Style&lt;/td&gt;
                &lt;td style=&quot;font-size:smaller;&quot;&gt;Acc.&lt;/td&gt;
				&lt;td style=&quot;font-size:smaller;&quot;&gt;Prod.&lt;/td&gt;
            &lt;/tr&gt;
&lt;&lt;if _Wig != 0&gt;&gt;
&lt;tr&gt;
    &lt;td style=&quot;text-align:center;width:30px;&quot;&gt;
	&lt;&lt;print &#39;&lt;&lt;radiobutton &quot;$HairStyle&quot; &quot;&#39;+_Wig.Id()+&#39;&quot; checked&gt;&gt;&#39;&gt;&gt;&lt;/td&gt;
	&lt;td&gt;&lt;&lt;print _PR.ColorizeString(_Wig.HairBonus(), &quot;⇑Wig&quot;);&gt;&gt; &lt;&lt;print _Wig.Description()&gt;&gt;&lt;/td&gt;
	&lt;td style=&quot;text-align:center;width:30px;&quot;&gt; - &lt;/td&gt;
	&lt;td style=&quot;text-align:center;width:30px;&quot;&gt; - &lt;/td&gt;
&lt;/tr&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if _Wigs.length != 0&gt;&gt;
&lt;&lt;for _i = 0; _i &lt; _Wigs.length; _i++&gt;&gt;
&lt;tr&gt;
    &lt;td style=&quot;text-align:center;width:30px;&quot;&gt;
&lt;&lt;print &#39;&lt;&lt;radiobutton &quot;$HairStyle&quot; &quot;&#39;+_Wigs[_i].Id()+&#39;&quot;&gt;&gt;&#39;&gt;&gt;	
   &lt;/td&gt;
	&lt;td&gt;&lt;&lt;print _PR.ColorizeString(_Wigs[_i].HairBonus(), &quot;⇑Wig&quot;);&gt;&gt; &lt;&lt;print _Wigs[_i].Description()&gt;&gt;&lt;/td&gt;
	&lt;td style=&quot;text-align:center;width:30px;&quot;&gt; - &lt;/td&gt;
	&lt;td style=&quot;text-align:center;width:30px;&quot;&gt; - &lt;/td&gt;
&lt;/tr&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for _i = 0; _i &lt; _Hair.length; _i++&gt;&gt;
&lt;tr&gt;
&lt;&lt;if ( _H1 &lt; _Hair[_i][&quot;RESOURCE1&quot;] ) ||
	 ( _H2 &lt; _Hair[_i][&quot;RESOURCE2&quot;] ) ||
	 ( _HL &lt; _Hair[_i][&quot;MIN&quot;] ) || 
	 ( _HL &gt; _Hair[_i][&quot;MAX&quot;] )&gt;&gt;
		 &lt;td&gt; &lt;/td&gt;
	     &lt;td&gt;
&lt;&lt;if _HL &lt; _Hair[_i][&quot;MIN&quot;]&gt;&gt;
@@color:red;⇓Hair@@&lt;&lt;else&gt;&gt;@@color:red;⇑Hair@@&lt;&lt;/if&gt;&gt;
@@color:grey;&lt;&lt;print _Hair[_i][&quot;SHORT&quot;];&gt;&gt;@@
		&lt;/td&gt;
		&lt;td style=&quot;text-align:center;width:30px;&quot;&gt;
&lt;&lt;if _H1 &lt; _Hair[_i][&quot;RESOURCE1&quot;]&gt;&gt;
@@color:red;&lt;&lt;print _Hair[_i][&quot;RESOURCE1&quot;];&gt;&gt;@@&lt;&lt;else&gt;&gt;
&lt;&lt;print _Hair[_i][&quot;RESOURCE1&quot;];&gt;&gt;
&lt;&lt;/if&gt;&gt;
		&lt;/td&gt;
		&lt;td style=&quot;text-align:center;width:30px;&quot;&gt;
&lt;&lt;if _H2 &lt; _Hair[_i][&quot;RESOURCE2&quot;]&gt;&gt;
@@color:red;&lt;&lt;print _Hair[_i][&quot;RESOURCE2&quot;];&gt;&gt;@@&lt;&lt;else&gt;&gt;
&lt;&lt;print _Hair[_i][&quot;RESOURCE2&quot;]&gt;&gt;
&lt;&lt;/if&gt;&gt;
		&lt;/td&gt;
&lt;&lt;else&gt;&gt;
	&lt;td style=&quot;text-align:center;&quot;&gt;
	&lt;&lt;if $Player.LastUsedHair == _Hair[_i][&quot;NAME&quot;] &amp;&amp; _Wig == 0&gt;&gt;
&lt;&lt;print &#39;&lt;&lt;radiobutton &quot;$HairStyle&quot; &quot;&#39;+_Hair[_i][&quot;NAME&quot;] +&#39;&quot; checked&gt;&gt;&#39;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;print &#39;&lt;&lt;radiobutton &quot;$HairStyle&quot; &quot;&#39;+_Hair[_i][&quot;NAME&quot;] +&#39;&quot;&gt;&gt;&#39;&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;/td&gt;
	&lt;td&gt;&lt;&lt;print _PR.ColorizeString(_Hair[_i][&quot;STYLE&quot;], &quot;⇑Style&quot;) + &quot; &quot;+ _Hair[_i][&quot;SHORT&quot;];&gt;&gt;&lt;/td&gt;
	&lt;td style=&quot;text-align:center;width:30px;&quot;&gt;&lt;&lt;print _Hair[_i][&quot;RESOURCE1&quot;];&gt;&gt;&lt;/td&gt;
	&lt;td style=&quot;text-align:center;width:30px;&quot;&gt;&lt;&lt;print _Hair[_i][&quot;RESOURCE2&quot;];&gt;&gt;&lt;/td&gt;
&lt;&lt;/if&gt;&gt;
&lt;/tr&gt;
&lt;&lt;/for&gt;&gt;
            &lt;tr style=&quot;border-top:1px solid white;&quot;&gt;
				&lt;td&gt; &lt;/td&gt;
                &lt;td style=&quot;text-align:right;font-size:smaller&quot;&gt;Accessories &amp; Products Owned&lt;/td&gt;
                &lt;td style=&quot;width:30px;text-align:center;&quot;&gt;&lt;&lt;print $Player.GetItemCharges(&quot;hair tool&quot;);&gt;&gt;&lt;/td&gt;
                &lt;td style=&quot;width:30px;text-align:center;&quot;&gt;&lt;&lt;print $Player.GetItemCharges(&quot;hair treatment&quot;);&gt;&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;/tbody&gt;
        &lt;/table&gt;
        &lt;/td&gt;
        &lt;td&gt;
        &lt;table class=&quot;MyTable&quot; style=&quot;border:1px solid black;&quot;&gt;
            &lt;tbody&gt;
            &lt;tr style=&quot;border-bottom:1px solid white;&quot;&gt;
			    &lt;td style=&quot;width:30px;&quot;&gt; &lt;/td&gt;
                &lt;td&gt;Makeup Styles&lt;/td&gt;
                &lt;td style=&quot;font-size:smaller;&quot;&gt;Bas.&lt;/td&gt;
				&lt;td style=&quot;font-size:smaller;&quot;&gt;Exp.&lt;/td&gt;
            &lt;/tr&gt;
&lt;&lt;for _i = 0; _i &lt; _Makeup.length; _i++&gt;&gt;
&lt;tr&gt;
&lt;&lt;if ( _M1 &lt; _Makeup[_i][&quot;RESOURCE1&quot;] ) ||
	 ( _M2 &lt; _Makeup[_i][&quot;RESOURCE2&quot;] )&gt;&gt;
		 &lt;td&gt; &lt;/td&gt;
	     &lt;td&gt;
&lt;&lt;print _PR.ColorizeString(_Makeup[_i][&quot;STYLE&quot;], &quot;⇑Style&quot;)&gt;&gt; @@color:grey;&lt;&lt;print _Makeup[_i][&quot;SHORT&quot;];&gt;&gt;@@
		&lt;/td&gt;
		&lt;td style=&quot;text-align:center;width:30px;&quot;&gt;
&lt;&lt;if _M1 &lt; _Makeup[_i][&quot;RESOURCE1&quot;]&gt;&gt;
@@color:red;&lt;&lt;print _Makeup[_i][&quot;RESOURCE1&quot;];&gt;&gt;@@&lt;&lt;else&gt;&gt;
&lt;&lt;print _Makeup[_i][&quot;RESOURCE1&quot;];&gt;&gt;
&lt;&lt;/if&gt;&gt;
		&lt;/td&gt;
		&lt;td style=&quot;text-align:center;width:30px;&quot;&gt;
&lt;&lt;if _M2 &lt; _Makeup[_i][&quot;RESOURCE2&quot;]&gt;&gt;
@@color:red;&lt;&lt;print _Makeup[_i][&quot;RESOURCE2&quot;];&gt;&gt;@@&lt;&lt;else&gt;&gt;
&lt;&lt;print _Makeup[_i][&quot;RESOURCE2&quot;]&gt;&gt;
&lt;&lt;/if&gt;&gt;
		&lt;/td&gt;
&lt;&lt;else&gt;&gt;
	&lt;td style=&quot;text-align:center;&quot;&gt;
	&lt;&lt;if $Player.LastUsedMakeup == _Makeup[_i][&quot;NAME&quot;]&gt;&gt;
&lt;&lt;print &#39;&lt;&lt;radiobutton &quot;$MakeupStyle&quot; &quot;&#39;+_Makeup[_i][&quot;NAME&quot;] +&#39;&quot; checked&gt;&gt;&#39;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;print &#39;&lt;&lt;radiobutton &quot;$MakeupStyle&quot; &quot;&#39;+_Makeup[_i][&quot;NAME&quot;] +&#39;&quot;&gt;&gt;&#39;&gt;&gt;&lt;&lt;/if&gt;&gt;
	&lt;/td&gt;
	&lt;td&gt;&lt;&lt;print _PR.ColorizeString(_Makeup[_i][&quot;STYLE&quot;], &quot;⇑Style&quot;) + &quot; &quot;+ _Makeup[_i][&quot;SHORT&quot;];&gt;&gt;&lt;/td&gt;
	&lt;td style=&quot;text-align:center;width:30px;&quot;&gt;&lt;&lt;print _Makeup[_i][&quot;RESOURCE1&quot;];&gt;&gt;&lt;/td&gt;
	&lt;td style=&quot;text-align:center;width:30px;&quot;&gt;&lt;&lt;print _Makeup[_i][&quot;RESOURCE2&quot;];&gt;&gt;&lt;/td&gt;
&lt;&lt;/if&gt;&gt;
&lt;/tr&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;set _HairRows = _Hair.length + _Wigs.length&gt;&gt;
&lt;&lt;if _Wig != 0&gt;&gt;&lt;&lt;set _HairRows = _HairRows + 1&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if _HairRows &gt; _Makeup.length &gt;&gt;
&lt;&lt;set _Rows = (_HairRows - _Makeup.length)&gt;&gt;
&lt;&lt;for _i = 0; _i &lt; _Rows; _i++&gt;&gt;
&lt;tr&gt;
&lt;td&gt; &lt;/td&gt;&lt;td&gt; &lt;/td&gt;&lt;td&gt; &lt;/td&gt;&lt;td&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/if&gt;&gt;
            &lt;tr style=&quot;border-top:1px solid white;&quot;&gt;
				&lt;td&gt; &lt;/td&gt;
                &lt;td style=&quot;text-align:right;font-size:smaller&quot;&gt;Basic &amp; Expensive Makeup Owned&lt;/td&gt;
                &lt;td style=&quot;width:30px;text-align:center;&quot;&gt;&lt;&lt;print $Player.GetItemCharges(&quot;basic makeup&quot;);&gt;&gt;&lt;/td&gt;
                &lt;td style=&quot;width:30px;text-align:center;&quot;&gt;&lt;&lt;print $Player.GetItemCharges(&quot;expensive makeup&quot;);&gt;&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;/tbody&gt;
        &lt;/table&gt;
		&lt;/td&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td colspan=&quot;2&quot; style=&quot;text-align:left;&quot;&gt;
@@color:yellow;Action@@: 
&lt;&lt;if $Player.GetStat(&quot;STAT&quot;, &quot;Energy&quot;) &lt; 1&gt;&gt;
@@color:grey;Do Makeup and Hair@@
&lt;&lt;else&gt;&gt;
&lt;&lt;click &quot;Do Makeup and Hair&quot; &quot;Vanity&quot;&gt;&gt;
&lt;&lt;run $Player.AdjustStat(&quot;Energy&quot;, -1);&gt;&gt;
&lt;&lt;run $Player.DoStyling($HairStyle, $MakeupStyle);&gt;&gt;
&lt;&lt;/click&gt;&gt;
&lt;&lt;/if&gt;&gt;
@@color:yellow; (1 Energy)@@ |
&lt;&lt;if $Player.MakeupStyle == &quot;plain faced&quot;&gt;&gt;
@@color:grey;Remove Makeup@@
&lt;&lt;else&gt;&gt;
&lt;&lt;click &quot;Remove Makeup&quot; &quot;Vanity&quot;&gt;&gt;
&lt;&lt;set $Player.MakeupStyle = &quot;plain faced&quot;;&gt;&gt;
&lt;&lt;set $Player.MakeupBonus = 0&gt;&gt;
&lt;&lt;/click&gt;&gt;
&lt;&lt;/if&gt;&gt;
 | 
&lt;&lt;if _TRIM &lt; 5&gt;&gt;
&lt;&lt;click &quot;Trim Hair&quot; &quot;Vanity&quot;&gt;&gt;
&lt;&lt;set $Player.BodyStats[&quot;Hair&quot;] = 5;&gt;&gt;
&lt;&lt;if _Wig != 0&gt;&gt;
&lt;&lt;run $Player.Remove($Player.Equipment[&quot;Wig&quot;]);&gt;&gt;.
&lt;&lt;/if&gt;&gt;
&lt;&lt;/click&gt;&gt; (&lt;&lt;print _PR.CMtoINCH(_PR.StatToCM($Player, &quot;Hair&quot;));&gt;&gt; in ⇒ &lt;&lt;print _PR.CMtoINCH(_PR.StatToCM($Player, &quot;Hair&quot;, (5 - $Player.GetStat(&quot;BODY&quot;, &quot;Hair&quot;))));&gt;&gt; in)
&lt;&lt;else&gt;&gt;
&lt;&lt;click &quot;Trim Hair&quot; &quot;Vanity&quot;&gt;&gt;
&lt;&lt;run $Player.AdjustBody(&quot;Hair&quot;, -5);&gt;&gt;
&lt;&lt;if _Wig != 0&gt;&gt;
&lt;&lt;run $Player.Remove($Player.Equipment[&quot;Wig&quot;]);&gt;&gt;.
&lt;&lt;/if&gt;&gt;
&lt;&lt;/click&gt;&gt; (&lt;&lt;print _PR.CMtoINCH(_PR.StatToCM($Player, &quot;Hair&quot;));&gt;&gt; in. -&gt; &lt;&lt;print _PR.CMtoINCH( (_PR.StatToCM($Player, &quot;Hair&quot;,-5)));&gt;&gt; in.)&lt;&lt;/if&gt;&gt;&lt;/td&gt;
	&lt;/tr&gt;
	&lt;/tbody&gt;
&lt;/table&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="83" name="ChangeLog" tags="custom-menu" position="10350,100">@@color:yellow;Change Log - Most Recent First@@ &lt;&lt;click &quot;Exit&quot; $GameBookmark&gt;&gt;&lt;&lt;/click&gt;&gt;

0.1 - Initial Version - 05/05/2018</tw-passagedata><tw-passagedata pid="84" name="Combat" tags="custom-menu" position="10475,100">&lt;&lt;combatPanel $MenuAction&gt;&gt;</tw-passagedata><tw-passagedata pid="85" name="Examine" tags="custom-menu" position="10600,100">&lt;&lt;= window.App.PR.TokenizeString($Player, $MenuAction, $MenuAction.ShortDesc())&gt;&gt;
&lt;&lt;= window.App.PR.TokenizeString($Player, $MenuAction, $MenuAction.LongDesc())&gt;&gt;

@@color:cyan;Interact@@: &lt;&lt;click &quot;Exit&quot; $GameBookmark&gt;&gt;&lt;&lt;/click&gt;&gt;</tw-passagedata><tw-passagedata pid="86" name="GameOver" tags="" position="10725,100">Game Over Man, GAME OVER.</tw-passagedata><tw-passagedata pid="87" name="GameWon" tags="custom-menu" position="10850,100">You won the game. Great moves. Proud of you.</tw-passagedata><tw-passagedata pid="88" name="Inventory" tags="custom-menu" position="10975,100">@@color:cyan;Interact@@: &lt;&lt;click &quot;Exit&quot; $GameBookmark&gt;&gt;&lt;&lt;/click&gt;&gt;\
&lt;&lt;set _Drugs = $Player.GetItemByTypes([&quot;potion&quot;]);&gt;&gt;\
&lt;&lt;set _Quests = $Player.GetItemByTypes([&quot;QUEST&quot;]);&gt;&gt;
&lt;span id=&quot;InventoryUI&quot;&gt;&lt;&lt;InventoryTable &quot;food&quot;&gt;&gt;&lt;/span&gt;</tw-passagedata><tw-passagedata pid="89" name="Jobs" tags="custom-menu" position="11100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set _NPC = $Player.NPCS[$MenuAction];&gt;&gt;
&lt;&lt;set _JE = window.App.JobEngine;&gt;&gt;
&lt;&lt;set _JA = _JE.GetAvailableJobs($Player, $MenuAction);&gt;&gt;
&lt;&lt;set _JU = _JE.GetUnavailableJobs($Player, $MenuAction);&gt;&gt;
&lt;span id=&quot;JobUI&quot;&gt;&lt;&lt;for _i = 0; _i &lt; _JA.length; _i++&gt;&gt;
&lt;&lt;if _i &gt; 0;&gt;&gt;&lt;br/&gt;&lt;br/&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;print _JA[_i].Title(); &gt;&gt;&lt;br/&gt;
&lt;&lt;print _JA[_i].Intro($Player, _NPC); &gt;&gt;&lt;br/&gt;
  &lt;&lt;if _JA[_i].Available($Player, _NPC)&gt;&gt;@@.cmdButton;&lt;&lt;jobButton _JA[_i]&gt;&gt;@@&lt;&lt;else&gt;&gt;@@.cmdDisabledButton;&lt;&lt;jobButton _JA[_i]&gt;&gt;@@&lt;&lt;/if&gt;&gt;&lt;br/&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;for _i = 0; _i &lt; _JU.length; _i++&gt;&gt;
&lt;&lt;if (_JA.length &gt; 0 &amp;&amp; _i == 0) || _i &gt; 0&gt;&gt;&lt;br/&gt;&lt;br/&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;print _JU[_i].Title(); &gt;&gt;&lt;br/&gt;
&lt;&lt;print _JU[_i].Intro($Player, _NPC); &gt;&gt;&lt;br/&gt;
  &lt;&lt;if _JU[_i].Available($Player, _NPC)&gt;&gt;@@.cmdButton;&lt;&lt;jobButton _JU[_i]&gt;&gt;@@&lt;&lt;else&gt;&gt;@@.cmdDisabledButton;&lt;&lt;jobButton _JU[_i]&gt;&gt;@@&lt;&lt;/if&gt;&gt;&lt;br/&gt;
&lt;&lt;/for&gt;&gt;&lt;/span&gt;&lt;&lt;/nobr&gt;&gt;
@@color:cyan;Interact@@: &lt;&lt;click &quot;Exit&quot; $GameBookmark&gt;&gt;&lt;&lt;/click&gt;&gt;</tw-passagedata><tw-passagedata pid="90" name="Journal" tags="custom-menu" position="11225,100">@@color:cyan;Interact@@: &lt;&lt;click &quot;Exit&quot; $GameBookmark&gt;&gt;&lt;&lt;/click&gt;&gt;

@@color:DeepPink;Active Quests@@
&lt;&lt;set _QE = window.App.QuestEngine;&gt;&gt;\
&lt;&lt;set _QLA = _QE.GetQuests(&quot;active&quot;, $Player);&gt;&gt;\
&lt;&lt;set _QLC = _QE.GetQuests(&quot;completed&quot;, $Player);&gt;&gt;\
&lt;&lt;if _QLA.length == 0&gt;&gt;\
No active quests.
&lt;&lt;else&gt;&gt;\
&lt;&lt;for _i = 0; _i &lt; _QLA.length; _i++&gt;&gt;\
&lt;&lt;set _NPC = $Player.NPCS[_QLA[_i][&quot;GIVER&quot;]];&gt;&gt;\
//&lt;&lt;print &quot;[&quot; +_NPC.pName() + &quot; - &quot; + _QLA[_i][&quot;Title&quot;] + &quot;]&quot;;&gt;&gt;//
&lt;&lt;print window.App.PR.pQuestDialog(_QLA[_i][&quot;ID&quot;], &quot;JOURNAL_ENTRY&quot;, $Player, _NPC);&gt;&gt;
&lt;&lt;if _QLA[_i][&quot;CHECKS&quot;].length != 0&gt;&gt;\
&lt;&lt;print window.App.PR.pQuestRequirements(_QLA[_i][&quot;ID&quot;], $Player) + &quot;\n&quot;;&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;/if&gt;&gt;\
&lt;&lt;/for&gt;&gt;\
&lt;&lt;/if&gt;&gt;\
&lt;hr&gt;
@@color:yellow;Completed Quests@@
&lt;&lt;if _QLC.length == 0&gt;&gt;\
No completed quests.

&lt;&lt;else&gt;&gt;\
&lt;&lt;for _i = 0; _i &lt; _QLC.length; _i++&gt;&gt;\
&lt;&lt;set _NPC = $Player.NPCS[_QLC[_i][&quot;GIVER&quot;]];&gt;&gt;\
//&lt;&lt;print &quot;[&quot; +_NPC.pName() + &quot; - &quot;  + _QLC[_i][&quot;Title&quot;] + &quot;]&quot;;&gt;&gt;//
&lt;&lt;print window.App.PR.pQuestDialog(_QLC[_i][&quot;ID&quot;], &quot;JOURNAL_COMPLETE&quot;, $Player, _NPC);&gt;&gt;


&lt;&lt;/for&gt;&gt;\
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="91" name="Player Score" tags="widget" position="11350,100">&lt;&lt;widget &quot;score&quot;&gt;&gt;\
@@color:DeepPink;&quot;&lt;&lt;= $Player.SlaveName &gt;&gt;&quot;@@
&lt;span id=&quot;DayCount&quot;&gt;Day &lt;&lt;print $Player.Day; &gt;&gt;, &lt;&lt;print $Player.GetPhase(1); &gt;&gt;&lt;/span&gt;.
Coins: &lt;span id=&quot;Money&quot;&gt;&lt;&lt;print $Player.Money&gt;&gt;&lt;/span&gt;
&lt;table class=&quot;#score-table&quot; width=&quot;100%&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;
	&lt;td colspan=&quot;2&quot;&gt;\
&lt;&lt;customMenuLink &quot;Journal&quot;&gt;&gt; | &lt;&lt;customMenuLink &quot;Skills&quot;&gt;&gt; | &lt;&lt;customMenuLink &quot;Inventory&quot;&gt;&gt;
	&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td&gt;Health:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;Health&quot;&gt;&lt;&lt;print window.App.PR.pStatMeter(&quot;Health&quot;, $Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Energy:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;Energy&quot;&gt;&lt;&lt;print window.App.PR.pStatMeter(&quot;Energy&quot;, $Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td&gt;Willpower:&lt;/td&gt;
	&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print window.App.PR.pStatMeter(&quot;WillPower&quot;, $Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td&gt;Perversion:&lt;/td&gt;
	&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print window.App.PR.pStatMeter(&quot;Perversion&quot;, $Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td&gt;Nutrition:&lt;/td&gt;
	&lt;td&gt;&lt;span id=&quot;Nutrition&quot;&gt;&lt;&lt;print window.App.PR.pStatMeter(&quot;Nutrition&quot;, $Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td&gt;Femininity:&lt;/td&gt;
	&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print window.App.PR.pStatMeter(&quot;Femininity&quot;, $Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td&gt;Toxicity:&lt;/td&gt;
	&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print window.App.PR.pStatMeter(&quot;Toxicity&quot;, $Player, 1); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
	&lt;td&gt;Hormones:&lt;/td&gt;
	&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print window.App.PR.pStatMeter(&quot;Hormones&quot;,$Player);&gt;&gt;&lt;/span&gt;&lt;&lt;if $Player.GetStat(&quot;STAT&quot;,&quot;Hormones&quot;) &lt; 78&gt;&gt;@@color:cyan;♂@@&lt;&lt;else&gt;&gt;&lt;&lt;if $Player.GetStat(&quot;STAT&quot;,&quot;Hormones&quot;) &gt;= 144&gt;&gt;@@color:DeepPink;♀@@&lt;&lt;else&gt;&gt;@@color:orange;⚥&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="92" name="Quests" tags="custom-menu" position="11475,100">&lt;span id=&quot;QuestUI&quot;&gt;&lt;&lt;questList&gt;&gt;&lt;/span&gt;</tw-passagedata><tw-passagedata pid="93" name="Rest" tags="custom-menu" position="11600,100">&lt;&lt;run $Player.Rest();&gt;&gt;You recline leisurely in your room. There isn&#39;t much to do so you after a few minutes you find yourself napping and trying to escape into your fantasies...

You wake up not long after, feeling slightly more energetic.

&lt;&lt;if $Player.SleepLog.length != 0&gt;&gt;&lt;&lt;for _i to 0; _i lt $Player.SleepLog.length; _i++&gt;&gt;\
&lt;&lt;print $Player.SleepLog[_i]&gt;&gt;&lt;br/&gt;&lt;&lt;/for&gt;&gt;&lt;&lt;/if&gt;&gt;\
@@color:cyan;Interact@@: [[Exit|Cabin]]
@@color:yellow;Action@@: &lt;&lt;if $Player.Phase != 3&gt;&gt;&lt;&lt;if $Player.CoreStats[&quot;Energy&quot;] &lt; $Player.GetMaxStat(&quot;STAT&quot;, &quot;Energy&quot;)&gt;&gt;[[Continue Resting|Rest]]&lt;&lt;else&gt;&gt;@@color:grey;[Continue Resting]@@&lt;&lt;/if&gt;&gt;&lt;&lt;else&gt;&gt;[[Sleep]]&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="94" name="Rules" tags="custom-menu" position="11725,100">@@color:yellow;Rules O&#39; the Sea@@ &lt;&lt;click &quot;Exit&quot; $GameBookmark&gt;&gt;&lt;&lt;/click&gt;&gt;
&#39;&#39;Don&#39;t Die&#39;&#39;
There are multiple ways to die in this game. Combat and fighting, either with the crew or with other pirates or enemies can end your life. In addition to this you must monitor your health and nutrition. Be careful of taking drugs or magical potions and avoid tiring yourself out too much.

&#39;&#39;Time and Game Phases&#39;&#39;
There are three phases to a game day, morning, afternoon and night. Not all activities or locations are available depending on the time of day. You may hit the &#39;&#39;END DAY&#39;&#39; button at any time to skip to the next day.

&#39;&#39;Willpower&#39;&#39;
If your Willpower statistic gets too low, you will automatically lose the game as your mind is totally broken. Willpower is hard to raise, but easy to lose, so be careful.

&#39;&#39;Crew Mood&#39;&#39;
If the crew hates you then you may find yourself in serious trouble, the least of which is abuse and violence upon your person. They may decide to sell you off at the next port, effectively ending your game. The Captain, of course, can probably kill you at any time due to the magical collar on your neck.</tw-passagedata><tw-passagedata pid="95" name="SelfJobs" tags="custom-ui" position="11850,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set _JE = window.App.JobEngine;&gt;&gt;
&lt;&lt;printJobResult $MenuAction&gt;&gt;
&lt;&lt;set $MenuAction = 0;&gt;&gt;&lt;&lt;/nobr&gt;&gt;
@@color:cyan;Interact@@: &lt;&lt;click &quot;Exit&quot; $GameBookmark&gt;&gt;&lt;&lt;/click&gt;&gt;</tw-passagedata><tw-passagedata pid="96" name="Shop" tags="custom-menu" position="11975,100">@@color:cyan;Interact@@: &lt;&lt;click &quot;Exit&quot; $GameBookmark&gt;&gt;&lt;&lt;/click&gt;&gt;
&lt;&lt;storeInventory $MenuAction&gt;&gt;</tw-passagedata><tw-passagedata pid="97" name="Skills" tags="custom-menu" position="12100,100">@@color:cyan;Interact@@: &lt;&lt;click &quot;Exit&quot; $GameBookmark&gt;&gt;&lt;&lt;/click&gt;&gt;
&lt;table class=&quot;#score-table&quot;&gt;
&lt;tbody&gt;
&lt;tr&gt;&lt;td colspan=&quot;6&quot; style=&quot;border-bottom: 1px solid&quot;&gt;@@color:yellow;Piracy Skills@@&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Swashbuckling:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print window.App.PR.pSkillMeter(&quot;Swashbuckling&quot;, $Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;Sailing:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print window.App.PR.pSkillMeter(&quot;Sailing&quot;, $Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;Navigating:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print window.App.PR.pSkillMeter(&quot;Navigating&quot;, $Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td colspan=&quot;6&quot; style=&quot;border-bottom: 1px solid&quot;&gt;@@color:yellow;Charisma Skills@@&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Seduction:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print window.App.PR.pSkillMeter(&quot;Seduction&quot;, $Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;Singing:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print window.App.PR.pSkillMeter(&quot;Singing&quot;,$Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;Dancing:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print window.App.PR.pSkillMeter(&quot;Dancing&quot;,$Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Styling:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print window.App.PR.pSkillMeter(&quot;Styling&quot;,$Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;td colspan=&quot;4&quot;&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td colspan=&quot;6&quot; style=&quot;border-bottom: 1px solid&quot;&gt;@@color:yellow;Domestic Skills@@&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Cleaning:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print window.App.PR.pSkillMeter(&quot;Cleaning&quot;,$Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;Cooking:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print window.App.PR.pSkillMeter(&quot;Cooking&quot;,$Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;Serving:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print window.App.PR.pSkillMeter(&quot;Serving&quot;,$Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;td colspan=&quot;1&quot;&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td colspan=&quot;6&quot; style=&quot;border-bottom: 1px solid&quot;&gt;@@color:yellow;Sex Skills@@&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Handjobs:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print window.App.PR.pSkillMeter(&quot;HandJobs&quot;,$Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;Tit Fucking:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print window.App.PR.pSkillMeter(&quot;TitFucking&quot;,$Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;Blowjobs:&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print window.App.PR.pSkillMeter(&quot;BlowJobs&quot;,$Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Ass Fucking&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print window.App.PR.pSkillMeter(&quot;AssFucking&quot;,$Player); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;td colspan=&quot;4&quot;&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;</tw-passagedata><tw-passagedata pid="98" name="Sleep" tags="custom-menu" position="12225,100">&lt;&lt;if $Player.Phase &gt;= 3&gt;&gt;&lt;&lt;run $Player.NextDay(); &gt;&gt;&lt;&lt;/if&gt;&gt;\
Night finally comes and you drag yourself off to bed. Within moments of laying down your tired body succumbs to sleep.

&lt;&lt;if $Player.SleepLog.length != 0&gt;&gt;&lt;&lt;for _i to 0; _i lt $Player.SleepLog.length; _i++&gt;&gt;\
&lt;&lt;print $Player.SleepLog[_i]&gt;&gt;&lt;br/&gt;&lt;&lt;/for&gt;&gt;&lt;&lt;/if&gt;&gt;\

@@color:cyan;Interact@@: [[Wake up|Cabin]]</tw-passagedata><tw-passagedata pid="99" name="StoryCaption" tags="" position="12350,100">&lt;span id=&quot;PlayerScore&quot;&gt;&lt;&lt;if $Player != undefined&gt;&gt;&lt;&lt;score&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;/span&gt;\</tw-passagedata><tw-passagedata pid="100" name="Whore" tags="custom-menu" position="12475,100">&lt;&lt;set _NPC = $Player.NPCS[$MenuAction];&gt;&gt;\
&lt;&lt;set _PR = window.App.PR;&gt;&gt;\
&lt;&lt;nobr&gt;&gt;
@@.custom-table;&lt;table style=&quot;border: 1px solid black;&quot;&gt;
&lt;tbody&gt;
&lt;tr style=&quot;border-bottom: 1px solid white&quot;&gt;
&lt;td colspan=&quot;2&quot; style=&quot;width:300px;&quot;&gt;
&lt;span id=&quot;ClientName&quot;&gt;@@color:yellow;&lt;&lt;print _NPC.Title();&gt;&gt;@@&lt;/span&gt;&lt;/td&gt;
&lt;td colspan=&quot;4&quot; style=&quot;width:500px;&quot;&gt;@@color:cyan;&quot;&lt;&lt;print $Player.SlaveName&gt;&gt;&quot;@@&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;font-size:smaller;&quot;&gt;&lt;span id=&quot;MoodTitle&quot;&gt;Mood&lt;/span&gt;&lt;/td&gt;
&lt;td style=&quot;font-size:smaller;&quot;&gt;&lt;span id=&quot;MoodScore&quot;&gt;&lt;&lt;print _NPC.pMood(); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;td style=&quot;font-size:smaller;&quot;&gt;Beauty&lt;/td&gt;
&lt;td&gt;
&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print _PR.pMeter( $Player.Beauty(), 100); &gt;&gt;&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&quot;font-size:smaller;&quot;&gt;Seduction&lt;/td&gt;
&lt;td&gt;
&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print  _PR.pSkillMeter(&quot;Seduction&quot;, $Player); &gt;&gt;&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;font-size:smaller;&quot;&gt;&lt;span id=&quot;LustTitle&quot;&gt;Lust&lt;/span&gt;&lt;/td&gt;
&lt;td style=&quot;font-size:smaller;&quot;&gt;&lt;span id=&quot;LustScore&quot;&gt;&lt;&lt;print _NPC.pLust(); &gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;td style=&quot;font-size:smaller;&quot;&gt;Style&lt;/td&gt;
&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print _PR.pMeter( $Player.Style(), 100); &gt;&gt;&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&quot;font-size:smaller;&quot;&gt;Fetish&lt;/td&gt;
&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print _PR.pMeter( $Player.Fetish(), 100); &gt;&gt;&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;font-size:smaller;&quot;&gt;Wealth&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print _PR.pMeter(_NPC.Wealth(), 100);&gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;td style=&quot;font-size:smaller;&quot;&gt;Hand Jobs&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print _PR.pSkillMeter(&quot;HandJobs&quot;, $Player);&gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;td style=&quot;font-size:smaller;&quot;&gt;Blow Jobs&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print _PR.pSkillMeter(&quot;BlowJobs&quot;, $Player);&gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td colspan=&quot;2&quot;&gt; &lt;/td&gt;
&lt;td style=&quot;font-size:smaller;&quot;&gt;Tit Fucking&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print _PR.pSkillMeter(&quot;TitFucking&quot;, $Player);&gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;td style=&quot;font-size:smaller;&quot;&gt;Ass Fucking&lt;/td&gt;&lt;td&gt;&lt;span id=&quot;fixed-font&quot;&gt;&lt;&lt;print _PR.pSkillMeter(&quot;AssFucking&quot;, $Player);&gt;&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr style=&quot;border-top:solid 1px white;border-bottom:solid 1px white;&quot;&gt;
&lt;td colspan=&quot;6&quot; style=&quot;font-size:smaller;font-weight:bold;&quot;&gt;
@@color:cyan;COMMAND MENU@@ : &lt;span id=&quot;CommandTxt&quot; style=&quot;color:yellow;&quot;&gt;Start whoring?&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td colspan=&quot;6&quot; style=&quot;vertical-align:top;&quot;&gt;
&lt;span id=&quot;WhoreCommands&quot;&gt;
@@.cmdButton;&lt;&lt;button &quot;Exit&quot; $GameBookmark&gt;&gt;&lt;&lt;/button&gt;&gt;@@
@@.cmdButton;&lt;&lt;button &quot;Start Whoring&quot;&gt;&gt;
&lt;&lt;replace &quot;#CommandTxt&quot;&gt;&gt;Attract Customers&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#WhoreDialog&quot;&gt;&gt;&lt;&lt;attractDialog&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;replace &quot;#WhoreCommands&quot;&gt;&gt;&lt;&lt;attractButtons&gt;&gt;&lt;&lt;/replace&gt;&gt;
&lt;&lt;/button&gt;&gt;@@
&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr style=&quot;border-bottom:solid 1px white;&quot;&gt;
&lt;td colspan=&quot;6&quot; style=&quot;font-size:smaller;font-weight:bold;&quot;&gt;DIALOG&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td colspan=&quot;4&quot; style=&quot;vertical-align:top;width:550px;&quot;&gt;
&lt;div style = &quot;overflow-y:scroll;overflow-x:hidden;width=530px;height:250px;&quot;&gt;
&lt;p style=&quot;padding:2px;&quot;&gt;
&lt;span id=&quot;WhoreDialog&quot;&gt;&lt;&lt;if $MenuAction eq &quot;Crew&quot;&gt;&gt;
The crew of the Salty Mermaid are for the most part filthy, violent and poor. Not your first choice for customers, but if you have no other choice then their coin spends as good as any other.
&lt;&lt;/if&gt;&gt;&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;
&lt;/td&gt;
&lt;td colspan=&quot;2&quot; style=&quot;vertical-align:top;&quot;&gt;
&lt;span id=&quot;SexProgress&quot;&gt;&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;@@&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="101" name="Start" tags="" position="12600,100">&lt;&lt;set $GameBookmark = passage(); &gt;&gt;
@@color:deepPink;Queen of the Seas@@ is designed to be an RPG like transformation game with @@color:red;heavy non-consentual themes@@. \
If this type of game bothers you then playing this game is not recommended.

@@color:yellow;The Story So far...@@
You are a young man who is in love with the daughter of the Governor of a small Caribbean-like island in a fantasy world. Since her father won&#39;t allow you to marry, you decide to elope by booking passage to the mainland on a passing trading ship.

Unfortunately you didn&#39;t do your research and end up hiring a bunch of pirates. It seems that these pirates are a superstitious lot, so they believe that having a woman on board is bad luck and as such they quickly sell your lover off as a slave to a brothel and recruit you into their ranks as their newest crew member. It&#39;s a pity about the job...

As the new &quot;Cabin Girl&quot; of the Salty Mermaid, can you manage to raise the price needed to free yourself from bondage, or will you find some other way to escape? Will you ever see your fiance again?

@@color:cyan;You must be 18 years of age or older to play this game.@@ Click the link below to agree and start the game.
[[I am 18 years of age or older.|Intro1]]

@@color:yellow;Additional Links...@@
[[Change Log|ChangeLog]] | [[Rules and FAQ|Rules]] | &lt;a href=&quot;https://www.tfgamessite.com/index.php?module=viewgame&amp;id=1680&quot;&gt;IGDB Entry&lt;/a&gt; | &lt;a href=&quot;https://github.com/JJM152/Queen&quot;&gt;GitHub Repository&lt;/a&gt;</tw-passagedata><tw-passagedata pid="102" name="Intro1" tags="" position="12725,100">&lt;&lt;set $Player = new window.App.Entity.Player();&gt;&gt;\
&lt;&lt;run $Player.Init(); &gt;&gt;\
You are a guy. You recieve a letter from your girlfriend to meet her in her garden this evening.

[[Intro2]]
[[Skip the intro and begin the game|Cabin]]</tw-passagedata><tw-passagedata pid="103" name="Intro2" tags="" position="12850,100">You meet your girlfriend in the garden. She tells you her father is going to marry her off to the Govenor of the island. You decide to escape together by boarding a ship at the docks.

[[Intro3]]</tw-passagedata><tw-passagedata pid="104" name="Intro3" tags="" position="12975,100">At the docks you ask around and only one ship is leaving. The guy claims to be a merchant but his crew looks rough. You agree to pay him a fee of 50 cash now and 50 when you arrive at the destination.

You board the ship.

As you and girlfriend rest in each others arms you fall asleep after eating/drinking food. You were drugged.

[[Intro4]]</tw-passagedata><tw-passagedata pid="105" name="Intro4" tags="" position="13100,100">Wake up, eyes are blurry. Your head feels groggy, your pulse is high and you&#39;re sweating. Your hands are tied and you&#39;re laying on the ground.

Merchant is actually a pirate captain and he&#39;s raping your girlfriend infront of your face. She seems drugged too, her eyes are rolling around in her head and she&#39;s gasping.

He taunts you, then the crew starts raping your asshole while he leans forward, putting your girlfriend in front of you. She momentarily comes out of it and realizes what&#39;s going on. 

For some reason your dick gets hard, pirates cum in your ass and then you cum all over yourself infront of your girlfriend. She breaks down crying as the Pirate Captain finishes off inside her. They spend the entire night raping both of you.

[[Intro5]]</tw-passagedata><tw-passagedata pid="106" name="Intro5" tags="" position="13225,100">You passed out and wake up naked in a small cell. A pirate comes by to feed you. You ask about your girlfriend and he taunts you that the Captain is raping her right now and planning to sell her off to a slave market in the next port. You find out the gruel is made up of semen

Eat gruel. +perv
Don&#39;t eat gruel. -nutrition

[[Intro6]]</tw-passagedata><tw-passagedata pid="107" name="Intro6" tags="" position="13350,100">After what seems like days the Captain and his First mate come and visit you. They bring you on deck to say farewell to your girlfriend one last time. The ship arrives at port tomorrow and the pirates are having a &quot;farewell party&quot; featuring your girlfriend as the party favor. She&#39;s getting buttfucked by a big black pirate and they bring you infront of her and you can see her panting and moaning in lust. Your dick gets hard at the sight of her being raped and the Captain taunts you.

They bring you infront of her one last time and she sucks your dick while being ass raped. The pirate cums in your ass and she orgasms while you cum in her mouth. The pirates then tie you up and force you to watch the rest of the crew raping her into the night.

[[Intro7]]</tw-passagedata><tw-passagedata pid="108" name="Intro7" tags="" position="13475,100">Two days later you&#39;re led from your cell infront of the Captain and first mate. Your girlfriend has been sold to a brothel in town in return for some gold and a special device. It&#39;s a magical collar that will kill you if the Captain dies or if you get too far away from him. It also allows him to punish you at will by ringing a bell, which he demonstrates. 

He explains that you&#39;re now part of the crew, their live-in &quot;Cabin Girl&quot; and he throws a bag full of clothes at you and has the first mate escort you to your bunk, a small room inside the main hold.

[[Cabin]]</tw-passagedata></tw-storydata></div>
	<script id="script-sugarcube" type="text/javascript">
	/*! SugarCube JS */
	if(document.documentElement.getAttribute("data-init")==="loading"){!function(window,document,jQuery,undefined){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_slicedToArray=function(){function e(e,t){var r=[],n=!0,a=!1,i=undefined;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw i}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Alert=function(){function e(e,t,r,n){var a="fatal"===e,i="Apologies! "+(a?"A fatal":"An")+" error has occurred.";i+=a?" Aborting.":" You may be able to continue, but some parts may not work properly.",null==t&&null==r||(i+="\n\nError",null!=t&&(i+=" ["+t+"]"),i+=null!=r?": "+r.replace(/^(?:(?:uncaught\s+(?:exception:\s+)?)?error:\s+)+/i,"")+".":": unknown error."),"object"===("undefined"==typeof n?"undefined":_typeof(n))&&n.stack&&(i+="\n\nStack Trace:\n"+n.stack),window.alert(i)}function t(t,r,n){e(null,t,r,n)}function r(t,r,n){e("fatal",t,r,n)}return function(e){window.onerror=function(n,a,i,o,s){"complete"===document.readyState?t(null,n,s):(r(null,n,s),window.onerror=e,"function"==typeof window.onerror&&window.onerror.apply(this,arguments))}}(window.onerror),Object.freeze(Object.defineProperties({},{error:{value:t},fatal:{value:r}}))}();!function(){function e(e,t){var a=String(e);switch(t){case"start":return a&&r.test(a)?a.replace(r,""):a;case"end":return a&&n.test(a)?a.replace(n,""):a;default:throw new Error('_trimFrom called with incorrect where parameter value: "'+t+'"')}}function t(e,t){var r=Number.parseInt(e,10)||0;if(r<1)return"";var n="undefined"==typeof t?"":String(t);for(""===n&&(n=" ");n.length<r;){var a=n.length,i=r-a;n+=a>i?n.slice(0,i):n}return n.length>r&&(n=n.slice(0,r)),n}var r=/^[\s\u00A0\uFEFF][\s\u00A0\uFEFF]*/,n=/[\s\u00A0\uFEFF][\s\u00A0\uFEFF]*$/;Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includes called on null or undefined");if(0===arguments.length)return!1;var e=this.length>>>0;if(0===e)return!1;var t=arguments[0],r=Number(arguments[1])||0;for(r<0&&(r=Math.max(0,e+r));r<e;++r){var n=this[r];if(t===n||t!==t&&n!==n)return!0}return!1}}),String.prototype.padStart||Object.defineProperty(String.prototype,"padStart",{configurable:!0,writable:!0,value:function(e,r){if(null==this)throw new TypeError("String.prototype.padStart called on null or undefined");var n=String(this),a=n.length,i=Number.parseInt(e,10);return i<=a?n:t(i-a,r)+n}}),String.prototype.padEnd||Object.defineProperty(String.prototype,"padEnd",{configurable:!0,writable:!0,value:function(e,r){if(null==this)throw new TypeError("String.prototype.padEnd called on null or undefined");var n=String(this),a=n.length,i=Number.parseInt(e,10);return i<=a?n:n+t(i-a,r)}}),String.prototype.trimStart||Object.defineProperty(String.prototype,"trimStart",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimStart called on null or undefined");return e(this,"start")}}),String.prototype.trimLeft||Object.defineProperty(String.prototype,"trimLeft",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimLeft called on null or undefined");return e(this,"start")}}),String.prototype.trimEnd||Object.defineProperty(String.prototype,"trimEnd",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimEnd called on null or undefined");return e(this,"end")}}),String.prototype.trimRight||Object.defineProperty(String.prototype,"trimRight",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimRight called on null or undefined");return e(this,"end")}})}(),function(){function _random(){if(0===arguments.length)throw new Error("_random called with insufficient parameters");var e=void 0,t=void 0;if(1===arguments.length?(e=0,t=arguments[0]):(e=arguments[0],t=arguments[1]),e>t){var r=[t,e];e=r[0],t=r[1]}return Math.floor(_nativeMathRandom()*(t-e+1))+e}function _getCodePointStartAndEnd(e,t){var r=e.charCodeAt(t);if(Number.isNaN(r))return{char:"",start:-1,end:-1};if(r<55296||r>57343)return{char:e.charAt(t),start:t,end:t};if(r>=55296&&r<=56319){var n=t+1;if(n>=e.length)throw new Error("high surrogate without trailing low surrogate");var a=e.charCodeAt(n);if(a<56320||a>57343)throw new Error("high surrogate without trailing low surrogate");return{char:e.charAt(t)+e.charAt(n),start:t,end:n}}if(0===t)throw new Error("low surrogate without leading high surrogate");var i=t-1,o=e.charCodeAt(i);if(o<55296||o>56319)throw new Error("low surrogate without leading high surrogate");return{char:e.charAt(i)+e.charAt(t),start:i,end:t}}var _nativeMathRandom=Math.random;Object.defineProperty(Array,"random",{configurable:!0,writable:!0,value:function(e,t,r){var n=t,a=r;return 2===arguments.length&&(a=n,n=0),Array.isArray(e)?e.random(n,a):e.hasOwnProperty("length")?[].concat(_toConsumableArray(e)).random(n,a):void 0}}),Object.defineProperty(Array.prototype,"count",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.count called on null or undefined");for(var e=Array.prototype.indexOf,t=arguments[0],r=Number(arguments[1])||0,n=0;(r=e.call(this,t,r))!==-1;)++n,++r;return n}}),Object.defineProperty(Array.prototype,"delete",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.delete called on null or undefined");if(0===arguments.length)return[];var e=this.length>>>0;if(0===e)return[];for(var t=Array.prototype.indexOf,r=Array.prototype.push,n=Array.prototype.splice,a=Array.prototype.concat.apply([],arguments),i=[],o=0,s=a.length;o<s;++o)for(var u=a[o],l=0;(l=t.call(this,u,l))!==-1;)r.apply(i,n.call(this,l,1));return i}}),Object.defineProperty(Array.prototype,"deleteAt",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.deleteAt called on null or undefined");if(0===arguments.length)return[];var e=this.length>>>0;if(0===e)return[];for(var t=Array.prototype.splice,r=[].concat(_toConsumableArray(new Set(Array.prototype.concat.apply([],arguments).map(function(t){return t<0?Math.max(0,e+t):t})).values())),n=[].concat(_toConsumableArray(r)).sort(function(e,t){return t-e}),a=[],i=0,o=r.length;i<o;++i)a[i]=this[r[i]];for(var s=0,u=n.length;s<u;++s)t.call(this,n[s],1);return a}}),Object.defineProperty(Array.prototype,"flatten",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.flatten called on null or undefined");return Array.prototype.reduce.call(this,function(e,t){return e.concat(Array.isArray(t)?t.flatten():t)},[])}}),Object.defineProperty(Array.prototype,"includesAll",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includesAll called on null or undefined");if(1===arguments.length)return Array.isArray(arguments[0])?Array.prototype.includesAll.apply(this,arguments[0]):Array.prototype.includes.apply(this,arguments);for(var e=0,t=arguments.length;e<t;++e)if(!Array.prototype.some.call(this,function(e){return e===this.val||e!==e&&this.val!==this.val},{val:arguments[e]}))return!1;return!0}}),Object.defineProperty(Array.prototype,"includesAny",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includesAny called on null or undefined");if(1===arguments.length)return Array.isArray(arguments[0])?Array.prototype.includesAny.apply(this,arguments[0]):Array.prototype.includes.apply(this,arguments);for(var e=0,t=arguments.length;e<t;++e)if(Array.prototype.some.call(this,function(e){return e===this.val||e!==e&&this.val!==this.val},{val:arguments[e]}))return!0;return!1}}),Object.defineProperty(Array.prototype,"pluck",{configurable:!0,writable:!0,value:function(e,t){if(null==this)throw new TypeError("Array.prototype.pluck called on null or undefined");var r=this.length>>>0;if(0!==r){var n=e,a=t;return 1===arguments.length&&(a=n,n=0),null==n?n=0:n<0?(n=r+n,n<0&&(n=0)):n>=r&&(n=r-1),null==a?a=r-1:a<0?(a=r+a,a<0&&(a=r-1)):a>=r&&(a=r-1),Array.prototype.splice.call(this,_random(n,a),1)[0]}}}),Object.defineProperty(Array.prototype,"random",{configurable:!0,writable:!0,value:function(e,t){if(null==this)throw new TypeError("Array.prototype.random called on null or undefined");var r=this.length>>>0;if(0!==r){var n=e,a=t;return 1===arguments.length&&(a=n,n=0),null==n?n=0:n<0?(n=r+n,n<0&&(n=0)):n>=r&&(n=r-1),null==a?a=r-1:a<0?(a=r+a,a<0&&(a=r-1)):a>=r&&(a=r-1),this[_random(n,a)]}}}),Object.defineProperty(Array.prototype,"shuffle",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.shuffle called on null or undefined");var e=this.length>>>0;if(0!==e){for(var t=e-1;t>0;--t){var r=Math.floor(_nativeMathRandom()*(t+1)),n=[this[r],this[t]];this[t]=n[0],this[r]=n[1]}return this}}}),Object.defineProperty(Function.prototype,"partial",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Function.prototype.partial called on null or undefined");var e=Array.prototype.slice,t=this,r=e.call(arguments,0);return function(){for(var n=[],a=0,i=0;i<r.length;++i)n.push(r[i]===undefined?arguments[a++]:r[i]);return t.apply(this,n.concat(e.call(arguments,a)))}}}),Object.defineProperty(Math,"clamp",{configurable:!0,writable:!0,value:function e(t,r,n){var e=Number(t);return Number.isNaN(e)?NaN:e.clamp(r,n)}}),Object.defineProperty(Math,"easeInOut",{configurable:!0,writable:!0,value:function(e){return 1-(Math.cos(Number(e)*Math.PI)+1)/2}}),Object.defineProperty(Number.prototype,"clamp",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Number.prototype.clamp called on null or undefined");if(2!==arguments.length)throw new Error("Number.prototype.clamp called with an incorrect number of parameters");var e=Number(arguments[0]),t=Number(arguments[1]);if(e>t){var r=[t,e];e=r[0],t=r[1]}return Math.min(Math.max(this,e),t)}}),RegExp.escape||!function(){var e=/[\\^$*+?.()|[\]{}]/g,t=new RegExp(e.source);Object.defineProperty(RegExp,"escape",{configurable:!0,writable:!0,value:function(r){var n=String(r);return n&&t.test(n)?n.replace(e,"\\$&"):n}})}(),function(){var e=/{(\d+)(?:,([+-]?\d+))?}/g,t=new RegExp(e.source);Object.defineProperty(String,"format",{configurable:!0,writable:!0,value:function(r){function n(e,t,r){if(!t)return e;var n=Math.abs(t)-e.length;if(n<1)return e;var a=String(r).repeat(n);return t<0?e+a:a+e}if(arguments.length<2)return 0===arguments.length?"":r;var a=2===arguments.length&&Array.isArray(arguments[1])?[].concat(_toConsumableArray(arguments[1])):Array.prototype.slice.call(arguments,1);return 0===a.length?r:t.test(r)?(e.lastIndex=0,r.replace(e,function(e,t,r){var i=a[t];if(null==i)return"";for(;"function"==typeof i;)i=i();switch("undefined"==typeof i?"undefined":_typeof(i)){case"string":break;case"object":i=JSON.stringify(i);break;default:i=String(i)}return n(i,r?Number.parseInt(r,10):0," ")})):r}})}(),Object.defineProperty(String.prototype,"contains",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.contains called on null or undefined");return String.prototype.indexOf.apply(this,arguments)!==-1}}),Object.defineProperty(String.prototype,"count",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.count called on null or undefined");var e=String(arguments[0]||"");if(""===e)return 0;for(var t=String.prototype.indexOf,r=e.length,n=Number(arguments[1])||0,a=0;(n=t.call(this,e,n))!==-1;)++a,n+=r;return a}}),Object.defineProperty(String.prototype,"splice",{configurable:!0,writable:!0,value:function(e,t,r){if(null==this)throw new TypeError("String.prototype.splice called on null or undefined");var n=this.length>>>0;if(0===n)return"";var a=Number(e);Number.isSafeInteger(a)?a<0&&(a+=n,a<0&&(a=0)):a=0,a>n&&(a=n);var i=Number(t);(!Number.isSafeInteger(i)||i<0)&&(i=0);var o=this.slice(0,a);return"undefined"!=typeof r&&(o+=r),a+i<n&&(o+=this.slice(a+i)),o}}),Object.defineProperty(String.prototype,"splitOrEmpty",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.splitOrEmpty called on null or undefined");return""===String(this)?[]:String.prototype.split.apply(this,arguments)}}),Object.defineProperty(String.prototype,"toLocaleUpperFirst",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.toLocaleUpperFirst called on null or undefined");var e=String(this),t=_getCodePointStartAndEnd(e,0),r=t.char,n=t.end;return n===-1?"":r.toLocaleUpperCase()+e.slice(n+1)}}),Object.defineProperty(String.prototype,"toUpperFirst",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.toUpperFirst called on null or undefined");var e=String(this),t=_getCodePointStartAndEnd(e,0),r=t.char,n=t.end;return n===-1?"":r.toUpperCase()+e.slice(n+1)}}),Object.defineProperty(Date.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:date)",this.toISOString()]}}),Object.defineProperty(Function.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:eval)","("+this.toString()+")"]}}),Object.defineProperty(Map.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:map)",[].concat(_toConsumableArray(this))]}}),Object.defineProperty(RegExp.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:eval)",this.toString()]}}),Object.defineProperty(Set.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:set)",[].concat(_toConsumableArray(this))]}}),Object.defineProperty(JSON,"reviveWrapper",{configurable:!0,writable:!0,value:function(e,t){if("string"!=typeof e)throw new TypeError("JSON.reviveWrapper code parameter must be a string");return["(revive:eval)",[e,t]]}}),Object.defineProperty(JSON,"_real_parse",{value:JSON.parse}),Object.defineProperty(JSON,"parse",{configurable:!0,writable:!0,value:function value(text,reviver){return JSON._real_parse(text,function(key,val){var value=val;if(Array.isArray(value)&&2===value.length)switch(value[0]){case"(revive:set)":value=new Set(value[1]);break;case"(revive:map)":value=new Map(value[1]);break;case"(revive:date)":value=new Date(value[1]);break;case"(revive:eval)":try{if(Array.isArray(value[1])){var $ReviveData$=value[1][1];value=eval(value[1][0])}else value=eval(value[1])}catch(e){}}else if("string"==typeof value&&"@@revive@@"===value.slice(0,10))try{value=eval(value.slice(10))}catch(e){}if("function"==typeof reviver)try{value=reviver(key,value)}catch(e){}return value})}}),Object.defineProperty(Array.prototype,"contains",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.contains called on null or undefined");return Array.prototype.includes.apply(this,arguments)}}),Object.defineProperty(Array.prototype,"containsAll",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.containsAll called on null or undefined");return Array.prototype.includesAll.apply(this,arguments)}}),Object.defineProperty(Array.prototype,"containsAny",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.containsAny called on null or undefined");return Array.prototype.includesAny.apply(this,arguments)}}),Object.defineProperty(String.prototype,"readBracketedList",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.readBracketedList called on null or undefined");for(var e=new RegExp("(?:\\[\\[((?:\\s|\\S)*?)\\]\\])|([^\"'\\s]\\S*)","gm"),t=[],r=void 0;null!==(r=e.exec(this));)r[1]?t.push(r[1]):r[2]&&t.push(r[2]);return t}})}();var Browser=function(){var e=navigator.userAgent.toLowerCase(),t=e.includes("windows phone"),r=Object.freeze({Android:!t&&e.includes("android"),BlackBerry:/blackberry|bb10/.test(e),iOS:!t&&/ip(?:hone|ad|od)/.test(e),Windows:t||e.includes("iemobile"),any:function(){return r.Android||r.BlackBerry||r.iOS||r.Windows}}),n=!r.Windows&&!/khtml|trident|edge/.test(e)&&e.includes("gecko"),a=!e.includes("opera")&&/msie|trident/.test(e),i=a?function(){var t=/(?:msie\s+|rv:)(\d+\.\d)/.exec(e);return t?Number(t[1]):0}():null,o=e.includes("opera")||e.includes(" opr/"),s=o?function(){var t=new RegExp((/khtml|chrome/.test(e)?"opr":"version")+"\\/(\\d+\\.\\d+)"),r=t.exec(e);return r?Number(r[1]):0}():null;return Object.freeze({userAgent:e,isMobile:r,isGecko:n,isIE:a,ieVersion:i,isOpera:o,operaVersion:s})}(),Has=function(){var e=function(){try{return"function"==typeof document.createElement("audio").canPlayType}catch(e){}return!1}(),t=function(){try{return"Blob"in window&&"File"in window&&"FileList"in window&&"FileReader"in window&&!Browser.isMobile.any()&&(!Browser.isOpera||Browser.operaVersion>=15)}catch(e){}return!1}(),r=function(){try{return"geolocation"in navigator&&"function"==typeof navigator.geolocation.getCurrentPosition&&"function"==typeof navigator.geolocation.watchPosition}catch(e){}return!1}();return Object.freeze({audio:e,fileAPI:t,geolocation:r})}(),_ref4=function(){function e(t){if("object"!==("undefined"==typeof t?"undefined":_typeof(t))||null==t)return t;if("function"==typeof t.clone)return t.clone(!0);if(t.nodeType&&"function"==typeof t.cloneNode)return t.cloneNode(!0);var r=void 0;return Array.isArray(t)?r=[]:t instanceof Date?r=new Date(t.getTime()):t instanceof Map?(r=new Map,t.forEach(function(t,n){r.set(n,e(t))})):t instanceof RegExp?r=new RegExp(t):t instanceof Set?(r=new Set,t.forEach(function(t){r.add(e(t))})):r=Object.create(Object.getPrototypeOf(t)),Object.keys(t).forEach(function(n){return r[n]=e(t[n])}),r}function t(e){for(var t=document.createDocumentFragment(),r=document.createElement("p"),n=void 0;null!==(n=e.firstChild);){if(n.nodeType===Node.ELEMENT_NODE){var a=n.nodeName.toUpperCase();switch(a){case"BR":if(null!==n.nextSibling&&n.nextSibling.nodeType===Node.ELEMENT_NODE&&"BR"===n.nextSibling.nodeName.toUpperCase()){e.removeChild(n.nextSibling),e.removeChild(n),t.appendChild(r),r=document.createElement("p");continue}if(!r.hasChildNodes()){e.removeChild(n);continue}break;case"ADDRESS":case"ARTICLE":case"ASIDE":case"BLOCKQUOTE":case"CENTER":case"DIV":case"DL":case"FIGURE":case"FOOTER":case"FORM":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"HEADER":case"HR":case"MAIN":case"NAV":case"OL":case"P":case"PRE":case"SECTION":case"TABLE":case"UL":r.hasChildNodes()&&(t.appendChild(r),r=document.createElement("p")),t.appendChild(n);continue}}r.appendChild(n)}r.hasChildNodes()&&t.appendChild(r),e.appendChild(t)}function r(){try{return document.activeElement||null}catch(e){return null}}function n(e,t,r){var n="object"===("undefined"==typeof e?"undefined":_typeof(e))?e:document.getElementById(e);if(null==n)return null;var a=Array.isArray(t)?t:[t];jQuery(n).empty();for(var i=0,o=a.length;i<o;++i)if(Story.has(a[i]))return new Wikifier(n,Story.get(a[i]).processText().trim()),n;if(null!=r){var s=String(r).trim();""!==s&&new Wikifier(n,s)}return n}function a(e,t,r){return jQuery(document.createElement("span")).addClass("error").attr("title",r).text(L10n.get("errorTitle")+": "+(t||"unknown error")).appendTo(e),!1}function i(e,t){switch("undefined"==typeof e?"undefined":_typeof(e)){case"number":if(Number.isNaN(e))return t;break;case"object":if(null===e)return t;if(Array.isArray(e)||e instanceof Set)return[].concat(_toConsumableArray(e)).map(function(e){return i(e,t)}).join(", ");if(e instanceof Map){var r=function(){var r=i,n=[].concat(_toConsumableArray(e)).map(function(e){return r(e[0],t)+" ⇒ "+r(e[1],t)}).join("; ");return{v:"( "+n+" )"}}();if("object"===("undefined"==typeof r?"undefined":_typeof(r)))return r.v}else{if(e instanceof Date)return e.toLocaleString();if("function"==typeof e.toString)return e.toString()}return Object.prototype.toString.call(e);case"function":case"undefined":return t}return String(e)}return Object.freeze(Object.defineProperties({},{clone:{value:e},convertBreaks:{value:t},safeActiveElement:{value:r},setPageElement:{value:n},throwError:{value:a},toStringOrDefault:{value:i}}))}(),clone=_ref4.clone,convertBreaks=_ref4.convertBreaks,safeActiveElement=_ref4.safeActiveElement,setPageElement=_ref4.setPageElement,throwError=_ref4.throwError,toStringOrDefault=_ref4.toStringOrDefault;!function(){function e(e){13!==e.which&&32!==e.which||(e.preventDefault(),jQuery(safeActiveElement()||this).trigger("click"))}function t(e){return function(){var t=jQuery(this);t.is("[aria-pressed]")&&t.attr("aria-pressed","true"===t.attr("aria-pressed")?"false":"true"),e.apply(this,arguments)}}function r(e){return t(function(){jQuery(this).off(".aria-clickable").removeAttr("tabindex aria-controls aria-pressed").not("a,button").removeAttr("role").end().filter("button").prop("disabled",!0),e.apply(this,arguments)})}jQuery.fn.extend({ariaClick:function(n,a){if(0===this.length||0===arguments.length)return this;var i=n,o=a;return null==o&&(o=i,i=undefined),i=jQuery.extend({namespace:undefined,one:!1,selector:undefined,data:undefined,controls:undefined,pressed:undefined,label:undefined},i),"string"!=typeof i.namespace?i.namespace="":"."!==i.namespace[0]&&(i.namespace="."+i.namespace),"boolean"==typeof i.pressed&&(i.pressed=i.pressed?"true":"false"),this.filter("button").prop("type","button"),this.not("a,button").attr("role","button"),this.attr("tabindex",0),null!=i.controls&&this.attr("aria-controls",i.controls),null!=i.pressed&&this.attr("aria-pressed",i.pressed),null!=i.label&&this.attr({"aria-label":i.label,title:i.label}),this.not("button").on("keypress.aria-clickable"+i.namespace,i.selector,e),this.on("click.aria-clickable"+i.namespace,i.selector,i.data,i.one?r(o):t(o)),this}})}(),function(){jQuery.extend({wikiWithOptions:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(0!==r.length){var a=document.createDocumentFragment();r.forEach(function(t){return new Wikifier(a,t,e)});var i=[].concat(_toConsumableArray(a.querySelectorAll(".error"))).map(function(e){return e.textContent.replace(/^(?:(?:Uncaught\s+)?Error:\s+)+/,"")});if(i.length>0)throw new Error(i.join("; "))}},wiki:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];this.wikiWithOptions.apply(this,[undefined].concat(t))}}),jQuery.fn.extend({wikiWithOptions:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(0===this.length||0===r.length)return this;var a=document.createDocumentFragment();return r.forEach(function(t){return new Wikifier(a,t,e)}),this.append(a),this},wiki:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.wikiWithOptions.apply(this,[undefined].concat(t))}})}();var Util=function(){function e(e){return Object.freeze(Object.assign(Object.create(null),e))}function t(e){var t=void 0;switch("undefined"==typeof e?"undefined":_typeof(e)){case"number":t=e;break;case"string":t=Number(e);break;default:return!1}return!Number.isNaN(t)&&Number.isFinite(t)}function r(e){return"boolean"==typeof e||"string"==typeof e&&("true"===e||"false"===e)}function n(e){return String(e).trim().replace(/[^\w\s\u2013\u2014-]+/g,"").replace(/[_\s\u2013\u2014-]+/g,"-").toLocaleLowerCase()}function a(e){if(null==e)return"";var t=String(e);return t&&d.test(t)?t.replace(c,function(e){return f[e]}):t}function i(e){if(null==e)return"";var t=String(e);return t&&h.test(t)?t.replace(p,function(e){return g[e]}):t}function o(e){var t=/^([+-]?(?:\d*\.)?\d+)([Mm]?[Ss])$/,r=t.exec(String(e));if(null===r)throw new SyntaxError('invalid time value syntax: "'+e+'"');var n=Number(r[1]);if(/^[Ss]$/.test(r[2])&&(n*=1e3),Number.isNaN(n)||!Number.isFinite(n))throw new RangeError('invalid time value: "'+e+'"');return n}function s(e){if("number"!=typeof e||Number.isNaN(e)||!Number.isFinite(e)){var t=void 0;switch("undefined"==typeof e?"undefined":_typeof(e)){case"string":t='"'+e+'"';break;case"number":t=String(e);break;default:t=Object.prototype.toString.call(e)}throw new Error("invalid milliseconds: "+t)}return e+"ms"}function u(e){if(!e.includes("-"))switch(e){case"bgcolor":return"backgroundColor";case"float":return"cssFloat";default:return e}var t="-ms-"===e.slice(0,4)?e.slice(1):e;return t.split("-").map(function(e,t){return 0===t?e:e.toUpperFirst()}).join("")}function l(e){var t=document.createElement("a"),r=Object.create(null);t.href=e,t.search&&t.search.replace(/^\?/,"").splitOrEmpty(/(?:&(?:amp;)?|;)/).forEach(function(e){var t=e.split("="),n=_slicedToArray(t,2),a=n[0],i=n[1];r[a]=i});var n=t.host&&"/"!==t.pathname[0]?"/"+t.pathname:t.pathname;return{href:t.href,protocol:t.protocol,host:t.host,hostname:t.hostname,port:t.port,path:""+n+t.search,pathname:n,query:t.search,search:t.search,queries:r,searches:r,hash:t.hash}}var c=/[&<>"'`]/g,d=new RegExp(c.source),f=Object.freeze({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"}),p=/&(?:amp|lt|gt|quot|apos|#39|#x27|#96|#x60);/g,h=new RegExp(p.source),g=Object.freeze({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'","&#39;":"'","&#x27;":"'","&#96;":"`","&#x60;":"`"});return Object.freeze(Object.defineProperties({},{toEnum:{value:e},isNumeric:{value:t},isBoolean:{value:r},slugify:{value:n},escape:{value:a},unescape:{value:i},fromCssTime:{value:o},toCssTime:{value:s},fromCssProperty:{value:u},parseUrl:{value:l},random:{value:Math.random},entityEncode:{value:a},entityDecode:{value:i},evalExpression:{value:function(){return Scripting.evalJavaScript.apply(Scripting,arguments)}},evalStatements:{value:function(){return Scripting.evalJavaScript.apply(Scripting,arguments)}}}))}(),SimpleAudio=function(){function e(){return g}function t(e){g=!!e,l("mute",g)}function r(){return p}function n(e){p=Math.clamp(e,.2,5),l("rate",p)}function a(){return h}function i(e){h=Math.clamp(e,0,1),l("volume",h)}function o(){l("stop")}function s(e,t){if("function"!=typeof t)throw new Error("callback parameter must be a function");f.set(e,t)}function u(e){f.delete(e)}function l(e,t){f.forEach(function(r){return r(e,t)})}function c(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return new(Function.prototype.bind.apply(m,[null].concat(t)))}function d(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return new(Function.prototype.bind.apply(v,[null].concat(t)))}var f=new Map,p=1,h=1,g=!1,m=function(){function e(t){if(_classCallCheck(this,e),Array.isArray(t))this._create(t);else{if(!(t instanceof e))throw new Error("sources parameter must be an array of either URLs or source objects");this._copy(t)}}return _createClass(e,[{key:"_create",value:function(t){if(!Array.isArray(t)||0===t.length)throw new Error("sources parameter must be an array of either URLs or source objects");var r=/^data:\s*audio\/([^;,]+)\s*[;,]/i,n=/\.([^.\/\\]+)$/,a=e.getType,i=[],o=document.createElement("audio");if(t.forEach(function(e){var t=null;switch("undefined"==typeof e?"undefined":_typeof(e)){case"string":var s=void 0;if("data:"===e.slice(0,5)){if(s=r.exec(e),null===s)throw new Error("source data URI missing media type")}else if(s=n.exec(Util.parseUrl(e).pathname),null===s)throw new Error("source URL missing file extension");var u=a(s[1]);null!==u&&(t={src:e,type:u});break;case"object":if(null===e)throw new Error("source object cannot be null");if(!e.hasOwnProperty("src"))throw new Error('source object missing required "src" property');if(!e.hasOwnProperty("format"))throw new Error('source object missing required "format" property');var l=a(e.format);null!==l&&(t={src:e.src,type:l});break;default:throw new Error("invalid source value (type: "+("undefined"==typeof e?"undefined":_typeof(e))+")")}if(null!==t){var c=document.createElement("source");c.src=t.src,c.type=Browser.isOpera?t.type.replace(/;.*$/,""):t.type,o.appendChild(c),i.push(t)}}),!o.hasChildNodes())if(Browser.isIE)o.src=undefined;else{var s=document.createElement("source");s.src=undefined,s.type=undefined,o.appendChild(s)}this._finalize(o,i,clone(t))}},{key:"_copy",value:function(t){if(!(t instanceof e))throw new Error("original parameter must be an instance of AudioWrapper");this._finalize(t.audio.cloneNode(!0),clone(t.sources),clone(t.originalSources))}},{key:"_finalize",value:function(e,t,r){var n=this;Object.defineProperties(this,{audio:{configurable:!0,value:e},sources:{configurable:!0,value:Object.freeze(t)},originalSources:{configurable:!0,value:Object.freeze(r)},_error:{writable:!0,value:!1},_faderId:{writable:!0,value:null},_mute:{writable:!0,value:!1},_rate:{writable:!0,value:1},_volume:{writable:!0,value:1}}),jQuery(this.audio).on("loadstart",function(){return n._error=!1}).on("error",function(){return n._error=!0}).find("source:last-of-type").on("error",function(){return n._trigger("error")}),SimpleAudio.subscribe(this,function(e){if(!n.audio)return void SimpleAudio.unsubscribe(n);switch(e){case"mute":n._updateAudioMute();break;case"rate":n._updateAudioRate();break;case"stop":n.stop();break;case"volume":n._updateAudioVolume()}}),this.load()}},{key:"_trigger",value:function(e){jQuery(this.audio).triggerHandler(e)}},{key:"clone",value:function(){return new e(this)}},{key:"destroy",value:function(){SimpleAudio.unsubscribe(this),this.fadeStop(),this.stop();var e=this.audio;for(jQuery(e).off();e.hasChildNodes();)e.removeChild(e.firstChild);e.load(),this._error=!0,delete this.audio,delete this.sources,delete this.originalSources}},{key:"_updateAudioMute",value:function(){this.audio.muted=this._mute||SimpleAudio.mute}},{key:"_updateAudioRate",value:function(){this.audio.playbackRate=this._rate*SimpleAudio.rate}},{key:"_updateAudioVolume",value:function(){this.audio.volume=this._volume*SimpleAudio.volume}},{key:"hasSource",value:function(){return this.sources.length>0}},{key:"hasNoData",value:function(){return this.audio.readyState===HTMLMediaElement.HAVE_NOTHING}},{key:"hasMetadata",value:function(){return this.audio.readyState>=HTMLMediaElement.HAVE_METADATA}},{key:"hasSomeData",value:function(){return this.audio.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA}},{key:"hasData",value:function(){return this.audio.readyState===HTMLMediaElement.HAVE_ENOUGH_DATA}},{key:"isFailed",value:function(){return this._error}},{key:"isLoading",value:function(){return this.audio.networkState===HTMLMediaElement.NETWORK_LOADING}},{key:"isPlaying",value:function(){return!(this.audio.ended||this.audio.paused||!this.hasSomeData())}},{key:"isPaused",value:function(){return this.audio.paused&&(this.audio.duration===1/0||this.audio.currentTime>0)&&!this.audio.ended}},{key:"isEnded",value:function(){return this.audio.ended}},{key:"isFading",value:function(){return null!==this._faderId}},{key:"isMuted",value:function(){return this._mute}},{key:"isLooped",value:function(){return this.audio.loop}},{key:"load",value:function(){"auto"!==this.audio.preload&&(this.audio.preload="auto"),this.isLoading()||this.audio.load()}},{key:"play",value:function(){this.audio.play()}},{key:"pause",value:function(){this.audio.pause()}},{key:"stop",value:function(){this.audio.pause(),
this.time=0,this._trigger(":stop")}},{key:"fadeWithDuration",value:function(e,t,r){var n=this;this.fadeStop();var a=Math.clamp(null==r?this.volume:r,0,1),i=Math.clamp(t,0,1);a!==i&&(this.volume=a,jQuery(this.audio).off("timeupdate.AudioWrapper:fadeWithDuration").one("timeupdate.AudioWrapper:fadeWithDuration",function(){var t=void 0,r=void 0;a<i?(t=a,r=i):(t=i,r=a);var o=Number(e);o<1&&(o=1);var s=25,u=(i-a)/(o/(s/1e3));n._faderId=setInterval(function(){return n.isPlaying()?(n.volume=Math.clamp(n.volume+u,t,r),0===n.volume&&n.pause(),void(n.volume===i&&(n.fadeStop(),n._trigger(":fade")))):void n.fadeStop()},s)}),this.play())}},{key:"fade",value:function(e,t){this.fadeWithDuration(5,e,t)}},{key:"fadeIn",value:function(){this.fade(1)}},{key:"fadeOut",value:function(){this.fade(0)}},{key:"fadeStop",value:function(){null!==this._faderId&&(clearInterval(this._faderId),this._faderId=null)}},{key:"on",value:function(t,r){if("function"!=typeof r)throw new Error("listener parameter must be a function");var n=e._events,a=t.trim().splitOrEmpty(/\s+/).map(function(e){var t=e.split(".",1)[0];if(!n.hasOwnProperty(t))throw new Error('unknown event "'+t+'"; valid: '+Object.keys(n).join(", "));return e.replace(t,n[t])+".AudioWrapperEvent"}).join(" ");if(""===a)throw new Error('invalid eventNames parameter "'+t+'"');return jQuery(this.audio).on(a,r),this}},{key:"one",value:function(t,r){if("function"!=typeof r)throw new Error("listener parameter must be a function");var n=e._events,a=t.trim().splitOrEmpty(/\s+/).map(function(e){var t=e.split(".",1)[0];if(!n.hasOwnProperty(t))throw new Error('unknown event "'+t+'"; valid: '+Object.keys(n).join(", "));return e.replace(t,n[t])+".AudioWrapperEvent"}).join(" ");if(""===a)throw new Error('invalid eventNames parameter "'+t+'"');return jQuery(this.audio).one(a,r),this}},{key:"off",value:function(t,r){if(r&&"function"!=typeof r)throw new Error("listener parameter must be a function");if(!t)return jQuery(this.audio).off(".AudioWrapperEvent",r);var n=e._events,a=t.trim().splitOrEmpty(/\s+/).map(function(e){var t=e.split(".",1)[0];if(t){if(!n.hasOwnProperty(t))throw new Error('unknown event "'+t+'"; valid: '+Object.keys(n).join(", "));return e.replace(t,n[t])+".AudioWrapperEvent"}return e+".AudioWrapperEvent"}).join(" ");if(""===a)throw new Error('invalid eventNames parameter "'+t+'"');return jQuery(this.audio).off(a,r),this}},{key:"duration",get:function(){return this.audio.duration}},{key:"ended",get:function(){return this.audio.ended}},{key:"loop",get:function(){return this.audio.loop},set:function(e){this.audio.loop=!!e}},{key:"mute",get:function(){return this._mute},set:function(e){this._mute=!!e,this._updateAudioMute()}},{key:"paused",get:function(){return this.audio.paused}},{key:"rate",get:function(){return this._rate},set:function(e){this._rate=Math.clamp(e,.2,5),this._updateAudioRate()}},{key:"remaining",get:function(){return this.audio.duration-this.audio.currentTime}},{key:"time",get:function(){return this.audio.currentTime},set:function(e){var t=this;try{this.audio.currentTime=e}catch(r){jQuery(this.audio).off("loadedmetadata.AudioWrapper:time").one("loadedmetadata.AudioWrapper:time",function(){return t.audio.currentTime=e})}}},{key:"volume",get:function(){return this._volume},set:function(e){this._volume=Math.clamp(e,0,1),this._updateAudioVolume()}}],[{key:"_verifyType",value:function(t){if(!t||!Has.audio)return null;var r=e._types;if(!r.hasOwnProperty(t)){var n=document.createElement("audio");r[t]=""!==n.canPlayType(t).replace(/^no$/i,"")}return r[t]?t:null}},{key:"getType",value:function(t){if(!t||!Has.audio)return null;var r=e.formats,n=t.toLowerCase(),a=r.hasOwnProperty(n)?r[n]:"audio/"+n;return e._verifyType(a)}},{key:"canPlayFormat",value:function(t){return null!==e.getType(t)}},{key:"canPlayType",value:function(t){return null!==e._verifyType(t)}}]),e}();Object.defineProperties(m,{formats:{value:{aac:"audio/aac",caf:"audio/x-caf","x-caf":"audio/x-caf",mp3:'audio/mpeg; codecs="mp3"',mpeg:'audio/mpeg; codecs="mp3"',m4a:"audio/mp4",mp4:"audio/mp4","x-m4a":"audio/mp4","x-mp4":"audio/mp4",oga:"audio/ogg",ogg:"audio/ogg",opus:'audio/ogg; codecs="opus"',wav:"audio/wav",wave:"audio/wav",weba:"audio/webm",webm:"audio/webm"}},_types:{value:{}},_events:{value:Object.freeze({canplay:"canplaythrough",end:"ended",error:"error",fade:":fade",pause:"pause",play:"playing",rate:"ratechange",seek:"seeked",stop:":stop",volume:"volumechange"})}});var v=function(){function e(t){var r=this;_classCallCheck(this,e),Object.defineProperties(this,{tracks:{configurable:!0,value:[]},queue:{configurable:!0,value:[]},current:{writable:!0,value:null},_rate:{writable:!0,value:1},_volume:{writable:!0,value:1},_mute:{writable:!0,value:!1},_loop:{writable:!0,value:!1},_shuffle:{writable:!0,value:!1}}),Array.isArray(t)?t.forEach(function(e){return r.add(e)}):t instanceof e&&t.tracks.forEach(function(e){return r.add(e)})}return _createClass(e,[{key:"add",value:function(e){var t=this;if(null==e||"object"!==("undefined"==typeof e?"undefined":_typeof(e)))throw new Error("track parameter must be an object");var r=void 0,n=void 0,a=void 0,i=void 0;if(e instanceof m)r=!0,n=e.clone(),a=e.volume,i=e.rate;else{if(!e.hasOwnProperty("track"))throw new Error('track object missing required "track" property');if(!(e.track instanceof m))throw new Error('track object\'s "track" property must be an AudioWrapper object');r=e.hasOwnProperty("copy")&&e.copy,n=r?e.track.clone():e.track,a=e.hasOwnProperty("volume")?e.volume:e.track.volume,i=e.hasOwnProperty("rate")?e.rate:e.track.rate}n.stop(),n.loop=!1,n.mute=!1,n.volume=a,n.rate=i,n.on("end.AudioListEvent",function(){return t._onEnd()}),this.tracks.push({copy:r,track:n,volume:a,rate:i})}},{key:"destroy",value:function(){this.stop(),this.tracks.filter(function(e){return e.copy}).forEach(function(e){return e.track.destroy()}),delete this.tracks,delete this.queue}},{key:"isPlaying",value:function(){return null!==this.current&&this.current.track.isPlaying()}},{key:"isEnded",value:function(){return 0===this.queue.length&&(null===this.current||this.current.track.isEnded())}},{key:"isPaused",value:function(){return null===this.current||this.current.track.isPaused()}},{key:"isMuted",value:function(){return this._mute}},{key:"isLooped",value:function(){return this._loop}},{key:"isShuffled",value:function(){return this._shuffle}},{key:"play",value:function(){(null!==this.current&&!this.current.track.isEnded()||(0===this.queue.length&&this._buildList(),this._next()))&&this.current.track.play()}},{key:"pause",value:function(){null!==this.current&&this.current.track.pause()}},{key:"stop",value:function(){null!==this.current&&(this.current.track.stop(),this.current=null),this.queue.splice(0)}},{key:"skip",value:function(){this._next()?this.current.track.play():this._loop&&this.play()}},{key:"fadeWithDuration",value:function(e,t,r){if(0===this.queue.length&&this._buildList(),null!==this.current&&!this.current.track.isEnded()||this._next()){var n=Math.clamp(t,0,1)*this.current.volume,a=void 0;null!=r&&(a=Math.clamp(r,0,1)*this.current.volume),this.current.track.fadeWithDuration(e,n,a),this._volume=t}}},{key:"fade",value:function(e,t){this.fadeWithDuration(5,e,t)}},{key:"fadeIn",value:function(){this.fade(1)}},{key:"fadeOut",value:function(){this.fade(0)}},{key:"_next",value:function(){return null!==this.current&&this.current.track.stop(),0===this.queue.length?(this.current=null,!1):(this.current=this.queue.shift(),!this.current.track.hasSource()||this.current.track.isFailed()?this._next():(this.current.track.mute=this._mute,this.current.track.rate=this.rate*this.current.rate,this.current.track.volume=this.volume*this.current.volume,!0))}},{key:"_onEnd",value:function(){if(0===this.queue.length){if(!this._loop)return;this._buildList()}this._next()&&this.current.track.play()}},{key:"_buildList",value:function(){var e;this.queue.splice(0),(e=this.queue).push.apply(e,_toConsumableArray(this.tracks)),0!==this.queue.length&&this._shuffle&&(this.queue.shuffle(),this.queue.length>1&&this.queue[0]===this.current&&this.queue.push(this.queue.shift()))}},{key:"duration",get:function(){return this.tracks.map(function(e){return e.track.duration}).reduce(function(e,t){return e+t},0)}},{key:"loop",get:function(){return this._loop},set:function(e){this._loop=!!e}},{key:"mute",get:function(){return this._mute},set:function(e){this._mute=!!e,null!==this.current&&(this.current.track.mute=this._mute)}},{key:"rate",get:function(){return this._rate},set:function(e){this._rate=Math.clamp(e,.2,5),null!==this.current&&(this.current.track.rate=this.rate*this.current.rate)}},{key:"remaining",get:function(){var e=this.queue.map(function(e){return e.track.duration}).reduce(function(e,t){return e+t},0);return null!==this.current&&(e+=this.current.track.remaining),e}},{key:"shuffle",get:function(){return this._shuffle},set:function(e){this._shuffle=!!e}},{key:"time",get:function(){return this.duration-this.remaining}},{key:"volume",get:function(){return this._volume},set:function(e){this._volume=Math.clamp(e,0,1),null!==this.current&&(this.current.track.volume=this.volume*this.current.volume)}}]),e}();return Object.freeze(Object.defineProperties({},{mute:{get:e,set:t},rate:{get:r,set:n},volume:{get:a,set:i},stop:{value:o},subscribe:{value:s},unsubscribe:{value:u},publish:{value:l},create:{value:c},createList:{value:d}}))}(),SimpleStore=function(){function e(e,n){if(r)return r.create(e,n);for(var a=0;a<t.length;++a)if(t[a].init(e,n))return r=t[a],r.create(e,n);throw new Error("no valid storage adapters found")}var t=[],r=null;return Object.freeze(Object.defineProperties({},{adapters:{value:t},create:{value:e}}))}();SimpleStore.adapters.push(function(){function e(){function e(e){try{var t=window[e],r="_sc_"+String(Date.now());t.setItem(r,r);var n=t.getItem(r)===r;return t.removeItem(r),n}catch(e){}return!1}return r=e("localStorage")&&e("sessionStorage")}function t(e,t){if(!r)throw new Error("adapter not initialized");return new n(e,t)}var r=!1,n=function(){function e(t,r){_classCallCheck(this,e);var n=t+".",a=null,i=null;r?(a=window.localStorage,i="localStorage"):(a=window.sessionStorage,i="sessionStorage"),Object.defineProperties(this,{_engine:{value:a},_prefix:{value:n},_prefixRe:{value:new RegExp("^"+RegExp.escape(n))},name:{value:i},id:{value:t},persistent:{value:!!r}})}return _createClass(e,[{key:"size",value:function(){return this.keys().length}},{key:"keys",value:function e(){for(var e=[],t=0;t<this._engine.length;++t){var r=this._engine.key(t);this._prefixRe.test(r)&&e.push(r.replace(this._prefixRe,""))}return e}},{key:"has",value:function(e){return!("string"!=typeof e||!e)&&this._engine.hasOwnProperty(this._prefix+e)}},{key:"get",value:function(t){if("string"!=typeof t||!t)return null;var r=this._engine.getItem(this._prefix+t);return null==r?null:e._deserialize(r)}},{key:"set",value:function(t,r){if("string"!=typeof t||!t)return!1;try{this._engine.setItem(this._prefix+t,e._serialize(r))}catch(e){throw/quota[_\s]?(?:exceeded|reached)/i.test(e.name)&&(e.message=this.name+" quota exceeded"),e}return!0}},{key:"delete",value:function(e){return!("string"!=typeof e||!e)&&(this._engine.removeItem(this._prefix+e),!0)}},{key:"clear",value:function(){for(var e=this.keys(),t=0,r=e.length;t<r;++t)this.delete(e[t]);return!0}},{key:"length",get:function(){return this.keys().length}}],[{key:"_serialize",value:function(e){return LZString.compressToUTF16(JSON.stringify(e))}},{key:"_deserialize",value:function(e){return JSON.parse(LZString.decompressFromUTF16(e))}}]),e}();return Object.freeze(Object.defineProperties({},{init:{value:e},create:{value:t}}))}()),SimpleStore.adapters.push(function(){function e(e){try{var t="_sc_"+String(Date.now());o._setCookie(t,o._serialize(t),undefined),i=o._deserialize(o._getCookie(t))===t,o._setCookie(t,undefined,a)}catch(e){i=!1}return i&&r(e),i}function t(e,t){if(!i)throw new Error("adapter not initialized");return new o(e,t)}function r(e){if(""!==document.cookie)for(var t=e+".",r=new RegExp("^"+RegExp.escape(t)),i=e+"!.",s=e+"*.",u=/\.(?:state|rcWarn)$/,l=document.cookie.split(/;\s*/),c=0;c<l.length;++c){var d=l[c].split("="),f=decodeURIComponent(d[0]);if(r.test(f)){var p=decodeURIComponent(d[1]);""!==p&&!function(){var e=!u.test(f);o._setCookie(f,undefined,a),o._setCookie(f.replace(r,function(){return e?i:s}),p,e?n:undefined)}()}}}var n="Tue, 19 Jan 2038 03:14:07 GMT",a="Thu, 01 Jan 1970 00:00:00 GMT",i=!1,o=function(){function e(t,r){_classCallCheck(this,e);var n=""+t+(r?"!":"*")+".";Object.defineProperties(this,{_prefix:{value:n},_prefixRe:{value:new RegExp("^"+RegExp.escape(n))},name:{value:"cookie"},id:{value:t},persistent:{value:!!r}})}return _createClass(e,[{key:"size",value:function(){return this.keys().length}},{key:"keys",value:function e(){if(""===document.cookie)return[];for(var t=document.cookie.split(/;\s*/),e=[],r=0;r<t.length;++r){var n=t[r].split("="),a=decodeURIComponent(n[0]);if(this._prefixRe.test(a)){var i=decodeURIComponent(n[1]);""!==i&&e.push(a.replace(this._prefixRe,""))}}return e}},{key:"has",value:function(t){return!("string"!=typeof t||!t)&&null!==e._getCookie(this._prefix+t)}},{key:"get",value:function(t){if("string"!=typeof t||!t)return null;var r=e._getCookie(this._prefix+t);return null===r?null:e._deserialize(r)}},{key:"set",value:function(t,r){if("string"!=typeof t||!t)return!1;try{if(e._setCookie(this._prefix+t,e._serialize(r),this.persistent?n:undefined),!this.has(t))throw new Error("unknown validation error during set")}catch(e){throw e.message="cookie error: "+e.message,e}return!0}},{key:"delete",value:function(t){if("string"!=typeof t||!t||!this.has(t))return!1;try{if(e._setCookie(this._prefix+t,undefined,a),this.has(t))throw new Error("unknown validation error during delete")}catch(e){throw e.message="cookie error: "+e.message,e}return!0}},{key:"clear",value:function(){for(var e=this.keys(),t=0,r=e.length;t<r;++t)this.delete(e[t]);return!0}},{key:"length",get:function(){return this.keys().length}}],[{key:"_getCookie",value:function(e){if(!e||""===document.cookie)return null;for(var t=document.cookie.split(/;\s*/),r=0;r<t.length;++r){var n=t[r].split("="),a=decodeURIComponent(n[0]);if(e===a){var i=decodeURIComponent(n[1]);return i||null}}return null}},{key:"_setCookie",value:function(e,t,r){if(e){var n=encodeURIComponent(e)+"=";null!=t&&(n+=encodeURIComponent(t)),null!=r&&(n+="; expires="+r),n+="; path=/",document.cookie=n}}},{key:"_serialize",value:function(e){return LZString.compressToBase64(JSON.stringify(e))}},{key:"_deserialize",value:function(e){return JSON.parse(LZString.decompressFromBase64(e))}}]),e}();return Object.freeze(Object.defineProperties({},{init:{value:e},create:{value:t}}))}());var DebugView=function(){var e=function(){function e(t,r,n,a){_classCallCheck(this,e),Object.defineProperties(this,{parent:{value:t},view:{value:document.createElement("span")},break:{value:document.createElement("wbr")}}),jQuery(this.view).attr({title:a,"aria-label":a,"data-type":null!=r?r:"","data-name":null!=n?n:""}).addClass("debug"),this.parent.appendChild(this.view),this.parent.appendChild(this.break)}return _createClass(e,[{key:"append",value:function(e){return jQuery(this.view).append(e),this}},{key:"modes",value:function(e){var t=this;if(null==e){var r=function(){var e={};return t.view.className.splitOrEmpty(/\s+/).forEach(function(t){"debug"!==t&&(e[t]=!0)}),{v:e}}();if("object"===("undefined"==typeof r?"undefined":_typeof(r)))return r.v}else if("object"===("undefined"==typeof e?"undefined":_typeof(e)))return Object.keys(e).forEach(function(t){this[e[t]?"addClass":"removeClass"](t)},jQuery(this.view)),this;throw new Error("DebugView.prototype.modes options parameter must be an object or null/undefined")}},{key:"remove",value:function(){var e=jQuery(this.view);this.view.hasChildNodes()&&e.contents().appendTo(this.parent),e.remove(),jQuery(this.break).remove()}},{key:"output",get:function(){return this.view}},{key:"type",get:function(){return this.view.getAttribute("data-type")},set:function(e){this.view.setAttribute("data-type",null!=e?e:"")}},{key:"name",get:function(){return this.view.getAttribute("data-name")},set:function(e){this.view.setAttribute("data-name",null!=e?e:"")}},{key:"title",get:function(){return this.view.title},set:function(e){this.view.title=e}}],[{key:"init",value:function(){jQuery('<button id="debug-view-toggle">'+L10n.get("debugViewTitle")+"</button>").ariaClick({label:L10n.get("debugViewToggle")},function(){return e.toggle()}).prependTo("#ui-bar-body"),e.enable()}},{key:"enable",value:function(){jQuery(document.documentElement).attr("data-debug-view","enabled"),jQuery.event.trigger(":debugviewupdate")}},{key:"disable",value:function(){jQuery(document.documentElement).removeAttr("data-debug-view"),jQuery.event.trigger(":debugviewupdate")}},{key:"toggle",value:function(){"enabled"===jQuery(document.documentElement).attr("data-debug-view")?e.disable():e.enable()}}]),e}();return e}(),PRNGWrapper=function(){var e=function(){function e(t,r){_classCallCheck(this,e),Object.defineProperties(this,new Math.seedrandom(t,r,function(e,t){return{_prng:{value:e},seed:{writable:!0,value:t},pull:{writable:!0,value:0},random:{value:function(){return++this.pull,this._prng()}}}}))}return _createClass(e,null,[{key:"marshal",value:function(e){if(!e||!e.hasOwnProperty("seed")||!e.hasOwnProperty("pull"))throw new Error("PRNG is missing required data");return{seed:e.seed,pull:e.pull}}},{key:"unmarshal",value:function(t){if(!t||!t.hasOwnProperty("seed")||!t.hasOwnProperty("pull"))throw new Error("PRNG object is missing required data");for(var r=new e(t.seed,!1),n=t.pull;n>0;--n)r.random();return r}}]),e}();return e}(),StyleWrapper=function(){var e=/\[[<>]?[Ii][Mm][Gg]\[(?:\s|\S)*?\]\]+/g,t=new RegExp(e.source),r=function(){function r(e){if(_classCallCheck(this,r),null==e)throw new TypeError("StyleWrapper style parameter must be an HTMLStyleElement object");Object.defineProperties(this,{style:{value:e}})}return _createClass(r,[{key:"isEmpty",value:function(){return 0===this.style.cssRules.length}},{key:"set",value:function(e){this.clear(),this.add(e)}},{key:"add",value:function(r){var n=r;t.test(n)&&(e.lastIndex=0,n=n.replace(e,function(e){var t=Wikifier.helpers.parseSquareBracketedMarkup({source:e,matchStart:0});if(t.hasOwnProperty("error")||t.pos<e.length)return e;var r=t.source;if("data:"!==r.slice(0,5)&&Story.has(r)){var n=Story.get(r);n.tags.includes("Twine.image")&&(r=n.text)}return'url("'+r.replace(/"/g,"%22")+'")'})),this.style.styleSheet?this.style.styleSheet.cssText+=n:this.style.appendChild(document.createTextNode(n))}},{key:"clear",value:function(){this.style.styleSheet?this.style.styleSheet.cssText="":jQuery(this.style).empty()}}]),r}();return r}(),Diff=function(){function e(t,n){for(var a=Object.prototype.toString,i=Array.isArray(t),o=[].concat(Object.keys(t),Object.keys(n)).sort().filter(function(e,t,r){return 0===t||r[t-1]!==e}),s={},u=void 0,l=function(e){return e===u},c=0,d=o.length;c<d;++c){var f=o[c],p=t[f],h=n[f];if(t.hasOwnProperty(f))if(n.hasOwnProperty(f)){if(p===h)continue;if(("undefined"==typeof p?"undefined":_typeof(p))===("undefined"==typeof h?"undefined":_typeof(h)))if("function"==typeof p)p.toString()!==h.toString()&&(s[f]=[r.Copy,h]);else if("object"!==("undefined"==typeof p?"undefined":_typeof(p))||null===p)s[f]=[r.Copy,h];else{var g=a.call(p),m=a.call(h);if(g===m)if("[object Date]"===g){var v=Number(h);Number(p)!==v&&(s[f]=[r.CopyDate,v])}else if("[object RegExp]"===g)p.toString()!==h.toString()&&(s[f]=[r.Copy,clone(h)]);else{var y=e(p,h);null!==y&&(s[f]=y)}else s[f]=[r.Copy,clone(h)]}else s[f]=[r.Copy,"object"!==("undefined"==typeof h?"undefined":_typeof(h))||null===h?h:clone(h)]}else if(i&&Util.isNumeric(f)){var b=Number(f);if(!u){u="";do u+="~";while(o.some(l));s[u]=[r.SpliceArray,b,b]}b<s[u][1]&&(s[u][1]=b),b>s[u][2]&&(s[u][2]=b)}else s[f]=r.Delete;else s[f]=[r.Copy,"object"!==("undefined"==typeof h?"undefined":_typeof(h))||null===h?h:clone(h)]}return Object.keys(s).length>0?s:null}function t(e,n){for(var a=Object.keys(n||{}),i=clone(e),o=0,s=a.length;o<s;++o){var u=a[o],l=n[u];if(l===r.Delete)delete i[u];else if(Array.isArray(l))switch(l[0]){case r.SpliceArray:i.splice(l[1],1+(l[2]-l[1]));break;case r.Copy:i[u]=clone(l[1]);break;case r.CopyDate:i[u]=new Date(l[1])}else i[u]=t(i[u],l)}return i}var r=Util.toEnum({Delete:0,SpliceArray:1,Copy:2,CopyDate:3});return Object.freeze(Object.defineProperties({},{Op:{value:r},diff:{value:e},patch:{value:t}}))}(),L10n=function(){function e(){r()}function t(e,t){if(!e)return"";var r=function(e){var t=void 0;return e.some(function(e){return!!l10nStrings.hasOwnProperty(e)&&(t=e,!0)}),t}(Array.isArray(e)?e:[e]);if(!r)return"";for(var i=50,o=l10nStrings[r],s=0;a.test(o);){if(++s>i)throw new Error("L10n.get exceeded maximum replacement iterations, probable infinite loop");n.lastIndex=0,o=o.replace(n,function(e){var r=e.slice(1,-1);return t&&t.hasOwnProperty(r)?t[r]:l10nStrings.hasOwnProperty(r)?l10nStrings[r]:void 0})}return o}function r(){strings&&Object.keys(strings).length>0&&Object.keys(l10nStrings).forEach(function(e){try{var t=void 0;switch(e){case"identity":t=strings.identity;break;case"aborting":t=strings.aborting;break;case"cancel":t=strings.cancel;break;case"close":t=strings.close;break;case"ok":t=strings.ok;break;case"errorTitle":t=strings.errors.title;break;case"errorNonexistentPassage":t=strings.errors.nonexistentPassage;break;case"errorSaveMissingData":t=strings.errors.saveMissingData;break;case"errorSaveIdMismatch":t=strings.errors.saveIdMismatch;break;case"warningDegraded":t=strings.warnings.degraded;break;case"debugViewTitle":t=strings.debugView.title;break;case"debugViewToggle":t=strings.debugView.toggle;break;case"uiBarToggle":t=strings.uiBar.toggle;break;case"uiBarBackward":t=strings.uiBar.backward;break;case"uiBarForward":t=strings.uiBar.forward;break;case"uiBarJumpto":t=strings.uiBar.jumpto;break;case"jumptoTitle":t=strings.jumpto.title;break;case"jumptoTurn":t=strings.jumpto.turn;break;case"jumptoUnavailable":t=strings.jumpto.unavailable;break;case"savesTitle":t=strings.saves.title;break;case"savesDisallowed":t=strings.saves.disallowed;break;case"savesEmptySlot":t=strings.saves.emptySlot;break;case"savesIncapable":t=strings.saves.incapable;break;case"savesLabelAuto":t=strings.saves.labelAuto;break;case"savesLabelDelete":t=strings.saves.labelDelete;break;case"savesLabelExport":t=strings.saves.labelExport;break;case"savesLabelImport":t=strings.saves.labelImport;break;case"savesLabelLoad":t=strings.saves.labelLoad;break;case"savesLabelClear":t=strings.saves.labelClear;break;case"savesLabelSave":t=strings.saves.labelSave;break;case"savesLabelSlot":t=strings.saves.labelSlot;break;case"savesSavedOn":t=strings.saves.savedOn;break;case"savesUnavailable":t=strings.saves.unavailable;break;case"savesUnknownDate":t=strings.saves.unknownDate;break;case"settingsTitle":t=strings.settings.title;break;case"settingsOff":t=strings.settings.off;break;case"settingsOn":t=strings.settings.on;break;case"settingsReset":t=strings.settings.reset;break;case"restartTitle":t=strings.restart.title;break;case"restartPrompt":t=strings.restart.prompt;break;case"shareTitle":t=strings.share.title;break;case"autoloadTitle":t=strings.autoload.title;break;case"autoloadCancel":t=strings.autoload.cancel;break;case"autoloadOk":t=strings.autoload.ok;break;case"autoloadPrompt":t=strings.autoload.prompt;break;case"macroBackText":t=strings.macros.back.text;break;case"macroReturnText":t=strings.macros.return.text}t&&(l10nStrings[e]=t.replace(/%\w+%/g,function(e){return"{"+e.slice(1,-1)+"}"}))}catch(e){}})}var n=/\{\w+\}/g,a=new RegExp(n.source);return Object.freeze(Object.defineProperties({},{init:{value:e},get:{value:t}}))}(),strings={errors:{},warnings:{},debugView:{},uiBar:{},jumpto:{},saves:{},settings:{},restart:{},share:{},autoload:{},macros:{back:{},return:{}}},l10nStrings={identity:"game",aborting:"Aborting",cancel:"Cancel",close:"Close",ok:"OK",errorTitle:"Error",errorNonexistentPassage:'the passage "{passage}" does not exist',errorSaveMissingData:"save is missing required data. Either the loaded file is not a save or the save has become corrupted",errorSaveIdMismatch:"save is from the wrong {identity}",_warningIntroLacking:"Your browser either lacks or has disabled",_warningOutroDegraded:", so this {identity} is running in a degraded mode. You may be able to continue, however, some parts may not work properly.",warningNoWebStorage:"{_warningIntroLacking} the Web Storage API{_warningOutroDegraded}",warningDegraded:"{_warningIntroLacking} some of the capabilities required by this {identity}{_warningOutroDegraded}",debugViewTitle:"Debug View",debugViewToggle:"Toggle the debug view",uiBarToggle:"Toggle the UI bar",uiBarBackward:"Go backward within the {identity} history",uiBarForward:"Go forward within the {identity} history",uiBarJumpto:"Jump to a specific point within the {identity} history",jumptoTitle:"Jump To",jumptoTurn:"Turn",jumptoUnavailable:"No jump points currently available…",savesTitle:"Saves",savesDisallowed:"Saving has been disallowed on this passage.",savesEmptySlot:"— slot empty —",savesIncapable:"{_warningIntroLacking} the capabilities required to support saves, so saves have been disabled for this session.",savesLabelAuto:"Autosave",savesLabelDelete:"Delete",savesLabelExport:"Save to Disk…",savesLabelImport:"Load from Disk…",savesLabelLoad:"Load",savesLabelClear:"Delete All",savesLabelSave:"Save",savesLabelSlot:"Slot",savesSavedOn:"Saved on",savesUnavailable:"No save slots found…",savesUnknownDate:"unknown",settingsTitle:"Settings",settingsOff:"Off",settingsOn:"On",settingsReset:"Reset to Defaults",restartTitle:"Restart",restartPrompt:"Are you sure that you want to restart? Unsaved progress will be lost.",shareTitle:"Share",autoloadTitle:"Autoload",autoloadCancel:"Go to start",autoloadOk:"Load autosave",autoloadPrompt:"An autosave exists. Load it now or go to the start?",macroBackText:"Back",macroReturnText:"Return"},Config=function(){function e(){throw new Error("Config.history.mode has been deprecated and is no longer used by SugarCube, please remove it from your code")}function t(){throw new Error("Config.history.tracking has been deprecated, use Config.history.maxStates instead")}var r=Object.seal({debug:!1,addVisitedLinkClass:!1,cleanupWikifierOutput:!1,loadDelay:0,history:Object.seal({controls:!0,maxStates:100,get mode(){e()},set mode(t){e()},get tracking(){t()},set tracking(e){t()}}),macros:Object.seal({ifAssignmentError:!0,maxLoopIterations:1e3}),navigation:Object.seal({override:undefined}),passages:Object.seal({descriptions:undefined,displayTitles:!1,nobr:!1,start:undefined,transitionOut:undefined}),saves:Object.seal({autoload:undefined,autosave:undefined,id:"untitled-story",isAllowed:undefined,onLoad:undefined,onSave:undefined,slots:8,version:undefined}),ui:Object.seal({stowBarInitially:800,updateStoryElements:!0}),transitionEndEventName:function(){for(var e=new Map([["transition","transitionend"],["MSTransition","msTransitionEnd"],["WebkitTransition","webkitTransitionEnd"],["MozTransition","transitionend"]]),t=[].concat(_toConsumableArray(e.keys())),r=document.createElement("div"),n=0;n<t.length;++n)if(r.style[t[n]]!==undefined)return e.get(t[n]);return""}()});return r}(),Patterns=function(){var e=/[\u0150\u0170]/g.test("Ő"),t=function(){var e=new Map([[" ","\\u0020"],["\f","\\f"],["\n","\\n"],["\r","\\r"],["\t","\\t"],["\v","\\v"],[" ","\\u00a0"],[" ","\\u1680"],["᠎","\\u180e"],[" ","\\u2000"],[" ","\\u2001"],[" ","\\u2002"],[" ","\\u2003"],[" ","\\u2004"],[" ","\\u2005"],[" ","\\u2006"],[" ","\\u2007"],[" ","\\u2008"],[" ","\\u2009"],[" ","\\u200a"],["\u2028","\\u2028"],["\u2029","\\u2029"],[" ","\\u202f"],[" ","\\u205f"],["　","\\u3000"],["\ufeff","\\ufeff"]]),t=/\s/,r="";return e.forEach(function(e,n){t.test(n)||(r+=e)}),r?"[\\s"+r+"]":"\\s"}(),r="[\\u0020\\f\\t\\v\\u00a0\\u1680\\u180e\\u2000-\\u200a\\u202f\\u205f\\u3000\\ufeff]",n="[\\n\\r\\u2028\\u2029]",a="[0-9A-Z_a-z\\-\\u00C0-\\u00D6\\u00D8-\\u00DE\\u00DF-\\u00F6\\u00F8-\\u00FF"+(e?"\\u0150\\u0170\\u0151\\u0171":"")+"]",i=a.replace("\\-",""),o="[$A-Z_a-z]",s=o+"[$0-9A-Z_a-z]*",u="[$_]",l=u+s,c="[A-Za-z][\\w-]*|[=-]",d="("+a+"+)\\(([^\\)\\|\\n]+)\\):",f="("+a+"+):([^;\\|\\n]+);",p="((?:\\."+a+"+)+);",h="((?:#"+a+"+)+);",g=d+"|"+f+"|"+p+"|"+h,m="(?:file|https?|mailto|ftp|javascript|irc|news|data):[^\\s'\"]+";return Object.freeze({space:t,spaceNoTerminator:r,lineTerminator:n,anyLetter:a,anyLetterStrict:i,identifierFirstChar:o,identifier:s,variableSigil:u,variable:l,macroName:c,inlineCss:g,url:m})}(),Scripting=function(){function addAccessibleClickHandler(e,t,r,n,a){if(arguments.length<2)throw new Error("addAccessibleClickHandler insufficient number of parameters");var i=void 0,o=void 0;if("function"==typeof t?(i=t,o={namespace:n,one:!!r}):(i=r,o={namespace:a,one:!!n,selector:t}),"function"!=typeof i)throw new TypeError("addAccessibleClickHandler handler parameter must be a function");return jQuery(e).ariaClick(o,i)}function insertElement(e,t,r,n,a,i){var o=jQuery(document.createElement(t));return r&&o.attr("id",r),n&&o.addClass(n),i&&o.attr("title",i),a&&o.text(a),e&&o.appendTo(e),o[0]}function insertText(e,t){jQuery(e).append(document.createTextNode(t))}function removeChildren(e){jQuery(e).empty()}function removeElement(e){jQuery(e).remove()}function fade(e,t){function r(){i+=.05*a,n(o,Math.easeInOut(i)),(1===a&&i>=1||a===-1&&i<=0)&&(e.style.visibility="in"===t.fade?"visible":"hidden",o.parentNode.replaceChild(e,o),o=null,window.clearInterval(s),t.onComplete&&t.onComplete())}function n(e,t){e.style.zoom=1,e.style.filter="alpha(opacity="+Math.floor(100*t)+")",e.style.opacity=t}var a="in"===t.fade?1:-1,i=void 0,o=e.cloneNode(!0),s=void 0;e.parentNode.replaceChild(o,e),"in"===t.fade?(i=0,o.style.visibility="visible"):i=1,n(o,i),s=window.setInterval(r,25)}function scrollWindowTo(e,t){function r(){c+=i,window.scroll(0,o+l*(u*Math.easeInOut(c))),c>=1&&window.clearInterval(d)}function n(e){for(var t=0;e.offsetParent;)t+=e.offsetTop,e=e.offsetParent;return t}function a(e){var t=n(e),r=t+e.offsetHeight,a=window.scrollY?window.scrollY:document.body.scrollTop,i=window.innerHeight?window.innerHeight:document.body.clientHeight,o=a+i;return t>=a&&r>o&&e.offsetHeight<i?t-(i-e.offsetHeight)+20:t}var i=null!=t?Number(t):.1;Number.isNaN(i)||!Number.isFinite(i)||i<0?i=.1:i>1&&(i=1);var o=window.scrollY?window.scrollY:document.body.scrollTop,s=a(e),u=Math.abs(o-s),l=o>s?-1:1,c=0,d=void 0;d=window.setInterval(r,25)}function either(){if(0!==arguments.length)return Array.prototype.concat.apply([],arguments).random()}function hasVisited(){if(0===arguments.length)throw new Error("hasVisited called with insufficient parameters");if(State.isEmpty())return!1;for(var e=Array.prototype.concat.apply([],arguments),t=State.passages,r=0,n=e.length;r<n;++r)if(!t.includes(e[r]))return!1;return!0}function lastVisited(){if(0===arguments.length)throw new Error("lastVisited called with insufficient parameters");if(State.isEmpty())return-1;for(var e=Array.prototype.concat.apply([],arguments),t=State.passages,r=t.length-1,n=State.turns,a=0,i=e.length;a<i&&n>-1;++a){var o=t.lastIndexOf(e[a]);n=Math.min(n,o===-1?-1:r-o)}return n}function passage(){return State.passage}function previous(){var e=State.passages;if(arguments.length>0){var t=Number(arguments[0]);if(!Number.isSafeInteger(t)||t<1)throw new RangeError("previous offset parameter must be a positive integer greater than zero");return e.length>t?e[e.length-1-t]:""}for(var r=e.length-2;r>=0;--r)if(e[r]!==State.passage)return e[r];return""}function random(){if(0===arguments.length)throw new Error("random called with insufficient parameters");var e=void 0,t=void 0;if(1===arguments.length?(e=0,t=arguments[0]):(e=arguments[0],t=arguments[1]),e>t){var r=[t,e];e=r[0],t=r[1]}return Math.floor(State.random()*(t-e+1))+e}function randomFloat(){if(0===arguments.length)throw new Error("randomFloat called with insufficient parameters");
var e=void 0,t=void 0;if(1===arguments.length?(e=0,t=arguments[0]):(e=arguments[0],t=arguments[1]),e>t){var r=[t,e];e=r[0],t=r[1]}return State.random()*(t-e)+e}function tags(){if(0===arguments.length)return Story.get(State.passage).tags.slice(0);for(var e=Array.prototype.concat.apply([],arguments),t=[],r=0,n=e.length;r<n;++r)t=t.concat(Story.get(e[r]).tags);return t}function temporary(){return State.temporary}function time(){return null===Engine.lastPlay?0:Date.now()-Engine.lastPlay}function turns(){return State.turns}function variables(){return State.variables}function visited(){if(State.isEmpty())return 0;for(var e=Array.prototype.concat.apply([],0===arguments.length?[State.passage]:arguments),t=State.passages,r=State.turns,n=0,a=e.length;n<a&&r>0;++n)r=Math.min(r,t.count(e[n]));return r}function visitedTags(){if(0===arguments.length)throw new Error("visitedTags called with insufficient parameters");if(State.isEmpty())return 0;for(var e=Array.prototype.concat.apply([],arguments),t=e.length,r=State.passages,n=new Map,a=0,i=0,o=r.length;i<o;++i){var s=r[i];if(n.has(s))n.get(s)&&++a;else{var u=Story.get(s).tags;if(u.length>0){for(var l=0,c=0;c<t;++c)u.includes(e[c])&&++l;l===t?(++a,n.set(s,!0)):n.set(s,!1)}}}return a}function evalJavaScript(code,output){return function(code,output){return eval(code)}.call(output?{output:output}:null,String(code),output)}function evalTwineScript(code,output){return function(code,output){return eval(code)}.call(output?{output:output}:null,parse(String(code)),output)}var _ref7=function(){function e(e){return e.reduce(function(e,t){return e=e.then(t)},Promise.resolve())}function t(e){return Util.parseUrl(e).path.replace(/^[^\w]+|[^\w]+$/g,"").replace(/[^\w]+/g,"-").toLocaleLowerCase()}function r(){function r(e){return new Promise(function(r,n){jQuery(document.createElement("script")).one("load abort error",function(e){jQuery(e.target).off(),"load"===e.type?r(e.target):n(e.target)}).appendTo(document.head).attr({id:"script-imported-"+t(e),type:"text/javascript",src:e})})}for(var n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];return Promise.all(a.map(function(t){return Array.isArray(t)?e(t.map(function(e){return function(){return r(e)}})):r(t)}))}function n(){function r(e){return new Promise(function(r,n){jQuery(document.createElement("link")).one("load abort error",function(e){jQuery(e.target).off(),"load"===e.type?r(e.target):n(e.target)}).appendTo(document.head).attr({id:"style-imported-"+t(e),rel:"stylesheet",href:e})})}for(var n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];return Promise.all(a.map(function(t){return Array.isArray(t)?e(t.map(function(e){return function(){return r(e)}})):r(t)}))}return{importScripts:r,importStyles:n}}(),importScripts=_ref7.importScripts,importStyles=_ref7.importStyles,parse=function(){function e(e){if(0!==r.lastIndex)throw new RangeError("Scripting.parse last index is non-zero at start");for(var a=e,i=void 0;null!==(i=r.exec(a));)if(i[5]){var o=i[5];if("$"===o||"_"===o)continue;if(n.test(o))o=o[0];else if("is"===o){var s=r.lastIndex,u=a.slice(s);/^\s+not\b/.test(u)&&(a=a.splice(s,u.search(/\S/)),o="isnot")}t.hasOwnProperty(o)&&(a=a.splice(i.index,o.length,t[o]),r.lastIndex+=t[o].length-o.length)}return a}var t=Object.freeze({$:"State.variables.",_:"State.temporary.",to:"=",eq:"==",neq:"!=",is:"===",isnot:"!==",gt:">",gte:">=",lt:"<",lte:"<=",and:"&&",or:"||",not:"!",def:'"undefined" !== typeof',ndef:'"undefined" === typeof'}),r=new RegExp(["(\"\"|'')",'("(?:\\\\.|[^"\\\\])+")',"('(?:\\\\.|[^'\\\\])+')","([=+\\-*\\/%<>&\\|\\^~!?:,;\\(\\)\\[\\]{}]+)","([^\"'=+\\-*\\/%<>&\\|\\^~!?:,;\\(\\)\\[\\]{}\\s]+)"].join("|"),"g"),n=new RegExp("^"+Patterns.variable);return e}();return Object.freeze(Object.defineProperties({},{parse:{value:parse},evalJavaScript:{value:evalJavaScript},evalTwineScript:{value:evalTwineScript}}))}(),Wikifier=function(){var e=0,t=function(){function t(r,n,a){_classCallCheck(this,t),t.Parser.Profile.isEmpty()&&t.Parser.Profile.compile(),Object.defineProperties(this,{source:{value:String(n)},options:{writable:!0,value:Object.assign({profile:"all"},a)},nextMatch:{writable:!0,value:0},output:{writable:!0,value:null},_rawArgs:{writable:!0,value:""}}),null==r?this.output=document.createDocumentFragment():r.jquery?this.output=r[0]:this.output=r;try{++e,this.subWikify(this.output),1===e&&Config.cleanupWikifierOutput&&convertBreaks(this.output)}finally{--e}}return _createClass(t,[{key:"subWikify",value:function(e,r,n){var a=this.output,i=void 0;this.output=e,null!=n&&"object"===("undefined"==typeof n?"undefined":_typeof(n))&&(i=this.options,this.options=Object.assign({},this.options,n));var o=t.Parser.Profile.get(this.options.profile),s=r?new RegExp("(?:"+r+")",this.options.ignoreTerminatorCase?"gim":"gm"):null,u=void 0,l=void 0;do{if(o.parserRegExp.lastIndex=this.nextMatch,s&&(s.lastIndex=this.nextMatch),l=o.parserRegExp.exec(this.source),u=s?s.exec(this.source):null,u&&(!l||u.index<=l.index))return u.index>this.nextMatch&&this.outputText(this.output,this.nextMatch,u.index),this.matchStart=u.index,this.matchLength=u[0].length,this.matchText=u[0],this.nextMatch=s.lastIndex,this.output=a,void(i&&(this.options=i));if(l){l.index>this.nextMatch&&this.outputText(this.output,this.nextMatch,l.index),this.matchStart=l.index,this.matchLength=l[0].length,this.matchText=l[0],this.nextMatch=o.parserRegExp.lastIndex;for(var c=void 0,d=1,f=l.length;d<f;++d)if(l[d]){c=d-1;break}if(o.parsers[c].handler(this),null!=TempState.break)break}}while(u||l);null==TempState.break?this.nextMatch<this.source.length&&(this.outputText(this.output,this.nextMatch,this.source.length),this.nextMatch=this.source.length):this.output.lastChild&&this.output.lastChild.nodeType===Node.ELEMENT_NODE&&"BR"===this.output.lastChild.nodeName.toUpperCase()&&jQuery(this.output.lastChild).remove(),this.output=a,i&&(this.options=i)}},{key:"outputText",value:function(e,t,r){jQuery(e).append(document.createTextNode(this.source.substring(t,r)))}},{key:"rawArgs",value:function(){return this._rawArgs}},{key:"fullArgs",value:function(){return Scripting.parse(this.rawArgs())}}],[{key:"getValue",value:function(e){var r=t.parseStoryVariable(e),n=void 0;if(null!==r){n=r.store;for(var a=r.names,i=0,o=a.length;i<o;++i){if("undefined"==typeof n[a[i]]){n=undefined;break}n=n[a[i]]}}return n}},{key:"setValue",value:function(e,r){var n=t.parseStoryVariable(e);if(null!==n){for(var a=n.names,i=a.pop(),o=n.store,s=0,u=a.length;s<u;++s){if("undefined"==typeof o[a[s]]){o=undefined;break}o=o[a[s]]}if(o!==undefined)return o[i]=r,!0}return!1}},{key:"parseStoryVariable",value:function(e){for(var r={store:"$"===e[0]?State.variables:State.temporary,names:[]},n=e,a=void 0;null!==(a=t._parseVarRegExp.exec(n));)n=n.slice(a[0].length),a[1]?r.names.push(a[1]):a[2]?r.names.push(a[2]):a[3]?r.names.push(a[3]):a[4]?r.names.push(a[4]):a[5]?r.names.push(t.getValue(a[5])):a[6]&&r.names.push(Number(a[6]));return""===n?r:null}},{key:"wikifyEval",value:function(e){var r=document.createDocumentFragment();new t(r,e);var n=r.querySelector(".error");if(null!==n)throw new Error(n.textContent.replace(/^(?:(?:Uncaught\s+)?Error:\s+)+/,""));return r}},{key:"createInternalLink",value:function(e,t,r,n){var a=jQuery(document.createElement("a"));return null!=t&&(a.attr("data-passage",t),Story.has(t)?(a.addClass("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(t)&&a.addClass("link-visited")):a.addClass("link-broken"),a.ariaClick({one:!0},function(){"function"==typeof n&&n(),Engine.play(t)})),r&&a.append(document.createTextNode(r)),e&&a.appendTo(e),a[0]}},{key:"createExternalLink",value:function(e,t,r){var n=jQuery(document.createElement("a")).attr("target","_blank").addClass("link-external").text(r).appendTo(e);return null!=t&&n.attr({href:t,tabindex:0}),n[0]}},{key:"isExternalLink",value:function(e){if(Story.has(e))return!1;var t=new RegExp("^"+Patterns.url,"gim");return t.test(e)||/[\/.?#]/.test(e)}}]),t}();return Object.defineProperty(t,"Parser",{value:function(){function e(){return d}function t(e){if("object"!==("undefined"==typeof e?"undefined":_typeof(e)))throw new Error("Wikifier.Parser.add parser parameter must be an object");if(!e.hasOwnProperty("name"))throw new Error('parser object missing required "name" property');if("string"!=typeof e.name)throw new Error('parser object "name" property must be a string');if(!e.hasOwnProperty("match"))throw new Error('parser object missing required "match" property');if("string"!=typeof e.match)throw new Error('parser object "match" property must be a string');if(!e.hasOwnProperty("handler"))throw new Error('parser object missing required "handler" property');if("function"!=typeof e.handler)throw new Error('parser object "handler" property must be a function');if(e.hasOwnProperty("profiles")&&!Array.isArray(e.profiles))throw new Error('parser object "profiles" property must be an array');if(a(e.name))throw new Error('cannot clobber existing parser "'+e.name+'"');d.push(e)}function r(e){var t=d.find(function(t){return t.name===e});t&&d.delete(t)}function n(){return 0===d.length}function a(e){return!!d.find(function(t){return t.name===e})}function i(e){return d.find(function(t){return t.name===e})||null}function o(){return f}function s(){var e=d,t=e.filter(function(e){return!Array.isArray(e.profiles)||e.profiles.includes("core")});return f=Object.freeze({all:{parsers:e,parserRegExp:new RegExp(e.map(function(e){return"("+e.match+")"}).join("|"),"gm")},core:{parsers:t,parserRegExp:new RegExp(t.map(function(e){return"("+e.match+")"}).join("|"),"gm")}})}function u(){return"object"!==("undefined"==typeof f?"undefined":_typeof(f))||0===Object.keys(f).length}function l(e){if("object"!==("undefined"==typeof f?"undefined":_typeof(f))||!f.hasOwnProperty(e))throw new Error('nonexistent parser profile "'+e+'"');return f[e]}function c(e){return"object"===("undefined"==typeof f?"undefined":_typeof(f))&&f.hasOwnProperty(e)}var d=[],f=void 0;return Object.freeze(Object.defineProperties({},{parsers:{get:e},add:{value:t},delete:{value:r},isEmpty:{value:n},has:{value:a},get:{value:i},Profile:{value:Object.freeze(Object.defineProperties({},{profiles:{get:o},compile:{value:s},isEmpty:{value:u},has:{value:c},get:{value:l}}))}}))}()}),Object.defineProperties(t,{_parseVarRegExp:{value:new RegExp("^(?:"+Patterns.variableSigil+"("+Patterns.identifier+")|\\.("+Patterns.identifier+")|\\[(?:(?:\"((?:\\\\.|[^\"\\\\])+)\")|(?:'((?:\\\\.|[^'\\\\])+)')|("+Patterns.variableSigil+Patterns.identifierFirstChar+".*)|(\\d+))\\])")},helpers:{value:{}},parse:{value:Scripting.parse},evalExpression:{value:Scripting.evalTwineScript},evalStatements:{value:Scripting.evalTwineScript},textPrimitives:{value:Patterns}}),Object.defineProperties(t.helpers,{inlineCss:{value:function(){function e(e){var r={classes:[],id:"",styles:{}},n=void 0;do{t.lastIndex=e.nextMatch;var a=t.exec(e.source);n=a&&a.index===e.nextMatch,n&&(a[1]?r.styles[Util.fromCssProperty(a[1])]=a[2].trim():a[3]?r.styles[Util.fromCssProperty(a[3])]=a[4].trim():a[5]?r.classes=r.classes.concat(a[5].slice(1).split(/\./)):a[6]&&(r.id=a[6].slice(1).split(/#/).pop()),e.nextMatch=t.lastIndex)}while(n);return r}var t=new RegExp(Patterns.inlineCss,"gm");return e}()},evalText:{value:function(e){var t=void 0;try{t=Scripting.evalTwineScript(e),null==t||"function"==typeof t?t=e:(t=String(t),/\[(?:object(?:\s+[^\]]+)?|native\s+code)\]/.test(t)&&(t=e))}catch(r){t=e}return t}},evalPassageId:{value:function(e){return null==e||Story.has(e)?e:t.helpers.evalText(e)}},hasBlockContext:{value:function(e){for(var t="function"==typeof window.getComputedStyle,r=e.length-1;r>=0;--r){var n=e[r];switch(n.nodeType){case Node.ELEMENT_NODE:var a=n.nodeName.toUpperCase();if("BR"===a)return!0;var i=t?window.getComputedStyle(n,null):n.currentStyle;if(i&&i.display){if("none"===i.display)continue;return"block"===i.display}switch(a){case"ADDRESS":case"ARTICLE":case"ASIDE":case"BLOCKQUOTE":case"CENTER":case"DIV":case"DL":case"FIGURE":case"FOOTER":case"FORM":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"HEADER":case"HR":case"MAIN":case"NAV":case"OL":case"P":case"PRE":case"SECTION":case"TABLE":case"UL":return!0}return!1;case Node.COMMENT_NODE:continue;default:return!1}}return!0}},createShadowSetterCallback:{value:function(){function e(){if(!a&&(a=t.Parser.get("macro"),!a))throw new Error('cannot find "macro" parser');return a}function r(){for(var t=a||e(),r=new Set,n=t.context;null!==n;n=n.parent)n._shadows&&n._shadows.forEach(function(e){return r.add(e)});return[].concat(_toConsumableArray(r))}function n(e){var t={};return r().forEach(function(e){var r=e.slice(1),n="$"===e[0]?State.variables:State.temporary;t[e]=n[r]}),function(){var r=Object.keys(t),n=r.length>0?{}:null;try{return r.forEach(function(e){var r=e.slice(1),a="$"===e[0]?State.variables:State.temporary;a.hasOwnProperty(r)&&(n[r]=a[r]),a[r]=t[e]}),Scripting.evalJavaScript(e)}finally{r.forEach(function(e){var r=e.slice(1),a="$"===e[0]?State.variables:State.temporary;t[e]=a[r],n.hasOwnProperty(r)?a[r]=n[r]:delete a[r]})}}}var a=null;return n}()},parseSquareBracketedMarkup:{value:function(e){function t(){return d>=e.source.length?u:e.source[d++]}function r(){return d>=e.source.length?u:e.source[d]}function n(t){return t<1||d+t>=e.source.length?u:e.source[d+t]}function a(){return{error:String.format.apply(String,arguments),pos:d}}function i(){c=d}function o(t){var r=e.source.slice(c,d).trim();if(""===r)throw new Error("malformed wiki "+(h?"link":"image")+", empty "+t+" component");"link"===t&&"~"===r[0]?(l.forceInternal=!0,l.link=r.slice(1)):l[t]=r,c=d}function s(e){++d;e:for(;;){switch(r()){case"\\":++d;var t=r();if(t!==u&&"\n"!==t)break;case u:case"\n":return u;case e:break e}++d}return d}var u=-1,l={},c=e.matchStart,d=c+1,f=void 0,p=void 0,h=void 0,g=void 0;if(g=r(),"["===g)h=l.isLink=!0;else{switch(h=!1,g){case"<":l.align="left",++d;break;case">":l.align="right",++d}if(!/^[Ii][Mm][Gg]$/.test(e.source.slice(d,d+3)))return a("malformed square-bracketed wiki markup");d+=3,l.isImage=!0}if("["!==t())return a("malformed wiki {0}",h?"link":"image");f=1,p=0,i();try{e:for(;;){switch(g=r()){case u:case"\n":return a("unterminated wiki {0}",h?"link":"image");case'"':if(s(g)===u)return a("unterminated double quoted string in wiki {0}",h?"link":"image");break;case"'":if((4===p||3===p&&h)&&s(g)===u)return a("unterminated single quoted string in wiki {0}",h?"link":"image");break;case"|":0===p&&(o(h?"text":"title"),++c,p=1);break;case"-":0===p&&">"===n(1)&&(o(h?"text":"title"),++d,c+=2,p=1);break;case"<":0===p&&"-"===n(1)&&(o(h?"link":"source"),++d,c+=2,p=2);break;case"[":if(p===-1)return a("unexpected left square bracket '['");++f,1===f&&(i(),++c);break;case"]":if(--f,0===f){switch(p){case 0:case 1:o(h?"link":"source"),p=3;break;case 2:o(h?"text":"title"),p=3;break;case 3:h?(o("setter"),p=-1):(o("link"),p=4);break;case 4:o("setter"),p=-1}if(++d,"]"===r()){++d;break e}--d}}++d}}catch(e){return a(e.message)}return l.pos=d,l}}}),t}();!function(){Wikifier.Parser.add({name:"macro",profiles:["core"],match:"<<",lookahead:new RegExp("<<(\\/?"+Patterns.macroName+")(?:\\s*)((?:(?:\"(?:\\\\.|[^\"\\\\])*\")|(?:'(?:\\\\.|[^'\\\\])*')|(?:\\[(?:[<>]?[Ii][Mm][Gg])?\\[[^\\r\\n]*?\\]\\]+)|[^>]|(?:>(?!>)))*)>>","gm"),argsPattern:["(``)","`((?:\\\\.|[^`\\\\])+)`","(\"\"|'')",'("(?:\\\\.|[^"\\\\])+")',"('(?:\\\\.|[^'\\\\])+')","(\\[(?:[<>]?[Ii][Mm][Gg])?\\[[^\\r\\n]*?\\]\\]+)","([^`\"'\\s]+)","(`|\"|')"].join("|"),working:{source:"",name:"",arguments:"",index:0},context:null,handler:function(e){var t=this.lookahead.lastIndex=e.matchStart;if(this.parseTag(e)){var r=e.nextMatch,n=this.working.source,a=this.working.name,i=this.working.arguments,o=void 0;try{if(o=Macro.get(a),!o){if(Macro.tags.has(a)){var s=Macro.tags.get(a);return throwError(e.output,"child tag <<"+a+">> was found outside of a call to its parent macro"+(1===s.length?"":"s")+" <<"+s.join(">>, <<")+">>",e.source.slice(t,e.nextMatch))}return throwError(e.output,"macro <<"+a+">> does not exist",e.source.slice(t,e.nextMatch))}var u=null;if(o.hasOwnProperty("tags")&&(u=this.parseBody(e,o),!u))return e.nextMatch=r,throwError(e.output,"cannot find a closing tag for macro <<"+a+">>",e.source.slice(t,e.nextMatch)+"…");if("function"!=typeof o.handler)return throwError(e.output,"macro <<"+a+">> handler function "+(o.hasOwnProperty("handler")?"is not a function":"does not exist"),e.source.slice(t,e.nextMatch));var l=u?u[0].args:this.createArgs(i,o.hasOwnProperty("skipArgs")&&!!o.skipArgs||o.hasOwnProperty("skipArg0")&&!!o.skipArg0);if(o.hasOwnProperty("_MACRO_API")){this.context=new MacroContext({parent:this.context,macro:o,name:a,args:l,payload:u,parser:e,source:n});try{o.handler.call(this.context)}finally{this.context=this.context.parent}}else{var c=e._rawArgs;e._rawArgs=i,o.handler(e.output,a,l,e,u),e._rawArgs=c}}catch(r){return throwError(e.output,"cannot execute "+(o&&o.isWidget?"widget":"macro")+" <<"+a+">>: "+r.message,e.source.slice(t,e.nextMatch))}finally{this.working.source="",this.working.name="",this.working.arguments="",this.working.index=0}}else e.outputText(e.output,e.matchStart,e.nextMatch)},parseTag:function(e){var t=this.lookahead.exec(e.source);return!(!t||t.index!==e.matchStart||!t[1])&&(e.nextMatch=this.lookahead.lastIndex,this.working.source=e.source.slice(t.index,this.lookahead.lastIndex),this.working.name=t[1],this.working.arguments=t[2],this.working.index=t.index,!0)},parseBody:function(e,t){for(var r=this.working.name,n="/"+r,a="end"+r,i=!!Array.isArray(t.tags)&&t.tags,o=[],s=t.hasOwnProperty("skipArgs")&&t.skipArgs,u=t.hasOwnProperty("skipArg0")&&t.skipArg0,l=-1,c=1,d=this.working.source,f=this.working.name,p=this.working.arguments,h=e.nextMatch;(e.matchStart=e.source.indexOf(this.match,e.nextMatch))!==-1;)if(this.parseTag(e)){var g=this.working.source,m=this.working.name,v=this.working.arguments,y=this.working.index,b=e.nextMatch;switch(m){case r:++c;break;case a:case n:--c;break;default:if(1===c&&i)for(var w=0,k=i.length;w<k;++w)m===i[w]&&(o.push({source:d,name:f,arguments:p,args:this.createArgs(p,s||0===o.length&&u),contents:e.source.slice(h,y)}),d=g,f=m,p=v,h=b)}if(0===c){o.push({source:d,name:f,arguments:p,args:this.createArgs(p,s||0===o.length&&u),contents:e.source.slice(h,y)}),l=b;break}}else this.lookahead.lastIndex=e.nextMatch=e.matchStart+this.match.length;return l!==-1?(e.nextMatch=l,o):null},createArgs:function(e,t){var r=t?[]:this.parseArgs(e);return Object.defineProperties(r,{raw:{value:e},full:{value:Scripting.parse(e)}}),r},parseArgs:function(e){for(var t=new RegExp(this.argsPattern,"gm"),r=[],n=new RegExp("^"+Patterns.variable),a=void 0;null!==(a=t.exec(e));){var i=void 0;if(a[1])i=undefined;else if(a[2]){i=a[2];try{i=Scripting.evalTwineScript(i)}catch(e){throw new Error('unable to parse macro argument "'+i+'": '+e.message)}}else if(a[3])i="";else if(a[4]){i=a[4];try{i=Scripting.evalJavaScript(i)}catch(e){throw new Error("unable to parse macro argument '"+i+"': "+e.message)}}else if(a[5]){i=a[5];try{i=Scripting.evalJavaScript(i)}catch(e){throw new Error('unable to parse macro argument "'+i+'": '+e.message)}}else if(a[6]){i=a[6];var o=Wikifier.helpers.parseSquareBracketedMarkup({source:i,matchStart:0});if(o.hasOwnProperty("error"))throw new Error('unable to parse macro argument "'+i+'": '+o.error);if(o.pos<i.length)throw new Error('unable to parse macro argument "'+i+'": unexpected character(s) "'+i.slice(o.pos)+'" (pos: '+o.pos+")");o.isLink?(i={isLink:!0},i.count=o.hasOwnProperty("text")?2:1,i.link=Wikifier.helpers.evalPassageId(o.link),i.text=o.hasOwnProperty("text")?Wikifier.helpers.evalText(o.text):i.link,i.external=!o.forceInternal&&Wikifier.isExternalLink(i.link),i.setFn=o.hasOwnProperty("setter")?Wikifier.helpers.createShadowSetterCallback(Scripting.parse(o.setter)):null):o.isImage&&(i=function(e){var t={source:e,isImage:!0};if("data:"!==e.slice(0,5)&&Story.has(e)){var r=Story.get(e);r.tags.includes("Twine.image")&&(t.source=r.text,t.passage=r.title)}return t}(Wikifier.helpers.evalPassageId(o.source)),o.hasOwnProperty("align")&&(i.align=o.align),o.hasOwnProperty("title")&&(i.title=Wikifier.helpers.evalText(o.title)),o.hasOwnProperty("link")&&(i.link=Wikifier.helpers.evalPassageId(o.link),i.external=!o.forceInternal&&Wikifier.isExternalLink(i.link)),i.setFn=o.hasOwnProperty("setter")?Wikifier.helpers.createShadowSetterCallback(Scripting.parse(o.setter)):null)}else if(a[7])if(i=a[7],n.test(i))i=Wikifier.getValue(i);else if(/^(?:settings|setup)[.[]/.test(i))try{i=Scripting.evalTwineScript(i)}catch(e){throw new Error('unable to parse macro argument "'+i+'": '+e.message)}else if("null"===i)i=null;else if("undefined"===i)i=undefined;else if("true"===i)i=!0;else if("false"===i)i=!1;else{var s=Number(i);Number.isNaN(s)||(i=s)}else if(a[8]){var u=void 0;switch(a[8]){case"`":u="backtick expression";break;case'"':u="double quoted string";break;case"'":u="single quoted string"}throw new Error("unterminated "+u+" in macro argument string")}r.push(i)}return r}}),Wikifier.Parser.add({name:"prettyLink",profiles:["core"],match:"\\[\\[[^[]",handler:function(e){var t=Wikifier.helpers.parseSquareBracketedMarkup(e);if(t.hasOwnProperty("error"))return void e.outputText(e.output,e.matchStart,e.nextMatch);e.nextMatch=t.pos;var r=Wikifier.helpers.evalPassageId(t.link),n=t.hasOwnProperty("text")?Wikifier.helpers.evalText(t.text):r,a=t.hasOwnProperty("setter")?Wikifier.helpers.createShadowSetterCallback(Scripting.parse(t.setter)):null,i=(Config.debug?new DebugView(e.output,"wiki-link","[[link]]",e.source.slice(e.matchStart,e.nextMatch)):e).output;t.forceInternal||!Wikifier.isExternalLink(r)?Wikifier.createInternalLink(i,r,n,a):Wikifier.createExternalLink(i,r,n)}}),Wikifier.Parser.add({name:"urlLink",profiles:["core"],match:Patterns.url,handler:function(e){e.outputText(Wikifier.createExternalLink(e.output,e.matchText),e.matchStart,e.nextMatch)}}),Wikifier.Parser.add({name:"image",profiles:["core"],match:"\\[[<>]?[Ii][Mm][Gg]\\[",handler:function(e){var t=Wikifier.helpers.parseSquareBracketedMarkup(e);if(t.hasOwnProperty("error"))return void e.outputText(e.output,e.matchStart,e.nextMatch);e.nextMatch=t.pos;var r=void 0;Config.debug&&(r=new DebugView(e.output,"wiki-image",t.hasOwnProperty("link")?"[img[][link]]":"[img[]]",e.source.slice(e.matchStart,e.nextMatch)),r.modes({block:!0}));var n=t.hasOwnProperty("setter")?Wikifier.helpers.createShadowSetterCallback(Scripting.parse(t.setter)):null,a=(Config.debug?r:e).output,i=void 0;if(t.hasOwnProperty("link")){var o=Wikifier.helpers.evalPassageId(t.link);a=t.forceInternal||!Wikifier.isExternalLink(o)?Wikifier.createInternalLink(a,o,null,n):Wikifier.createExternalLink(a,o),a.classList.add("link-image")}if(a=jQuery(document.createElement("img")).appendTo(a).get(0),i=Wikifier.helpers.evalPassageId(t.source),"data:"!==i.slice(0,5)&&Story.has(i)){var s=Story.get(i);s.tags.includes("Twine.image")&&(a.setAttribute("data-passage",s.title),i=s.text)}a.src=i,t.hasOwnProperty("title")&&(a.title=Wikifier.helpers.evalText(t.title)),t.hasOwnProperty("align")&&(a.align=t.align)}}),Wikifier.Parser.add({name:"monospacedByBlock",profiles:["block"],match:"^\\{\\{\\{\\n",lookahead:/^\{\{\{\n((?:^[^\n]*\n)+?)(^\}\}\}$\n?)/gm,handler:function(e){this.lookahead.lastIndex=e.matchStart;var t=this.lookahead.exec(e.source);t&&t.index===e.matchStart&&(jQuery(document.createElement("pre")).text(t[1]).appendTo(e.output),e.nextMatch=this.lookahead.lastIndex)}}),Wikifier.Parser.add({name:"formatByChar",profiles:["core"],match:"''|//|__|\\^\\^|~~|==|\\{\\{\\{",handler:function(e){switch(e.matchText){case"''":e.subWikify(jQuery(document.createElement("strong")).appendTo(e.output).get(0),"''");break;case"//":e.subWikify(jQuery(document.createElement("em")).appendTo(e.output).get(0),"//");break;case"__":e.subWikify(jQuery(document.createElement("u")).appendTo(e.output).get(0),"__");break;case"^^":e.subWikify(jQuery(document.createElement("sup")).appendTo(e.output).get(0),"\\^\\^");break;case"~~":e.subWikify(jQuery(document.createElement("sub")).appendTo(e.output).get(0),"~~");break;case"==":e.subWikify(jQuery(document.createElement("s")).appendTo(e.output).get(0),"==");break;case"{{{":var t=/\{\{\{((?:.|\n)*?)\}\}\}/gm;t.lastIndex=e.matchStart;var r=t.exec(e.source);r&&r.index===e.matchStart&&(jQuery(document.createElement("code")).text(r[1]).appendTo(e.output),e.nextMatch=t.lastIndex)}}}),Wikifier.Parser.add({name:"customStyle",profiles:["core"],match:"@@",terminator:"@@",blockRegExp:/\s*\n/gm,handler:function(e){var t=Wikifier.helpers.inlineCss(e);this.blockRegExp.lastIndex=e.nextMatch;var r=this.blockRegExp.exec(e.source),n=r&&r.index===e.nextMatch,a=jQuery(document.createElement(n?"div":"span")).appendTo(e.output);0===t.classes.length&&""===t.id&&0===Object.keys(t.styles).length?a.addClass("marked"):(t.classes.forEach(function(e){return a.addClass(e)}),""!==t.id&&a.attr("id",t.id),a.css(t.styles)),n?(e.nextMatch+=r[0].length,e.subWikify(a[0],"\\n?"+this.terminator)):e.subWikify(a[0],this.terminator)}}),Wikifier.Parser.add({name:"verbatimText",profiles:["core"],match:'"{3}|<nowiki>',lookahead:/(?:"{3}((?:.|\n)*?)"{3})|(?:<nowiki>((?:.|\n)*?)<\/nowiki>)/gm,handler:function(e){this.lookahead.lastIndex=e.matchStart;var t=this.lookahead.exec(e.source);t&&t.index===e.matchStart&&(jQuery(document.createElement("span")).addClass("verbatim").text(t[1]||t[2]).appendTo(e.output),e.nextMatch=this.lookahead.lastIndex)}}),Wikifier.Parser.add({name:"horizontalRule",profiles:["core"],match:"^----+$\\n?|<hr\\s*/?>\\n?",handler:function(e){jQuery(document.createElement("hr")).appendTo(e.output)}}),Wikifier.Parser.add({name:"emdash",profiles:["core"],match:"--",handler:function(e){jQuery(document.createTextNode("—")).appendTo(e.output)}}),Wikifier.Parser.add({name:"doubleDollarSign",profiles:["core"],match:"\\${2}",handler:function(e){jQuery(document.createTextNode("$")).appendTo(e.output)}}),Wikifier.Parser.add({name:"nakedVariable",profiles:["core"],match:Patterns.variable+"(?:(?:\\."+Patterns.identifier+")|(?:\\[\\d+\\])|(?:\\[\"(?:\\\\.|[^\"\\\\])+\"\\])|(?:\\['(?:\\\\.|[^'\\\\])+'\\])|(?:\\["+Patterns.variable+"\\]))*",handler:function(e){var t=toStringOrDefault(Wikifier.getValue(e.matchText),null);null===t?jQuery(document.createTextNode(e.matchText)).appendTo(e.output):new Wikifier((Config.debug?new DebugView(e.output,"variable",e.matchText,e.matchText):e).output,t)}}),Wikifier.Parser.add({name:"heading",profiles:["block"],match:"^!{1,6}",terminator:"\\n",handler:function(e){return Wikifier.helpers.hasBlockContext(e.output.childNodes)?void e.subWikify(jQuery(document.createElement("h"+e.matchLength)).appendTo(e.output).get(0),this.terminator):void jQuery(e.output).append(document.createTextNode(e.matchText))}}),Wikifier.Parser.add({name:"table",profiles:["block"],match:"^\\|(?:[^\\n]*)\\|(?:[fhck]?)$",lookahead:/^\|([^\n]*)\|([fhck]?)$/gm,rowTerminator:"\\|(?:[cfhk]?)$\\n?",cellPattern:"(?:\\|([^\\n\\|]*)\\|)|(\\|[cfhk]?$\\n?)",cellTerminator:"(?:\\u0020*)\\|",rowTypes:{c:"caption",f:"tfoot",h:"thead","":"tbody"},handler:function(e){if(!Wikifier.helpers.hasBlockContext(e.output.childNodes))return void jQuery(e.output).append(document.createTextNode(e.matchText));var t=jQuery(document.createElement("table")).appendTo(e.output).get(0),r=[],n=null,a=null,i=0,o=void 0;e.nextMatch=e.matchStart;do{this.lookahead.lastIndex=e.nextMatch;var s=this.lookahead.exec(e.source);if(o=s&&s.index===e.nextMatch){var u=s[2];"k"===u?(t.className=s[1],e.nextMatch+=s[0].length+1):(u!==n&&(n=u,a=jQuery(document.createElement(this.rowTypes[u])).appendTo(t)),"c"===n?(a.css("caption-side",0===i?"top":"bottom"),e.nextMatch+=1,e.subWikify(a[0],this.rowTerminator)):this.rowHandler(e,jQuery(document.createElement("tr")).appendTo(a).get(0),r),++i)}}while(o)},rowHandler:function(e,t,r){var n=this,a=new RegExp(this.cellPattern,"gm"),i=0,o=1,s=void 0;do{a.lastIndex=e.nextMatch;var u=a.exec(e.source);if(s=u&&u.index===e.nextMatch){if("~"===u[1]){var l=r[i];l&&(++l.rowCount,l.$element.attr("rowspan",l.rowCount).css("vertical-align","middle")),e.nextMatch=u.index+u[0].length-1}else if(">"===u[1])++o,e.nextMatch=u.index+u[0].length-1;else{if(u[2]){e.nextMatch=u.index+u[0].length;break}!function(){++e.nextMatch;for(var a=Wikifier.helpers.inlineCss(e),s=!1,u=!1,l=void 0;" "===e.source.substr(e.nextMatch,1);)s=!0,++e.nextMatch;"!"===e.source.substr(e.nextMatch,1)?(l=jQuery(document.createElement("th")).appendTo(t),++e.nextMatch):l=jQuery(document.createElement("td")).appendTo(t),r[i]={rowCount:1,$element:l},o>1&&(l.attr("colspan",o),o=1),e.subWikify(l[0],n.cellTerminator)," "===e.matchText.substr(e.matchText.length-2,1)&&(u=!0),a.classes.forEach(function(e){return l.addClass(e)}),""!==a.id&&l.attr("id",a.id),s&&u?a.styles["text-align"]="center":s?a.styles["text-align"]="right":u&&(a.styles["text-align"]="left"),l.css(a.styles),e.nextMatch=e.nextMatch-1}()}++i}}while(s)}}),Wikifier.Parser.add({name:"list",profiles:["block"],match:"^(?:(?:\\*+)|(?:#+))",lookahead:/^(?:(\*+)|(#+))/gm,terminator:"\\n",handler:function(e){if(!Wikifier.helpers.hasBlockContext(e.output.childNodes))return void jQuery(e.output).append(document.createTextNode(e.matchText));e.nextMatch=e.matchStart;var t=[e.output],r=null,n=0,a=void 0,i=void 0;do{this.lookahead.lastIndex=e.nextMatch;var o=this.lookahead.exec(e.source);if(a=o&&o.index===e.nextMatch){var s=o[2]?"ol":"ul",u=o[0].length;if(e.nextMatch+=o[0].length,u>n)for(i=n;i<u;++i)t.push(jQuery(document.createElement(s)).appendTo(t[t.length-1]).get(0));else if(u<n)for(i=n;i>u;--i)t.pop();else u===n&&s!==r&&(t.pop(),t.push(jQuery(document.createElement(s)).appendTo(t[t.length-1]).get(0)));n=u,r=s,e.subWikify(jQuery(document.createElement("li")).appendTo(t[t.length-1]).get(0),this.terminator)}}while(a)}}),Wikifier.Parser.add({name:"quoteByBlock",profiles:["block"],match:"^<<<\\n",terminator:"^<<<\\n",handler:function(e){return Wikifier.helpers.hasBlockContext(e.output.childNodes)?void e.subWikify(jQuery(document.createElement("blockquote")).appendTo(e.output).get(0),this.terminator):void jQuery(e.output).append(document.createTextNode(e.matchText))}}),Wikifier.Parser.add({name:"quoteByLine",profiles:["block"],match:"^>+",lookahead:/^>+/gm,terminator:"\\n",handler:function(e){if(!Wikifier.helpers.hasBlockContext(e.output.childNodes))return void jQuery(e.output).append(document.createTextNode(e.matchText));var t=[e.output],r=0,n=e.matchLength,a=void 0,i=void 0;do{if(n>r)for(i=r;i<n;++i)t.push(jQuery(document.createElement("blockquote")).appendTo(t[t.length-1]).get(0));else if(n<r)for(i=r;i>n;--i)t.pop();r=n,e.subWikify(t[t.length-1],this.terminator),jQuery(document.createElement("br")).appendTo(t[t.length-1]),this.lookahead.lastIndex=e.nextMatch;var o=this.lookahead.exec(e.source);a=o&&o.index===e.nextMatch,a&&(n=o[0].length,e.nextMatch+=o[0].length)}while(a)}}),Wikifier.Parser.add({name:"html",profiles:["core"],match:"<[Hh][Tt][Mm][Ll]>",lookahead:/<[Hh][Tt][Mm][Ll]>((?:.|\n)*?)<\/[Hh][Tt][Mm][Ll]>/gm,handler:function(e){this.lookahead.lastIndex=e.matchStart;var t=this.lookahead.exec(e.source);t&&t.index===e.matchStart&&(e.nextMatch=this.lookahead.lastIndex,jQuery(document.createDocumentFragment()).append(t[1]).appendTo(e.output))}}),Wikifier.Parser.add({name:"commentByBlock",profiles:["core"],match:"(?:/(?:%|\\*))|(?:<!--)",lookahead:/(?:\/(%|\*)(?:(?:.|\n)*?)\1\/)|(?:<!--(?:(?:.|\n)*?)-->)/gm,handler:function(e){this.lookahead.lastIndex=e.matchStart;var t=this.lookahead.exec(e.source);t&&t.index===e.matchStart&&(e.nextMatch=this.lookahead.lastIndex)}}),Wikifier.Parser.add({name:"lineContinuation",profiles:["core"],match:"\\\\"+Patterns.spaceNoTerminator+"*(?:\\n|$)|(?:^|\\n)"+Patterns.spaceNoTerminator+"*\\\\",handler:function(e){e.nextMatch=e.matchStart+e.matchLength}}),Wikifier.Parser.add({name:"lineBreak",profiles:["core"],match:"\\n|<br\\s*/?>",handler:function(e){e.options.nobr||jQuery(document.createElement("br")).appendTo(e.output)}}),Wikifier.Parser.add({name:"htmlCharacterReference",
profiles:["core"],match:"(?:(?:&#?[0-9A-Za-z]{2,8};|.)(?:&#?(?:x0*(?:3[0-6][0-9A-Fa-f]|1D[C-Fc-f][0-9A-Fa-f]|20[D-Fd-f][0-9A-Fa-f]|FE2[0-9A-Fa-f])|0*(?:76[89]|7[7-9][0-9]|8[0-7][0-9]|761[6-9]|76[2-7][0-9]|84[0-3][0-9]|844[0-7]|6505[6-9]|6506[0-9]|6507[0-1]));)+|&#?[0-9A-Za-z]{2,8};)",handler:function(e){jQuery(document.createDocumentFragment()).append(e.matchText).appendTo(e.output)}}),Wikifier.Parser.add({name:"htmlTag",profiles:["core"],match:"<\\w+(?:\\s+[^\\u0000-\\u001F\\u007F-\\u009F\\s\"'>\\/=]+(?:\\s*=\\s*(?:\"[^\"]*?\"|'[^']*?'|[^\\s\"'=<>`]+))?)*\\s*\\/?>",tagPattern:"<(\\w+)",voidElements:["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"],nobrElements:["colgroup","datalist","dl","figure","ol","optgroup","select","table","tbody","tfoot","thead","tr","ul"],handler:function(e){var t=new RegExp(this.tagPattern).exec(e.matchText),r=t&&t[1],n=r&&r.toLowerCase();if(n){var a=this.voidElements.includes(n),i=this.nobrElements.includes(n),o=void 0,s=void 0;if(!a){o="<\\/"+n+"\\s*>";var u=new RegExp(o,"gim");u.lastIndex=e.matchStart,s=u.exec(e.source)}if(a||s){var l=e.output,c=document.createElement(e.output.tagName),d=void 0;for(c.innerHTML=e.matchText;c.firstChild;)c=c.firstChild;c.hasAttribute("data-passage")&&(this.processDataAttributes(c),Config.debug&&(d=new DebugView(e.output,"html-"+n,n,e.matchText),d.modes({block:"img"===n,nonvoid:s}),l=d.output)),s&&(e.subWikify(c,o,{ignoreTerminatorCase:!0,nobr:i}),d&&jQuery(c).find(".debug.block").length>0&&d.modes({block:!0})),l.appendChild(c)}else throwError(e.output,'HTML tag "'+r+'" is not closed',e.matchText+"…")}},processDataAttributes:function(e){var t=e.getAttribute("data-passage");if(null!=t){var r=Wikifier.helpers.evalPassageId(t);r!==t&&(t=r,e.setAttribute("data-passage",r)),""!==t&&("IMG"===e.tagName.toUpperCase()?"data:"!==t.slice(0,5)&&Story.has(t)&&(t=Story.get(t),t.tags.includes("Twine.image")&&(e.src=t.text.trim())):!function(){var r=e.getAttribute("data-setter"),n=void 0;null!=r&&(r=String(r).trim(),""!==r&&(n=Wikifier.helpers.createShadowSetterCallback(Scripting.parse(r)))),Story.has(t)?(e.classList.add("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(t)&&e.classList.add("link-visited")):e.classList.add("link-broken"),jQuery(e).ariaClick({one:!0},function(){"function"==typeof n&&n.call(this),Engine.play(t)})}())}}})}();var Macro=function(){function e(t,r,a){if(Array.isArray(t))return void t.forEach(function(t){return e(t,r,a)});if(!f.test(t))throw new Error('invalid macro name "'+t+'"');if(n(t))throw new Error("cannot clobber existing macro <<"+t+">>");if(u(t))throw new Error("cannot clobber child tag <<"+t+">> of parent macro"+(1===d[t].length?"":"s")+" <<"+d[t].join(">>, <<")+">>");try{if("object"===("undefined"==typeof r?"undefined":_typeof(r)))c[t]=a?clone(r):r;else{if(!n(r))throw new Error("cannot create alias of nonexistent macro <<"+r+">>");c[t]=a?clone(c[r]):c[r]}Object.defineProperty(c,t,{writable:!1}),c[t]._MACRO_API=!0}catch(e){throw"TypeError"===e.name?new Error("cannot clobber protected macro <<"+t+">>"):new Error("unknown error when attempting to add macro <<"+t+">>: ["+e.name+"] "+e.message)}if(c[t].hasOwnProperty("tags"))if(null==c[t].tags)o(t);else{if(!Array.isArray(c[t].tags))throw new Error('bad value for "tags" property of macro <<'+t+">>");o(t,c[t].tags)}}function t(e){if(Array.isArray(e))return void e.forEach(function(e){return t(e)});if(n(e)){c[e].hasOwnProperty("tags")&&s(e);try{Object.defineProperty(c,e,{writable:!0}),delete c[e]}catch(t){throw new Error("unknown error removing macro <<"+e+">>: "+t.message)}}else if(u(e))throw new Error("cannot remove child tag <<"+e+">> of parent macro <<"+d[e]+">>")}function r(){return 0===Object.keys(c).length}function n(e){return c.hasOwnProperty(e)}function a(e){var t=null;return n(e)&&"function"==typeof c[e].handler?t=c[e]:macros.hasOwnProperty(e)&&"function"==typeof macros[e].handler&&(t=macros[e]),t}function i(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"init";Object.keys(c).forEach(function(t){"function"==typeof c[t][e]&&c[t][e](t)}),Object.keys(macros).forEach(function(t){"function"==typeof macros[t][e]&&macros[t][e](t)})}function o(e,t){if(!e)throw new Error("no parent specified");for(var r=["/"+e,"end"+e],a=[].concat(r,Array.isArray(t)?t:[]),i=0;i<a.length;++i){var o=a[i];if(n(o))throw new Error("cannot register tag for an existing macro");u(o)?d[o].includes(e)||(d[o].push(e),d[o].sort()):d[o]=[e]}}function s(e){if(!e)throw new Error("no parent specified");Object.keys(d).forEach(function(t){var r=d[t].indexOf(e);r!==-1&&(1===d[t].length?delete d[t]:d[t].splice(r,1))})}function u(e){return d.hasOwnProperty(e)}function l(e){return u(e)?d[e]:null}var c={},d={},f=new RegExp("^(?:"+Patterns.macroName+")$");return Object.freeze(Object.defineProperties({},{add:{value:e},delete:{value:t},isEmpty:{value:r},has:{value:n},get:{value:a},init:{value:i},tags:{value:Object.freeze(Object.defineProperties({},{register:{value:o},unregister:{value:s},has:{value:u},get:{value:l}}))},evalStatements:{value:function(){return Scripting.evalJavaScript.apply(Scripting,arguments)}}}))}(),MacroContext=function(){var e=function(){function e(t){_classCallCheck(this,e);var r=Object.assign({parent:null,macro:null,name:"",args:null,payload:null,parser:null,source:""},t);if(null===r.macro||""===r.name||null===r.parser)throw new TypeError("context object missing required properties");Object.defineProperties(this,{parent:{value:r.parent},self:{value:r.macro},name:{value:r.name},args:{value:r.args},payload:{value:r.payload},source:{value:r.source},parser:{value:r.parser},_output:{value:r.parser.output},_shadows:{writable:!0,value:null},_debugView:{writable:!0,value:null},_debugViewEnabled:{writable:!0,value:Config.debug}})}return _createClass(e,[{key:"contextHas",value:function(e){for(var t=this;null!==(t=t.parent);)if(e(t))return!0;return!1}},{key:"contextSelect",value:function(e){for(var t=this;null!==(t=t.parent);)if(e(t))return t;return null}},{key:"contextSelectAll",value:function(e){for(var t=[],r=this;null!==(r=r.parent);)e(r)&&t.push(r);return t}},{key:"addShadow",value:function(){var e=this;this._shadows||(this._shadows=new Set);for(var t=new RegExp("^"+Patterns.variable+"$"),r=arguments.length,n=Array(r),a=0;a<r;a++)n[a]=arguments[a];n.flatten().forEach(function(r){if("string"!=typeof r)throw new TypeError("variable name must be a string; type: "+("undefined"==typeof r?"undefined":_typeof(r)));if(!t.test(r))throw new Error('invalid variable name "'+r+'"');e._shadows.add(r)})}},{key:"createShadowWrapper",value:function(e,t,r){var n=void 0;return"function"==typeof e&&(n={},this.shadowView.forEach(function(e){var t=e.slice(1),r="$"===e[0]?State.variables:State.temporary;n[e]=r[t]})),function(){for(var a=this,i=arguments.length,o=Array(i),s=0;s<i;s++)o[s]=arguments[s];"function"==typeof r&&r.apply(this,o),"function"==typeof e&&!function(){var t=Object.keys(n),r=t.length>0?{}:null;try{t.forEach(function(e){var t=e.slice(1),a="$"===e[0]?State.variables:State.temporary;a.hasOwnProperty(t)&&(r[t]=a[t]),a[t]=n[e]}),e.apply(a,o)}finally{t.forEach(function(e){var t=e.slice(1),a="$"===e[0]?State.variables:State.temporary;n[e]=a[t],r.hasOwnProperty(t)?a[t]=r[t]:delete a[t]})}}(),"function"==typeof t&&t.apply(this,o)}}},{key:"createDebugView",value:function(e,t){return this._debugView=new DebugView(this._output,"macro",e?e:this.name,t?t:this.source),null!==this.payload&&this.payload.length>0&&this._debugView.modes({nonvoid:!0}),this._debugViewEnabled=!0,this._debugView}},{key:"removeDebugView",value:function(){null!==this._debugView&&(this._debugView.remove(),this._debugView=null),this._debugViewEnabled=!1}},{key:"error",value:function(e,t){return throwError(this._output,"<<"+this.name+">>: "+e,t?t:this.source)}},{key:"output",get:function(){return this._debugViewEnabled?this.debugView.output:this._output}},{key:"shadows",get:function(){return[].concat(_toConsumableArray(this._shadows))}},{key:"shadowView",get:function(){var e=new Set;return this.contextSelectAll(function(e){return e._shadows}).forEach(function(t){return t._shadows.forEach(function(t){return e.add(t)})}),[].concat(_toConsumableArray(e))}},{key:"debugView",get:function(){return this._debugViewEnabled?null!==this._debugView?this._debugView:this.createDebugView():null}}]),e}();return e}();!function(){Macro.add("capture",{skipArgs:!0,tags:null,handler:function(){if(0===this.args.raw.length)return this.error("no story/temporary variable list specified");var e={};try{for(var t=new RegExp("("+Patterns.variable+")","g"),r=void 0;null!==(r=t.exec(this.args.raw));){var n=r[1],a=n.slice(1),i="$"===n[0]?State.variables:State.temporary;i.hasOwnProperty(a)&&(e[a]=i[a]),this.addShadow(n)}new Wikifier(this.output,this.payload[0].contents)}finally{this.shadows.forEach(function(t){var r=t.slice(1),n="$"===t[0]?State.variables:State.temporary;e.hasOwnProperty(r)?n[r]=e[r]:delete n[r]})}}}),Macro.add("set",{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no expression specified");try{Scripting.evalJavaScript(this.args.full)}catch(e){return this.error("bad evaluation: "+("object"===("undefined"==typeof e?"undefined":_typeof(e))?e.message:e))}Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("unset",{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no story/temporary variable list specified");for(var e=new RegExp("State\\.(variables|temporary)\\.("+Patterns.identifier+")","g"),t=void 0;null!==(t=e.exec(this.args.full));){var r=State[t[1]],n=t[2];r.hasOwnProperty(n)&&delete r[n]}Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("remember",{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no expression specified");try{Scripting.evalJavaScript(this.args.full)}catch(e){return this.error("bad evaluation: "+("object"===("undefined"==typeof e?"undefined":_typeof(e))?e.message:e))}for(var e=storage.get("remember")||{},t=new RegExp("State\\.variables\\.("+Patterns.identifier+")","g"),r=void 0;null!==(r=t.exec(this.args.full));){var n=r[1];e[n]=State.variables[n]}return storage.set("remember",e)?void(Config.debug&&this.debugView.modes({hidden:!0})):this.error("unknown error, cannot remember: "+this.args.raw)},init:function(){var e=storage.get("remember");e&&Object.keys(e).forEach(function(t){return State.variables[t]=e[t]})}}),Macro.add("forget",{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no story variable list specified");for(var e=storage.get("remember"),t=new RegExp("State\\.variables\\.("+Patterns.identifier+")","g"),r=void 0,n=!1;null!==(r=t.exec(this.args.full));){var a=r[1];State.variables.hasOwnProperty(a)&&delete State.variables[a],e&&e.hasOwnProperty(a)&&(n=!0,delete e[a])}return n&&!storage.set("remember",e)?this.error("unknown error, cannot update remember store"):void(Config.debug&&this.debugView.modes({hidden:!0}))}}),Macro.add("run","set"),Macro.add("script",{skipArgs:!0,tags:null,handler:function(){var e=document.createDocumentFragment();try{Scripting.evalJavaScript(this.payload[0].contents,e),Config.debug&&this.createDebugView(this.name,this.source+this.payload[0].contents+"<</"+this.name+">>")}catch(e){return this.error("bad evaluation: "+("object"===("undefined"==typeof e?"undefined":_typeof(e))?e.message:e),this.source+this.payload[0].contents+"<</"+this.name+">>")}e.hasChildNodes()&&this.output.appendChild(e)}}),Macro.add("include",{handler:function(){if(0===this.args.length)return this.error("no passage specified");var e=void 0;if(e="object"===_typeof(this.args[0])?this.args[0].link:this.args[0],!Story.has(e))return this.error('passage "'+e+'" does not exist');Config.debug&&this.debugView.modes({block:!0}),e=Story.get(e);var t=void 0;t=this.args[1]?jQuery(document.createElement(this.args[1])).addClass(e.domId+" macro-"+this.name).attr("data-passage",e.title).appendTo(this.output):jQuery(this.output),t.wiki(e.processText())}}),Macro.add("nobr",{skipArgs:!0,tags:null,handler:function(){new Wikifier(this.output,this.payload[0].contents.replace(/^\n+|\n+$/g,"").replace(/\n+/g," "))}}),Macro.add(["print","=","-"],{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no expression specified");try{var e=toStringOrDefault(Scripting.evalJavaScript(this.args.full),null);null!==e&&new Wikifier(this.output,"-"===this.name?Util.escape(e):e)}catch(e){return this.error("bad evaluation: "+("object"===("undefined"==typeof e?"undefined":_typeof(e))?e.message:e))}}}),Macro.add("silently",{skipArgs:!0,tags:null,handler:function(){var e=document.createDocumentFragment();if(new Wikifier(e,this.payload[0].contents.trim()),Config.debug)this.debugView.modes({hidden:!0}),this.output.appendChild(e);else{var t=[].concat(_toConsumableArray(e.querySelectorAll(".error"))).map(function(e){return e.textContent});if(t.length>0)return this.error("error"+(1===t.length?"":"s")+" within contents ("+t.join("; ")+")",this.source+this.payload[0].contents+"<</"+this.name+">>")}}}),Macro.add("display","include"),Macro.add("if",{skipArgs:!0,tags:["elseif","else"],handler:function(){var e=0;try{for(var t=Scripting.evalJavaScript,r=this.payload.length,n=!1;e<r;++e){switch(this.payload[e].name){case"else":if(e+1!==r)return this.error("<<else>> must be the final clause");if(this.payload[e].args.raw.length>0)return/^\s*if\b/i.test(this.payload[e].args.raw)?this.error('whitespace is not allowed between the "else" and "if" in <<elseif>> clause'+(e>0?" (#"+e+")":"")):this.error("<<else>> does not accept a conditional expression (perhaps you meant to use <<elseif>>), invalid: "+this.payload[e].args.raw);break;default:if(0===this.payload[e].args.full.length)return this.error("no conditional expression specified for <<"+this.payload[e].name+">> clause"+(e>0?" (#"+e+")":""));if(Config.macros.ifAssignmentError&&/[^!=&^|<>*\/%+-]=[^=]/.test(this.payload[e].args.full))return this.error("assignment operator found within <<"+this.payload[e].name+">> clause"+(e>0?" (#"+e+")":"")+" (perhaps you meant to use an equality operator: ==, ===, eq, is), invalid: "+this.payload[e].args.raw)}if(Config.debug&&this.createDebugView(this.payload[e].name,this.payload[e].source).modes({nonvoid:!1}),"else"===this.payload[e].name||t(this.payload[e].args.full)){n=!0,new Wikifier(this.output,this.payload[e].contents);break}Config.debug&&this.debugView.modes({hidden:!0,invalid:!0})}if(Config.debug){for(++e;e<r;++e)this.createDebugView(this.payload[e].name,this.payload[e].source).modes({nonvoid:!1,hidden:!0,invalid:!0});this.createDebugView("/"+this.name,"<</"+this.name+">>").modes({nonvoid:!1,hidden:!n,invalid:!n})}}catch(t){return this.error("bad conditional expression in <<"+(0===e?"if":"elseif")+">> clause"+(e>0?" (#"+e+")":"")+": "+("object"===("undefined"==typeof t?"undefined":_typeof(t))?t.message:t))}}}),Macro.add("switch",{skipArg0:!0,tags:["case","default"],handler:function(){if(0===this.args.full.length)return this.error("no expression specified");var e=this.payload.length,t=void 0;if(1===e)return this.error("no cases specified");try{t=Scripting.evalJavaScript(this.args.full)}catch(e){return this.error("bad evaluation: "+("object"===("undefined"==typeof e?"undefined":_typeof(e))?e.message:e))}var r=this.debugView,n=1,a=!1;for(Config.debug&&r.modes({nonvoid:!1,hidden:!0});n<e;++n){switch(this.payload[n].name){case"default":if(n+1!==e)return this.error("<<default>> must be the final case");if(this.payload[n].args.length>0)return this.error("<<default>> does not accept values, invalid: "+this.payload[n].args.raw);break;default:if(0===this.payload[n].args.length)return this.error("no value(s) specified for <<"+this.payload[n].name+">> (#"+n+")")}if(Config.debug&&this.createDebugView(this.payload[n].name,this.payload[n].source).modes({nonvoid:!1}),"default"===this.payload[n].name||this.payload[n].args.some(function(e){return e===t})){a=!0,new Wikifier(this.output,this.payload[n].contents);break}Config.debug&&this.debugView.modes({hidden:!0,invalid:!0})}if(Config.debug){for(++n;n<e;++n)this.createDebugView(this.payload[n].name,this.payload[n].source).modes({nonvoid:!1,hidden:!0,invalid:!0});r.modes({nonvoid:!1,hidden:!0,invalid:!a}),this.createDebugView("/"+this.name,"<</"+this.name+">>").modes({nonvoid:!1,hidden:!0,invalid:!a})}}}),Macro.add("for",{skipArgs:!0,tags:null,handler:function(){var e=Scripting.evalJavaScript,t=this.payload[0].contents.replace(/\n$/,""),r=void 0,n=this.args.full.trim(),a=void 0,i=!0,o=Config.macros.maxLoopIterations;if(0===n.length)n=!0;else if(n.indexOf(";")!==-1){var s=n.match(/^([^;]*?)\s*;\s*([^;]*?)\s*;\s*([^;]*?)$/);if(null===s)return this.error("invalid 3-part syntax, format: init ; condition ; post");r=s[1],n=s[2],a=s[3]}if("string"==typeof n){if(/^\S+\s+in\s+\S+/i.test(n))return this.error("invalid syntax, for…in is not supported");if(/^\S+\s+of\s+\S+/i.test(n))return this.error("invalid syntax, for…of is not supported")}Config.debug&&this.debugView.modes({block:!0});try{if(TempState.break=null,r)try{e(r)}catch(e){return this.error("bad init expression: "+("object"===("undefined"==typeof e?"undefined":_typeof(e))?e.message:e))}for(;e(n);){if(--o<0)return this.error("exceeded configured maximum loop iterations ("+Config.macros.maxLoopIterations+")");if(new Wikifier(this.output,i?t.replace(/^\n/,""):t),i&&(i=!1),null!=TempState.break)if(1===TempState.break)TempState.break=null;else if(2===TempState.break){TempState.break=null;break}if(a)try{e(a)}catch(e){return this.error("bad post expression: "+("object"===("undefined"==typeof e?"undefined":_typeof(e))?e.message:e))}}}catch(e){return this.error("bad conditional expression: "+("object"===("undefined"==typeof e?"undefined":_typeof(e))?e.message:e))}finally{TempState.break=null}}}),Macro.add(["break","continue"],{skipArgs:!0,handler:function(){return this.contextHas(function(e){return"for"===e.name})?(TempState.break="continue"===this.name?1:2,void(Config.debug&&this.debugView.modes({hidden:!0}))):this.error("must only be used in conjunction with its parent macro <<for>>")}}),Macro.add(["button","link"],{isAsync:!0,tags:null,handler:function(){var e=this;if(0===this.args.length)return this.error("no "+("button"===this.name?"button":"link")+" text specified");Config.debug&&this.createDebugView(this.name,this.source+this.payload[0].contents+"<</"+this.name+">>");var t=jQuery(document.createElement("button"===this.name?"button":"a")),r=void 0;if("object"===_typeof(this.args[0]))if(this.args[0].isImage){var n=jQuery(document.createElement("img")).attr("src",this.args[0].source).appendTo(t);this.args[0].hasOwnProperty("passage")&&n.attr("data-passage",this.args[0].passage),this.args[0].hasOwnProperty("title")&&n.attr("title",this.args[0].title),this.args[0].hasOwnProperty("align")&&n.attr("align",this.args[0].align),this.args[0].hasOwnProperty("link")&&(r=this.args[0].link),r=this.args[0].link}else t.append(document.createTextNode(this.args[0].text)),r=this.args[0].link;else t.wikiWithOptions({profile:"core"},this.args[0]),r=this.args.length>1?this.args[1]:undefined;null!=r?(t.attr("data-passage",r),Story.has(r)?(t.addClass("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(r)&&t.addClass("link-visited")):t.addClass("link-broken")):t.addClass("link-internal"),t.addClass("macro-"+this.name).ariaClick({namespace:".macros",one:null!=r},this.createShadowWrapper(""!==this.payload[0].contents?function(){return Wikifier.wikifyEval(e.payload[0].contents.trim())}:null,null!=r?function(){return Engine.play(r)}:null)).appendTo(this.output)}}),Macro.add("checkbox",{handler:function(){if(this.args.length<3){var e=[];return this.args.length<1&&e.push("variable name"),this.args.length<2&&e.push("unchecked value"),this.args.length<3&&e.push("checked value"),this.error("no "+e.join(" or ")+" specified")}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var t=this.args[0].trim();if("$"!==t[0]&&"_"!==t[0])return this.error('variable name "'+this.args[0]+'" is missing its sigil ($ or _)');var r=Util.slugify(t),n=this.args[1],a=this.args[2],i=document.createElement("input");jQuery(i).attr({id:this.name+"-"+r,name:this.name+"-"+r,type:"checkbox",tabindex:0}).addClass("macro-"+this.name).on("change",function(){Wikifier.setValue(t,this.checked?a:n)}).appendTo(this.output),this.args.length>3&&"checked"===this.args[3]?(i.checked=!0,Wikifier.setValue(t,a)):Wikifier.setValue(t,n)}}),Macro.add(["linkappend","linkprepend","linkreplace"],{isAsync:!0,tags:null,handler:function(){var e=this;if(0===this.args.length)return this.error("no link text specified");Config.debug&&this.createDebugView(this.name,this.source+this.payload[0].contents+"<</"+this.name+">>");var t=jQuery(document.createElement("a")),r=jQuery(document.createElement("span")),n=this.args.length>1&&/^(?:transition|t8n)$/.test(this.args[1]);t.wikiWithOptions({profile:"core"},this.args[0]).addClass("link-internal macro-"+this.name).ariaClick({namespace:".macros",one:!0},this.createShadowWrapper(function(){if("linkreplace"===e.name?t.remove():t.wrap('<span class="macro-'+e.name+'"></span>').replaceWith(function(){return t.html()}),""!==e.payload[0].contents){var a=document.createDocumentFragment();new Wikifier(a,e.payload[0].contents),r.append(a)}n&&setTimeout(function(){return r.removeClass("macro-"+e.name+"-in")},Engine.minDomActionDelay)})).appendTo(this.output),r.addClass("macro-"+this.name+"-insert"),n&&r.addClass("macro-"+this.name+"-in"),"linkprepend"===this.name?r.insertBefore(t):r.insertAfter(t)}}),Macro.add("radiobutton",{handler:function(){if(this.args.length<2){var e=[];return this.args.length<1&&e.push("variable name"),this.args.length<2&&e.push("checked value"),this.error("no "+e.join(" or ")+" specified")}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var t=this.args[0].trim();if("$"!==t[0]&&"_"!==t[0])return this.error('variable name "'+this.args[0]+'" is missing its sigil ($ or _)');var r=Util.slugify(t),n=this.args[1],a=document.createElement("input");TempState.hasOwnProperty(this.name)||(TempState[this.name]={}),TempState[this.name].hasOwnProperty(r)||(TempState[this.name][r]=0),jQuery(a).attr({id:this.name+"-"+r+"-"+TempState[this.name][r]++,name:this.name+"-"+r,type:"radio",tabindex:0}).addClass("macro-"+this.name).on("change",function(){this.checked&&Wikifier.setValue(t,n)}).appendTo(this.output),this.args.length>2&&"checked"===this.args[2]&&(a.checked=!0,Wikifier.setValue(t,n))}}),Macro.add("textarea",{handler:function(){if(this.args.length<2){var e=[];return this.args.length<1&&e.push("variable name"),this.args.length<2&&e.push("default value"),this.error("no "+e.join(" or ")+" specified")}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var t=this.args[0].trim();if("$"!==t[0]&&"_"!==t[0])return this.error('variable name "'+this.args[0]+'" is missing its sigil ($ or _)');Config.debug&&this.debugView.modes({block:!0});var r=Util.slugify(t),n=this.args[1],a="autofocus"===this.args[2],i=document.createElement("textarea");jQuery(i).attr({id:this.name+"-"+r,name:this.name+"-"+r,rows:4,tabindex:0}).addClass("macro-"+this.name).on("change",function(){Wikifier.setValue(t,this.value)}).appendTo(this.output),Wikifier.setValue(t,n),i.textContent=n,a&&(i.setAttribute("autofocus","autofocus"),postdisplay["#autofocus:"+i.id]=function(e){delete postdisplay[e],setTimeout(function(){return i.focus()},Engine.minDomActionDelay)})}}),Macro.add("textbox",{handler:function(){if(this.args.length<2){var e=[];return this.args.length<1&&e.push("variable name"),this.args.length<2&&e.push("default value"),this.error("no "+e.join(" or ")+" specified")}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var t=this.args[0].trim();if("$"!==t[0]&&"_"!==t[0])return this.error('variable name "'+this.args[0]+'" is missing its sigil ($ or _)');Config.debug&&this.debugView.modes({block:!0});var r=Util.slugify(t),n=this.args[1],a=document.createElement("input"),i=!1,o=void 0;this.args.length>3?(o=this.args[2],i="autofocus"===this.args[3]):this.args.length>2&&("autofocus"===this.args[2]?i=!0:o=this.args[2]),jQuery(a).attr({id:this.name+"-"+r,name:this.name+"-"+r,type:"text",tabindex:0}).addClass("macro-"+this.name).on("change",function(){Wikifier.setValue(t,this.value)}).on("keypress",function(e){13===e.which&&(e.preventDefault(),Wikifier.setValue(t,this.value),null!=o&&Engine.play(o))}).appendTo(this.output),Wikifier.setValue(t,n),a.value=n,i&&(a.setAttribute("autofocus","autofocus"),postdisplay["#autofocus:"+a.id]=function(e){delete postdisplay[e],setTimeout(function(){return a.focus()},Engine.minDomActionDelay)})}}),Macro.add("click","link"),Macro.add("actions",{handler:function(){for(var e=jQuery(document.createElement("ul")).addClass(this.name).appendTo(this.output),t=0;t<this.args.length;++t){var r=void 0,n=void 0,a=void 0,i=void 0;"object"===_typeof(this.args[t])?this.args[t].isImage?(a=jQuery(document.createElement("img")).attr("src",this.args[t].source),this.args[t].hasOwnProperty("passage")&&a.attr("data-passage",this.args[t].passage),this.args[t].hasOwnProperty("title")&&a.attr("title",this.args[t].title),this.args[t].hasOwnProperty("align")&&a.attr("align",this.args[t].align),r=this.args[t].link,i=this.args[t].setFn):(n=this.args[t].text,r=this.args[t].link,i=this.args[t].setFn):n=r=this.args[t],State.variables.hasOwnProperty("#actions")&&State.variables["#actions"].hasOwnProperty(r)&&State.variables["#actions"][r]||jQuery(Wikifier.createInternalLink(jQuery(document.createElement("li")).appendTo(e),r,null,function(e,t){return function(){State.variables.hasOwnProperty("#actions")||(State.variables["#actions"]={}),State.variables["#actions"][e]=!0,"function"==typeof t&&t()}}(r,i))).addClass("macro-"+this.name).append(a||document.createTextNode(n))}}}),Macro.add(["back","return"],{handler:function(){if(this.args.length>1)return this.error("too many arguments specified, check the documentation for details");var e=-1,t=void 0,r=void 0,n=void 0;if(1===this.args.length&&("object"===_typeof(this.args[0])?this.args[0].isImage?(n=jQuery(document.createElement("img")).attr("src",this.args[0].source),this.args[0].hasOwnProperty("passage")&&n.attr("data-passage",this.args[0].passage),this.args[0].hasOwnProperty("title")&&n.attr("title",this.args[0].title),this.args[0].hasOwnProperty("align")&&n.attr("align",this.args[0].align),this.args[0].hasOwnProperty("link")&&(t=this.args[0].link)):1===this.args[0].count?t=this.args[0].link:(r=this.args[0].text,t=this.args[0].link):1===this.args.length&&(r=this.args[0])),null==t){for(var a=State.length-2;a>=0;--a)if(State.history[a].title!==State.passage){e=a,t=State.history[a].title;break}if(null==t&&"return"===this.name)for(var i=State.expired.length-1;i>=0;--i)if(State.expired[i]!==State.passage){t=State.expired[i];break}}else{if(!Story.has(t))return this.error('passage "'+t+'" does not exist');if("back"===this.name){for(var o=State.length-2;o>=0;--o)if(State.history[o].title===t){e=o;break}if(e===-1)return this.error('cannot find passage "'+t+'" in the current story history')}}if(null==t)return this.error("cannot find passage");var s=void 0;s="back"!==this.name||e!==-1?jQuery(document.createElement("a")).addClass("link-internal").ariaClick({one:!0},"return"===this.name?function(){return Engine.play(t)}:function(){return Engine.goTo(e)}):jQuery(document.createElement("span")).addClass("link-disabled"),s.addClass("macro-"+this.name).append(n||document.createTextNode(r||L10n.get("macro"+this.name.toUpperFirst()+"Text"))).appendTo(this.output)}}),Macro.add("choice",{handler:function(){if(0===this.args.length)return this.error("no passage specified");var e=State.passage,t=void 0,r=void 0,n=void 0,a=void 0;return 1===this.args.length?"object"===_typeof(this.args[0])?this.args[0].isImage?(n=jQuery(document.createElement("img")).attr("src",this.args[0].source),this.args[0].hasOwnProperty("passage")&&n.attr("data-passage",this.args[0].passage),this.args[0].hasOwnProperty("title")&&n.attr("title",this.args[0].title),this.args[0].hasOwnProperty("align")&&n.attr("align",this.args[0].align),t=this.args[0].link,a=this.args[0].setFn):(r=this.args[0].text,t=this.args[0].link,a=this.args[0].setFn):r=t=this.args[0]:(t=this.args[0],r=this.args[1]),State.variables.hasOwnProperty("#choice")&&State.variables["#choice"].hasOwnProperty(e)&&State.variables["#choice"][e]?void jQuery(document.createElement("span")).addClass("link-disabled macro-"+this.name).attr("tabindex",-1).append(n||document.createTextNode(r)).appendTo(this.output):void jQuery(Wikifier.createInternalLink(this.output,t,null,function(){State.variables.hasOwnProperty("#choice")||(State.variables["#choice"]={}),State.variables["#choice"][e]=!0,"function"==typeof a&&a()})).addClass("macro-"+this.name).append(n||document.createTextNode(r))}}),Macro.add(["addclass","toggleclass"],{handler:function(){if(this.args.length<2){var e=[];return this.args.length<1&&e.push("selector"),this.args.length<2&&e.push("class names"),this.error("no "+e.join(" or ")+" specified")}var t=jQuery(this.args[0]);if(0===t.length)return this.error('no elements matched the selector "'+this.args[0]+'"');switch(this.name){case"addclass":t.addClass(this.args[1].trim());break;case"toggleclass":t.toggleClass(this.args[1].trim())}}}),Macro.add("removeclass",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var e=jQuery(this.args[0]);return 0===e.length?this.error('no elements matched the selector "'+this.args[0]+'"'):void(this.args.length>1?e.removeClass(this.args[1].trim()):e.removeClass())}}),Macro.add("copy",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var e=jQuery(this.args[0]);return 0===e.length?this.error('no elements matched the selector "'+this.args[0]+'"'):void jQuery(this.output).append(e.html())}}),Macro.add(["append","prepend","replace"],{tags:null,handler:function(){if(0===this.args.length)return this.error("no selector specified");var e=jQuery(this.args[0]);if(0===e.length)return this.error('no elements matched the selector "'+this.args[0]+'"');if(""!==this.payload[0].contents){var t=document.createDocumentFragment();switch(new Wikifier(t,this.payload[0].contents),this.name){case"replace":e.empty();case"append":e.append(t);break;case"prepend":e.prepend(t)}}else"replace"===this.name&&e.empty()}}),Macro.add("remove",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var e=jQuery(this.args[0]);return 0===e.length?this.error('no elements matched the selector "'+this.args[0]+'"'):void e.remove()}}),Has.audio?!function(){var e=Object.freeze([":not",":all",":looped",":muted",":paused",":playing"]);Macro.add("audio",{handler:function(){var e=this;if(this.args.length<2){var t=[];return this.args.length<1&&t.push("track or group IDs"),this.args.length<2&&t.push("actions"),this.error("no "+t.join(" or ")+" specified")}var r=Macro.get("cacheaudio").tracks,n=[];try{!function(){var t=function e(t){var n=t.id,o=void 0;switch(n){case":all":o=a;break;case":looped":o=a.filter(function(e){return r[e].isLooped()});break;case":muted":o=a.filter(function(e){return r[e].isMuted()});break;case":paused":o=a.filter(function(e){return r[e].isPaused()});break;case":playing":o=a.filter(function(e){return r[e].isPlaying()});break;default:o=":"===n[0]?i[n]:[n]}return t.hasOwnProperty("not")&&!function(){var r=t.not.map(function(t){return e(t)}).flatten();o=o.filter(function(e){return!r.includes(e)})}(),o},a=Object.freeze(Object.keys(r)),i=Macro.get("cacheaudio").groups;e.self.parseIds(String(e.args[0]).trim()).forEach(function(e){n.push.apply(n,_toConsumableArray(t(e)))}),n.forEach(function(e){if(!r.hasOwnProperty(e))throw new Error('track "'+e+'" does not exist')})}()}catch(e){return this.error(e.message)}for(var a=this.args.slice(1),i=void 0,o=void 0,s=void 0,u=void 0,l=void 0,c=void 0,d=5,f=void 0,p=void 0;a.length>0;){
var h=a.shift();switch(h){case"play":case"pause":case"stop":i=h;break;case"fadein":i="fade",c=1;break;case"fadeout":i="fade",c=0;break;case"fadeto":if(0===a.length)return this.error("fadeto missing required level value");if(i="fade",p=a.shift(),c=Number.parseFloat(p),Number.isNaN(c)||!Number.isFinite(c))return this.error("cannot parse fadeto: "+p);break;case"fadeoverto":if(a.length<2){var g=[];return a.length<1&&g.push("seconds"),a.length<2&&g.push("level"),this.error("fadeoverto missing required "+g.join(" and ")+" value"+(g.length>1?"s":""))}if(i="fade",p=a.shift(),d=Number.parseFloat(p),Number.isNaN(d)||!Number.isFinite(d))return this.error("cannot parse fadeoverto: "+p);if(p=a.shift(),c=Number.parseFloat(p),Number.isNaN(c)||!Number.isFinite(c))return this.error("cannot parse fadeoverto: "+p);break;case"volume":if(0===a.length)return this.error("volume missing required level value");if(p=a.shift(),o=Number.parseFloat(p),Number.isNaN(o)||!Number.isFinite(o))return this.error("cannot parse volume: "+p);break;case"mute":case"unmute":s="mute"===h;break;case"time":if(0===a.length)return this.error("time missing required seconds value");if(p=a.shift(),u=Number.parseFloat(p),Number.isNaN(u)||!Number.isFinite(u))return this.error("cannot parse time: "+p);break;case"loop":case"unloop":l="loop"===h;break;case"goto":if(0===a.length)return this.error("goto missing required passage title");if(p=a.shift(),f="object"===("undefined"==typeof p?"undefined":_typeof(p))?p.link:p,!Story.has(f))return this.error('passage "'+f+'" does not exist');break;default:return this.error("unknown action: "+h)}}try{n.forEach(function(e){var t=r[e];switch(null!=o&&(t.volume=o),null!=u&&(t.time=u),null!=s&&(t.mute=s),null!=l&&(t.loop=l),null!=f&&t.one("end",function(){return Engine.play(f)}),i){case"play":t.play();break;case"pause":t.pause();break;case"stop":t.stop();break;case"fade":t.fadeWithDuration(d,c)}}),Config.debug&&this.createDebugView()}catch(e){return this.error("error executing audio action: "+e.message)}},parseIds:function(e){function t(e,t){var r=/\S/g,n=/[()]/g,a=void 0;if(r.lastIndex=t,a=r.exec(e),null===a||"("!==a[0])throw new Error('invalid ":not()" syntax: missing parentheticals');n.lastIndex=r.lastIndex;for(var i=r.lastIndex,o={str:"",nextMatch:-1},s=1;null!==(a=n.exec(e));)if("("===a[0]?++s:--s,s<1){o.nextMatch=n.lastIndex,o.str=e.slice(i,o.nextMatch-1);break}return o}for(var r=[],n=/:?[^\s:()]+/g,a=void 0;null!==(a=n.exec(e));){var i=a[0];if(":not"===i){if(0===r.length)throw new Error('invalid negation: no group ID preceded ":not()"');var o=r[r.length-1];if(":"!==o.id[0])throw new Error('invalid negation of track "'+o.id+'": only groups may be negated with ":not()"');var s=t(e,n.lastIndex);if(s.nextMatch===-1)throw new Error('unknown error parsing ":not()"');n.lastIndex=s.nextMatch,o.not=this.parseIds(s.str)}else r.push({id:i})}return r}}),Macro.add("cacheaudio",{tracks:{},groups:{},handler:function(){if(this.args.length<2){var e=[];return this.args.length<1&&e.push("track ID"),this.args.length<2&&e.push("sources"),this.error("no "+e.join(" or ")+" specified")}var t=String(this.args[0]).trim(),r=/^:|\s/;if(r.test(t))return this.error('invalid track ID "'+t+'": track IDs may not start with a colon or contain whitespace');var n=/^format:\s*([\w-]+)\s*;\s*(\S.*)$/i,a=void 0;try{a=SimpleAudio.create(this.args.slice(1).map(function(e){var t=n.exec(e);return null===t?e:{format:t[1],src:t[2]}}))}catch(e){return this.error('error during track initialization for "'+t+'": '+e.message)}if(Config.debug&&!a.hasSource())return this.error('no supported audio sources found for "'+t+'"');var i=this.self.tracks;i.hasOwnProperty(t)&&i[t].destroy(),i[t]=a,Config.debug&&this.createDebugView()}}),Macro.add("createaudiogroup",{tags:["track"],handler:function(){if(0===this.args.length)return this.error("no group ID specified");var t=String(this.args[0]).trim(),r=/^[^:]|\s/;if(r.test(t))return this.error('invalid group ID "'+t+'": group IDs must start with a colon and may not contain whitespace');if(e.includes(t))return this.error('cannot clobber special group ID "'+t+'"');if(1===this.payload.length)return this.error("no tracks defined via <<track>>");Config.debug&&this.debugView.modes({nonvoid:!1,hidden:!0});for(var n=Macro.get("cacheaudio").tracks,a=[],i=1,o=this.payload.length;i<o;++i){if(this.payload[i].args.length<1)return this.error("no track ID specified");var s=String(this.payload[i].args[0]).trim();if(!n.hasOwnProperty(s))return this.error('track "'+s+'" does not exist');a.push(s),Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0})}var u=Macro.get("cacheaudio").groups;u.hasOwnProperty(t)&&delete u[t],u[t]=a,this.createDebugView("/"+this.name,"<</"+this.name+">>").modes({nonvoid:!1,hidden:!0})}}),Macro.add("createplaylist",{tags:["track"],lists:{},handler:function(){if(0===this.args.length)return this.error("no list ID specified");var e=Macro.get("playlist");if(null!==e.from&&"createplaylist"!==e.from)return this.error("a playlist has already been defined with <<setplaylist>>");var t=Macro.get("cacheaudio").tracks,r=String(this.args[0]).trim(),n=/^:|\s/;if(n.test(r))return this.error('invalid list ID "'+r+'": list IDs may not start with a colon or contain whitespace');if(1===this.payload.length)return this.error("no tracks defined via <<track>>");Config.debug&&this.debugView.modes({nonvoid:!1,hidden:!0});for(var a=SimpleAudio.createList(),i=1,o=this.payload.length;i<o;++i){if(this.payload[i].args.length<2){var s=[];return this.payload[i].args.length<1&&s.push("track ID"),this.payload[i].args.length<2&&s.push("actions"),this.error("no "+s.join(" or ")+" specified")}var u=String(this.payload[i].args[0]).trim();if(!t.hasOwnProperty(u))return this.error('track "'+u+'" does not exist');for(var l=this.payload[i].args.slice(1),c=!1,d=void 0;l.length>0;){var f=l.shift(),p=void 0;switch(f){case"copy":c=!0;break;case"rate":l.length>0&&l.shift();break;case"volume":if(0===l.length)return this.error("volume missing required level value");if(p=l.shift(),d=Number.parseFloat(p),Number.isNaN(d)||!Number.isFinite(d))return this.error("cannot parse volume: "+p);break;default:return this.error("unknown action: "+f)}}var h=t[u];a.add({copy:c,track:h,volume:null!=d?d:h.volume}),Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0})}var g=this.self.lists;g.hasOwnProperty(r)&&g[r].destroy(),g[r]=a,null===e.from&&(e.from="createplaylist"),this.createDebugView("/"+this.name,"<</"+this.name+">>").modes({nonvoid:!1,hidden:!0})}}),Macro.add("masteraudio",{handler:function(){if(0===this.args.length)return this.error("no actions specified");for(var e=this.args.slice(0),t=!1,r=void 0,n=void 0;e.length>0;){var a=e.shift(),i=void 0;switch(a){case"stop":t=!0;break;case"mute":case"unmute":r="mute"===a;break;case"volume":if(0===e.length)return this.error("volume missing required level value");if(i=e.shift(),n=Number.parseFloat(i),Number.isNaN(n)||!Number.isFinite(n))return this.error("cannot parse volume: "+i);break;default:return this.error("unknown action: "+a)}}try{null!=r&&(SimpleAudio.mute=r),null!=n&&(SimpleAudio.volume=n),t&&SimpleAudio.stop(),Config.debug&&this.createDebugView()}catch(e){return this.error("error executing master audio action: "+e.message)}}}),Macro.add("playlist",{from:null,handler:function(){var e=this.self.from;if(null===e)return this.error("no playlists have been created");var t=void 0,r=void 0;if("createplaylist"===e){if(this.args.length<2){var n=[];return this.args.length<1&&n.push("list ID"),this.args.length<2&&n.push("actions"),this.error("no "+n.join(" or ")+" specified")}var a=Macro.get("createplaylist").lists,i=String(this.args[0]).trim();if(!a.hasOwnProperty(i))return this.error('playlist "'+i+'" does not exist');t=a[i],r=this.args.slice(1)}else{if(0===this.args.length)return this.error("no actions specified");t=Macro.get("setplaylist").list,r=this.args.slice(0)}for(var o=void 0,s=void 0,u=void 0,l=void 0,c=void 0,d=void 0,f=5,p=void 0;r.length>0;){var h=r.shift();switch(h){case"play":case"pause":case"stop":case"skip":o=h;break;case"fadein":o="fade",d=1;break;case"fadeout":o="fade",d=0;break;case"fadeto":if(0===r.length)return this.error("fadeto missing required level value");if(o="fade",p=r.shift(),d=Number.parseFloat(p),Number.isNaN(d)||!Number.isFinite(d))return this.error("cannot parse fadeto: "+p);break;case"fadeoverto":if(r.length<2){var g=[];return r.length<1&&g.push("seconds"),r.length<2&&g.push("level"),this.error("fadeoverto missing required "+g.join(" and ")+" value"+(g.length>1?"s":""))}if(o="fade",p=r.shift(),f=Number.parseFloat(p),Number.isNaN(f)||!Number.isFinite(f))return this.error("cannot parse fadeoverto: "+p);if(p=r.shift(),d=Number.parseFloat(p),Number.isNaN(d)||!Number.isFinite(d))return this.error("cannot parse fadeoverto: "+p);break;case"volume":if(0===r.length)return this.error("volume missing required level value");if(p=r.shift(),s=Number.parseFloat(p),Number.isNaN(s)||!Number.isFinite(s))return this.error("cannot parse volume: "+p);break;case"mute":case"unmute":u="mute"===h;break;case"loop":case"unloop":l="loop"===h;break;case"shuffle":case"unshuffle":c="shuffle"===h;break;default:return this.error("unknown action: "+h)}}try{switch(null!=s&&(t.volume=s),null!=u&&(t.mute=u),null!=l&&(t.loop=l),null!=c&&(t.shuffle=c),o){case"play":t.play();break;case"pause":t.pause();break;case"stop":t.stop();break;case"skip":t.skip();break;case"fade":t.fadeWithDuration(f,d)}Config.debug&&this.createDebugView()}catch(e){return this.error("error playing audio: "+e.message)}}}),Macro.add("removeplaylist",{handler:function(){if(0===this.args.length)return this.error("no list ID specified");var e=Macro.get("createplaylist").lists,t=String(this.args[0]).trim();return e.hasOwnProperty(t)?(e[t].destroy(),delete e[t],void(Config.debug&&this.createDebugView())):this.error('playlist "'+t+'" does not exist')}}),Macro.add("waitforaudio",{skipArgs:!0,queue:[],handler:function(){function e(){if(0===t.length)return LoadScreen.unlock(r);var n=t.shift();return n.hasData()?e():void n.one("canplay.waitforaudio error.waitforaudio",function(){jQuery(this).off(".waitforaudio"),e()}).load()}var t=this.self.queue,r=void 0;t.length>0||(this.self.fillQueue(t),t.length>0&&(r=LoadScreen.lock(),e()))},fillQueue:function(e){var t=Macro.get("cacheaudio").tracks;Object.keys(t).forEach(function(r){return e.push(t[r])});var r=Macro.get("createplaylist").lists;if(Object.keys(r).map(function(e){return r[e].tracks}).flatten().filter(function(e){return e.copy}).forEach(function(t){return e.push(t.track)}),Macro.has("setplaylist")){var n=Macro.get("setplaylist").list;null!==n&&n.tracks.forEach(function(t){return e.push(t.track)})}}}),Macro.add("setplaylist",{list:null,handler:function(){if(0===this.args.length)return this.error("no track ID(s) specified");var e=Macro.get("playlist");if(null!==e.from&&"setplaylist"!==e.from)return this.error("playlists have already been defined with <<createplaylist>>");var t=this.self,r=Macro.get("cacheaudio").tracks;null!==t.list&&t.list.destroy(),t.list=SimpleAudio.createList();for(var n=0;n<this.args.length;++n){var a=this.args[n];if(!r.hasOwnProperty(a))return this.error('track "'+a+'" does not exist');t.list.add(r[a])}null===e.from&&(e.from="setplaylist"),Config.debug&&this.createDebugView()}}),Macro.add("stopallaudio",{skipArgs:!0,handler:function(){var e=Macro.get("cacheaudio").tracks;Object.keys(e).forEach(function(t){return e[t].stop()}),Config.debug&&this.createDebugView()}})}():Macro.add(["audio","cacheaudio","createaudiogroup","createplaylist","masteraudio","playlist","removeplaylist","waitforaudio","setplaylist","stopallaudio"],{skipArgs:!0,handler:function(){}}),Macro.add("goto",{handler:function(){if(0===this.args.length)return this.error("no passage specified");var e=void 0;return e="object"===_typeof(this.args[0])?this.args[0].link:this.args[0],Story.has(e)?void setTimeout(function(){return Engine.play(e)},Engine.minDomActionDelay):this.error('passage "'+e+'" does not exist')}}),Macro.add("timed",{isAsync:!0,tags:["next"],timers:new Set,handler:function(){if(0===this.args.length)return this.error("no time value specified in <<timed>>");var e=[];try{e.push({name:this.name,source:this.source,delay:Math.max(Engine.minDomActionDelay,Util.fromCssTime(this.args[0])),content:this.payload[0].contents})}catch(e){return this.error(e.message+" in <<timed>>")}if(this.payload.length>1){var t=void 0;try{var r=void 0;for(t=1,r=this.payload.length;t<r;++t)e.push({name:this.payload[t].name,source:this.payload[t].source,delay:0===this.payload[t].args.length?e[e.length-1].delay:Math.max(Engine.minDomActionDelay,Util.fromCssTime(this.payload[t].args[0])),content:this.payload[t].contents})}catch(e){return this.error(e.message+" in <<next>> (#"+t+")")}}Config.debug&&this.debugView.modes({block:!0});var n=this.args.length>1&&/^(?:transition|t8n)$/.test(this.args[1]),a=jQuery(document.createElement("span")).addClass("macro-"+this.name).appendTo(this.output);this.self.registerTimeout(this.createShadowWrapper(function(e){var t=document.createDocumentFragment();new Wikifier(t,e.content);var r=a;Config.debug&&"next"===e.name&&(r=jQuery(new DebugView(r[0],"macro",e.name,e.source).output)),n&&(r=jQuery(document.createElement("span")).addClass("macro-timed-insert macro-timed-in").appendTo(r)),r.append(t),n&&setTimeout(function(){return r.removeClass("macro-timed-in")},Engine.minDomActionDelay)}),e)},registerTimeout:function(e,t){if("function"!=typeof e)throw new TypeError("callback parameter must be a function");var r=State.turns,n=this.timers,a=null,i=t.shift(),o=function o(){if(n.delete(a),r===State.turns){var s=i;null!=(i=t.shift())&&(a=setTimeout(o,i.delay),n.add(a)),e.call(this,s)}};a=setTimeout(o,i.delay),n.add(a),prehistory.hasOwnProperty("#timed-timers-cleanup")||(prehistory["#timed-timers-cleanup"]=function(e){delete prehistory[e],n.forEach(function(e){return clearTimeout(e)}),n.clear()})}}),Macro.add("repeat",{isAsync:!0,tags:null,timers:new Set,handler:function(){var e=this;if(0===this.args.length)return this.error("no time value specified");var t=void 0;try{t=Math.max(Engine.minDomActionDelay,Util.fromCssTime(this.args[0]))}catch(e){return this.error(e.message)}Config.debug&&this.debugView.modes({block:!0});var r=this.args.length>1&&/^(?:transition|t8n)$/.test(this.args[1]),n=jQuery(document.createElement("span")).addClass("macro-"+this.name).appendTo(this.output);this.self.registerInterval(this.createShadowWrapper(function(){var t=document.createDocumentFragment();new Wikifier(t,e.payload[0].contents);var a=n;r&&(a=jQuery(document.createElement("span")).addClass("macro-repeat-insert macro-repeat-in").appendTo(a)),a.append(t),r&&setTimeout(function(){return a.removeClass("macro-repeat-in")},Engine.minDomActionDelay)}),t)},registerInterval:function(e,t){var r=this;if("function"!=typeof e)throw new TypeError("callback parameter must be a function");var n=State.turns,a=this.timers,i=null;i=setInterval(function(){if(n!==State.turns)return clearInterval(i),void a.delete(i);var t=void 0;try{TempState.break=null,TempState.hasOwnProperty("repeatTimerId")&&(t=TempState.repeatTimerId),TempState.repeatTimerId=i,e.call(r)}finally{"undefined"!=typeof t?TempState.repeatTimerId=t:delete TempState.repeatTimerId,TempState.break=null}},t),a.add(i),prehistory.hasOwnProperty("#repeat-timers-cleanup")||(prehistory["#repeat-timers-cleanup"]=function(e){delete prehistory[e],a.forEach(function(e){return clearInterval(e)}),a.clear()})}}),Macro.add("stop",{skipArgs:!0,handler:function(){if(!TempState.hasOwnProperty("repeatTimerId"))return this.error("must only be used in conjunction with its parent macro <<repeat>>");var e=Macro.get("repeat").timers,t=TempState.repeatTimerId;clearInterval(t),e.delete(t),TempState.break=2,Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("widget",{tags:null,handler:function(){if(0===this.args.length)return this.error("no widget name specified");var e=this.args[0];if(Macro.has(e)){if(!Macro.get(e).isWidget)return this.error('cannot clobber existing macro "'+e+'"');Macro.delete(e)}try{Macro.add(e,{isWidget:!0,handler:function(e){return function(){var t=this,r=void 0;try{var n=function(){State.variables.hasOwnProperty("args")&&(r=State.variables.args),State.variables.args=[].concat(_toConsumableArray(t.args)),State.variables.args.raw=t.args.raw,State.variables.args.full=t.args.full,t.addShadow("$args");var n=document.createDocumentFragment(),a=[];return new Wikifier(n,e),Array.from(n.querySelectorAll(".error")).forEach(function(e){a.push(e.textContent)}),0!==a.length?{v:t.error("error"+(a.length>1?"s":"")+" within widget contents ("+a.join("; ")+")")}:void t.output.appendChild(n)}();if("object"===("undefined"==typeof n?"undefined":_typeof(n)))return n.v}catch(e){return this.error("cannot execute widget: "+e.message)}finally{"undefined"!=typeof r?State.variables.args=r:delete State.variables.args}}}(this.payload[0].contents)}),Config.debug&&this.createDebugView(this.name,this.source+this.payload[0].contents+"<</"+this.name+">>")}catch(t){return this.error('cannot create widget macro "'+e+'": '+t.message)}}})}();var Dialog=function(){function e(){m=function(){var e=void 0;try{var t=document.createElement("p"),r=document.createElement("div");t.style.width="100%",t.style.height="200px",r.style.position="absolute",r.style.left="0px",r.style.top="0px",r.style.width="100px",r.style.height="100px",r.style.visibility="hidden",r.style.overflow="hidden",r.appendChild(t),document.body.appendChild(r);var n=t.offsetWidth;r.style.overflow="auto";var a=t.offsetWidth;n===a&&(a=r.clientWidth),document.body.removeChild(r),e=n-a}catch(e){}return e||17}();var e=jQuery(document.createDocumentFragment()).append('<div id="ui-overlay" class="ui-close"></div><div id="ui-dialog" tabindex="0" role="dialog" aria-labelledby="ui-dialog-title"><div id="ui-dialog-titlebar"><h1 id="ui-dialog-title"></h1>'+('<button id="ui-dialog-close" class="ui-close" tabindex="0" aria-label="'+L10n.get("close")+'"></button>')+'</div><div id="ui-dialog-body"></div></div>');d=jQuery(e.find("#ui-overlay").get(0)),f=jQuery(e.find("#ui-dialog").get(0)),p=jQuery(e.find("#ui-dialog-title").get(0)),h=jQuery(e.find("#ui-dialog-body").get(0)),e.insertBefore("#store-area")}function t(e){return f.hasClass("open")&&(!e||e.splitOrEmpty(/\s+/).every(function(e){return h.hasClass(e)}))}function r(e,t){return h.empty().removeClass(),null!=t&&h.addClass(t),p.empty().append((null!=e?String(e):"")||" "),h.get(0)}function n(){return h.get(0)}function a(){var e;return(e=h).append.apply(e,arguments),Dialog}function i(){var e;return(e=h).wiki.apply(e,arguments),Dialog}function o(e,t,r,n,a){return jQuery(e).ariaClick(function(e){e.preventDefault(),"function"==typeof r&&r(e),s(t,a),"function"==typeof n&&n(e)})}function s(e,r){var n=jQuery.extend({top:50},e),a=n.top;t()||(g=safeActiveElement()),jQuery(document.documentElement).attr("data-dialog","open"),d.addClass("open"),null!==h[0].querySelector("img")&&h.imagesLoaded().always(function(){return l({data:{top:a}})}),jQuery("body>:not(script,#store-area,#ui-bar,#ui-overlay,#ui-dialog)").attr("tabindex",-3).attr("aria-hidden",!0),jQuery("#ui-bar,#story").find("[tabindex]:not([tabindex^=-])").attr("tabindex",-2).attr("aria-hidden",!0);var i=c(a);return f.css(i).addClass("open").focus(),jQuery(window).on("resize.ui-resize",null,{top:a},jQuery.throttle(40,l)),jQuery(document).on("click.ui-close",".ui-close",{closeFn:r},u).on("keypress.ui-close",".ui-close",function(e){13!==e.which&&32!==e.which||jQuery(this).trigger("click")}),setTimeout(function(){return jQuery.event.trigger(":dialogopen")},Engine.minDomActionDelay),Dialog}function u(e){return jQuery(document).off(".ui-close"),jQuery(window).off("resize.ui-resize"),f.removeClass("open").css({left:"",right:"",top:"",bottom:""}),jQuery("#ui-bar,#story").find("[tabindex=-2]").removeAttr("aria-hidden").attr("tabindex",0),jQuery("body>[tabindex=-3]").removeAttr("aria-hidden").removeAttr("tabindex"),p.empty(),h.empty().removeClass(),d.removeClass("open"),jQuery(document.documentElement).removeAttr("data-dialog"),null!==g&&(jQuery(g).focus(),g=null),e&&e.data&&"function"==typeof e.data.closeFn&&e.data.closeFn(e),setTimeout(function(){return jQuery.event.trigger(":dialogclose")},Engine.minDomActionDelay),Dialog}function l(e){var t=e&&e.data&&"undefined"!=typeof e.data.top?e.data.top:50;"block"===f.css("display")&&(f.css({display:"none"}),f.css(jQuery.extend({display:""},c(t))))}function c(e){var t=null!=e?e:50,r=jQuery(window),n={left:"",right:"",top:"",bottom:""};f.css(n);var a=r.width()-f.outerWidth(!0)-1,i=r.height()-f.outerHeight(!0)-1;return a<=32+m&&(i-=m),i<=32+m&&(a-=m),a<=32?n.left=n.right=16:n.left=n.right=~~(a/2),i<=32?n.top=n.bottom=16:i/2>t?n.top=t:n.top=n.bottom=~~(i/2),Object.keys(n).forEach(function(e){""!==n[e]&&(n[e]+="px")}),n}var d=null,f=null,p=null,h=null,g=null,m=0;return Object.freeze(Object.defineProperties({},{init:{value:e},isOpen:{value:t},setup:{value:r},body:{value:n},append:{value:a},wiki:{value:i},addClickHandler:{value:o},open:{value:s},close:{value:u},resize:{value:function(){return l()}}}))}(),Engine=function(){function e(){jQuery("#init-no-js,#init-lacking").remove(),function(){var e=jQuery(document.createDocumentFragment()),t=Story.has("StoryInterface")&&Story.get("StoryInterface").text.trim();if(t){if(UIBar.destroy(),jQuery(document.head).find("#style-core-display").remove(),e.append(t),0===e.find("#passages").length)throw new Error('no element with ID "passages" found within "StoryInterface" special passage')}else e.append('<div id="story" role="main"><div id="passages"></div></div>');e.insertBefore("#store-area")}(),S=new StyleWrapper(function(){return jQuery(document.createElement("style")).attr({id:"style-aria-outlines",type:"text/css"}).appendTo(document.head).get(0)}()),jQuery(document).on("mousedown.aria-outlines keydown.aria-outlines",function(e){return"keydown"===e.type?m():g()})}function t(){if(Story.has("StoryInit"))try{var e=Wikifier.wikifyEval(Story.get("StoryInit").text);if(Config.debug){var t=new DebugView(document.createDocumentFragment(),"special","StoryInit","StoryInit");t.modes({hidden:!0}),t.append(e),k=t.output}}catch(e){console.error(e),Alert.error("StoryInit",e.message)}if(Config.history.maxStates=Math.max(0,Config.history.maxStates),Number.isSafeInteger(Config.history.maxStates)||(Config.history.maxStates=100),1===Config.history.maxStates&&(Config.history.controls=!1),Config.debug&&DebugView.init(),null==Config.passages.start)throw new Error("starting passage not selected");if(!Story.has(Config.passages.start))throw new Error('starting passage ("'+Config.passages.start+'") not found');if(jQuery(document.documentElement).focus(),State.restore())f();else{var r=!0;switch(_typeof(Config.saves.autoload)){case"boolean":Config.saves.autoload&&Save.autosave.ok()&&Save.autosave.has()&&(r=!Save.autosave.load());break;case"string":"prompt"===Config.saves.autoload&&Save.autosave.ok()&&Save.autosave.has()&&(r=!1,UI.buildDialogAutoload(),UI.open());break;case"function":Save.autosave.ok()&&Save.autosave.has()&&Config.saves.autoload()&&(r=!Save.autosave.load())}r&&p(Config.passages.start)}}function r(){LoadScreen.show(),window.scroll(0,0),State.reset(),window.location.reload()}function n(){return b}function a(){return b===v.Idle}function i(){return b!==v.Idle}function o(){return b===v.Rendering}function s(){return w}function u(e){var t=State.goTo(e);return t&&f(),t}function l(e){var t=State.go(e);return t&&f(),t}function c(){return l(-1)}function d(){return l(1)}function f(){return p(State.passage,!0)}function p(e,t){var r=e;b=v.Playing,TempState={},State.clearTemporary();var n=void 0,a=void 0;if("function"==typeof Config.navigation.override)try{var i=Config.navigation.override(r);i&&(r=i)}catch(e){}var o=Story.get(r);if(Object.keys(prehistory).forEach(function(e){"function"==typeof prehistory[e]&&prehistory[e].call(this,e)},o),t||State.create(o.title),document.body.className&&(document.body.className=""),Object.keys(predisplay).forEach(function(e){"function"==typeof predisplay[e]&&predisplay[e].call(this,e)},o),Story.has("PassageReady"))try{n=Wikifier.wikifyEval(Story.get("PassageReady").text)}catch(e){console.error(e),Alert.error("PassageReady",e.message)}b=v.Rendering;var s=jQuery(o.render()),u=document.getElementById("passages");if(u.hasChildNodes()&&("number"==typeof Config.passages.transitionOut||"string"==typeof Config.passages.transitionOut&&""!==Config.passages.transitionOut&&""!==Config.transitionEndEventName?[].concat(_toConsumableArray(u.childNodes)).forEach(function(e){var t=jQuery(e);if(e.nodeType===Node.ELEMENT_NODE&&t.hasClass("passage")){if(t.hasClass("passage-out"))return;t.attr("id","out-"+t.attr("id")).addClass("passage-out"),"string"==typeof Config.passages.transitionOut?t.on(Config.transitionEndEventName,function(e){e.originalEvent.propertyName===Config.passages.transitionOut&&t.remove()}):setTimeout(function(){return t.remove()},Math.max(y,Config.passages.transitionOut))}else t.remove()}):jQuery(u).empty()),s.addClass("passage-in").appendTo(u),setTimeout(function(){return s.removeClass("passage-in")},y),Config.passages.displayTitles&&o.title!==Config.passages.start&&(document.title=o.title+" | "+Story.title),window.scroll(0,0),b=v.Playing,Story.has("PassageDone"))try{a=Wikifier.wikifyEval(Story.get("PassageDone").text)}catch(e){console.error(e),Alert.error("PassageDone",e.message)}if(Object.keys(postdisplay).forEach(function(e){"function"==typeof postdisplay[e]&&postdisplay[e].call(this,e)},o),Config.ui.updateStoryElements&&UIBar.setStoryElements(),Config.debug){var l=void 0;null!=n&&(l=new DebugView(document.createDocumentFragment(),"special","PassageReady","PassageReady"),l.modes({hidden:!0}),l.append(n),s.prepend(l.output)),null!=a&&(l=new DebugView(document.createDocumentFragment(),"special","PassageDone","PassageDone"),l.modes({hidden:!0}),l.append(a),s.append(l.output)),1===State.turns&&null!=k&&s.prepend(k)}switch(w=Date.now(),g(),jQuery("#story").find("a[href]:not(.link-external)").addClass("link-external").end().find("a,link,button,input,select,textarea").not("[tabindex]").attr("tabindex",0),_typeof(Config.saves.autosave)){case"boolean":Config.saves.autosave&&Save.autosave.save();break;case"string":o.tags.includes(Config.saves.autosave)&&Save.autosave.save();break;case"object":Array.isArray(Config.saves.autosave)&&o.tags.some(function(e){return Config.saves.autosave.includes(e)})&&Save.autosave.save()}return b=v.Idle,s[0]}function h(e,t,r){var n=!1;switch(r){case undefined:break;case"replace":case"back":n=!0;break;default:throw new Error('Engine.display option parameter called with obsolete value "'+r+'"; please notify the developer')}p(e,n)}function g(){S.set("*:focus{outline:none}")}function m(){S.clear()}var v=Util.toEnum({Idle:"idle",Playing:"playing",Rendering:"rendering"}),y=40,b=v.Idle,w=null,k=null,S=null;return Object.freeze(Object.defineProperties({},{States:{value:v},minDomActionDelay:{value:y},init:{value:e},start:{value:t},restart:{value:r},state:{get:n},isIdle:{value:a},isPlaying:{value:i},isRendering:{value:o},lastPlay:{get:s},goTo:{value:u},go:{value:l},backward:{value:c},forward:{value:d},show:{value:f},play:{value:p},display:{value:h}}))}(),Passage=function(){var e=void 0;e=/^(?:debug|nobr|passage|widget|twine\..*)$/i;var t=function(){function t(r,n){var a=this;_classCallCheck(this,t),Object.defineProperties(this,{title:{value:Util.unescape(r)},element:{value:n||null},tags:{value:Object.freeze(n&&n.hasAttribute("tags")?n.getAttribute("tags").trim().splitOrEmpty(/\s+/).sort().filter(function(e,t,r){return 0===t||r[t-1]!==e}):[])},_excerpt:{writable:!0,value:null}}),Object.defineProperties(this,{domId:{value:"passage-"+Util.slugify(this.title)},classes:{value:Object.freeze(0===this.tags.length?[]:function(){return a.tags.filter(function(t){return!e.test(t)}).map(function(e){return Util.slugify(e)})}())}})}return _createClass(t,[{key:"description",value:function(){var e=Config.passages.descriptions;if(null!=e)switch("undefined"==typeof e?"undefined":_typeof(e)){case"boolean":if(e)return this.title;break;case"object":if(e instanceof Map&&e.has(this.title))return e.get(this.title);if(e.hasOwnProperty(this.title))return e[this.title];break;case"function":var r=e.call(this);if(r)return r;break;default:throw new TypeError("Config.passages.descriptions must be a boolean, object, or function")}return null===this._excerpt&&(this._excerpt=t.getExcerptFromText(this.text)),this._excerpt}},{key:"processText",value:function(){var e=this.text;return(Config.passages.nobr||this.tags.includes("nobr"))&&(e=e.replace(/^\n+|\n+$/g,"").replace(/\n+/g," ")),this.tags.includes("Twine.image")&&(e="[img["+e+"]]"),e}},{key:"render",value:function(){var e=this,r=this.tags.length>0?this.tags.join(" "):null,n=document.createElement("div");return jQuery(n).attr({id:this.domId,"data-passage":this.title,"data-tags":r}).addClass("passage "+this.className),jQuery(document.body).attr("data-tags",r).addClass(this.className),jQuery(document.documentElement).attr("data-tags",r),Object.keys(prerender).forEach(function(t){"function"==typeof prerender[t]&&prerender[t].call(e,n,t)}),Story.has("PassageHeader")&&new Wikifier(n,Story.get("PassageHeader").processText()),new Wikifier(n,this.processText()),Story.has("PassageFooter")&&new Wikifier(n,Story.get("PassageFooter").processText()),Object.keys(postrender).forEach(function(t){"function"==typeof postrender[t]&&postrender[t].call(e,n,t)}),this._excerpt=t.getExcerptFromNode(n),n}},{key:"className",get:function(){return this.classes.join(" ")}},{key:"text",get:function(){if(null==this.element){var e=Util.escape(this.title);return'<span class="error" title="'+e+'">'+L10n.get("errorTitle")+": "+L10n.get("errorNonexistentPassage",{passage:e})+"</span>"}return this.element.textContent.replace(/\r/g,"")}}],[{key:"getExcerptFromNode",value:function(e,t){if(!e.hasChildNodes())return"";var r=e.textContent.trim();if(""!==r){var n=new RegExp("(\\S+(?:\\s+\\S+){0,"+(t>0?t-1:7)+"})");r=r.replace(/\s+/g," ").match(n)}return r?r[1]+"…":"…"}},{key:"getExcerptFromText",value:function(e,t){if(""===e)return"";var r=new RegExp("(\\S+(?:\\s+\\S+){0,"+(t>0?t-1:7)+"})"),n=e.replace(/<<.*?>>/g," ").replace(/<.*?>/g," ").trim().replace(/^\s*\|.*\|.*?$/gm,"").replace(/\[[<>]?img\[[^\]]*\]\]/g,"").replace(/\[\[([^|\]]*)(?:|[^\]]*)?\]\]/g,"$1").replace(/^\s*!+(.*?)$/gm,"$1").replace(/'{2}|\/{2}|_{2}|@{2}/g,"").trim().replace(/\s+/g," ").match(r);return n?n[1]+"…":"…"}}]),t}();return t}(),Save=function(){function e(){if("cookie"===storage.name)return n(),Config.saves.autosave=undefined,Config.saves.slots=0,!1;Config.saves.slots=Math.max(0,Config.saves.slots),Number.isSafeInteger(Config.saves.slots)||(Config.saves.slots=8);var e=r(),t=!1;Array.isArray(e)&&(e={autosave:null,slots:e},t=!0),Config.saves.slots!==e.slots.length&&(Config.saves.slots<e.slots.length?(e.slots.reverse(),e.slots=e.slots.filter(function(e){return!(null===e&&this.count>0)||(--this.count,!1)},{count:e.slots.length-Config.saves.slots}),e.slots.reverse()):Config.saves.slots>e.slots.length&&S(e.slots,Config.saves.slots-e.slots.length),t=!0),j(e.autosave)&&(t=!0);for(var a=0;a<e.slots.length;++a)j(e.slots[a])&&(t=!0);return E(e)&&(storage.delete("saves"),t=!1),t&&x(e),T=e.slots.length-1,!0}function t(){return{autosave:null,slots:S([],Config.saves.slots)}}function r(){var e=storage.get("saves");return null===e?t():e}function n(){return storage.delete("saves"),!0}function a(){return i()||d()}function i(){return"cookie"!==storage.name&&"undefined"!=typeof Config.saves.autosave}function o(){var e=r();return null!==e.autosave}function s(){var e=r();return e.autosave}function u(){var e=r();return null!==e.autosave&&O(e.autosave)}function l(e,t){if("function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed())return!1;var n=r(),a={
title:e||Story.get(State.passage).description(),date:Date.now()};return null!=t&&(a.metadata=t),n.autosave=C(a),x(n)}function c(){var e=r();return e.autosave=null,x(e)}function d(){return"cookie"!==storage.name&&T!==-1}function f(){return T+1}function p(){if(!d())return 0;for(var e=r(),t=0,n=0,a=e.slots.length;n<a;++n)null!==e.slots[n]&&++t;return t}function h(){return 0===p()}function g(e){if(e<0||e>T)return!1;var t=r();return!(e>=t.slots.length||null===t.slots[e])}function m(e){if(e<0||e>T)return null;var t=r();return e>=t.slots.length?null:t.slots[e]}function v(e){if(e<0||e>T)return!1;var t=r();return!(e>=t.slots.length||null===t.slots[e])&&O(t.slots[e])}function y(e,t,n){if("function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed())return UI.alert(L10n.get("savesDisallowed")),!1;if(e<0||e>T)return!1;var a=r();if(e>=a.slots.length)return!1;var i={title:t||Story.get(State.passage).description(),date:Date.now()};return null!=n&&(i.metadata=n),a.slots[e]=C(i),x(a)}function b(e){if(e<0||e>T)return!1;var t=r();return!(e>=t.slots.length)&&(t.slots[e]=null,x(t))}function w(e,t){function r(){var e=new Date,t=e.getMonth()+1,r=e.getDate(),n=e.getHours(),a=e.getMinutes(),i=e.getSeconds();return t<10&&(t="0"+t),r<10&&(r="0"+r),n<10&&(n="0"+n),a<10&&(a="0"+a),i<10&&(i="0"+i),""+e.getFullYear()+t+r+"-"+n+a+i}if("function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed())return void UI.alert(L10n.get("savesDisallowed"));var n=null==e?Story.domId:Util.slugify(e),a=n+"-"+r()+".save",i=null==t?{}:{metadata:t},o=LZString.compressToBase64(JSON.stringify(C(i)));saveAs(new Blob([o],{type:"text/plain;charset=UTF-8"}),a)}function k(e){var t=e.target.files[0],r=new FileReader;jQuery(r).on("load",function(e){var r=e.currentTarget;if(r.result){var n=void 0;try{n=JSON.parse(/\.json$/i.test(t.name)||/^\{/.test(r.result)?r.result:LZString.decompressFromBase64(r.result))}catch(e){}O(n)}}),r.readAsText(t)}function S(e,t){for(var r=0;r<t;++r)e.push(null);return e}function E(e){for(var t=e.slots,r=!0,n=0,a=t.length;n<a;++n)if(null!==t[n]){r=!1;break}return null===e.autosave&&r}function x(e){return E(e)?(storage.delete("saves"),!0):storage.set("saves",e)}function j(e){if(null===e)return!1;var t=!1;return e.hasOwnProperty("state")&&e.state.hasOwnProperty("delta")&&e.state.hasOwnProperty("index")||(e.hasOwnProperty("data")?(delete e.mode,e.state={delta:State.deltaEncode(e.data)},delete e.data):e.state.hasOwnProperty("delta")?e.state.hasOwnProperty("index")||delete e.state.mode:(delete e.state.mode,e.state.delta=State.deltaEncode(e.state.history),delete e.state.history),e.state.index=e.state.delta.length-1,t=!0),e.state.hasOwnProperty("rseed")&&(e.state.seed=e.state.rseed,delete e.state.rseed,e.state.delta.forEach(function(e,t,r){r[t].hasOwnProperty("rcount")&&(r[t].pull=r[t].rcount,delete r[t].rcount)}),t=!0),(e.state.hasOwnProperty("expired")&&"number"==typeof e.state.expired||e.state.hasOwnProperty("unique")||e.state.hasOwnProperty("last"))&&(e.state.hasOwnProperty("expired")&&"number"==typeof e.state.expired&&delete e.state.expired,(e.state.hasOwnProperty("unique")||e.state.hasOwnProperty("last"))&&(e.state.expired=[],e.state.hasOwnProperty("unique")&&(e.state.expired.push(e.state.unique),delete e.state.unique),e.state.hasOwnProperty("last")&&(e.state.expired.push(e.state.last),delete e.state.last)),t=!0),t}function C(e){if(null!=e&&"object"!==("undefined"==typeof e?"undefined":_typeof(e)))throw new Error("supplemental parameter must be an object");var t=Object.assign({},e,{id:Config.saves.id,state:State.marshalForSave()});return Config.saves.version&&(t.version=Config.saves.version),"function"==typeof Config.saves.onSave&&Config.saves.onSave(t),t.state.delta=State.deltaEncode(t.state.history),delete t.state.history,t}function O(e){try{if(j(e),!e||!e.hasOwnProperty("id")||!e.hasOwnProperty("state"))throw new Error(L10n.get("errorSaveMissingData"));if(e.state.history=State.deltaDecode(e.state.delta),delete e.state.delta,"function"==typeof Config.saves.onLoad&&Config.saves.onLoad(e),e.id!==Config.saves.id)throw new Error(L10n.get("errorSaveIdMismatch"));State.unmarshalForSave(e.state),Engine.show()}catch(e){return UI.alert(e.message.toUpperFirst()+".</p><p>"+L10n.get("aborting")+"."),!1}return!0}var T=-1;return Object.freeze(Object.defineProperties({},{init:{value:e},get:{value:r},clear:{value:n},ok:{value:a},autosave:{value:Object.freeze(Object.defineProperties({},{ok:{value:i},has:{value:o},get:{value:s},load:{value:u},save:{value:l},delete:{value:c}}))},slots:{value:Object.freeze(Object.defineProperties({},{ok:{value:d},length:{get:f},isEmpty:{value:h},count:{value:p},has:{value:g},get:{value:m},load:{value:v},save:{value:y},delete:{value:b}}))},export:{value:w},import:{value:k}}))}(),Setting=function(){function e(){if(storage.has("options")){var e=storage.get("options");null!==e&&(window.SugarCube.settings=settings=Object.assign(t(),e)),r(),storage.delete("options")}n(),g.forEach(function(e){if(e.hasOwnProperty("onInit")){var t={name:e.name,value:settings[e.name],default:e.default};e.hasOwnProperty("list")&&(t.list=e.list),e.onInit.call(t)}})}function t(){return Object.create(null)}function r(){var e=t();return Object.keys(settings).length>0&&g.filter(function(e){return e.type!==m.Header&&settings[e.name]!==e.default}).forEach(function(t){return e[t.name]=settings[t.name]}),0===Object.keys(e).length?(storage.delete("settings"),!0):storage.set("settings",e)}function n(){var e=t(),r=storage.get("settings")||t();g.filter(function(e){return e.type!==m.Header}).forEach(function(t){return e[t.name]=t.default}),window.SugarCube.settings=settings=Object.assign(e,r)}function a(){return window.SugarCube.settings=settings=t(),storage.delete("settings"),!0}function i(e){if(0===arguments.length)a(),n();else{if(null==e||!f(e))throw new Error('nonexistent setting "'+e+'"');var t=p(e);t.type!==m.Header&&(settings[e]=t.default)}return r()}function o(e,t){g.forEach(e,t)}function s(e,t,r){if(arguments.length<3){var n=[];throw arguments.length<1&&n.push("type"),arguments.length<2&&n.push("name"),arguments.length<3&&n.push("definition"),new Error("missing parameters, no "+n.join(" or ")+" specified")}if("object"!==("undefined"==typeof r?"undefined":_typeof(r)))throw new TypeError("definition parameter must be an object");if(f(t))throw new Error('cannot clobber existing setting "'+t+'"');var a={type:e,name:t,label:null==r.label?"":String(r.label).trim()};switch(e){case m.Header:break;case m.Toggle:a.default=!!r.default;break;case m.List:if(!r.hasOwnProperty("list"))throw new Error("no list specified");if(!Array.isArray(r.list))throw new TypeError("list must be an array");if(0===r.list.length)throw new Error("list must not be empty");if(a.list=Object.freeze(r.list),null==r.default)a.default=r.list[0];else{var i=r.list.indexOf(r.default);if(i===-1)throw new Error("list does not contain default");a.default=r.list[i]}break;default:throw new Error("unknown Setting type: "+e)}"function"==typeof r.onInit&&(a.onInit=Object.freeze(r.onInit)),"function"==typeof r.onChange&&(a.onChange=Object.freeze(r.onChange)),g.push(Object.freeze(a))}function u(e,t){s(m.Header,e,{label:t})}function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];s.apply(undefined,[m.Toggle].concat(t))}function c(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];s.apply(undefined,[m.List].concat(t))}function d(){return 0===g.length}function f(e){return g.some(function(t){return t.name===e})}function p(e){return g.find(function(t){return t.name===e})}function h(e){f(e)&&delete settings[e];for(var t=0;t<g.length;++t)if(g[t].name===e){g.splice(t,1),h(e);break}}var g=[],m=Util.toEnum({Header:0,Toggle:1,List:2});return Object.freeze(Object.defineProperties({},{Types:{value:m},init:{value:e},create:{value:t},save:{value:r},load:{value:n},clear:{value:a},reset:{value:i},forEach:{value:o},add:{value:s},addHeader:{value:u},addToggle:{value:l},addList:{value:c},isEmpty:{value:d},has:{value:f},get:{value:p},delete:{value:h}}))}(),State=function(){function e(){session.delete("state"),I=[],L=c(),Q=-1,W=[],R=null===R?null:new PRNGWrapper(R.seed,!1)}function t(){if(session.has("state")){var e=session.get("state");return null!=e&&(n(e),!0)}return!1}function r(e){var t={index:Q};return e?t.history=clone(I):t.delta=A(I),W.length>0&&(t.expired=[].concat(_toConsumableArray(W))),null!==R&&(t.seed=R.seed),t}function n(e,t){if(null==e)throw new Error("state object is null or undefined");if(!e.hasOwnProperty(t?"history":"delta")||0===e[t?"history":"delta"].length)throw new Error("state object has no history or history is empty");if(!e.hasOwnProperty("index"))throw new Error("state object has no index");if(null!==R&&!e.hasOwnProperty("seed"))throw new Error("state object has no seed, but PRNG is enabled");if(null===R&&e.hasOwnProperty("seed"))throw new Error("state object has seed, but PRNG is disabled");I=t?clone(e.history):P(e.delta),Q=e.index,W=e.hasOwnProperty("expired")?[].concat(_toConsumableArray(e.expired)):[],e.hasOwnProperty("seed")&&(R.seed=e.seed),g(Q)}function a(){return r(!0)}function i(e){return n(e,!0)}function o(){return W}function s(){return W.length+v()}function u(){return W.concat(I.slice(0,v()).map(function(e){return e.title}))}function l(e){return null!=e&&""!==e&&(!!W.includes(e)||!!I.slice(0,v()).some(function(t){return t.title===e}))}function c(e,t){return{title:null==e?"":String(e),variables:null==t?{}:clone(t)}}function d(){return L}function f(){return Q}function p(){return L.title}function h(){return L.variables}function g(e){if(null==e)throw new Error("moment activation attempted with null or undefined");switch("undefined"==typeof e?"undefined":_typeof(e)){case"object":L=clone(e);break;case"number":if(b())throw new Error("moment activation attempted with index on empty history");if(e<0||e>=y())throw new RangeError("moment activation attempted with out-of-bounds index; need [0, "+(y()-1)+"], got "+e);L=clone(I[e]);break;default:throw new TypeError('moment activation attempted with a "'+("undefined"==typeof e?"undefined":_typeof(e))+'"; must be an object or valid history stack index')}return null!==R&&(R=PRNGWrapper.unmarshal({seed:R.seed,pull:L.pull})),session.set("state",r()),jQuery.event.trigger(":historyupdate"),L}function m(){return I}function v(){return Q+1}function y(){return I.length}function b(){return 0===I.length}function w(){return I.length>0?I[Q]:null}function k(){return I.length>0?I[I.length-1]:null}function S(){return I.length>0?I[0]:null}function E(e){return b()||e<0||e>Q?null:I[e]}function x(e){if(b())return null;var t=1+(e?Math.abs(e):0);return t>v()?null:I[v()-t]}function j(e){if(b()||null==e||""===e)return!1;for(var t=Q;t>=0;--t)if(I[t].title===e)return!0;return!1}function C(e){if(v()<y()&&I.splice(v(),y()-v()),I.push(c(e,L.variables)),R&&(k().pull=R.pull),Config.history.maxStates>0)for(;y()>Config.history.maxStates;)W.push(I.shift().title);return Q=y()-1,g(Q),v()}function O(e){return!(null==e||e<0||e>=y()||e===Q)&&(Q=e,g(Q),!0)}function T(e){return null!=e&&0!==e&&O(Q+e)}function A(e){if(!Array.isArray(e))return null;if(0===e.length)return[];for(var t=[clone(e[0])],r=1,n=e.length;r<n;++r)t.push(Diff.diff(e[r-1],e[r]));return t}function P(e){if(!Array.isArray(e))return null;if(0===e.length)return[];for(var t=[clone(e[0])],r=1,n=e.length;r<n;++r)t.push(Diff.patch(t[r-1],e[r]));return t}function _(e,t){if(!b()){var r=void 0;throw r="the Story JavaScript",new Error("State.initPRNG must be called during initialization, within either "+r+" or the StoryInit special passage")}R=new PRNGWrapper(e,t),L.pull=R.pull}function D(){return R?R.random():Math.random()}function M(){F={},TempVariables=F}function N(){return F}var I=[],L=c(),Q=-1,W=[],R=null,F={};return Object.freeze(Object.defineProperties({},{reset:{value:e},restore:{value:t},marshalForSave:{value:a},unmarshalForSave:{value:i},expired:{get:o},turns:{get:s},passages:{get:u},hasPlayed:{value:l},active:{get:d},activeIndex:{get:f},passage:{get:p},variables:{get:h},history:{get:m},length:{get:v},size:{get:y},isEmpty:{value:b},current:{get:w},top:{get:k},bottom:{get:S},index:{value:E},peek:{value:x},has:{value:j},create:{value:C},goTo:{value:O},go:{value:T},deltaEncode:{value:A},deltaDecode:{value:P},initPRNG:{value:_},random:{value:D},clearTemporary:{value:M},temporary:{get:N},restart:{value:function(){return Engine.restart()}},backward:{value:function(){return Engine.backward()}},forward:{value:function(){return Engine.forward()}},display:{value:function(){return Engine.display.apply(Engine,arguments)}},show:{value:function(){return Engine.show.apply(Engine,arguments)}},play:{value:function(){return Engine.play.apply(Engine,arguments)}}}))}(),Story=function(){function e(){function e(e){if(e.tags.includesAny(n))throw new Error('starting passage "'+e.title+'" contains illegal tags; invalid: "'+e.tags.filter(function(e){return n.includes(e)}).sort().join('", "')+'"')}function t(e){if(a.includes(e.title)&&e.tags.includesAny(n))throw new Error('special passage "'+e.title+'" contains illegal tags; invalid: "'+e.tags.filter(function(e){return n.includes(e)}).sort().join('", "')+'"')}var n=["widget"],a=["PassageDone","PassageFooter","PassageHeader","PassageReady","StoryAuthor","StoryBanner","StoryCaption","StoryInit","StoryMenu","StoryShare","StorySubtitle"];!function(){var n=jQuery("#store-area>tw-storydata"),a=n.attr("startnode")||"";Config.passages.start=null,Config.debug=/\bdebug\b/.test(n.attr("options")),n.children("style").each(function(e){d.push(new Passage("tw-user-style-"+e,this))}),n.children("script").each(function(e){f.push(new Passage("tw-user-script-"+e,this))}),n.children('tw-passagedata:not([tags~="Twine.private"],[tags~="annotation"])').each(function(){var r=jQuery(this),n=r.attr("pid")||"",i=new Passage(r.attr("name"),this);n===a&&""!==a?(Config.passages.start=i.title,e(i),c[i.title]=i):i.tags.includes("widget")?p.push(i):(t(i),c[i.title]=i)}),g=n.attr("ifid"),r(Util.unescape("Queen of the Seas")),Config.saves.id=Story.domId}()}function t(){!function(){var e=document.createElement("style");new StyleWrapper(e).add(d.map(function(e){return e.text.trim()}).join("\n")),jQuery(e).appendTo(document.head).attr({id:"style-story",type:"text/css"})}();for(var e=0;e<f.length;++e)try{Scripting.evalJavaScript(f[e].text)}catch(t){console.error(t),Alert.error(f[e].title,"object"===("undefined"==typeof t?"undefined":_typeof(t))?t.message:t)}for(var t=0;t<p.length;++t)try{Wikifier.wikifyEval(p[t].processText())}catch(e){console.error(e),Alert.error(p[t].title,"object"===("undefined"==typeof e?"undefined":_typeof(e))?e.message:e)}}function r(e){if(null==e||""===e)throw new Error("story title cannot be null or empty");document.title=h=Util.unescape(e),m=Util.slugify(h)}function n(){return h}function a(){return m}function i(){return g}function o(e){var t="undefined"==typeof e?"undefined":_typeof(e);switch(t){case"number":case"string":var r=String(e);return c.hasOwnProperty(r);case"boolean":case"function":t="a "+t;break;case"undefined":break;default:t=null===e?"null":"an "+t}throw new TypeError("Story.has title parameter cannot be "+t)}function s(e){var t="undefined"==typeof e?"undefined":_typeof(e);switch(t){case"number":case"string":var r=String(e);return c.hasOwnProperty(r)?c[r]:new Passage(r||"(unknown)");case"boolean":case"function":t="a "+t;break;case"undefined":break;default:t=null===e?"null":"an "+t}throw new TypeError("Story.get title parameter cannot be "+t)}function u(e,t){for(var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"title",n=Object.keys(c),a=[],i=0;i<n.length;++i){var o=c[n[i]];if(o.hasOwnProperty(e))switch(_typeof(o[e])){case"undefined":break;case"object":for(var s=0,u=o[e].length;s<u;++s)if(o[e][s]==t){a.push(o);break}break;default:o[e]==t&&a.push(o)}}return a.sort(function(e,t){return e[r]==t[r]?0:e[r]<t[r]?-1:1}),a}function l(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"title";if("function"!=typeof e)throw new Error("Story.lookupWith filter parameter must be a function");for(var r=Object.keys(c),n=[],a=0;a<r.length;++a){var i=c[r[a]];e(i)&&n.push(i)}return n.sort(function(e,r){return e[t]==r[t]?0:e[t]<r[t]?-1:1}),n}var c={},d=[],f=[],p=[],h="",g="",m="";return Object.freeze(Object.defineProperties({},{passages:{value:c},styles:{value:d},scripts:{value:f},widgets:{value:p},load:{value:e},init:{value:t},title:{get:n},domId:{get:a},ifId:{get:i},has:{value:o},get:{value:s},lookup:{value:u},lookupWith:{value:l}}))}(),UI=function(){function e(e,t){var r=t,n=Config.debug;Config.debug=!1;try{null==r&&(r=document.createElement("ul"));var a=document.createDocumentFragment();new Wikifier(a,Story.get(e).processText().trim());var i=[].concat(_toConsumableArray(a.querySelectorAll(".error"))).map(function(e){return e.textContent.replace(/^(?:(?:Uncaught\s+)?Error:\s+)+/,"")});if(i.length>0)throw new Error(i.join("; "));for(;a.hasChildNodes();){var o=a.firstChild;if(o.nodeType===Node.ELEMENT_NODE&&"A"===o.nodeName.toUpperCase()){var s=document.createElement("li");r.appendChild(s),s.appendChild(o)}else a.removeChild(o)}}finally{Config.debug=n}return r}function t(e){jQuery(Dialog.setup("Alert","alert")).append("<p>"+e+'</p><ul class="buttons">'+('<li><button id="alert-ok" class="ui-close">'+L10n.get(["alertOk","ok"])+"</button></li>")+"</ul>");for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];Dialog.open.apply(Dialog,r)}function r(){u(),Dialog.open.apply(Dialog,arguments)}function n(){l(),Dialog.open.apply(Dialog,arguments)}function a(){c(),Dialog.open.apply(Dialog,arguments)}function i(){d(),Dialog.open.apply(Dialog,arguments)}function o(){f(),Dialog.open.apply(Dialog,arguments)}function s(){return jQuery(Dialog.setup(L10n.get("autoloadTitle"),"autoload")).append("<p>"+L10n.get("autoloadPrompt")+'</p><ul class="buttons">'+('<li><button id="autoload-ok" class="ui-close">'+L10n.get(["autoloadOk","ok"])+"</button></li>")+('<li><button id="autoload-cancel" class="ui-close">'+L10n.get(["autoloadCancel","cancel"])+"</button></li>")+"</ul>"),jQuery(document).one("click.autoload",".ui-close",function(e){var t="autoload-ok"===e.target.id;jQuery(document).one(":dialogclose",function(){t&&Save.autosave.load()||Engine.play(Config.passages.start)})}),!0}function u(){var e=document.createElement("ul");jQuery(Dialog.setup(L10n.get("jumptoTitle"),"jumpto list")).append(e);for(var t=State.expired.length,r=State.size-1;r>=0;--r)if(r!==State.activeIndex){var n=Story.get(State.history[r].title);n&&n.tags.includes("bookmark")&&jQuery(document.createElement("li")).append(jQuery(document.createElement("a")).ariaClick({one:!0},function(e){return function(){return jQuery(document).one(":dialogclose",function(){return Engine.goTo(e)})}}(r)).addClass("ui-close").text(L10n.get("jumptoTurn")+" "+(t+r+1)+": "+n.description())).appendTo(e)}e.hasChildNodes()||jQuery(e).append("<li><a><em>"+L10n.get("jumptoUnavailable")+"</em></a></li>")}function l(){return jQuery(Dialog.setup(L10n.get("restartTitle"),"restart")).append("<p>"+L10n.get("restartPrompt")+'</p><ul class="buttons">'+('<li><button id="restart-ok">'+L10n.get(["restartOk","ok"])+"</button></li>")+('<li><button id="restart-cancel" class="ui-close">'+L10n.get(["restartCancel","cancel"])+"</button></li>")+"</ul>").find("#restart-ok").ariaClick({one:!0},function(){jQuery(document).one(":dialogclose",function(){return Engine.restart()}),Dialog.close()}),!0}function c(){function e(e,t,r,n){var a=jQuery(document.createElement("button")).attr("id","saves-"+e).html(r);return t&&a.addClass(t),n?a.ariaClick(n):a.prop("disabled",!0),jQuery(document.createElement("li")).append(a)}function r(){function e(e,t,r,n,a){var i=jQuery(document.createElement("button")).attr("id","saves-"+e+"-"+n).addClass(e).html(r);return t&&i.addClass(t),a?"auto"===n?i.ariaClick({label:r+" "+L10n.get("savesLabelAuto")},function(){return a()}):i.ariaClick({label:r+" "+L10n.get("savesLabelSlot")+" "+(n+1)},function(){return a(n)}):i.prop("disabled",!0),i}var t=Save.get(),r=jQuery(document.createElement("tbody"));if(Save.autosave.ok()){var n=jQuery(document.createElement("td")),a=jQuery(document.createElement("td")),i=jQuery(document.createElement("td")),o=jQuery(document.createElement("td"));jQuery(document.createElement("b")).attr({title:L10n.get("savesLabelAuto"),"aria-label":L10n.get("savesLabelAuto")}).text("A").appendTo(n),t.autosave?(a.append(e("load","ui-close",L10n.get("savesLabelLoad"),"auto",function(){jQuery(document).one(":dialogclose",function(){return Save.autosave.load()})})),jQuery(document.createElement("div")).text(t.autosave.title).appendTo(i),jQuery(document.createElement("div")).addClass("datestamp").html(t.autosave.date?L10n.get("savesSavedOn")+" "+new Date(t.autosave.date).toLocaleString():L10n.get("savesSavedOn")+" <em>"+L10n.get("savesUnknownDate")+"</em>").appendTo(i),o.append(e("delete",null,L10n.get("savesLabelDelete"),"auto",function(){Save.autosave.delete(),c(),Dialog.resize()}))):(a.append(e("load",null,L10n.get("savesLabelLoad"),"auto")),jQuery(document.createElement("em")).text(L10n.get("savesEmptySlot")).appendTo(i),i.addClass("empty"),o.append(e("delete",null,L10n.get("savesLabelDelete"),"auto"))),jQuery(document.createElement("tr")).append(n).append(a).append(i).append(o).appendTo(r)}for(var s=0,u=t.slots.length;s<u;++s){var l=jQuery(document.createElement("td")),d=jQuery(document.createElement("td")),f=jQuery(document.createElement("td")),p=jQuery(document.createElement("td"));l.append(document.createTextNode(s+1)),t.slots[s]?(d.append(e("load","ui-close",L10n.get("savesLabelLoad"),s,function(e){jQuery(document).one(":dialogclose",function(){return Save.slots.load(e)})})),jQuery(document.createElement("div")).text(t.slots[s].title).appendTo(f),jQuery(document.createElement("div")).addClass("datestamp").html(t.slots[s].date?L10n.get("savesSavedOn")+" "+new Date(t.slots[s].date).toLocaleString():L10n.get("savesSavedOn")+" <em>"+L10n.get("savesUnknownDate")+"</em>").appendTo(f),p.append(e("delete",null,L10n.get("savesLabelDelete"),s,function(e){Save.slots.delete(e),c(),Dialog.resize()}))):(d.append(e("save","ui-close",L10n.get("savesLabelSave"),s,Save.slots.save)),jQuery(document.createElement("em")).text(L10n.get("savesEmptySlot")).appendTo(f),f.addClass("empty"),p.append(e("delete",null,L10n.get("savesLabelDelete"),s))),jQuery(document.createElement("tr")).append(l).append(d).append(f).append(p).appendTo(r)}return jQuery(document.createElement("table")).attr("id","saves-list").append(r)}var n=jQuery(Dialog.setup(L10n.get("savesTitle"),"saves")),a=Save.ok();if(a&&n.append(r()),a||Has.fileAPI){var i=jQuery(document.createElement("ul")).addClass("buttons").appendTo(n);return Has.fileAPI&&(i.append(e("export","ui-close",L10n.get("savesLabelExport"),function(){return Save.export()})),i.append(e("import",null,L10n.get("savesLabelImport"),function(){return n.find("#saves-import-file").trigger("click")})),jQuery(document.createElement("input")).css({display:"block",visibility:"hidden",position:"fixed",left:"-9999px",top:"-9999px",width:"1px",height:"1px"}).attr({type:"file",id:"saves-import-file",tabindex:-1,"aria-hidden":!0}).on("change",function(e){jQuery(document).one(":dialogclose",function(){return Save.import(e)}),Dialog.close()}).appendTo(n)),a&&i.append(e("clear",null,L10n.get("savesLabelClear"),Save.autosave.has()||!Save.slots.isEmpty()?function(){Save.clear(),c(),Dialog.resize()}:null)),!0}return t(L10n.get("savesIncapable")),!1}function d(){var e=jQuery(Dialog.setup(L10n.get("settingsTitle"),"settings"));return Setting.forEach(function(t){if(t.type===Setting.Types.Header){var r=t.name,n=Util.slugify(r),a=jQuery(document.createElement("div")),i=jQuery(document.createElement("h2")),o=jQuery(document.createElement("p"));return a.attr("id","header-body-"+n).append(i).append(o).appendTo(e),i.attr("id","header-heading-"+n).wiki(r),void o.attr("id","header-label-"+n).wiki(t.label)}var s=t.name,u=Util.slugify(s),l=jQuery(document.createElement("div")),c=jQuery(document.createElement("label")),d=jQuery(document.createElement("div")),f=void 0;switch(l.attr("id","setting-body-"+u).append(c).append(d).appendTo(e),c.attr({id:"setting-label-"+u,for:"setting-control-"+u}).wiki(t.label),null==settings[s]&&(settings[s]=t.default),t.type){case Setting.Types.Toggle:f=jQuery(document.createElement("button")),settings[s]?f.addClass("enabled").text(L10n.get("settingsOn")):f.text(L10n.get("settingsOff")),f.ariaClick(function(){settings[s]?(jQuery(this).removeClass("enabled").text(L10n.get("settingsOff")),settings[s]=!1):(jQuery(this).addClass("enabled").text(L10n.get("settingsOn")),settings[s]=!0),Setting.save(),t.hasOwnProperty("onChange")&&t.onChange.call({name:s,value:settings[s],default:t.default})});break;case Setting.Types.List:f=jQuery(document.createElement("select"));for(var p=0,h=t.list.length;p<h;++p)jQuery(document.createElement("option")).val(p).text(t.list[p]).appendTo(f);f.val(t.list.indexOf(settings[s])).attr("tabindex",0).on("change",function(){settings[s]=t.list[Number(this.value)],Setting.save(),t.hasOwnProperty("onChange")&&t.onChange.call({name:s,value:settings[s],default:t.default,list:t.list})})}f.attr("id","setting-control-"+u).appendTo(d)}),e.append('<ul class="buttons">'+('<li><button id="settings-ok" class="ui-close">'+L10n.get(["settingsOk","ok"])+"</button></li>")+('<li><button id="settings-reset">'+L10n.get("settingsReset")+"</button></li>")+"</ul>").find("#settings-reset").ariaClick({one:!0},function(){jQuery(document).one(":dialogclose",function(){Setting.reset(),window.location.reload()}),Dialog.close()}),!0}function f(){try{jQuery(Dialog.setup(L10n.get("shareTitle"),"share list")).append(e("StoryShare"))}catch(e){return console.error(e),Alert.error("StoryShare",e.message),!1}return!0}return Object.freeze(Object.defineProperties({},{assembleLinkList:{value:e},alert:{value:t},jumpto:{value:r},restart:{value:n},saves:{value:a},settings:{value:i},share:{value:o},buildAutoload:{value:s},buildJumpto:{value:u},buildRestart:{value:l},buildSaves:{value:c},buildSettings:{value:d},buildShare:{value:f},stow:{value:function(){return UIBar.stow()}},unstow:{value:function(){return UIBar.unstow()}},setStoryElements:{value:function(){return UIBar.setStoryElements()}},isOpen:{value:function(){return Dialog.isOpen.apply(Dialog,arguments)}},body:{value:function(){return Dialog.body()}},setup:{value:function(){return Dialog.setup.apply(Dialog,arguments)}},addClickHandler:{value:function(){return Dialog.addClickHandler.apply(Dialog,arguments)}},open:{value:function(){return Dialog.open.apply(Dialog,arguments)}},close:{value:function(){return Dialog.close.apply(Dialog,arguments)}},resize:{value:function(){return Dialog.resize()}},buildDialogAutoload:{value:s},buildDialogJumpto:{value:u},buildDialogRestart:{value:l},buildDialogSaves:{value:c},buildDialogSettings:{value:d},buildDialogShare:{value:f},buildLinkListFromPassage:{value:e}}))}(),UIBar=function(){function e(){o||document.getElementById("ui-bar")||(!function(){var e=L10n.get("uiBarToggle"),t=L10n.get("uiBarBackward"),r=L10n.get("uiBarJumpto"),n=L10n.get("uiBarForward");jQuery(document.createDocumentFragment()).append('<div id="ui-bar"><div id="ui-bar-tray">'+('<button id="ui-bar-toggle" tabindex="0" title="'+e+'" aria-label="'+e+'"></button>')+'<div id="ui-bar-history">'+('<button id="history-backward" tabindex="0" title="'+t+'" aria-label="'+t+'"></button>')+('<button id="history-jumpto" tabindex="0" title="'+r+'" aria-label="'+r+'"></button>')+('<button id="history-forward" tabindex="0" title="'+n+'" aria-label="'+n+'"></button>')+'</div></div><div id="ui-bar-body"><header id="title" role="banner"><div id="story-banner"></div><h1 id="story-title"></h1><div id="story-subtitle"></div><div id="story-title-separator"></div><p id="story-author"></p></header><div id="story-caption"></div><nav id="menu" role="navigation"><ul id="menu-story"></ul><ul id="menu-core">'+('<li id="menu-item-saves"><a tabindex="0">'+L10n.get("savesTitle")+"</a></li>")+('<li id="menu-item-settings"><a tabindex="0">'+L10n.get("settingsTitle")+"</a></li>")+('<li id="menu-item-restart"><a tabindex="0">'+L10n.get("restartTitle")+"</a></li>")+('<li id="menu-item-share"><a tabindex="0">'+L10n.get("shareTitle")+"</a></li>")+"</ul></nav></div></div>").insertBefore("#store-area")}(),jQuery(document).on(":historyupdate.ui-bar",function(e,t){return function(){e.prop("disabled",State.length<2),t.prop("disabled",State.length===State.size)}}(jQuery("#history-backward"),jQuery("#history-forward"))))}function t(){if(!o){var e=jQuery("#ui-bar");("boolean"==typeof Config.ui.stowBarInitially?Config.ui.stowBarInitially:jQuery(window).width()<=Config.ui.stowBarInitially)&&!function(){var t=jQuery(e).add("#story");t.addClass("no-transition"),e.addClass("stowed"),setTimeout(function(){return t.removeClass("no-transition")},Engine.minDomActionDelay)}(),jQuery("#ui-bar-toggle").ariaClick({label:L10n.get("uiBarToggle")},function(){return e.toggleClass("stowed")}),Config.history.controls?(jQuery("#history-backward").prop("disabled",State.length<2).ariaClick({label:L10n.get("uiBarBackward")},function(){return Engine.backward()}),Story.lookup("tags","bookmark").length>0?jQuery("#history-jumpto").ariaClick({label:L10n.get("uiBarJumpto")},function(){return UI.jumpto()}):jQuery("#history-jumpto").remove(),jQuery("#history-forward").prop("disabled",State.length===State.size).ariaClick({label:L10n.get("uiBarForward")},function(){return Engine.forward()})):jQuery("#ui-bar-history").remove(),jQuery("#story-title").text(Story.title),Story.has("StoryCaption")||jQuery("#story-caption").remove(),Story.has("StoryMenu")||jQuery("#menu-story").remove(),Config.ui.updateStoryElements||i(),Dialog.addClickHandler("#menu-item-saves a",null,UI.buildSaves).text(L10n.get("savesTitle")),Setting.isEmpty()?jQuery("#menu-item-settings").remove():Dialog.addClickHandler("#menu-item-settings a",null,UI.buildSettings).text(L10n.get("settingsTitle")),Dialog.addClickHandler("#menu-item-restart a",null,UI.buildRestart).text(L10n.get("restartTitle")),Story.has("StoryShare")?Dialog.addClickHandler("#menu-item-share a",null,UI.buildShare).text(L10n.get("shareTitle")):jQuery("#menu-item-share").remove()}}function r(){o||(jQuery(document).off(".ui-bar"),jQuery("#ui-bar").remove(),jQuery(document.head).find("#style-ui-bar").remove(),Config.ui.updateStoryElements=!1,o=!0)}function n(){o||jQuery("#ui-bar").addClass("stowed")}function a(){o||jQuery("#ui-bar").removeClass("stowed")}function i(){if(!o){setPageElement("story-banner","StoryBanner"),setPageElement("story-subtitle","StorySubtitle"),setPageElement("story-author","StoryAuthor"),setPageElement("story-caption","StoryCaption");var e=document.getElementById("menu-story");if(null!==e&&(jQuery(e).empty(),Story.has("StoryMenu")))try{UI.assembleLinkList("StoryMenu",e)}catch(e){console.error(e),Alert.error("StoryMenu",e.message)}}}var o=!1;return Object.freeze(Object.defineProperties({},{init:{value:e},start:{value:t},destroy:{value:r},stow:{value:n},unstow:{value:a},setStoryElements:{value:i}}))}(),LoadScreen=function(){function e(){jQuery(document).on("readystatechange.SugarCube",function(){o.size>0||("complete"===document.readyState?"loading"===jQuery(document.documentElement).attr("data-init")&&(Config.loadDelay>0?setTimeout(function(){0===o.size&&r()},Math.max(Engine.minDomActionDelay,Config.loadDelay)):r()):n())})}function t(){jQuery(document).off("readystatechange.SugarCube"),o.clear(),r()}function r(){jQuery(document.documentElement).removeAttr("data-init")}function n(){jQuery(document.documentElement).attr("data-init","loading")}function a(){return++s,o.add(s),n(),s}function i(e){if(null==e)throw new Error("LoadScreen.unlock called with a null or undefined ID");o.has(e)&&o.delete(e),0===o.size&&jQuery(document).trigger("readystatechange")}var o=new Set,s=0;return Object.freeze(Object.defineProperties({},{init:{value:e},clear:{value:t},hide:{value:r
},show:{value:n},lock:{value:a},unlock:{value:i}}))}(),version=Object.freeze({title:"SugarCube",major:2,minor:19,patch:0,prerelease:null,build:8048,date:new Date("2017-07-14T16:14:44.638Z"),extensions:{},toString:function(){var e=this.prerelease?"-"+this.prerelease:"";return this.major+"."+this.minor+"."+this.patch+e+"+"+this.build},short:function(){var e=this.prerelease?"-"+this.prerelease:"";return this.title+" (v"+this.major+"."+this.minor+"."+this.patch+e+")"},long:function(){return this.title+" v"+this.toString()+" ("+this.date.toUTCString()+")"}}),TempState={},macros={},postdisplay={},postrender={},predisplay={},prehistory={},prerender={},session=null,settings={},setup={},storage=null,browser=Browser,config=Config,has=Has,History=State,state=State,tale=Story,TempVariables=State.temporary;window.SugarCube={},jQuery(function(){try{var e=LoadScreen.lock();LoadScreen.init(),document.normalize&&document.normalize(),Story.load(),storage=SimpleStore.create(Story.domId,!0),session=SimpleStore.create(Story.domId,!1),Dialog.init(),UIBar.init(),Engine.init(),Story.init(),L10n.init(),session.has("rcWarn")||"cookie"!==storage.name||(session.set("rcWarn",1),window.alert(L10n.get("warningNoWebStorage"))),Save.init(),Setting.init(),Macro.init(),Engine.start(),UIBar.start(),window.SugarCube={Browser:Browser,Config:Config,Dialog:Dialog,DebugView:DebugView,Engine:Engine,Has:Has,L10n:L10n,Macro:Macro,Passage:Passage,Save:Save,Scripting:Scripting,Setting:Setting,SimpleAudio:SimpleAudio,State:State,Story:Story,UI:UI,UIBar:UIBar,Util:Util,Wikifier:Wikifier,macros:macros,session:session,settings:settings,setup:setup,storage:storage,version:version},LoadScreen.unlock(e)}catch(e){return console.error(e),LoadScreen.clear(),Alert.fatal(null,e.message,e)}})}(window,window.document,jQuery);}
	</script>
</body>
</html>
